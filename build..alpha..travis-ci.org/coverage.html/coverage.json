{"/home/travis/build/npmtest/node-npmtest-exceljs/test.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/test.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":1,"20":1,"21":2,"22":2,"23":2,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":2,"40":2,"41":1,"42":2,"43":2,"44":1,"45":2,"46":2,"47":1,"48":2,"49":2,"50":1,"51":1,"52":1,"53":1,"54":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[1,1],"5":[1,1],"6":[1,1],"7":[1,1],"8":[1,1],"9":[1,1],"10":[1,1,1],"11":[1,1],"12":[1,1],"13":[1,1],"14":[1,1],"15":[1,1],"16":[1,1],"17":[1,1]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":5},"end":{"line":61,"column":17}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":5},"end":{"line":82,"column":17}}},"6":{"name":"(anonymous_6)","line":91,"loc":{"start":{"line":91,"column":77},"end":{"line":94,"column":10}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":83},"end":{"line":115,"column":10}},"skip":true},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":77},"end":{"line":126,"column":10}},"skip":true},"9":{"name":"(anonymous_9)","line":139,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":40}},"skip":true},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":77},"end":{"line":150,"column":10}},"skip":true},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":83},"end":{"line":161,"column":10}},"skip":true},"12":{"name":"(anonymous_12)","line":169,"loc":{"start":{"line":169,"column":79},"end":{"line":172,"column":10}},"skip":true},"13":{"name":"(anonymous_13)","line":180,"loc":{"start":{"line":180,"column":75},"end":{"line":183,"column":10}},"skip":true}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":195,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":56,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":40,"column":8},"end":{"line":53,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":46,"column":14}},"12":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"13":{"start":{"line":50,"column":12},"end":{"line":51,"column":46}},"14":{"start":{"line":52,"column":12},"end":{"line":52,"column":18}},"15":{"start":{"line":55,"column":8},"end":{"line":55,"column":35}},"16":{"start":{"line":61,"column":4},"end":{"line":63,"column":9}},"17":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"18":{"start":{"line":64,"column":4},"end":{"line":77,"column":5}},"19":{"start":{"line":70,"column":8},"end":{"line":70,"column":14}},"20":{"start":{"line":76,"column":8},"end":{"line":76,"column":14}},"21":{"start":{"line":82,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"23":{"start":{"line":85,"column":4},"end":{"line":194,"column":5}},"24":{"start":{"line":91,"column":8},"end":{"line":99,"column":10}},"25":{"start":{"line":98,"column":12},"end":{"line":98,"column":35}},"26":{"start":{"line":102,"column":8},"end":{"line":104,"column":63}},"27":{"start":{"line":105,"column":8},"end":{"line":105,"column":14}},"28":{"start":{"line":112,"column":8},"end":{"line":121,"column":10},"skip":true},"29":{"start":{"line":119,"column":12},"end":{"line":119,"column":55},"skip":true},"30":{"start":{"line":120,"column":12},"end":{"line":120,"column":48},"skip":true},"31":{"start":{"line":123,"column":8},"end":{"line":136,"column":10},"skip":true},"32":{"start":{"line":130,"column":12},"end":{"line":130,"column":76},"skip":true},"33":{"start":{"line":131,"column":12},"end":{"line":131,"column":73},"skip":true},"34":{"start":{"line":132,"column":12},"end":{"line":132,"column":74},"skip":true},"35":{"start":{"line":133,"column":12},"end":{"line":133,"column":79},"skip":true},"36":{"start":{"line":134,"column":12},"end":{"line":134,"column":25},"skip":true},"37":{"start":{"line":135,"column":12},"end":{"line":135,"column":45},"skip":true},"38":{"start":{"line":138,"column":8},"end":{"line":145,"column":14},"skip":true},"39":{"start":{"line":143,"column":16},"end":{"line":143,"column":29},"skip":true},"40":{"start":{"line":144,"column":16},"end":{"line":144,"column":55},"skip":true},"41":{"start":{"line":147,"column":8},"end":{"line":156,"column":10},"skip":true},"42":{"start":{"line":154,"column":12},"end":{"line":154,"column":25},"skip":true},"43":{"start":{"line":155,"column":12},"end":{"line":155,"column":45},"skip":true},"44":{"start":{"line":158,"column":8},"end":{"line":167,"column":10},"skip":true},"45":{"start":{"line":165,"column":12},"end":{"line":165,"column":25},"skip":true},"46":{"start":{"line":166,"column":12},"end":{"line":166,"column":48},"skip":true},"47":{"start":{"line":169,"column":8},"end":{"line":178,"column":10},"skip":true},"48":{"start":{"line":176,"column":12},"end":{"line":176,"column":25},"skip":true},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":46},"skip":true},"50":{"start":{"line":180,"column":8},"end":{"line":189,"column":10},"skip":true},"51":{"start":{"line":187,"column":12},"end":{"line":187,"column":94},"skip":true},"52":{"start":{"line":188,"column":12},"end":{"line":188,"column":48},"skip":true},"53":{"start":{"line":192,"column":8},"end":{"line":192,"column":35},"skip":true},"54":{"start":{"line":193,"column":8},"end":{"line":193,"column":14},"skip":true}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":40,"type":"switch","locations":[{"start":{"line":42,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":52,"column":18}}]},"5":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":44}},{"start":{"line":44,"column":48},"end":{"line":44,"column":66}}]},"6":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":21},"end":{"line":50,"column":49}},{"start":{"line":50,"column":53},"end":{"line":50,"column":72}}]},"7":{"line":64,"type":"switch","locations":[{"start":{"line":69,"column":4},"end":{"line":70,"column":14}},{"start":{"line":75,"column":4},"end":{"line":76,"column":14}}]},"8":{"line":85,"type":"switch","locations":[{"start":{"line":90,"column":4},"end":{"line":105,"column":14}},{"start":{"line":111,"column":4},"end":{"line":193,"column":14},"skip":true}]},"9":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":42},"end":{"line":91,"column":73}},{"start":{"line":91,"column":77},"end":{"line":99,"column":9}}]},"10":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":18},"end":{"line":102,"column":32}},{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},{"start":{"line":104,"column":12},"end":{"line":104,"column":61}}]},"11":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":45},"end":{"line":112,"column":79},"skip":true},{"start":{"line":112,"column":83},"end":{"line":121,"column":9},"skip":true}]},"12":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":42},"end":{"line":123,"column":73},"skip":true},{"start":{"line":123,"column":77},"end":{"line":136,"column":9},"skip":true}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":48},"end":{"line":138,"column":85},"skip":true},{"start":{"line":139,"column":12},"end":{"line":145,"column":13},"skip":true}]},"14":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":42},"end":{"line":147,"column":73},"skip":true},{"start":{"line":147,"column":77},"end":{"line":156,"column":9},"skip":true}]},"15":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":45},"end":{"line":158,"column":79},"skip":true},{"start":{"line":158,"column":83},"end":{"line":167,"column":9},"skip":true}]},"16":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":43},"end":{"line":169,"column":75},"skip":true},{"start":{"line":169,"column":79},"end":{"line":178,"column":9},"skip":true}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":41},"end":{"line":180,"column":71},"skip":true},{"start":{"line":180,"column":75},"end":{"line":189,"column":9},"skip":true}]}},"code":["/* istanbul instrument in package npmtest_exceljs */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - pre-init","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        switch (local.modeJs) {","        // re-init local from window.local","        case 'browser':","            local = local.global.utility2.objectSetDefault(","                local.global.utility2_rollup || local.global.local,","                local.global.utility2","            );","            break;","        // re-init local from example.js","        case 'node':","            local = (local.global.utility2_rollup || require('utility2'))","                .requireExampleJsFromReadme();","            break;","        }","        // export local","        local.global.local = local;","    }());","","","","    // run shared js-env code - function","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - function","    case 'browser':","        break;","","","","    // run node js-env code - function","    case 'node':","        break;","    }","","","","    // run shared js-env code - post-init","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - post-init","    case 'browser':","        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (","            options,","            onError","        ) {","        /*","         * this function will test browsers's null-case handling-behavior-behavior","         */","            onError(null, options);","        };","","        // run tests","        local.nop(local.modeTest &&","            document.querySelector('#testRunButton1') &&","            document.querySelector('#testRunButton1').click());","        break;","","","","    // run node js-env code - post-init","    /* istanbul ignore next */","    case 'node':","        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApidoc's default handling-behavior-behavior","         */","            options = { modulePathList: module.paths };","            local.buildApidoc(options, onError);","        };","","        local.testCase_buildApp_default = local.testCase_buildApp_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApp's default handling-behavior-behavior","         */","            local.testCase_buildReadme_default(options, local.onErrorThrow);","            local.testCase_buildLib_default(options, local.onErrorThrow);","            local.testCase_buildTest_default(options, local.onErrorThrow);","            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);","            options = [];","            local.buildApp(options, onError);","        };","","        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||","            function (options, onError) {","            /*","             * this function will test buildCustomOrg's default handling-behavior","             */","                options = {};","                local.buildCustomOrg(options, onError);","            };","","        local.testCase_buildLib_default = local.testCase_buildLib_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildLib's default handling-behavior","         */","            options = {};","            local.buildLib(options, onError);","        };","","        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildReadme's default handling-behavior-behavior","         */","            options = {};","            local.buildReadme(options, onError);","        };","","        local.testCase_buildTest_default = local.testCase_buildTest_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildTest's default handling-behavior","         */","            options = {};","            local.buildTest(options, onError);","        };","","        local.testCase_webpage_default = local.testCase_webpage_default || function (","            options,","            onError","        ) {","        /*","         * this function will test webpage's default handling-behavior","         */","            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };","            local.browserTest(options, onError);","        };","","        // run test-server","        local.testRunServer(local);","        break;","    }","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"40":2,"43":1,"47":1,"50":1,"52":1,"55":2,"61":2,"62":2,"64":2,"70":1,"76":1,"82":2,"83":2,"85":2,"91":1,"98":1,"102":1,"105":1,"112":1,"119":1,"120":1,"123":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"138":1,"143":2,"144":2,"147":1,"154":2,"155":2,"158":1,"165":2,"166":2,"169":1,"176":2,"177":2,"180":1,"187":1,"188":1,"192":1,"193":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/lib.npmtest_exceljs.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/lib.npmtest_exceljs.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":1,"15":1,"16":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1]},"f":{"1":2,"2":2,"3":2},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":53,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":52,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"11":{"start":{"line":43,"column":8},"end":{"line":43,"column":52}},"12":{"start":{"line":45,"column":8},"end":{"line":51,"column":9}},"13":{"start":{"line":46,"column":12},"end":{"line":46,"column":58}},"14":{"start":{"line":48,"column":12},"end":{"line":48,"column":35}},"15":{"start":{"line":49,"column":12},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":12},"end":{"line":50,"column":43}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":44}},{"start":{"line":41,"column":48},"end":{"line":41,"column":53}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]}},"code":["/* istanbul instrument in package npmtest_exceljs */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - pre-init","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || local;","        // init lib","        local.local = local.npmtest_exceljs = local;","        // init exports","        if (local.modeJs === 'browser') {","            local.global.utility2_npmtest_exceljs = local;","        } else {","            module.exports = local;","            module.exports.__dirname = __dirname;","            module.exports.module = module;","        }","    }());","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"41":2,"43":2,"45":2,"46":1,"48":1,"49":1,"50":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/example.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/example.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":2,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":0,"32":0,"33":0,"34":1,"35":2,"36":2,"37":3,"38":3,"39":3,"40":3,"41":0,"42":3,"43":3,"44":3,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":1,"59":6,"60":6,"61":1,"62":2,"63":0,"64":2,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1],"6":[1,1],"7":[2,0],"8":[2,1,1,1,1,1],"9":[0,2,0],"10":[1,1],"11":[2,1,1],"12":[1,0],"13":[0,2],"14":[2,0,0,0,0,0,0],"15":[0,3],"16":[3,0],"17":[1,1],"18":[0,1],"19":[1,2,0,2],"20":[1,0],"21":[1,1],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":3,"8":3,"9":3,"10":1,"11":6,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":13}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":5},"end":{"line":33,"column":17}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":36}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":48}},"skip":true},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":26},"end":{"line":78,"column":45}},"skip":true},"6":{"name":"(anonymous_6)","line":123,"loc":{"start":{"line":123,"column":33},"end":{"line":123,"column":48}},"skip":true},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":27},"end":{"line":125,"column":39}},"skip":true},"8":{"name":"(anonymous_8)","line":133,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":74}},"skip":true},"9":{"name":"(anonymous_9)","line":143,"loc":{"start":{"line":143,"column":45},"end":{"line":143,"column":62}},"skip":true},"10":{"name":"(anonymous_10)","line":144,"loc":{"start":{"line":144,"column":73},"end":{"line":144,"column":92}},"skip":true},"11":{"name":"(anonymous_11)","line":272,"loc":{"start":{"line":272,"column":51},"end":{"line":272,"column":77}},"skip":true},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":32},"end":{"line":315,"column":61}},"skip":true}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":326,"column":5}},"2":{"start":{"line":28,"column":4},"end":{"line":28,"column":14}},"3":{"start":{"line":33,"column":4},"end":{"line":60,"column":9}},"4":{"start":{"line":35,"column":8},"end":{"line":35,"column":19}},"5":{"start":{"line":37,"column":8},"end":{"line":49,"column":13}},"6":{"start":{"line":38,"column":12},"end":{"line":48,"column":13}},"7":{"start":{"line":39,"column":16},"end":{"line":42,"column":30}},"8":{"start":{"line":44,"column":16},"end":{"line":47,"column":27}},"9":{"start":{"line":51,"column":8},"end":{"line":53,"column":21}},"10":{"start":{"line":55,"column":8},"end":{"line":57,"column":45}},"11":{"start":{"line":59,"column":8},"end":{"line":59,"column":35}},"12":{"start":{"line":61,"column":4},"end":{"line":325,"column":5}},"13":{"start":{"line":69,"column":8},"end":{"line":121,"column":10},"skip":true},"14":{"start":{"line":70,"column":12},"end":{"line":88,"column":13},"skip":true},"15":{"start":{"line":76,"column":16},"end":{"line":87,"column":19},"skip":true},"16":{"start":{"line":79,"column":20},"end":{"line":86,"column":21},"skip":true},"17":{"start":{"line":82,"column":24},"end":{"line":82,"column":43},"skip":true},"18":{"start":{"line":83,"column":24},"end":{"line":83,"column":30},"skip":true},"19":{"start":{"line":85,"column":24},"end":{"line":85,"column":49},"skip":true},"20":{"start":{"line":89,"column":12},"end":{"line":107,"column":13},"skip":true},"21":{"start":{"line":92,"column":16},"end":{"line":102,"column":17},"skip":true},"22":{"start":{"line":93,"column":20},"end":{"line":93,"column":86},"skip":true},"23":{"start":{"line":94,"column":20},"end":{"line":95,"column":45},"skip":true},"24":{"start":{"line":96,"column":20},"end":{"line":96,"column":42},"skip":true},"25":{"start":{"line":97,"column":20},"end":{"line":97,"column":48},"skip":true},"26":{"start":{"line":100,"column":20},"end":{"line":100,"column":85},"skip":true},"27":{"start":{"line":101,"column":20},"end":{"line":101,"column":96},"skip":true},"28":{"start":{"line":103,"column":16},"end":{"line":103,"column":22},"skip":true},"29":{"start":{"line":106,"column":16},"end":{"line":106,"column":22},"skip":true},"30":{"start":{"line":108,"column":12},"end":{"line":120,"column":13},"skip":true},"31":{"start":{"line":114,"column":16},"end":{"line":119,"column":17},"skip":true},"32":{"start":{"line":116,"column":20},"end":{"line":116,"column":78},"skip":true},"33":{"start":{"line":118,"column":20},"end":{"line":118,"column":47},"skip":true},"34":{"start":{"line":123,"column":8},"end":{"line":141,"column":11},"skip":true},"35":{"start":{"line":124,"column":12},"end":{"line":124,"column":54},"skip":true},"36":{"start":{"line":125,"column":12},"end":{"line":140,"column":14},"skip":true},"37":{"start":{"line":126,"column":16},"end":{"line":126,"column":28},"skip":true},"38":{"start":{"line":127,"column":16},"end":{"line":127,"column":69},"skip":true},"39":{"start":{"line":128,"column":16},"end":{"line":128,"column":75},"skip":true},"40":{"start":{"line":129,"column":16},"end":{"line":131,"column":17},"skip":true},"41":{"start":{"line":130,"column":20},"end":{"line":130,"column":27},"skip":true},"42":{"start":{"line":133,"column":16},"end":{"line":137,"column":36},"skip":true},"43":{"start":{"line":134,"column":20},"end":{"line":136,"column":55},"skip":true},"44":{"start":{"line":139,"column":16},"end":{"line":139,"column":57},"skip":true},"45":{"start":{"line":143,"column":8},"end":{"line":147,"column":11},"skip":true},"46":{"start":{"line":144,"column":12},"end":{"line":146,"column":15},"skip":true},"47":{"start":{"line":145,"column":16},"end":{"line":145,"column":70},"skip":true},"48":{"start":{"line":149,"column":8},"end":{"line":149,"column":31},"skip":true},"49":{"start":{"line":150,"column":8},"end":{"line":150,"column":14},"skip":true},"50":{"start":{"line":158,"column":8},"end":{"line":158,"column":31},"skip":true},"51":{"start":{"line":160,"column":8},"end":{"line":160,"column":33},"skip":true},"52":{"start":{"line":161,"column":8},"end":{"line":161,"column":37},"skip":true},"53":{"start":{"line":162,"column":8},"end":{"line":162,"column":35},"skip":true},"54":{"start":{"line":164,"column":8},"end":{"line":164,"column":50},"skip":true},"55":{"start":{"line":166,"column":8},"end":{"line":256,"column":2},"skip":true},"56":{"start":{"line":258,"column":8},"end":{"line":286,"column":9},"skip":true},"57":{"start":{"line":259,"column":12},"end":{"line":269,"column":14},"skip":true},"58":{"start":{"line":271,"column":12},"end":{"line":285,"column":19},"skip":true},"59":{"start":{"line":274,"column":20},"end":{"line":274,"column":35},"skip":true},"60":{"start":{"line":275,"column":20},"end":{"line":284,"column":21},"skip":true},"61":{"start":{"line":277,"column":24},"end":{"line":277,"column":64},"skip":true},"62":{"start":{"line":279,"column":24},"end":{"line":279,"column":40},"skip":true},"63":{"start":{"line":281,"column":24},"end":{"line":281,"column":40},"skip":true},"64":{"start":{"line":283,"column":24},"end":{"line":283,"column":39},"skip":true},"65":{"start":{"line":288,"column":8},"end":{"line":290,"column":9},"skip":true},"66":{"start":{"line":289,"column":12},"end":{"line":289,"column":18},"skip":true},"67":{"start":{"line":291,"column":8},"end":{"line":293,"column":54},"skip":true},"68":{"start":{"line":296,"column":8},"end":{"line":301,"column":37},"skip":true},"69":{"start":{"line":303,"column":8},"end":{"line":303,"column":82},"skip":true},"70":{"start":{"line":306,"column":8},"end":{"line":308,"column":9},"skip":true},"71":{"start":{"line":307,"column":12},"end":{"line":307,"column":82},"skip":true},"72":{"start":{"line":310,"column":8},"end":{"line":312,"column":9},"skip":true},"73":{"start":{"line":311,"column":12},"end":{"line":311,"column":18},"skip":true},"74":{"start":{"line":313,"column":8},"end":{"line":313,"column":54},"skip":true},"75":{"start":{"line":314,"column":8},"end":{"line":314,"column":69},"skip":true},"76":{"start":{"line":315,"column":8},"end":{"line":323,"column":36},"skip":true},"77":{"start":{"line":316,"column":12},"end":{"line":316,"column":61},"skip":true},"78":{"start":{"line":317,"column":12},"end":{"line":320,"column":13},"skip":true},"79":{"start":{"line":318,"column":16},"end":{"line":318,"column":75},"skip":true},"80":{"start":{"line":319,"column":16},"end":{"line":319,"column":23},"skip":true},"81":{"start":{"line":321,"column":12},"end":{"line":321,"column":38},"skip":true},"82":{"start":{"line":322,"column":12},"end":{"line":322,"column":27},"skip":true},"83":{"start":{"line":324,"column":8},"end":{"line":324,"column":14},"skip":true}},"branchMap":{"1":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":23},"end":{"line":39,"column":62}},{"start":{"line":40,"column":20},"end":{"line":40,"column":70}},{"start":{"line":41,"column":20},"end":{"line":41,"column":71}},{"start":{"line":42,"column":20},"end":{"line":42,"column":29}}]},"2":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":23},"end":{"line":44,"column":37}},{"start":{"line":45,"column":20},"end":{"line":45,"column":61}},{"start":{"line":46,"column":20},"end":{"line":46,"column":70}},{"start":{"line":47,"column":20},"end":{"line":47,"column":26}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":52,"column":14},"end":{"line":52,"column":20}},{"start":{"line":53,"column":14},"end":{"line":53,"column":20}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":44}},{"start":{"line":55,"column":49},"end":{"line":57,"column":43}}]},"5":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":51}},{"start":{"line":57,"column":14},"end":{"line":57,"column":43}}]},"6":{"line":61,"type":"switch","locations":[{"start":{"line":68,"column":4},"end":{"line":150,"column":14},"skip":true},{"start":{"line":156,"column":4},"end":{"line":324,"column":14},"skip":true}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true},{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":22},"skip":true},{"start":{"line":70,"column":27},"end":{"line":70,"column":32},"skip":true},{"start":{"line":71,"column":20},"end":{"line":71,"column":39},"skip":true},{"start":{"line":72,"column":20},"end":{"line":72,"column":49},"skip":true},{"start":{"line":73,"column":20},"end":{"line":73,"column":58},"skip":true},{"start":{"line":74,"column":20},"end":{"line":74,"column":69},"skip":true}]},"9":{"line":79,"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":80,"column":33},"skip":true},{"start":{"line":81,"column":20},"end":{"line":83,"column":30},"skip":true},{"start":{"line":84,"column":20},"end":{"line":85,"column":49},"skip":true}]},"10":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":12},"end":{"line":103,"column":22},"skip":true},{"start":{"line":105,"column":12},"end":{"line":106,"column":22},"skip":true}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":25},"skip":true},{"start":{"line":89,"column":29},"end":{"line":89,"column":48},"skip":true},{"start":{"line":89,"column":52},"end":{"line":89,"column":74},"skip":true}]},"12":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true},{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true}]},"13":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true},{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true}]},"14":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":16},"end":{"line":108,"column":61},"skip":true},{"start":{"line":108,"column":66},"end":{"line":108,"column":72},"skip":true},{"start":{"line":108,"column":77},"end":{"line":108,"column":82},"skip":true},{"start":{"line":109,"column":20},"end":{"line":109,"column":39},"skip":true},{"start":{"line":110,"column":20},"end":{"line":110,"column":49},"skip":true},{"start":{"line":111,"column":20},"end":{"line":111,"column":58},"skip":true},{"start":{"line":112,"column":20},"end":{"line":112,"column":68},"skip":true}]},"15":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true},{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true}]},"16":{"line":134,"type":"cond-expr","locations":[{"start":{"line":135,"column":26},"end":{"line":135,"column":29},"skip":true},{"start":{"line":136,"column":26},"end":{"line":136,"column":54},"skip":true}]},"17":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":27},"end":{"line":164,"column":43},"skip":true},{"start":{"line":164,"column":47},"end":{"line":164,"column":49},"skip":true}]},"18":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true},{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true}]},"19":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":20},"end":{"line":277,"column":64},"skip":true},{"start":{"line":278,"column":20},"end":{"line":279,"column":40},"skip":true},{"start":{"line":280,"column":20},"end":{"line":281,"column":40},"skip":true},{"start":{"line":282,"column":20},"end":{"line":283,"column":39},"skip":true}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true},{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true}]},"21":{"line":288,"type":"binary-expr","locations":[{"start":{"line":288,"column":12},"end":{"line":288,"column":40},"skip":true},{"start":{"line":288,"column":44},"end":{"line":288,"column":67},"skip":true}]},"22":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":12},"end":{"line":292,"column":50},"skip":true},{"start":{"line":293,"column":12},"end":{"line":293,"column":53},"skip":true}]},"23":{"line":297,"type":"binary-expr","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":65},"skip":true},{"start":{"line":298,"column":12},"end":{"line":301,"column":36},"skip":true}]},"24":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":43},"end":{"line":303,"column":75},"skip":true},{"start":{"line":303,"column":79},"end":{"line":303,"column":81},"skip":true}]},"25":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true},{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true}]},"26":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true},{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true}]},"27":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":27},"end":{"line":313,"column":43},"skip":true},{"start":{"line":313,"column":47},"end":{"line":313,"column":53},"skip":true}]},"28":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true},{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true}]}},"code":["/*","example.js","","quickstart example","","instruction","    1. save this script as example.js","    2. run the shell command:","        $ npm install npmtest-exceljs && PORT=8081 node example.js","    3. play with the browser-demo on http://127.0.0.1:8081","*/","","","","/* istanbul instrument in package npmtest_exceljs */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - pre-init","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || (local.modeJs === 'browser'","            ? local.global.utility2_npmtest_exceljs","            : global.utility2_moduleExports);","        // export local","        local.global.local = local;","    }());","    switch (local.modeJs) {","","","","    // post-init","    // run browser js-env code - post-init","    /* istanbul ignore next */","    case 'browser':","        local.testRunBrowser = function (event) {","            if (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('onreset'))) {","                // reset output","                Array.from(","                    document.querySelectorAll('body > .resettable')","                ).forEach(function (element) {","                    switch (element.tagName) {","                    case 'INPUT':","                    case 'TEXTAREA':","                        element.value = '';","                        break;","                    default:","                        element.textContent = '';","                    }","                });","            }","            switch (event && event.currentTarget && event.currentTarget.id) {","            case 'testRunButton1':","                // show tests","                if (document.querySelector('#testReportDiv1').style.display === 'none') {","                    document.querySelector('#testReportDiv1').style.display = 'block';","                    document.querySelector('#testRunButton1').textContent =","                        'hide internal test';","                    local.modeTest = true;","                    local.testRunDefault(local);","                // hide tests","                } else {","                    document.querySelector('#testReportDiv1').style.display = 'none';","                    document.querySelector('#testRunButton1').textContent = 'run internal test';","                }","                break;","            // custom-case","            default:","                break;","            }","            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('oneval')))) {","                // try to eval input-code","                try {","                    /*jslint evil: true*/","                    eval(document.querySelector('#inputTextareaEval1').value);","                } catch (errorCaught) {","                    console.error(errorCaught);","                }","            }","        };","        // log stderr and stdout to #outputTextareaStdout1","        ['error', 'log'].forEach(function (key) {","            console[key + '_original'] = console[key];","            console[key] = function () {","                var element;","                console[key + '_original'].apply(console, arguments);","                element = document.querySelector('#outputTextareaStdout1');","                if (!element) {","                    return;","                }","                // append text to #outputTextareaStdout1","                element.value += Array.from(arguments).map(function (arg) {","                    return typeof arg === 'string'","                        ? arg","                        : JSON.stringify(arg, null, 4);","                }).join(' ') + '\\n';","                // scroll textarea to bottom","                element.scrollTop = element.scrollHeight;","            };","        });","        // init event-handling","        ['change', 'click', 'keyup'].forEach(function (event) {","            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {","                element.addEventListener(event, local.testRunBrowser);","            });","        });","        // run tests","        local.testRunBrowser();","        break;","","","","    // run node js-env code - post-init","    /* istanbul ignore next */","    case 'node':","        // export local","        module.exports = local;","        // require modules","        local.fs = require('fs');","        local.http = require('http');","        local.url = require('url');","        // init assets","        local.assetsDict = local.assetsDict || {};","        /* jslint-ignore-begin */","        local.assetsDict['/assets.index.template.html'] = '\\","<!doctype html>\\n\\","<html lang=\"en\">\\n\\","<head>\\n\\","<meta charset=\"UTF-8\">\\n\\","<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\","<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\","<style>\\n\\","/*csslint\\n\\","    box-sizing: false,\\n\\","    universal-selector: false\\n\\","*/\\n\\","* {\\n\\","    box-sizing: border-box;\\n\\","}\\n\\","body {\\n\\","    background: #dde;\\n\\","    font-family: Arial, Helvetica, sans-serif;\\n\\","    margin: 2rem;\\n\\","}\\n\\","body > * {\\n\\","    margin-bottom: 1rem;\\n\\","}\\n\\",".utility2FooterDiv {\\n\\","    margin-top: 20px;\\n\\","    text-align: center;\\n\\","}\\n\\","</style>\\n\\","<style>\\n\\","/*csslint\\n\\","*/\\n\\","textarea {\\n\\","    font-family: monospace;\\n\\","    height: 10rem;\\n\\","    width: 100%;\\n\\","}\\n\\","textarea[readonly] {\\n\\","    background: #ddd;\\n\\","}\\n\\","</style>\\n\\","</head>\\n\\","<body>\\n\\","<!-- utility2-comment\\n\\","<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\","utility2-comment -->\\n\\","<h1>\\n\\","<!-- utility2-comment\\n\\","    <a\\n\\","        {{#if env.npm_package_homepage}}\\n\\","        href=\"{{env.npm_package_homepage}}\"\\n\\","        {{/if env.npm_package_homepage}}\\n\\","        target=\"_blank\"\\n\\","    >\\n\\","utility2-comment -->\\n\\","        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\","<!-- utility2-comment\\n\\","    </a>\\n\\","utility2-comment -->\\n\\","</h1>\\n\\","<h3>{{env.npm_package_description}}</h3>\\n\\","<!-- utility2-comment\\n\\","<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\","<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\","<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\","utility2-comment -->\\n\\","\\n\\","\\n\\","\\n\\","<label>stderr and stdout</label>\\n\\","<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\","<!-- utility2-comment\\n\\","{{#if isRollup}}\\n\\","<script src=\"assets.app.js\"></script>\\n\\","{{#unless isRollup}}\\n\\","utility2-comment -->\\n\\","<script src=\"assets.utility2.rollup.js\"></script>\\n\\","<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\","<script src=\"assets.npmtest_exceljs.rollup.js\"></script>\\n\\","<script src=\"assets.example.js\"></script>\\n\\","<script src=\"assets.test.js\"></script>\\n\\","<!-- utility2-comment\\n\\","{{/if isRollup}}\\n\\","utility2-comment -->\\n\\","<div class=\"utility2FooterDiv\">\\n\\","    [ this app was created with\\n\\","    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\","    ]\\n\\","</div>\\n\\","</body>\\n\\","</html>\\n\\","';","        /* jslint-ignore-end */","        if (local.templateRender) {","            local.assetsDict['/'] = local.templateRender(","                local.assetsDict['/assets.index.template.html'],","                {","                    env: local.objectSetDefault(local.env, {","                        npm_package_description: 'the greatest app in the world!',","                        npm_package_name: 'my-app',","                        npm_package_nameAlias: 'my_app',","                        npm_package_version: '0.0.1'","                    })","                }","            );","        } else {","            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']","                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {","                    // jslint-hack","                    String(match0);","                    switch (match1) {","                    case 'npm_package_description':","                        return 'the greatest app in the world!';","                    case 'npm_package_name':","                        return 'my-app';","                    case 'npm_package_nameAlias':","                        return 'my_app';","                    case 'npm_package_version':","                        return '0.0.1';","                    }","                });","        }","        // run the cli","        if (local.global.utility2_rollup || module !== require.main) {","            break;","        }","        local.assetsDict['/assets.example.js'] =","            local.assetsDict['/assets.example.js'] ||","            local.fs.readFileSync(__filename, 'utf8');","        // bug-workaround - long $npm_package_buildCustomOrg","        /* jslint-ignore-begin */","        local.assetsDict['/assets.npmtest_exceljs.rollup.js'] =","            local.assetsDict['/assets.npmtest_exceljs.rollup.js'] ||","            local.fs.readFileSync(","                local.npmtest_exceljs.__dirname + '/lib.npmtest_exceljs.js',","                'utf8'","            ).replace((/^#!/), '//');","        /* jslint-ignore-end */","        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';","        // if $npm_config_timeout_exit exists,","        // then exit this process after $npm_config_timeout_exit ms","        if (Number(process.env.npm_config_timeout_exit)) {","            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));","        }","        // start server","        if (local.global.utility2_serverHttp1) {","            break;","        }","        process.env.PORT = process.env.PORT || '8081';","        console.error('server starting on port ' + process.env.PORT);","        local.http.createServer(function (request, response) {","            request.urlParsed = local.url.parse(request.url);","            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {","                response.end(local.assetsDict[request.urlParsed.pathname]);","                return;","            }","            response.statusCode = 404;","            response.end();","        }).listen(process.env.PORT);","        break;","    }","}());",""],"l":{"26":2,"28":2,"33":2,"35":2,"37":2,"38":2,"39":2,"44":1,"51":2,"55":2,"59":2,"61":2,"69":1,"70":2,"76":2,"79":2,"82":2,"83":2,"85":1,"89":2,"92":1,"93":1,"94":1,"96":1,"97":1,"100":1,"101":1,"103":1,"106":1,"108":2,"114":1,"116":1,"118":1,"123":1,"124":2,"125":2,"126":3,"127":3,"128":3,"129":3,"130":1,"133":3,"134":3,"139":3,"143":1,"144":3,"145":1,"149":1,"150":1,"158":1,"160":1,"161":1,"162":1,"164":1,"166":1,"258":1,"259":1,"271":1,"274":6,"275":6,"277":1,"279":2,"281":1,"283":2,"288":1,"289":1,"291":1,"296":1,"303":1,"306":1,"307":1,"310":1,"311":1,"313":1,"314":1,"315":1,"316":1,"317":1,"318":1,"319":1,"321":1,"322":1,"324":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/excel.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/excel.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":24,"column":0},"end":{"line":24,"column":49}}},"branchMap":{},"code":["/**"," * Copyright (c) 2014-2017 Guyon Roche"," * "," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:</p>"," * "," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," * "," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," * "," */","","module.exports = require('./lib/exceljs.nodejs');"],"l":{"24":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/exceljs.nodejs.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/exceljs.nodejs.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":51}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":53}},"3":{"start":{"line":4,"column":0},"end":{"line":16,"column":2}},"4":{"start":{"line":18,"column":0},"end":{"line":18,"column":47}},"5":{"start":{"line":20,"column":0},"end":{"line":20,"column":25}}},"branchMap":{},"code":["var setConfigValue = require('./config/set-value');","setConfigValue('promise', require('promish'), false);","","var ExcelJS = {","  Workbook: require(\"./doc/workbook\"),","  ModelContainer: require(\"./doc/modelcontainer\"),","  stream: {","    xlsx: {","      WorkbookWriter: require(\"./stream/xlsx/workbook-writer\"),","      WorkbookReader: require(\"./stream/xlsx/workbook-reader\")","    }","  },","  config: {","    setValue: require('./config/set-value')","  }","};","","Object.assign(ExcelJS, require(\"./doc/enums\"));","","module.exports = ExcelJS;"],"l":{"1":1,"2":1,"4":1,"18":1,"20":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/config/set-value.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/config/set-value.js","s":{"1":1,"2":1,"3":2,"4":0,"5":2,"6":2,"7":1,"8":1,"9":1,"10":1},"b":{"1":[0,2],"2":[2],"3":[1,1],"4":[2,2]},"f":{"1":2},"fnMap":{"1":{"name":"setValue","line":5,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":41}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":45}},"2":{"start":{"line":5,"column":0},"end":{"line":16,"column":1}},"3":{"start":{"line":6,"column":2},"end":{"line":9,"column":3}},"4":{"start":{"line":8,"column":4},"end":{"line":8,"column":21}},"5":{"start":{"line":10,"column":2},"end":{"line":15,"column":3}},"6":{"start":{"line":12,"column":6},"end":{"line":12,"column":51}},"7":{"start":{"line":12,"column":44},"end":{"line":12,"column":51}},"8":{"start":{"line":13,"column":6},"end":{"line":13,"column":33}},"9":{"start":{"line":14,"column":6},"end":{"line":14,"column":12}},"10":{"start":{"line":18,"column":0},"end":{"line":18,"column":26}}},"branchMap":{"1":{"line":6,"type":"if","locations":[{"start":{"line":6,"column":2},"end":{"line":6,"column":2}},{"start":{"line":6,"column":2},"end":{"line":6,"column":2}}]},"2":{"line":10,"type":"switch","locations":[{"start":{"line":11,"column":4},"end":{"line":14,"column":12}}]},"3":{"line":12,"type":"if","locations":[{"start":{"line":12,"column":6},"end":{"line":12,"column":6}},{"start":{"line":12,"column":6},"end":{"line":12,"column":6}}]},"4":{"line":12,"type":"binary-expr","locations":[{"start":{"line":12,"column":10},"end":{"line":12,"column":20}},{"start":{"line":12,"column":24},"end":{"line":12,"column":42}}]}},"code":["'use strict';","","var PromishLib = require('../utils/promish');","","function setValue(key, value, overwrite) {","  if (overwrite === undefined) {","    // only avoid overwrite if explicitly disabled","    overwrite = true;","  }","  switch(key.toLowerCase()) {","    case 'promise':","      if (!overwrite && PromishLib.Promish) return;","      PromishLib.Promish = value;","      break;","  }","}","","module.exports = setValue;"],"l":{"3":1,"5":1,"6":2,"8":0,"10":2,"12":2,"13":1,"14":1,"18":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/promish.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/promish.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":5,"column":2}}},"branchMap":{},"code":["'use strict';","","module.exports = {","  Promish: null","};",""],"l":{"3":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/workbook.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/workbook.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":13,"14":13,"15":9,"16":9,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":6,"47":0,"48":0,"49":6,"50":0,"51":6,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0},"b":{"1":[13,1],"2":[13,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[6,6],"16":[6,6]},"f":{"1":0,"2":13,"3":13,"4":9,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":6,"12":0,"13":0,"14":6,"15":0,"16":6,"17":0,"18":0,"19":0},"fnMap":{"1":{"name":"(anonymous_1)","line":36,"loc":{"start":{"line":36,"column":32},"end":{"line":36,"column":43}}},"2":{"name":"(anonymous_2)","line":46,"loc":{"start":{"line":46,"column":10},"end":{"line":46,"column":13}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":9},"end":{"line":49,"column":12}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":12},"end":{"line":52,"column":15}}},"5":{"name":"(anonymous_5)","line":62,"loc":{"start":{"line":62,"column":16},"end":{"line":62,"column":40}}},"6":{"name":"(anonymous_6)","line":97,"loc":{"start":{"line":97,"column":20},"end":{"line":97,"column":40}}},"7":{"name":"(anonymous_7)","line":100,"loc":{"start":{"line":100,"column":19},"end":{"line":100,"column":32}}},"8":{"name":"(anonymous_8)","line":107,"loc":{"start":{"line":107,"column":16},"end":{"line":107,"column":29}}},"9":{"name":"(anonymous_9)","line":109,"loc":{"start":{"line":109,"column":35},"end":{"line":109,"column":55}}},"10":{"name":"(anonymous_10)","line":113,"loc":{"start":{"line":113,"column":35},"end":{"line":113,"column":55}}},"11":{"name":"(anonymous_11)","line":121,"loc":{"start":{"line":121,"column":16},"end":{"line":121,"column":19}}},"12":{"name":"(anonymous_12)","line":126,"loc":{"start":{"line":126,"column":13},"end":{"line":126,"column":32}}},"13":{"name":"(anonymous_13)","line":127,"loc":{"start":{"line":127,"column":29},"end":{"line":127,"column":45}}},"14":{"name":"(anonymous_14)","line":132,"loc":{"start":{"line":132,"column":18},"end":{"line":132,"column":21}}},"15":{"name":"(anonymous_15)","line":136,"loc":{"start":{"line":136,"column":15},"end":{"line":136,"column":26}}},"16":{"name":"(anonymous_16)","line":141,"loc":{"start":{"line":141,"column":11},"end":{"line":141,"column":14}}},"17":{"name":"(anonymous_17)","line":149,"loc":{"start":{"line":149,"column":55},"end":{"line":149,"column":75}}},"18":{"name":"(anonymous_18)","line":165,"loc":{"start":{"line":165,"column":11},"end":{"line":165,"column":19}}},"19":{"name":"(anonymous_19)","line":187,"loc":{"start":{"line":187,"column":29},"end":{"line":187,"column":54}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":39}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":46}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":37}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":34}},"5":{"start":{"line":36,"column":0},"end":{"line":43,"column":2}},"6":{"start":{"line":37,"column":2},"end":{"line":37,"column":28}},"7":{"start":{"line":38,"column":2},"end":{"line":38,"column":31}},"8":{"start":{"line":39,"column":2},"end":{"line":39,"column":23}},"9":{"start":{"line":40,"column":2},"end":{"line":40,"column":24}},"10":{"start":{"line":41,"column":2},"end":{"line":41,"column":18}},"11":{"start":{"line":42,"column":2},"end":{"line":42,"column":42}},"12":{"start":{"line":45,"column":0},"end":{"line":203,"column":2}},"13":{"start":{"line":47,"column":4},"end":{"line":47,"column":55}},"14":{"start":{"line":50,"column":4},"end":{"line":50,"column":52}},"15":{"start":{"line":54,"column":4},"end":{"line":54,"column":10}},"16":{"start":{"line":55,"column":4},"end":{"line":59,"column":5}},"17":{"start":{"line":56,"column":6},"end":{"line":58,"column":7}},"18":{"start":{"line":57,"column":8},"end":{"line":57,"column":17}},"19":{"start":{"line":60,"column":4},"end":{"line":60,"column":40}},"20":{"start":{"line":64,"column":4},"end":{"line":64,"column":25}},"21":{"start":{"line":65,"column":4},"end":{"line":65,"column":32}},"22":{"start":{"line":68,"column":4},"end":{"line":84,"column":5}},"23":{"start":{"line":69,"column":6},"end":{"line":83,"column":7}},"24":{"start":{"line":70,"column":8},"end":{"line":70,"column":150}},"25":{"start":{"line":71,"column":8},"end":{"line":75,"column":10}},"26":{"start":{"line":76,"column":13},"end":{"line":83,"column":7}},"27":{"start":{"line":77,"column":8},"end":{"line":77,"column":136}},"28":{"start":{"line":78,"column":8},"end":{"line":82,"column":10}},"29":{"start":{"line":86,"column":4},"end":{"line":90,"column":7}},"30":{"start":{"line":92,"column":4},"end":{"line":92,"column":52}},"31":{"start":{"line":94,"column":4},"end":{"line":94,"column":37}},"32":{"start":{"line":95,"column":4},"end":{"line":95,"column":21}},"33":{"start":{"line":98,"column":4},"end":{"line":98,"column":42}},"34":{"start":{"line":101,"column":4},"end":{"line":101,"column":42}},"35":{"start":{"line":102,"column":4},"end":{"line":104,"column":5}},"36":{"start":{"line":103,"column":6},"end":{"line":103,"column":26}},"37":{"start":{"line":108,"column":4},"end":{"line":118,"column":5}},"38":{"start":{"line":109,"column":6},"end":{"line":109,"column":78}},"39":{"start":{"line":109,"column":57},"end":{"line":109,"column":74}},"40":{"start":{"line":110,"column":11},"end":{"line":118,"column":5}},"41":{"start":{"line":111,"column":6},"end":{"line":111,"column":34}},"42":{"start":{"line":112,"column":11},"end":{"line":118,"column":5}},"43":{"start":{"line":113,"column":6},"end":{"line":115,"column":9}},"44":{"start":{"line":114,"column":8},"end":{"line":114,"column":49}},"45":{"start":{"line":117,"column":6},"end":{"line":117,"column":23}},"46":{"start":{"line":123,"column":4},"end":{"line":123,"column":44}},"47":{"start":{"line":127,"column":4},"end":{"line":129,"column":7}},"48":{"start":{"line":128,"column":6},"end":{"line":128,"column":32}},"49":{"start":{"line":133,"column":4},"end":{"line":133,"column":30}},"50":{"start":{"line":138,"column":4},"end":{"line":138,"column":29}},"51":{"start":{"line":142,"column":4},"end":{"line":163,"column":6}},"52":{"start":{"line":149,"column":77},"end":{"line":149,"column":100}},"53":{"start":{"line":166,"column":4},"end":{"line":166,"column":20}},"54":{"start":{"line":169,"column":4},"end":{"line":169,"column":33}},"55":{"start":{"line":170,"column":4},"end":{"line":170,"column":47}},"56":{"start":{"line":171,"column":4},"end":{"line":171,"column":41}},"57":{"start":{"line":172,"column":4},"end":{"line":172,"column":33}},"58":{"start":{"line":173,"column":4},"end":{"line":173,"column":35}},"59":{"start":{"line":174,"column":4},"end":{"line":174,"column":33}},"60":{"start":{"line":175,"column":4},"end":{"line":175,"column":34}},"61":{"start":{"line":176,"column":4},"end":{"line":176,"column":30}},"62":{"start":{"line":177,"column":4},"end":{"line":177,"column":34}},"63":{"start":{"line":178,"column":4},"end":{"line":178,"column":36}},"64":{"start":{"line":179,"column":4},"end":{"line":179,"column":36}},"65":{"start":{"line":180,"column":4},"end":{"line":180,"column":42}},"66":{"start":{"line":181,"column":4},"end":{"line":181,"column":35}},"67":{"start":{"line":182,"column":4},"end":{"line":182,"column":35}},"68":{"start":{"line":183,"column":4},"end":{"line":183,"column":45}},"69":{"start":{"line":185,"column":4},"end":{"line":185,"column":39}},"70":{"start":{"line":186,"column":4},"end":{"line":186,"column":26}},"71":{"start":{"line":187,"column":4},"end":{"line":197,"column":7}},"72":{"start":{"line":188,"column":6},"end":{"line":188,"column":33}},"73":{"start":{"line":189,"column":6},"end":{"line":189,"column":37}},"74":{"start":{"line":190,"column":6},"end":{"line":194,"column":9}},"75":{"start":{"line":196,"column":6},"end":{"line":196,"column":39}},"76":{"start":{"line":199,"column":4},"end":{"line":199,"column":50}},"77":{"start":{"line":200,"column":4},"end":{"line":200,"column":29}},"78":{"start":{"line":201,"column":4},"end":{"line":201,"column":32}}},"branchMap":{"1":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":11},"end":{"line":47,"column":21}},{"start":{"line":47,"column":26},"end":{"line":47,"column":53}}]},"2":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":11},"end":{"line":50,"column":20}},{"start":{"line":50,"column":25},"end":{"line":50,"column":50}}]},"3":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":6},"end":{"line":56,"column":6}},{"start":{"line":56,"column":6},"end":{"line":56,"column":6}}]},"4":{"line":60,"type":"binary-expr","locations":[{"start":{"line":60,"column":11},"end":{"line":60,"column":34}},{"start":{"line":60,"column":38},"end":{"line":60,"column":39}}]},"5":{"line":65,"type":"binary-expr","locations":[{"start":{"line":65,"column":11},"end":{"line":65,"column":15}},{"start":{"line":65,"column":19},"end":{"line":65,"column":31}}]},"6":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]},"7":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":6},"end":{"line":69,"column":6}},{"start":{"line":69,"column":6},"end":{"line":69,"column":6}}]},"8":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":13},"end":{"line":76,"column":13}},{"start":{"line":76,"column":13},"end":{"line":76,"column":13}}]},"9":{"line":76,"type":"binary-expr","locations":[{"start":{"line":76,"column":17},"end":{"line":76,"column":29}},{"start":{"line":76,"column":33},"end":{"line":76,"column":46}},{"start":{"line":76,"column":50},"end":{"line":76,"column":65}}]},"10":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":4},"end":{"line":102,"column":4}},{"start":{"line":102,"column":4},"end":{"line":102,"column":4}}]},"11":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":108,"column":4}},{"start":{"line":108,"column":4},"end":{"line":108,"column":4}}]},"12":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":11},"end":{"line":110,"column":11}},{"start":{"line":110,"column":11},"end":{"line":110,"column":11}}]},"13":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":11},"end":{"line":112,"column":11}},{"start":{"line":112,"column":11},"end":{"line":112,"column":11}}]},"14":{"line":114,"type":"binary-expr","locations":[{"start":{"line":114,"column":15},"end":{"line":114,"column":24}},{"start":{"line":114,"column":28},"end":{"line":114,"column":48}}]},"15":{"line":143,"type":"binary-expr","locations":[{"start":{"line":143,"column":15},"end":{"line":143,"column":27}},{"start":{"line":143,"column":31},"end":{"line":143,"column":40}}]},"16":{"line":144,"type":"binary-expr","locations":[{"start":{"line":144,"column":22},"end":{"line":144,"column":41}},{"start":{"line":144,"column":45},"end":{"line":144,"column":54}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var Worksheet = require('./worksheet');","var DefinedNames = require('./defined-names');","var XLSX = require('./../xlsx/xlsx');","var CSV = require('./../csv/csv');","","// Workbook requirements","//  Load and Save from file and stream","//  Access/Add/Delete individual worksheets","//  Manage String table, Hyperlink table, etc.","//  Manage scaffolding for contained objects to write to/read from","","var Workbook = module.exports = function() {","  this.created = new Date();","  this.modified = this.created;","  this.properties = {};","  this._worksheets = [];","  this.views = [];","  this._definedNames = new DefinedNames();","};","","Workbook.prototype = {","  get xlsx() {","    return this._xlsx || (this._xlsx = new XLSX(this));","  },","  get csv() {","    return this._csv || (this._csv = new CSV(this));","  },","  get nextId() {","    // find the next unique spot to add worksheet","    var i;","    for (i = 1; i < this._worksheets.length; i++) {","      if (!this._worksheets[i]) {","        return i;","      }","    }","    return this._worksheets.length || 1;","  },","  addWorksheet: function(name, options) {","","    var id = this.nextId;","    name = name || 'sheet' + id;","    ","    // if options is a color, call it tabColor (and signal deprecated message)","    if (options) {","      if (typeof options === 'string') {","        console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: \"rbg value\" } }');","        options = {","          properties: {","            tabColor: {argb: options}","          }","        };","      } else if (options.argb || options.theme || options.indexed) {","        console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }');","        options = {","          properties: {","            tabColor: options","          }","        };","      }","    }","","    var worksheetOptions = Object.assign({}, options, {","      id: id,","      name: name,","      workbook: this","    });","","    var worksheet = new Worksheet(worksheetOptions);","","    this._worksheets[id] = worksheet;","    return worksheet;","  },","  _removeWorksheet: function(worksheet) {","    delete this._worksheets[worksheet.id];","  },","  removeWorksheet: function(id) {","    var worksheet = this.getWorksheet(id);","    if (worksheet) {","      worksheet.destroy();","    }","  },","","  getWorksheet: function(id) {","    if (id === undefined) {","      return this._worksheets.find(function(worksheet) { return worksheet; });","    } else if (typeof(id) === 'number') {","      return this._worksheets[id];","    } else if (typeof id === 'string') {","      return this._worksheets.find(function(worksheet) {","        return worksheet && worksheet.name == id;","      });","    } else {","      return undefined;","    }","  },","","  get worksheets() {","    // return a clone of _worksheets","    return this._worksheets.filter(Boolean);","  },","","  eachSheet: function(iteratee) {","    this._worksheets.forEach(function(sheet) {","      iteratee(sheet, sheet.id);","    });","  },","","  get definedNames() {","    return this._definedNames;","  },","","  clearThemes: function() {","    // Note: themes are not an exposed feature, meddle at your peril!","    this._themes = undefined;","  },","","  get model() {","    return {","      creator: this.creator || 'Unknown',","      lastModifiedBy: this.lastModifiedBy || 'Unknown',","      lastPrinted: this.lastPrinted,","      created: this.created,","      modified: this.modified,","      properties: this.properties,","      worksheets: this._worksheets.filter(Boolean).map(function(worksheet) { return worksheet.model; }),","      definedNames: this._definedNames.model,","      views: this.views,","      company: this.company,","      manager: this.manager,","      title: this.title,","      subject: this.subject,","      keywords: this.keywords,","      category:  this.category,","      description: this.description,","      language: this.language,","      revision: this.revision,","      contentStatus: this.contentStatus,","      themes: this._themes,","    };","  },","  set model(value) {","    var self = this;","","    // oh-for-a-rest-spread-operator!","    this.creator = value.creator;","    this.lastModifiedBy = value.lastModifiedBy;","    this.lastPrinted = value.lastPrinted;","    this.created = value.created;","    this.modified = value.modified;","    this.company = value.company;","    this.manager  = value.manager;","    this.title  = value.title;","    this.subject  = value.subject;","    this.keywords  = value.keywords;","    this.category  = value.category;","    this.description  = value.description;","    this.language = value.language;","    this.revision = value.revision;","    this.contentStatus = value.contentStatus;","","    this.properties = value.properties;","    this._worksheets = [];","    value.worksheets.forEach(function(worksheetModel) {","      var id = worksheetModel.id;","      var name = worksheetModel.name;","      var worksheet = self._worksheets[id] = new Worksheet({","        id: id,","        name: name,","        workbook: self","      });","","      worksheet.model = worksheetModel;","    });","","    this._definedNames.model = value.definedNames;","    this.views = value.views;","    this._themes = value.themes;","  }","};",""],"l":{"25":1,"26":1,"27":1,"28":1,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"45":1,"47":13,"50":13,"54":9,"55":9,"56":0,"57":0,"60":0,"64":0,"65":0,"68":0,"69":0,"70":0,"71":0,"76":0,"77":0,"78":0,"86":0,"92":0,"94":0,"95":0,"98":0,"101":0,"102":0,"103":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"117":0,"123":6,"127":0,"128":0,"133":6,"138":0,"142":6,"149":0,"166":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"196":0,"199":0,"200":0,"201":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/worksheet.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/worksheet.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0},"fnMap":{"1":{"name":"(anonymous_1)","line":42,"loc":{"start":{"line":42,"column":33},"end":{"line":42,"column":51}}},"2":{"name":"(anonymous_2)","line":107,"loc":{"start":{"line":107,"column":14},"end":{"line":107,"column":17}}},"3":{"name":"(anonymous_3)","line":112,"loc":{"start":{"line":112,"column":11},"end":{"line":112,"column":22}}},"4":{"name":"(anonymous_4)","line":117,"loc":{"start":{"line":117,"column":16},"end":{"line":117,"column":19}}},"5":{"name":"(anonymous_5)","line":119,"loc":{"start":{"line":119,"column":23},"end":{"line":119,"column":37}}},"6":{"name":"(anonymous_6)","line":134,"loc":{"start":{"line":134,"column":13},"end":{"line":134,"column":16}}},"7":{"name":"(anonymous_7)","line":140,"loc":{"start":{"line":140,"column":13},"end":{"line":140,"column":21}}},"8":{"name":"(anonymous_8)","line":144,"loc":{"start":{"line":144,"column":40},"end":{"line":144,"column":56}}},"9":{"name":"(anonymous_9)","line":152,"loc":{"start":{"line":152,"column":18},"end":{"line":152,"column":33}}},"10":{"name":"(anonymous_10)","line":160,"loc":{"start":{"line":160,"column":13},"end":{"line":160,"column":25}}},"11":{"name":"(anonymous_11)","line":178,"loc":{"start":{"line":178,"column":17},"end":{"line":178,"column":40}}},"12":{"name":"(anonymous_12)","line":188,"loc":{"start":{"line":188,"column":24},"end":{"line":188,"column":41}}},"13":{"name":"(anonymous_13)","line":196,"loc":{"start":{"line":196,"column":25},"end":{"line":196,"column":39}}},"14":{"name":"(anonymous_14)","line":222,"loc":{"start":{"line":222,"column":17},"end":{"line":222,"column":20}}},"15":{"name":"(anonymous_15)","line":224,"loc":{"start":{"line":224,"column":17},"end":{"line":224,"column":31}}},"16":{"name":"(anonymous_16)","line":229,"loc":{"start":{"line":229,"column":23},"end":{"line":229,"column":26}}},"17":{"name":"(anonymous_17)","line":233,"loc":{"start":{"line":233,"column":17},"end":{"line":233,"column":31}}},"18":{"name":"(anonymous_18)","line":234,"loc":{"start":{"line":234,"column":19},"end":{"line":234,"column":34}}},"19":{"name":"(anonymous_19)","line":249,"loc":{"start":{"line":249,"column":14},"end":{"line":249,"column":25}}},"20":{"name":"(anonymous_20)","line":253,"loc":{"start":{"line":253,"column":20},"end":{"line":253,"column":23}}},"21":{"name":"(anonymous_21)","line":262,"loc":{"start":{"line":262,"column":14},"end":{"line":262,"column":17}}},"22":{"name":"(anonymous_22)","line":266,"loc":{"start":{"line":266,"column":13},"end":{"line":266,"column":16}}},"23":{"name":"(anonymous_23)","line":275,"loc":{"start":{"line":275,"column":11},"end":{"line":275,"column":23}}},"24":{"name":"(anonymous_24)","line":279,"loc":{"start":{"line":279,"column":14},"end":{"line":279,"column":17}}},"25":{"name":"(anonymous_25)","line":282,"loc":{"start":{"line":282,"column":20},"end":{"line":282,"column":23}}},"26":{"name":"(anonymous_26)","line":285,"loc":{"start":{"line":285,"column":17},"end":{"line":285,"column":28}}},"27":{"name":"(anonymous_27)","line":292,"loc":{"start":{"line":292,"column":10},"end":{"line":292,"column":22}}},"28":{"name":"(anonymous_28)","line":299,"loc":{"start":{"line":299,"column":10},"end":{"line":299,"column":26}}},"29":{"name":"(anonymous_29)","line":304,"loc":{"start":{"line":304,"column":11},"end":{"line":304,"column":27}}},"30":{"name":"(anonymous_30)","line":306,"loc":{"start":{"line":306,"column":18},"end":{"line":306,"column":32}}},"31":{"name":"(anonymous_31)","line":311,"loc":{"start":{"line":311,"column":14},"end":{"line":311,"column":37}}},"32":{"name":"(anonymous_32)","line":348,"loc":{"start":{"line":348,"column":11},"end":{"line":348,"column":39}}},"33":{"name":"(anonymous_33)","line":359,"loc":{"start":{"line":359,"column":25},"end":{"line":359,"column":39}}},"34":{"name":"(anonymous_34)","line":368,"loc":{"start":{"line":368,"column":18},"end":{"line":368,"column":29}}},"35":{"name":"(anonymous_35)","line":370,"loc":{"start":{"line":370,"column":23},"end":{"line":370,"column":37}}},"36":{"name":"(anonymous_36)","line":380,"loc":{"start":{"line":380,"column":12},"end":{"line":380,"column":27}}},"37":{"name":"(anonymous_37)","line":387,"loc":{"start":{"line":387,"column":11},"end":{"line":387,"column":26}}},"38":{"name":"(anonymous_38)","line":397,"loc":{"start":{"line":397,"column":14},"end":{"line":397,"column":25}}},"39":{"name":"(anonymous_39)","line":401,"loc":{"start":{"line":401,"column":25},"end":{"line":401,"column":41}}},"40":{"name":"(anonymous_40)","line":421,"loc":{"start":{"line":421,"column":18},"end":{"line":421,"column":35}}},"41":{"name":"(anonymous_41)","line":434,"loc":{"start":{"line":434,"column":15},"end":{"line":434,"column":18}}},"42":{"name":"(anonymous_42)","line":435,"loc":{"start":{"line":435,"column":32},"end":{"line":435,"column":57}}},"43":{"name":"(anonymous_43)","line":444,"loc":{"start":{"line":444,"column":16},"end":{"line":444,"column":27}}},"44":{"name":"(anonymous_44)","line":465,"loc":{"start":{"line":465,"column":14},"end":{"line":465,"column":17}}},"45":{"name":"(anonymous_45)","line":469,"loc":{"start":{"line":469,"column":14},"end":{"line":469,"column":22}}},"46":{"name":"(anonymous_46)","line":477,"loc":{"start":{"line":477,"column":11},"end":{"line":477,"column":14}}},"47":{"name":"(anonymous_47)","line":495,"loc":{"start":{"line":495,"column":23},"end":{"line":495,"column":37}}},"48":{"name":"(anonymous_48)","line":506,"loc":{"start":{"line":506,"column":25},"end":{"line":506,"column":41}}},"49":{"name":"(anonymous_49)","line":512,"loc":{"start":{"line":512,"column":14},"end":{"line":512,"column":30}}},"50":{"name":"(anonymous_50)","line":515,"loc":{"start":{"line":515,"column":23},"end":{"line":515,"column":42}}},"51":{"name":"(anonymous_51)","line":521,"loc":{"start":{"line":521,"column":20},"end":{"line":521,"column":36}}},"52":{"name":"(anonymous_52)","line":523,"loc":{"start":{"line":523,"column":29},"end":{"line":523,"column":45}}},"53":{"name":"(anonymous_53)","line":527,"loc":{"start":{"line":527,"column":11},"end":{"line":527,"column":19}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":39}},"2":{"start":{"line":28,"column":0},"end":{"line":28,"column":40}},"3":{"start":{"line":29,"column":0},"end":{"line":29,"column":47}},"4":{"start":{"line":30,"column":0},"end":{"line":30,"column":31}},"5":{"start":{"line":31,"column":0},"end":{"line":31,"column":27}},"6":{"start":{"line":32,"column":0},"end":{"line":32,"column":33}},"7":{"start":{"line":33,"column":0},"end":{"line":33,"column":31}},"8":{"start":{"line":34,"column":0},"end":{"line":34,"column":52}},"9":{"start":{"line":42,"column":0},"end":{"line":103,"column":2}},"10":{"start":{"line":43,"column":2},"end":{"line":43,"column":26}},"11":{"start":{"line":46,"column":2},"end":{"line":46,"column":23}},"12":{"start":{"line":49,"column":2},"end":{"line":49,"column":48}},"13":{"start":{"line":53,"column":2},"end":{"line":53,"column":18}},"14":{"start":{"line":56,"column":2},"end":{"line":56,"column":23}},"15":{"start":{"line":59,"column":2},"end":{"line":59,"column":18}},"16":{"start":{"line":62,"column":2},"end":{"line":62,"column":20}},"17":{"start":{"line":64,"column":2},"end":{"line":64,"column":36}},"18":{"start":{"line":67,"column":2},"end":{"line":72,"column":25}},"19":{"start":{"line":75,"column":2},"end":{"line":97,"column":24}},"20":{"start":{"line":99,"column":2},"end":{"line":99,"column":47}},"21":{"start":{"line":102,"column":2},"end":{"line":102,"column":35}},"22":{"start":{"line":105,"column":0},"end":{"line":538,"column":2}},"23":{"start":{"line":108,"column":4},"end":{"line":108,"column":26}},"24":{"start":{"line":113,"column":4},"end":{"line":113,"column":42}},"25":{"start":{"line":118,"column":4},"end":{"line":118,"column":33}},"26":{"start":{"line":119,"column":4},"end":{"line":126,"column":7}},"27":{"start":{"line":120,"column":6},"end":{"line":125,"column":7}},"28":{"start":{"line":121,"column":8},"end":{"line":121,"column":37}},"29":{"start":{"line":122,"column":8},"end":{"line":124,"column":9}},"30":{"start":{"line":123,"column":10},"end":{"line":123,"column":78}},"31":{"start":{"line":127,"column":4},"end":{"line":127,"column":22}},"32":{"start":{"line":135,"column":4},"end":{"line":135,"column":25}},"33":{"start":{"line":141,"column":4},"end":{"line":141,"column":20}},"34":{"start":{"line":144,"column":4},"end":{"line":147,"column":10}},"35":{"start":{"line":145,"column":6},"end":{"line":145,"column":77}},"36":{"start":{"line":146,"column":6},"end":{"line":146,"column":38}},"37":{"start":{"line":150,"column":4},"end":{"line":150,"column":18}},"38":{"start":{"line":151,"column":4},"end":{"line":151,"column":38}},"39":{"start":{"line":152,"column":4},"end":{"line":156,"column":7}},"40":{"start":{"line":153,"column":6},"end":{"line":153,"column":52}},"41":{"start":{"line":154,"column":6},"end":{"line":154,"column":28}},"42":{"start":{"line":155,"column":6},"end":{"line":155,"column":25}},"43":{"start":{"line":161,"column":4},"end":{"line":168,"column":5}},"44":{"start":{"line":163,"column":6},"end":{"line":163,"column":30}},"45":{"start":{"line":164,"column":6},"end":{"line":164,"column":26}},"46":{"start":{"line":164,"column":15},"end":{"line":164,"column":26}},"47":{"start":{"line":167,"column":6},"end":{"line":167,"column":26}},"48":{"start":{"line":169,"column":4},"end":{"line":169,"column":47}},"49":{"start":{"line":169,"column":26},"end":{"line":169,"column":45}},"50":{"start":{"line":170,"column":4},"end":{"line":175,"column":5}},"51":{"start":{"line":171,"column":6},"end":{"line":171,"column":39}},"52":{"start":{"line":172,"column":6},"end":{"line":174,"column":7}},"53":{"start":{"line":173,"column":8},"end":{"line":173,"column":50}},"54":{"start":{"line":176,"column":4},"end":{"line":176,"column":30}},"55":{"start":{"line":181,"column":4},"end":{"line":181,"column":59}},"56":{"start":{"line":182,"column":4},"end":{"line":182,"column":27}},"57":{"start":{"line":183,"column":4},"end":{"line":183,"column":29}},"58":{"start":{"line":184,"column":4},"end":{"line":199,"column":5}},"59":{"start":{"line":186,"column":6},"end":{"line":193,"column":7}},"60":{"start":{"line":187,"column":8},"end":{"line":187,"column":42}},"61":{"start":{"line":188,"column":8},"end":{"line":190,"column":11}},"62":{"start":{"line":189,"column":10},"end":{"line":189,"column":47}},"63":{"start":{"line":191,"column":8},"end":{"line":191,"column":35}},"64":{"start":{"line":192,"column":8},"end":{"line":192,"column":44}},"65":{"start":{"line":196,"column":6},"end":{"line":198,"column":9}},"66":{"start":{"line":197,"column":8},"end":{"line":197,"column":46}},"67":{"start":{"line":197,"column":19},"end":{"line":197,"column":44}},"68":{"start":{"line":202,"column":4},"end":{"line":202,"column":41}},"69":{"start":{"line":203,"column":4},"end":{"line":203,"column":30}},"70":{"start":{"line":204,"column":4},"end":{"line":204,"column":36}},"71":{"start":{"line":205,"column":4},"end":{"line":216,"column":5}},"72":{"start":{"line":206,"column":6},"end":{"line":208,"column":7}},"73":{"start":{"line":207,"column":8},"end":{"line":207,"column":65}},"74":{"start":{"line":209,"column":6},"end":{"line":211,"column":7}},"75":{"start":{"line":210,"column":8},"end":{"line":210,"column":38}},"76":{"start":{"line":213,"column":6},"end":{"line":215,"column":7}},"77":{"start":{"line":214,"column":8},"end":{"line":214,"column":66}},"78":{"start":{"line":217,"column":4},"end":{"line":219,"column":5}},"79":{"start":{"line":218,"column":6},"end":{"line":218,"column":36}},"80":{"start":{"line":223,"column":4},"end":{"line":223,"column":21}},"81":{"start":{"line":224,"column":4},"end":{"line":226,"column":7}},"82":{"start":{"line":225,"column":6},"end":{"line":225,"column":51}},"83":{"start":{"line":227,"column":4},"end":{"line":227,"column":20}},"84":{"start":{"line":231,"column":4},"end":{"line":231,"column":20}},"85":{"start":{"line":232,"column":4},"end":{"line":232,"column":18}},"86":{"start":{"line":233,"column":4},"end":{"line":241,"column":7}},"87":{"start":{"line":234,"column":6},"end":{"line":240,"column":9}},"88":{"start":{"line":235,"column":8},"end":{"line":235,"column":27}},"89":{"start":{"line":236,"column":8},"end":{"line":239,"column":9}},"90":{"start":{"line":237,"column":10},"end":{"line":237,"column":29}},"91":{"start":{"line":238,"column":10},"end":{"line":238,"column":18}},"92":{"start":{"line":242,"column":4},"end":{"line":242,"column":17}},"93":{"start":{"line":255,"column":4},"end":{"line":255,"column":27}},"94":{"start":{"line":256,"column":4},"end":{"line":256,"column":25}},"95":{"start":{"line":257,"column":4},"end":{"line":259,"column":5}},"96":{"start":{"line":258,"column":6},"end":{"line":258,"column":10}},"97":{"start":{"line":260,"column":4},"end":{"line":260,"column":13}},"98":{"start":{"line":263,"column":4},"end":{"line":263,"column":35}},"99":{"start":{"line":267,"column":4},"end":{"line":271,"column":5}},"100":{"start":{"line":268,"column":6},"end":{"line":268,"column":45}},"101":{"start":{"line":270,"column":6},"end":{"line":270,"column":23}},"102":{"start":{"line":276,"column":4},"end":{"line":276,"column":27}},"103":{"start":{"line":280,"column":4},"end":{"line":280,"column":31}},"104":{"start":{"line":284,"column":4},"end":{"line":284,"column":18}},"105":{"start":{"line":285,"column":4},"end":{"line":287,"column":7}},"106":{"start":{"line":286,"column":6},"end":{"line":286,"column":14}},"107":{"start":{"line":288,"column":4},"end":{"line":288,"column":17}},"108":{"start":{"line":293,"column":4},"end":{"line":293,"column":30}},"109":{"start":{"line":294,"column":4},"end":{"line":296,"column":5}},"110":{"start":{"line":295,"column":6},"end":{"line":295,"column":47}},"111":{"start":{"line":297,"column":4},"end":{"line":297,"column":15}},"112":{"start":{"line":300,"column":4},"end":{"line":300,"column":41}},"113":{"start":{"line":301,"column":4},"end":{"line":301,"column":23}},"114":{"start":{"line":302,"column":4},"end":{"line":302,"column":15}},"115":{"start":{"line":305,"column":4},"end":{"line":305,"column":20}},"116":{"start":{"line":306,"column":4},"end":{"line":308,"column":7}},"117":{"start":{"line":307,"column":6},"end":{"line":307,"column":23}},"118":{"start":{"line":313,"column":4},"end":{"line":313,"column":59}},"119":{"start":{"line":314,"column":4},"end":{"line":314,"column":30}},"120":{"start":{"line":315,"column":4},"end":{"line":315,"column":41}},"121":{"start":{"line":316,"column":4},"end":{"line":316,"column":33}},"122":{"start":{"line":317,"column":4},"end":{"line":317,"column":16}},"123":{"start":{"line":318,"column":4},"end":{"line":339,"column":5}},"124":{"start":{"line":320,"column":6},"end":{"line":328,"column":7}},"125":{"start":{"line":321,"column":8},"end":{"line":321,"column":31}},"126":{"start":{"line":322,"column":8},"end":{"line":327,"column":9}},"127":{"start":{"line":323,"column":10},"end":{"line":323,"column":54}},"128":{"start":{"line":324,"column":10},"end":{"line":324,"column":38}},"129":{"start":{"line":326,"column":10},"end":{"line":326,"column":46}},"130":{"start":{"line":329,"column":11},"end":{"line":339,"column":5}},"131":{"start":{"line":331,"column":6},"end":{"line":338,"column":7}},"132":{"start":{"line":332,"column":8},"end":{"line":332,"column":31}},"133":{"start":{"line":333,"column":8},"end":{"line":337,"column":9}},"134":{"start":{"line":334,"column":10},"end":{"line":334,"column":54}},"135":{"start":{"line":336,"column":10},"end":{"line":336,"column":46}},"136":{"start":{"line":342,"column":4},"end":{"line":344,"column":5}},"137":{"start":{"line":343,"column":6},"end":{"line":343,"column":49}},"138":{"start":{"line":349,"column":4},"end":{"line":352,"column":5}},"139":{"start":{"line":350,"column":6},"end":{"line":350,"column":25}},"140":{"start":{"line":351,"column":6},"end":{"line":351,"column":26}},"141":{"start":{"line":353,"column":4},"end":{"line":364,"column":5}},"142":{"start":{"line":354,"column":6},"end":{"line":354,"column":32}},"143":{"start":{"line":355,"column":6},"end":{"line":357,"column":7}},"144":{"start":{"line":356,"column":8},"end":{"line":356,"column":36}},"145":{"start":{"line":359,"column":6},"end":{"line":363,"column":9}},"146":{"start":{"line":360,"column":8},"end":{"line":362,"column":9}},"147":{"start":{"line":361,"column":10},"end":{"line":361,"column":36}},"148":{"start":{"line":369,"column":4},"end":{"line":369,"column":18}},"149":{"start":{"line":370,"column":4},"end":{"line":372,"column":7}},"150":{"start":{"line":371,"column":6},"end":{"line":371,"column":49}},"151":{"start":{"line":371,"column":17},"end":{"line":371,"column":47}},"152":{"start":{"line":373,"column":4},"end":{"line":373,"column":16}},"153":{"start":{"line":381,"column":4},"end":{"line":381,"column":44}},"154":{"start":{"line":382,"column":4},"end":{"line":382,"column":40}},"155":{"start":{"line":383,"column":4},"end":{"line":383,"column":55}},"156":{"start":{"line":388,"column":4},"end":{"line":388,"column":44}},"157":{"start":{"line":389,"column":4},"end":{"line":389,"column":39}},"158":{"start":{"line":390,"column":4},"end":{"line":390,"column":33}},"159":{"start":{"line":398,"column":4},"end":{"line":398,"column":73}},"160":{"start":{"line":401,"column":4},"end":{"line":405,"column":7}},"161":{"start":{"line":402,"column":6},"end":{"line":404,"column":7}},"162":{"start":{"line":403,"column":8},"end":{"line":403,"column":60}},"163":{"start":{"line":408,"column":4},"end":{"line":408,"column":63}},"164":{"start":{"line":409,"column":4},"end":{"line":416,"column":5}},"165":{"start":{"line":410,"column":6},"end":{"line":415,"column":7}},"166":{"start":{"line":412,"column":8},"end":{"line":414,"column":9}},"167":{"start":{"line":413,"column":10},"end":{"line":413,"column":42}},"168":{"start":{"line":419,"column":4},"end":{"line":419,"column":46}},"169":{"start":{"line":423,"column":4},"end":{"line":423,"column":45}},"170":{"start":{"line":424,"column":4},"end":{"line":431,"column":5}},"171":{"start":{"line":425,"column":6},"end":{"line":429,"column":7}},"172":{"start":{"line":426,"column":8},"end":{"line":428,"column":9}},"173":{"start":{"line":427,"column":10},"end":{"line":427,"column":38}},"174":{"start":{"line":430,"column":6},"end":{"line":430,"column":42}},"175":{"start":{"line":435,"column":4},"end":{"line":438,"column":7}},"176":{"start":{"line":437,"column":6},"end":{"line":437,"column":18}},"177":{"start":{"line":445,"column":4},"end":{"line":445,"column":73}},"178":{"start":{"line":448,"column":4},"end":{"line":461,"column":5}},"179":{"start":{"line":449,"column":6},"end":{"line":460,"column":7}},"180":{"start":{"line":450,"column":8},"end":{"line":450,"column":38}},"181":{"start":{"line":451,"column":8},"end":{"line":459,"column":9}},"182":{"start":{"line":452,"column":10},"end":{"line":458,"column":11}},"183":{"start":{"line":454,"column":12},"end":{"line":454,"column":45}},"184":{"start":{"line":455,"column":17},"end":{"line":458,"column":11}},"185":{"start":{"line":457,"column":12},"end":{"line":457,"column":38}},"186":{"start":{"line":466,"column":4},"end":{"line":466,"column":109}},"187":{"start":{"line":467,"column":4},"end":{"line":467,"column":36}},"188":{"start":{"line":470,"column":4},"end":{"line":470,"column":109}},"189":{"start":{"line":471,"column":4},"end":{"line":471,"column":37}},"190":{"start":{"line":478,"column":4},"end":{"line":485,"column":6}},"191":{"start":{"line":489,"column":4},"end":{"line":489,"column":46}},"192":{"start":{"line":493,"column":4},"end":{"line":493,"column":31}},"193":{"start":{"line":494,"column":4},"end":{"line":494,"column":52}},"194":{"start":{"line":495,"column":4},"end":{"line":501,"column":7}},"195":{"start":{"line":496,"column":6},"end":{"line":496,"column":38}},"196":{"start":{"line":497,"column":6},"end":{"line":500,"column":7}},"197":{"start":{"line":498,"column":8},"end":{"line":498,"column":88}},"198":{"start":{"line":499,"column":8},"end":{"line":499,"column":28}},"199":{"start":{"line":505,"column":4},"end":{"line":505,"column":22}},"200":{"start":{"line":506,"column":4},"end":{"line":508,"column":7}},"201":{"start":{"line":507,"column":6},"end":{"line":507,"column":37}},"202":{"start":{"line":510,"column":4},"end":{"line":510,"column":17}},"203":{"start":{"line":513,"column":4},"end":{"line":513,"column":20}},"204":{"start":{"line":514,"column":4},"end":{"line":514,"column":20}},"205":{"start":{"line":515,"column":4},"end":{"line":519,"column":7}},"206":{"start":{"line":516,"column":6},"end":{"line":516,"column":47}},"207":{"start":{"line":517,"column":6},"end":{"line":517,"column":37}},"208":{"start":{"line":518,"column":6},"end":{"line":518,"column":27}},"209":{"start":{"line":522,"column":4},"end":{"line":522,"column":20}},"210":{"start":{"line":523,"column":4},"end":{"line":525,"column":7}},"211":{"start":{"line":524,"column":6},"end":{"line":524,"column":29}},"212":{"start":{"line":528,"column":4},"end":{"line":528,"column":27}},"213":{"start":{"line":529,"column":4},"end":{"line":529,"column":55}},"214":{"start":{"line":530,"column":4},"end":{"line":530,"column":27}},"215":{"start":{"line":532,"column":4},"end":{"line":532,"column":33}},"216":{"start":{"line":533,"column":4},"end":{"line":533,"column":70}},"217":{"start":{"line":534,"column":4},"end":{"line":534,"column":39}},"218":{"start":{"line":535,"column":4},"end":{"line":535,"column":37}},"219":{"start":{"line":536,"column":4},"end":{"line":536,"column":29}}},"branchMap":{"1":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":12},"end":{"line":43,"column":19}},{"start":{"line":43,"column":23},"end":{"line":43,"column":25}}]},"2":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":14},"end":{"line":49,"column":26}},{"start":{"line":49,"column":30},"end":{"line":49,"column":47}}]},"3":{"line":80,"type":"binary-expr","locations":[{"start":{"line":80,"column":18},"end":{"line":80,"column":35}},{"start":{"line":80,"column":41},"end":{"line":80,"column":69}},{"start":{"line":80,"column":73},"end":{"line":80,"column":102}},{"start":{"line":80,"column":107},"end":{"line":80,"column":131}}]},"4":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":15},"end":{"line":102,"column":28}},{"start":{"line":102,"column":32},"end":{"line":102,"column":34}}]},"5":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":6},"end":{"line":120,"column":6}},{"start":{"line":120,"column":6},"end":{"line":120,"column":6}}]},"6":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":8},"end":{"line":122,"column":8}},{"start":{"line":122,"column":8},"end":{"line":122,"column":8}}]},"7":{"line":145,"type":"cond-expr","locations":[{"start":{"line":145,"column":36},"end":{"line":145,"column":37}},{"start":{"line":145,"column":41},"end":{"line":145,"column":75}}]},"8":{"line":145,"type":"cond-expr","locations":[{"start":{"line":145,"column":54},"end":{"line":145,"column":71}},{"start":{"line":145,"column":74},"end":{"line":145,"column":75}}]},"9":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":4},"end":{"line":161,"column":4}},{"start":{"line":161,"column":4},"end":{"line":161,"column":4}}]},"10":{"line":164,"type":"if","locations":[{"start":{"line":164,"column":6},"end":{"line":164,"column":6}},{"start":{"line":164,"column":6},"end":{"line":164,"column":6}}]},"11":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":4},"end":{"line":169,"column":4}},{"start":{"line":169,"column":4},"end":{"line":169,"column":4}}]},"12":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":4},"end":{"line":170,"column":4}},{"start":{"line":170,"column":4},"end":{"line":170,"column":4}}]},"13":{"line":184,"type":"if","locations":[{"start":{"line":184,"column":4},"end":{"line":184,"column":4}},{"start":{"line":184,"column":4},"end":{"line":184,"column":4}}]},"14":{"line":189,"type":"binary-expr","locations":[{"start":{"line":189,"column":28},"end":{"line":189,"column":37}},{"start":{"line":189,"column":41},"end":{"line":189,"column":45}}]},"15":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":8},"end":{"line":197,"column":8}},{"start":{"line":197,"column":8},"end":{"line":197,"column":8}}]},"16":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":4},"end":{"line":205,"column":4}},{"start":{"line":205,"column":4},"end":{"line":205,"column":4}}]},"17":{"line":236,"type":"if","locations":[{"start":{"line":236,"column":8},"end":{"line":236,"column":8}},{"start":{"line":236,"column":8},"end":{"line":236,"column":8}}]},"18":{"line":257,"type":"binary-expr","locations":[{"start":{"line":257,"column":12},"end":{"line":257,"column":17}},{"start":{"line":257,"column":23},"end":{"line":257,"column":47}}]},"19":{"line":267,"type":"if","locations":[{"start":{"line":267,"column":4},"end":{"line":267,"column":4}},{"start":{"line":267,"column":4},"end":{"line":267,"column":4}}]},"20":{"line":294,"type":"if","locations":[{"start":{"line":294,"column":4},"end":{"line":294,"column":4}},{"start":{"line":294,"column":4},"end":{"line":294,"column":4}}]},"21":{"line":318,"type":"if","locations":[{"start":{"line":318,"column":4},"end":{"line":318,"column":4}},{"start":{"line":318,"column":4},"end":{"line":318,"column":4}}]},"22":{"line":322,"type":"if","locations":[{"start":{"line":322,"column":8},"end":{"line":322,"column":8}},{"start":{"line":322,"column":8},"end":{"line":322,"column":8}}]},"23":{"line":329,"type":"if","locations":[{"start":{"line":329,"column":11},"end":{"line":329,"column":11}},{"start":{"line":329,"column":11},"end":{"line":329,"column":11}}]},"24":{"line":333,"type":"if","locations":[{"start":{"line":333,"column":8},"end":{"line":333,"column":8}},{"start":{"line":333,"column":8},"end":{"line":333,"column":8}}]},"25":{"line":349,"type":"if","locations":[{"start":{"line":349,"column":4},"end":{"line":349,"column":4}},{"start":{"line":349,"column":4},"end":{"line":349,"column":4}}]},"26":{"line":353,"type":"if","locations":[{"start":{"line":353,"column":4},"end":{"line":353,"column":4}},{"start":{"line":353,"column":4},"end":{"line":353,"column":4}}]},"27":{"line":353,"type":"binary-expr","locations":[{"start":{"line":353,"column":8},"end":{"line":353,"column":15}},{"start":{"line":353,"column":19},"end":{"line":353,"column":39}}]},"28":{"line":360,"type":"if","locations":[{"start":{"line":360,"column":8},"end":{"line":360,"column":8}},{"start":{"line":360,"column":8},"end":{"line":360,"column":8}}]},"29":{"line":360,"type":"binary-expr","locations":[{"start":{"line":360,"column":12},"end":{"line":360,"column":15}},{"start":{"line":360,"column":19},"end":{"line":360,"column":32}}]},"30":{"line":371,"type":"if","locations":[{"start":{"line":371,"column":6},"end":{"line":371,"column":6}},{"start":{"line":371,"column":6},"end":{"line":371,"column":6}}]},"31":{"line":383,"type":"cond-expr","locations":[{"start":{"line":383,"column":17},"end":{"line":383,"column":42}},{"start":{"line":383,"column":45},"end":{"line":383,"column":54}}]},"32":{"line":402,"type":"if","locations":[{"start":{"line":402,"column":6},"end":{"line":402,"column":6}},{"start":{"line":402,"column":6},"end":{"line":402,"column":6}}]},"33":{"line":412,"type":"if","locations":[{"start":{"line":412,"column":8},"end":{"line":412,"column":8}},{"start":{"line":412,"column":8},"end":{"line":412,"column":8}}]},"34":{"line":412,"type":"binary-expr","locations":[{"start":{"line":412,"column":13},"end":{"line":412,"column":31}},{"start":{"line":412,"column":37},"end":{"line":412,"column":56}}]},"35":{"line":424,"type":"if","locations":[{"start":{"line":424,"column":4},"end":{"line":424,"column":4}},{"start":{"line":424,"column":4},"end":{"line":424,"column":4}}]},"36":{"line":451,"type":"if","locations":[{"start":{"line":451,"column":8},"end":{"line":451,"column":8}},{"start":{"line":451,"column":8},"end":{"line":451,"column":8}}]},"37":{"line":452,"type":"if","locations":[{"start":{"line":452,"column":10},"end":{"line":452,"column":10}},{"start":{"line":452,"column":10},"end":{"line":452,"column":10}}]},"38":{"line":455,"type":"if","locations":[{"start":{"line":455,"column":17},"end":{"line":455,"column":17}},{"start":{"line":455,"column":17},"end":{"line":455,"column":17}}]},"39":{"line":496,"type":"binary-expr","locations":[{"start":{"line":496,"column":21},"end":{"line":496,"column":24}},{"start":{"line":496,"column":28},"end":{"line":496,"column":37}}]},"40":{"line":497,"type":"if","locations":[{"start":{"line":497,"column":6},"end":{"line":497,"column":6}},{"start":{"line":497,"column":6},"end":{"line":497,"column":6}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../utils/under-dash');","","","var utils = require('./../utils/utils');","var colCache = require('./../utils/col-cache');","var Range = require('./range');","var Row = require('./row');","var Column = require('./column');","var Enums = require('./enums');","var DataValidations = require('./data-validations');","","// Worksheet requirements","//  Operate as sheet inside workbook or standalone","//  Load and Save from file and stream","//  Access/Add/Delete individual cells","//  Manage column widths and row heights","","var Worksheet = module.exports = function(options) {","  options = options || {};","","  // in a workbook, each sheet will have a number","  this.id = options.id;","","  // and a name","  this.name = options.name || 'Sheet' + this.id;","","  // rows allows access organised by row. Sparse array of arrays indexed by row-1, col","  // Note: _rows is zero based. Must subtract 1 to go from cell.row to index","  this._rows = [];","","  // column definitions","  this._columns = null;","","  // column keys (addRow convenience): key ==> this._collumns index","  this._keys = {};","","  // keep record of all merges","  this._merges = {};","","  this._workbook = options.workbook;","","  // for tabColor, default row height, outline levels, etc","  this.properties = Object.assign({}, {","    defaultRowHeight: 15,","    dyDescent: 55,","    outlineLevelCol: 0,","    outlineLevelRow: 0","  }, options.properties);","  ","  // for all things printing","  this.pageSetup = Object.assign({}, {","    margins: {left: 0.7, right: 0.7, top: 0.75, bottom: 0.75, header: 0.3, footer:  0.3 },","    orientation: 'portrait',","    horizontalDpi: 4294967295,","    verticalDpi: 4294967295,","    fitToPage: !!(options.pageSetup && ((options.pageSetup.fitToWidth || options.pageSetup.fitToHeight) && !options.pageSetup.scale)),","    pageOrder: 'downThenOver',","    blackAndWhite: false,","    draft: false,","    cellComments: 'None',","    errors: 'displayed',","    scale: 100,","    fitToWidth: 1,","    fitToHeight: 1,","    paperSize: undefined,","    showRowColHeaders: false,","    showGridLines: false,","    firstPageNumber: undefined,","    horizontalCentered: false,","    verticalCentered: false,","    rowBreaks: null,","    colBreaks: null","  }, options.pageSetup);","","  this.dataValidations = new DataValidations();","","  // for freezepanes, split, zoom, gridlines, etc","  this.views = options.views || [];","};","","Worksheet.prototype = {","","  get workbook() {","    return this._workbook;","  },","","  // when you're done with this worksheet, call this to remove from workbook","  destroy: function() {","    this._workbook._removeWorksheet(this);","  },","","  // Get the bounding range of the cells in this worksheet","  get dimensions() {","    var dimensions = new Range();","    this._rows.forEach(function(row) {","      if (row) {","        var rowDims = row.dimensions;","        if (rowDims) {","          dimensions.expand(row.number, rowDims.min, row.number, rowDims.max);","        }","      }","    });","    return dimensions;","  },","","  // =========================================================================","  // Columns","","  // get the current columns array.","  get columns() {","    return this._columns;","  },","","  // set the columns from an array of column definitions.","  // Note: any headers defined will overwrite existing values.","  set columns(value) {","    var self = this;","","    // calculate max header row count","    this._headerRowCount = value.reduce(function(pv,cv) {","      var headerCount = cv.header ? 1 : (cv.headers ? cv.headers.length : 0);","      return Math.max(pv, headerCount)","    }, 0);","","    // construct Column objects","    var count = 1;","    var _columns = this._columns = [];","    value.forEach(function(defn) {","      var column = new Column(self, count++, false);","      _columns.push(column);","      column.defn = defn;","    });","  },","","  // get a single column by col number. If it doesn't exist, create it and any gaps before it","  getColumn: function(c) {","    if (typeof c == 'string'){","      // if it matches a key'd column, return that","      var col = this._keys[c];","      if (col) return col;","","      // otherwise, assume letter","      c = colCache.l2n(c);","    }","    if (!this._columns) { this._columns = []; }","    if (c > this._columns.length) {","      var n = this._columns.length + 1;","      while (n <= c) {","        this._columns.push(new Column(this, n++));","      }","    }","    return this._columns[c-1];","  },","  spliceColumns: function(start, count) {","    // each member of inserts is a column of data. ","","    var inserts = Array.prototype.slice.call(arguments, 2);","    var _rows = this._rows;","    var nRows = _rows.length;","    if (inserts.length > 0) {","      // must iterate over all rows whether they exist yet or not","      for (var i = 0; i <  nRows; i++) {","        var rowArguments = [start, count];","        inserts.forEach(function(insert) {","          rowArguments.push(insert[i] || null);","        });","        var row = this.getRow(i+1);","        row.splice.apply(row, rowArguments);","      }","    } else {","      // nothing to insert, so just splice all rows","      this._rows.forEach(function(row) {","        if (row) { row.splice(start, count); }","      });","    }","    ","    // splice column definitions","    var nExpand = inserts.length - count;","    var nKeep = start + count;","    var nEnd = this._columns.length;","    if (nExpand < 0) {","      for (i = nKeep; i <= nEnd; i++) {","        this.getColumn(i + nExpand).defn = this.getColumn(i).defn","      }","      for (i = nEnd + nExpand + 1; i <= nEnd; i++) {","        this.getColumn(i).defn = null;","      }","    } else {","      for (i = nEnd; i >= nKeep; i--) {","        this.getColumn(i + nExpand).defn = this.getColumn(i).defn;","      }","    }","    for (i = start; i < nKeep + nExpand; i++) {","      this.getColumn(i).defn = null;","    }","  },","","  get columnCount() {","    var maxCount = 0;","    this.eachRow(function(row) {","      maxCount = Math.max(maxCount, row.cellCount);","    });","    return maxCount;","  },","  get actualColumnCount() {","    // performance nightmare - for each row, counts all the columns used","    var counts = [];","    var count = 0;","    this.eachRow(function(row) {","      row.eachCell(function(cell) {","        var col = cell.col;","        if (!counts[col]) {","          counts[col] = true;","          count++;","        }","      });","    });","    return count;","  },","","","  // =========================================================================","  // Rows","","  _commitRow: function() {","    // nop - allows streaming reader to fill a document","  },","","  get _lastRowNumber() {","    // need to cope with results of splice","    var _rows = this._rows;","    var n = _rows.length;","    while ((n > 0) && (_rows[n-1] === undefined)) {","      n--;","    }","    return n;","  },","  get _nextRow() {","    return this._lastRowNumber + 1;","  },","","  get lastRow() {","    if (this._rows.length) {","      return this._rows[this._rows.length-1];","    } else {","      return undefined;","    }","  },","","  // find a row (if exists) by row number","  findRow: function(r) {","    return this._rows[r-1];","  },","","  get rowCount() {","    return this._lastRowNumber;","  },","  get actualRowCount() {","    // counts actual rows that have actual data","    var count = 0;","    this.eachRow(function() {","      count++;","    });","    return count;","  },","","  // get a row by row number.","  getRow: function(r) {","    var row = this._rows[r-1];","    if (!row) {","      row = this._rows[r-1] = new Row(this, r);","    }","    return row;","  },","  addRow: function(value) {","    var row = this.getRow(this._nextRow);","    row.values = value;","    return row;","  },","  addRows: function(value) {","    var self = this;","    value.forEach(function(row) {","      self.addRow(row);","    });","  },","  ","  spliceRows: function(start, count) {","    // same problem as row.splice, except worse.","    var inserts = Array.prototype.slice.call(arguments, 2);","    var nKeep = start + count;","    var nExpand = inserts.length - count;","    var nEnd = this._rows.length;","    var i, rSrc;","    if (nExpand < 0) {","      // remove rows","      for (i = nKeep; i <= nEnd; i++) {","        rSrc = this._rows[i-1];","        if (rSrc) {","          this.getRow(i+nExpand).values = rSrc.values;","          this._rows[i-1] = undefined;","        } else {","          this._rows[i+nExpand-1] = undefined;","        }","      }","    } else if (nExpand > 0) {","      // insert new cells","      for (i = nEnd; i >= nKeep; i--) {","        rSrc = this._rows[i-1];","        if (rSrc) {","          this.getRow(i+nExpand).values = rSrc.values;","        } else {","          this._rows[i+nExpand-1] = undefined;","        }","      }","    }","","    // now copy over the new values","    for (i = 0; i < inserts.length; i++) {","      this.getRow(start + i).values = inserts[i];","    }","  },","","  // iterate over every row in the worksheet, including maybe empty rows","  eachRow: function(options, iteratee) {","    if (!iteratee) {","      iteratee = options;","      options = undefined;","    }","    if (options && options.includeEmpty) {","      var n = this._rows.length;","      for (var i = 1; i <= n; i++) {","        iteratee(this.getRow(i), i);","      }","    } else {","      this._rows.forEach(function(row) {","        if (row && row.hasValues) {","          iteratee(row, row.number);","        }","      });","    }","  },","","  // return all rows as sparse array","  getSheetValues: function() {","    var rows = [];","    this._rows.forEach(function(row) {","      if (row) { rows[row.number] = row.values; }","    });","    return rows;","  },","","  // =========================================================================","  // Cells","","  // returns the cell at [r,c] or address given by r. If not found, return undefined","  findCell: function(r, c) {","    var address = colCache.getAddress(r, c);","    var row = this._rows[address.row-1];","    return row ? row.findCell(address.col) : undefined;","  },","","  // return the cell at [r,c] or address given by r. If not found, create a new one.","  getCell: function(r, c) {","    var address = colCache.getAddress(r, c);","    var row = this.getRow(address.row);","    return row._getCell(address);","  },","","  // =========================================================================","  // Merge","","  // convert the range defined by ['tl:br'], [tl,br] or [t,l,b,r] into a single 'merged' cell","  mergeCells: function() {","    var dimensions = new Range(Array.prototype.slice.call(arguments, 0)); // convert arguments into Array","","    // check cells aren't already merged","    _.each(this._merges, function(merge) {","      if (merge.intersects(dimensions)) {","        throw new Error('Cannot merge alreay merged cells');","      }","    });","","    // apply merge","    var master = this.getCell(dimensions.top, dimensions.left);","    for (var i = dimensions.top; i <= dimensions.bottom; i++) {","      for (var j = dimensions.left; j <= dimensions.right; j++) {","        // merge all but the master cell","        if ((i > dimensions.top) || (j > dimensions.left)) {","          this.getCell(i,j).merge(master);","        }","      }","    }","","    // index merge","    this._merges[master.address] = dimensions;","  },","  _unMergeMaster: function(master) {","    // master is always top left of a rectangle","    var merge = this._merges[master.address];","    if (merge) {","      for (var i = merge.top; i <= merge.bottom; i++) {","        for (var j = merge.left; j <= merge.right; j++) {","          this.getCell(i,j).unmerge();","        }","      }","      delete this._merges[master.address];","    }","  },","  ","  get hasMerges() {","    return _.some(this._merges, function(merge, address) {","      // TODO: this doesn't look right","      return true;","    });","  },","","  // scan the range defined by ['tl:br'], [tl,br] or [t,l,b,r] and if any cell is part of a merge,","  // un-merge the group. Note this function can affect multiple merges and merge-blocks are","  // atomic - either they're all merged or all un-merged.","  unMergeCells: function() {","    var dimensions = new Range(Array.prototype.slice.call(arguments, 0)); // convert arguments into Array","","    // find any cells in that range and unmerge them","    for (var i = dimensions.top; i <= dimensions.bottom; i++) {","      for (var j = dimensions.left; j <= dimensions.right; j++) {","        var cell = this.findCell(i,j);","        if (cell) {","          if (cell.type === Enums.ValueType.Merge) {","            // this cell merges to another master","            this._unMergeMaster(cell.master);","          } else if (this._merges[cell.address]) {","            // this cell is a master","            this._unMergeMaster(cell);","          }","        }","      }","    }","  },","  // ===========================================================================","  // Deprecated","  get tabColor() {","    console.trace('worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor');","    return this.properties.tabColor;","  },","  set tabColor(value) {","    console.trace('worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor');","    this.properties.tabColor = value;","  },","","  // ===========================================================================","  // Model","","  get model() {","    var model = {","      id: this.id,","      name: this.name,","      dataValidations: this.dataValidations.model,","      properties: this.properties,","      pageSetup: this.pageSetup,","      views: this.views","    };","","    // =================================================","    // columns","    model.cols = Column.toModel(this.columns);","","    // ==========================================================","    // Rows","    var rows = model.rows = [];","    var dimensions = model.dimensions = new Range();","    this._rows.forEach(function(row) {","      var rowModel = row && row.model;","      if (rowModel) {","        dimensions.expand(rowModel.number, rowModel.min, rowModel.number, rowModel.max);","        rows.push(rowModel);","      }","    });","","    // ==========================================================","    // Merges","    model.merges = [];","    _.each(this._merges, function(merge) {","      model.merges.push(merge.range);","    });","","    return model;","  },","  _parseRows: function(model) {","    var self = this;","    this._rows = [];","    model.rows.forEach(function(rowModel) {","      var row = new Row(self, rowModel.number);","      self._rows[row.number-1] = row;","      row.model = rowModel;","    });","  },","  _parseMergeCells: function(model) {","    var self = this;","    _.each(model.mergeCells, function(merge) {","      self.mergeCells(merge);","    });","  },","  set model(value) {","    this.name = value.name;","    this._columns = Column.fromModel(this, value.cols);","    this._parseRows(value);","","    this._parseMergeCells(value);","    this.dataValidations = new DataValidations(value.dataValidations);","    this.properties = value.properties;","    this.pageSetup = value.pageSetup;","    this.views = value.views;","  }","};",""],"l":{"25":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"42":1,"43":0,"46":0,"49":0,"53":0,"56":0,"59":0,"62":0,"64":0,"67":0,"75":0,"99":0,"102":0,"105":1,"108":0,"113":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"127":0,"135":0,"141":0,"144":0,"145":0,"146":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"161":0,"163":0,"164":0,"167":0,"169":0,"170":0,"171":0,"172":0,"173":0,"176":0,"181":0,"182":0,"183":0,"184":0,"186":0,"187":0,"188":0,"189":0,"191":0,"192":0,"196":0,"197":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"209":0,"210":0,"213":0,"214":0,"217":0,"218":0,"223":0,"224":0,"225":0,"227":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"242":0,"255":0,"256":0,"257":0,"258":0,"260":0,"263":0,"267":0,"268":0,"270":0,"276":0,"280":0,"284":0,"285":0,"286":0,"288":0,"293":0,"294":0,"295":0,"297":0,"300":0,"301":0,"302":0,"305":0,"306":0,"307":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"320":0,"321":0,"322":0,"323":0,"324":0,"326":0,"329":0,"331":0,"332":0,"333":0,"334":0,"336":0,"342":0,"343":0,"349":0,"350":0,"351":0,"353":0,"354":0,"355":0,"356":0,"359":0,"360":0,"361":0,"369":0,"370":0,"371":0,"373":0,"381":0,"382":0,"383":0,"388":0,"389":0,"390":0,"398":0,"401":0,"402":0,"403":0,"408":0,"409":0,"410":0,"412":0,"413":0,"419":0,"423":0,"424":0,"425":0,"426":0,"427":0,"430":0,"435":0,"437":0,"445":0,"448":0,"449":0,"450":0,"451":0,"452":0,"454":0,"455":0,"457":0,"466":0,"467":0,"470":0,"471":0,"478":0,"489":0,"493":0,"494":0,"495":0,"496":0,"497":0,"498":0,"499":0,"505":0,"506":0,"507":0,"510":0,"513":0,"514":0,"515":0,"516":0,"517":0,"518":0,"522":0,"523":0,"524":0,"528":0,"529":0,"530":0,"532":0,"533":0,"534":0,"535":0,"536":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/under-dash.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/under-dash.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":56,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1},"b":{"1":[1,0],"2":[0,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":1,"2":56,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"each","line":4,"loc":{"start":{"line":4,"column":8},"end":{"line":4,"column":31}}},"2":{"name":"(anonymous_2)","line":9,"loc":{"start":{"line":9,"column":33},"end":{"line":9,"column":48}}},"3":{"name":"some","line":16,"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":31}}},"4":{"name":"(anonymous_4)","line":21,"loc":{"start":{"line":21,"column":37},"end":{"line":21,"column":52}}},"5":{"name":"every","line":28,"loc":{"start":{"line":28,"column":9},"end":{"line":28,"column":33}}},"6":{"name":"(anonymous_6)","line":33,"loc":{"start":{"line":33,"column":38},"end":{"line":33,"column":53}}},"7":{"name":"map","line":42,"loc":{"start":{"line":42,"column":7},"end":{"line":42,"column":29}}},"8":{"name":"(anonymous_8)","line":47,"loc":{"start":{"line":47,"column":36},"end":{"line":47,"column":51}}},"9":{"name":"isEqual","line":56,"loc":{"start":{"line":56,"column":11},"end":{"line":56,"column":33}}},"10":{"name":"(anonymous_10)","line":68,"loc":{"start":{"line":68,"column":22},"end":{"line":68,"column":46}}},"11":{"name":"(anonymous_11)","line":76,"loc":{"start":{"line":76,"column":28},"end":{"line":76,"column":50}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":86,"column":2}},"2":{"start":{"line":5,"column":4},"end":{"line":13,"column":5}},"3":{"start":{"line":6,"column":6},"end":{"line":12,"column":7}},"4":{"start":{"line":7,"column":8},"end":{"line":7,"column":24}},"5":{"start":{"line":9,"column":8},"end":{"line":11,"column":11}},"6":{"start":{"line":10,"column":10},"end":{"line":10,"column":28}},"7":{"start":{"line":17,"column":4},"end":{"line":25,"column":5}},"8":{"start":{"line":18,"column":6},"end":{"line":24,"column":7}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":28}},"10":{"start":{"line":21,"column":8},"end":{"line":23,"column":11}},"11":{"start":{"line":22,"column":10},"end":{"line":22,"column":35}},"12":{"start":{"line":29,"column":4},"end":{"line":39,"column":5}},"13":{"start":{"line":30,"column":6},"end":{"line":36,"column":7}},"14":{"start":{"line":31,"column":8},"end":{"line":31,"column":29}},"15":{"start":{"line":33,"column":8},"end":{"line":35,"column":11}},"16":{"start":{"line":34,"column":10},"end":{"line":34,"column":35}},"17":{"start":{"line":38,"column":6},"end":{"line":38,"column":18}},"18":{"start":{"line":43,"column":4},"end":{"line":53,"column":5}},"19":{"start":{"line":44,"column":6},"end":{"line":50,"column":7}},"20":{"start":{"line":45,"column":8},"end":{"line":45,"column":27}},"21":{"start":{"line":47,"column":8},"end":{"line":49,"column":11}},"22":{"start":{"line":48,"column":10},"end":{"line":48,"column":35}},"23":{"start":{"line":52,"column":6},"end":{"line":52,"column":16}},"24":{"start":{"line":57,"column":4},"end":{"line":57,"column":25}},"25":{"start":{"line":58,"column":4},"end":{"line":58,"column":25}},"26":{"start":{"line":59,"column":4},"end":{"line":59,"column":34}},"27":{"start":{"line":60,"column":4},"end":{"line":60,"column":34}},"28":{"start":{"line":62,"column":4},"end":{"line":62,"column":38}},"29":{"start":{"line":62,"column":25},"end":{"line":62,"column":38}},"30":{"start":{"line":63,"column":4},"end":{"line":84,"column":5}},"31":{"start":{"line":65,"column":8},"end":{"line":80,"column":9}},"32":{"start":{"line":66,"column":10},"end":{"line":74,"column":11}},"33":{"start":{"line":67,"column":12},"end":{"line":71,"column":17}},"34":{"start":{"line":69,"column":16},"end":{"line":69,"column":38}},"35":{"start":{"line":70,"column":16},"end":{"line":70,"column":49}},"36":{"start":{"line":73,"column":12},"end":{"line":73,"column":25}},"37":{"start":{"line":76,"column":10},"end":{"line":79,"column":13}},"38":{"start":{"line":77,"column":12},"end":{"line":77,"column":32}},"39":{"start":{"line":78,"column":12},"end":{"line":78,"column":45}},"40":{"start":{"line":83,"column":8},"end":{"line":83,"column":23}},"41":{"start":{"line":88,"column":0},"end":{"line":88,"column":19}}},"branchMap":{"1":{"line":5,"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":5,"column":4}},{"start":{"line":5,"column":4},"end":{"line":5,"column":4}}]},"2":{"line":6,"type":"if","locations":[{"start":{"line":6,"column":6},"end":{"line":6,"column":6}},{"start":{"line":6,"column":6},"end":{"line":6,"column":6}}]},"3":{"line":17,"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":17,"column":4}},{"start":{"line":17,"column":4},"end":{"line":17,"column":4}}]},"4":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":6},"end":{"line":18,"column":6}},{"start":{"line":18,"column":6},"end":{"line":18,"column":6}}]},"5":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"6":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":6},"end":{"line":30,"column":6}},{"start":{"line":30,"column":6},"end":{"line":30,"column":6}}]},"7":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":43,"column":4}},{"start":{"line":43,"column":4},"end":{"line":43,"column":4}}]},"8":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":6}},{"start":{"line":44,"column":6},"end":{"line":44,"column":6}}]},"9":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":62,"column":4}},{"start":{"line":62,"column":4},"end":{"line":62,"column":4}}]},"10":{"line":63,"type":"switch","locations":[{"start":{"line":64,"column":6},"end":{"line":80,"column":9}},{"start":{"line":82,"column":6},"end":{"line":83,"column":23}}]},"11":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":8}},{"start":{"line":65,"column":8},"end":{"line":65,"column":8}}]},"12":{"line":65,"type":"binary-expr","locations":[{"start":{"line":65,"column":12},"end":{"line":65,"column":18}},{"start":{"line":65,"column":22},"end":{"line":65,"column":28}}]},"13":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":10},"end":{"line":66,"column":10}},{"start":{"line":66,"column":10},"end":{"line":66,"column":10}}]},"14":{"line":66,"type":"binary-expr","locations":[{"start":{"line":66,"column":14},"end":{"line":66,"column":20}},{"start":{"line":66,"column":24},"end":{"line":66,"column":30}}]},"15":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":20},"end":{"line":67,"column":41}},{"start":{"line":68,"column":14},"end":{"line":71,"column":16}}]}},"code":["'use strict';","","var _ = {","  each: function each(obj, cb) {","    if (obj) {","      if (Array.isArray(obj)) {","        obj.forEach(cb);","      } else {","        Object.keys(obj).forEach(function (key) {","          cb(obj[key], key);","        });","      }","    }","  },","","  some: function some(obj, cb) {","    if (obj) {","      if (Array.isArray(obj)) {","        return obj.some(cb);","      } else {","        return Object.keys(obj).some(function (key) {","          return cb(obj[key], key);","        });","      }","    }","  },","","  every: function every(obj, cb) {","    if (obj) {","      if (Array.isArray(obj)) {","        return obj.every(cb);","      } else {","        return Object.keys(obj).every(function (key) {","          return cb(obj[key], key);","        });","      }","    } else {","      return true;","    }","  },","","  map: function map(obj, cb) {","    if (obj) {","      if (Array.isArray(obj)) {","        return obj.map(cb);","      } else {","        return Object.keys(obj).map(function (key) {","          return cb(obj[key], key);","        });","      }","    } else {","      return [];","    }","  },","","  isEqual: function isEqual(a,b) {","    var aType = typeof a;","    var bType = typeof b;","    var aArray = Array.isArray(a);","    var bArray = Array.isArray(b);","","    if (aType !== bType) return false;","    switch(typeof a) {","      case 'object':","        if (aArray || bArray) {","          if (aArray && bArray) {","            return (a.length === b.length) &&","              a.every(function(aValue, index) {","                var bValue = b[index];","                return _.isEqual(aValue, bValue);","              });","          } else {","            return false;","          }","        } else {","          return _.every(a, function(aValue, key) {","            var bValue = b[key];","            return _.isEqual(aValue, bValue);","          });","        }","","      default:","        return a === b;","    }","  }","};","","module.exports = _;"],"l":{"3":1,"5":1,"6":1,"7":0,"9":1,"10":56,"17":0,"18":0,"19":0,"21":0,"22":0,"29":0,"30":0,"31":0,"33":0,"34":0,"38":0,"43":0,"44":0,"45":0,"47":0,"48":0,"52":0,"57":0,"58":0,"59":0,"60":0,"62":0,"63":0,"65":0,"66":0,"67":0,"69":0,"70":0,"73":0,"76":0,"77":0,"78":0,"83":0,"88":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/utils.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/utils.js","s":{"1":1,"2":1,"3":1,"4":59,"5":59,"6":52,"7":52,"8":59,"9":7,"10":13,"11":59,"12":59,"13":59,"14":342,"15":59,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0},"b":{"1":[52,7],"2":[7,52],"3":[59,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0,0,0,0],"8":[0,0,0,0,0,0],"9":[0,0],"10":[0,0]},"f":{"1":59,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"fnMap":{"1":{"name":"(anonymous_1)","line":29,"loc":{"start":{"line":29,"column":15},"end":{"line":29,"column":60}}},"2":{"name":"(anonymous_2)","line":62,"loc":{"start":{"line":62,"column":7},"end":{"line":62,"column":18}}},"3":{"name":"(anonymous_3)","line":63,"loc":{"start":{"line":63,"column":20},"end":{"line":63,"column":36}}},"4":{"name":"(anonymous_4)","line":64,"loc":{"start":{"line":64,"column":34},"end":{"line":64,"column":60}}},"5":{"name":"(anonymous_5)","line":66,"loc":{"start":{"line":66,"column":21},"end":{"line":66,"column":32}}},"6":{"name":"(anonymous_6)","line":71,"loc":{"start":{"line":71,"column":19},"end":{"line":71,"column":30}}},"7":{"name":"(anonymous_7)","line":78,"loc":{"start":{"line":78,"column":15},"end":{"line":78,"column":37}}},"8":{"name":"(anonymous_8)","line":81,"loc":{"start":{"line":81,"column":15},"end":{"line":81,"column":37}}},"9":{"name":"(anonymous_9)","line":84,"loc":{"start":{"line":84,"column":13},"end":{"line":84,"column":32}}},"10":{"name":"(anonymous_10)","line":91,"loc":{"start":{"line":91,"column":15},"end":{"line":91,"column":34}}},"11":{"name":"(anonymous_11)","line":95,"loc":{"start":{"line":95,"column":13},"end":{"line":95,"column":28}}},"12":{"name":"(anonymous_12)","line":96,"loc":{"start":{"line":96,"column":67},"end":{"line":96,"column":80}}},"13":{"name":"(anonymous_13)","line":107,"loc":{"start":{"line":107,"column":13},"end":{"line":107,"column":28}}},"14":{"name":"(anonymous_14)","line":108,"loc":{"start":{"line":108,"column":38},"end":{"line":108,"column":50}}},"15":{"name":"(anonymous_15)","line":119,"loc":{"start":{"line":119,"column":12},"end":{"line":119,"column":28}}},"16":{"name":"(anonymous_16)","line":124,"loc":{"start":{"line":124,"column":13},"end":{"line":124,"column":27}}},"17":{"name":"(anonymous_17)","line":136,"loc":{"start":{"line":136,"column":12},"end":{"line":136,"column":27}}},"18":{"name":"(anonymous_18)","line":137,"loc":{"start":{"line":137,"column":36},"end":{"line":137,"column":62}}},"19":{"name":"(anonymous_19)","line":138,"loc":{"start":{"line":138,"column":24},"end":{"line":138,"column":41}}},"20":{"name":"(anonymous_20)","line":145,"loc":{"start":{"line":145,"column":19},"end":{"line":145,"column":32}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":23}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":38}},"3":{"start":{"line":29,"column":0},"end":{"line":58,"column":2}},"4":{"start":{"line":30,"column":2},"end":{"line":30,"column":25}},"5":{"start":{"line":32,"column":2},"end":{"line":35,"column":3}},"6":{"start":{"line":33,"column":4},"end":{"line":33,"column":24}},"7":{"start":{"line":34,"column":4},"end":{"line":34,"column":19}},"8":{"start":{"line":37,"column":2},"end":{"line":41,"column":3}},"9":{"start":{"line":38,"column":4},"end":{"line":40,"column":5}},"10":{"start":{"line":39,"column":6},"end":{"line":39,"column":81}},"11":{"start":{"line":43,"column":2},"end":{"line":50,"column":4}},"12":{"start":{"line":51,"column":2},"end":{"line":55,"column":3}},"13":{"start":{"line":52,"column":4},"end":{"line":54,"column":5}},"14":{"start":{"line":53,"column":6},"end":{"line":53,"column":68}},"15":{"start":{"line":57,"column":2},"end":{"line":57,"column":65}},"16":{"start":{"line":61,"column":0},"end":{"line":148,"column":2}},"17":{"start":{"line":64,"column":4},"end":{"line":75,"column":7}},"18":{"start":{"line":65,"column":6},"end":{"line":74,"column":7}},"19":{"start":{"line":66,"column":8},"end":{"line":68,"column":11}},"20":{"start":{"line":67,"column":10},"end":{"line":67,"column":25}},"21":{"start":{"line":71,"column":8},"end":{"line":73,"column":13}},"22":{"start":{"line":72,"column":10},"end":{"line":72,"column":25}},"23":{"start":{"line":79,"column":4},"end":{"line":79,"column":76}},"24":{"start":{"line":82,"column":4},"end":{"line":82,"column":76}},"25":{"start":{"line":85,"column":4},"end":{"line":85,"column":41}},"26":{"start":{"line":86,"column":4},"end":{"line":89,"column":6}},"27":{"start":{"line":92,"column":4},"end":{"line":92,"column":41}},"28":{"start":{"line":93,"column":4},"end":{"line":93,"column":55}},"29":{"start":{"line":96,"column":4},"end":{"line":105,"column":7}},"30":{"start":{"line":97,"column":6},"end":{"line":104,"column":7}},"31":{"start":{"line":98,"column":18},"end":{"line":98,"column":32}},"32":{"start":{"line":99,"column":18},"end":{"line":99,"column":32}},"33":{"start":{"line":100,"column":18},"end":{"line":100,"column":33}},"34":{"start":{"line":101,"column":19},"end":{"line":101,"column":35}},"35":{"start":{"line":102,"column":18},"end":{"line":102,"column":34}},"36":{"start":{"line":103,"column":17},"end":{"line":103,"column":27}},"37":{"start":{"line":108,"column":4},"end":{"line":117,"column":7}},"38":{"start":{"line":109,"column":6},"end":{"line":116,"column":7}},"39":{"start":{"line":110,"column":21},"end":{"line":110,"column":32}},"40":{"start":{"line":111,"column":21},"end":{"line":111,"column":32}},"41":{"start":{"line":112,"column":22},"end":{"line":112,"column":33}},"42":{"start":{"line":113,"column":23},"end":{"line":113,"column":35}},"43":{"start":{"line":114,"column":23},"end":{"line":114,"column":34}},"44":{"start":{"line":115,"column":17},"end":{"line":115,"column":26}},"45":{"start":{"line":120,"column":4},"end":{"line":120,"column":28}},"46":{"start":{"line":121,"column":4},"end":{"line":121,"column":29}},"47":{"start":{"line":125,"column":4},"end":{"line":125,"column":31}},"48":{"start":{"line":125,"column":16},"end":{"line":125,"column":29}},"49":{"start":{"line":128,"column":4},"end":{"line":128,"column":44}},"50":{"start":{"line":129,"column":4},"end":{"line":129,"column":37}},"51":{"start":{"line":131,"column":4},"end":{"line":131,"column":50}},"52":{"start":{"line":132,"column":4},"end":{"line":132,"column":18}},"53":{"start":{"line":137,"column":6},"end":{"line":141,"column":9}},"54":{"start":{"line":138,"column":8},"end":{"line":140,"column":11}},"55":{"start":{"line":139,"column":10},"end":{"line":139,"column":26}},"56":{"start":{"line":146,"column":4},"end":{"line":146,"column":42}}},"branchMap":{"1":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":2},"end":{"line":32,"column":2}},{"start":{"line":32,"column":2},"end":{"line":32,"column":2}}]},"2":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":2},"end":{"line":37,"column":2}},{"start":{"line":37,"column":2},"end":{"line":37,"column":2}}]},"3":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":2},"end":{"line":51,"column":2}},{"start":{"line":51,"column":2},"end":{"line":51,"column":2}}]},"4":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":6},"end":{"line":65,"column":6}},{"start":{"line":65,"column":6},"end":{"line":65,"column":6}}]},"5":{"line":79,"type":"cond-expr","locations":[{"start":{"line":79,"column":66},"end":{"line":79,"column":70}},{"start":{"line":79,"column":73},"end":{"line":79,"column":74}}]},"6":{"line":82,"type":"cond-expr","locations":[{"start":{"line":82,"column":45},"end":{"line":82,"column":49}},{"start":{"line":82,"column":52},"end":{"line":82,"column":53}}]},"7":{"line":97,"type":"switch","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":32}},{"start":{"line":99,"column":8},"end":{"line":99,"column":32}},{"start":{"line":100,"column":8},"end":{"line":100,"column":33}},{"start":{"line":101,"column":8},"end":{"line":101,"column":35}},{"start":{"line":102,"column":8},"end":{"line":102,"column":34}},{"start":{"line":103,"column":8},"end":{"line":103,"column":27}}]},"8":{"line":109,"type":"switch","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":32}},{"start":{"line":111,"column":8},"end":{"line":111,"column":32}},{"start":{"line":112,"column":8},"end":{"line":112,"column":33}},{"start":{"line":113,"column":8},"end":{"line":113,"column":35}},{"start":{"line":114,"column":8},"end":{"line":114,"column":34}},{"start":{"line":115,"column":8},"end":{"line":115,"column":26}}]},"9":{"line":121,"type":"cond-expr","locations":[{"start":{"line":121,"column":23},"end":{"line":121,"column":24}},{"start":{"line":121,"column":27},"end":{"line":121,"column":28}}]},"10":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":4},"end":{"line":125,"column":4}},{"start":{"line":125,"column":4},"end":{"line":125,"column":4}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var fs = require('fs');","var PromishLib = require('./promish');","","// useful stuff","var inherits = function(cls, superCtor, statics, prototype) {","  cls.super_ = superCtor;","","  if (!prototype) {","    prototype = statics;","    statics = null;","  }","","  if (statics) {","    for (var i in statics) {","      Object.defineProperty(cls, i, Object.getOwnPropertyDescriptor(statics, i));","    }","  }","","  var properties = {","    constructor: {","      value: cls,","      enumerable: false,","      writable: false,","      configurable: true","    }","  };","  if (prototype) {","    for (var i in prototype) {","      properties[i] = Object.getOwnPropertyDescriptor(prototype, i);","    }","  }","","  cls.prototype = Object.create(superCtor.prototype, properties);","};","","","var utils = module.exports = {","  nop: function() {},","  promiseImmediate: function(value) {","    return new PromishLib.Promish(function(resolve, reject) {","      if (global.setImmediate) {","        setImmediate(function() {","          resolve(value);","        });","      } else {","        // poorman's setImmediate - must wait at least 1ms","        setTimeout(function() {","          resolve(value);","        },1);","      }","    });","  },","  inherits: inherits,","  dateToExcel: function(d, date1904) {","    return 25569 + d.getTime() / (24 * 3600 * 1000) - (date1904 ? 1462 : 0);","  },","  excelToDate: function(v, date1904) {","    return new Date((v - 25569 + (date1904 ? 1462 : 0)) * 24 * 3600 * 1000);","  },","  parsePath: function(filepath) {","    var last = filepath.lastIndexOf('/');","    return {","      path: filepath.substring(0, last),","      name: filepath.substring(last + 1)","    };","  },","  getRelsPath: function(filepath) {","    var path = utils.parsePath(filepath);","    return path.path + '/_rels/' + path.name + '.rels';","  },","  xmlEncode: function(text) {","    return text.replace(/[<>&'\"\\x7F\\x00-\\x08\\x0A-\\x0C\\x0E-\\x1F]/g, function (c) {","      switch (c) {","        case '<': return '&lt;';","        case '>': return '&gt;';","        case '&': return '&amp;';","        case '\\'': return '&apos;';","        case '\"': return '&quot;';","        default: return '';","      }","    });","  },","  xmlDecode: function(text) {","    return text.replace(/&([a-z]*);/, function(c) {","      switch (c) {","        case '&lt;': return '<';","        case '&gt;': return '>';","        case '&amp;': return '&';","        case '&apos;': return '\\'';","        case '&quot;': return '\"';","        default: return c;","      }","    });","  },","  validInt: function(value) {","    var i = parseInt(value);","    return !isNaN(i) ? i : 0;","  },","","  isDateFmt: function(fmt) {","    if (!fmt) { return false; }","","    // must remove all chars inside quotes and []","    fmt = fmt.replace(/[\\[][^\\]]*[\\]]/g,'');","    fmt = fmt.replace(/\"[^\"]*\"/g,'');","    // then check for date formatting chars","    var result = fmt.match(/[ymdhMsb]+/) !== null;","    return result;","  },","","  fs: {","    exists: function(path) {","      return new PromishLib.Promish(function(resolve, reject) {","        fs.exists(path, function(exists) {","          resolve(exists);","        });","      });","    }","  },","  ","  toIsoDateString: function(dt) {","    return dt.toIsoString().subsstr(0,10);","  }","};","",""],"l":{"25":1,"26":1,"29":1,"30":59,"32":59,"33":52,"34":52,"37":59,"38":7,"39":13,"43":59,"51":59,"52":59,"53":342,"57":59,"61":1,"64":0,"65":0,"66":0,"67":0,"71":0,"72":0,"79":0,"82":0,"85":0,"86":0,"92":0,"93":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"120":0,"121":0,"125":0,"128":0,"129":0,"131":0,"132":0,"137":0,"138":0,"139":0,"146":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/col-cache.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/col-cache.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":10},"end":{"line":31,"column":22}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":9},"end":{"line":36,"column":25}}},"3":{"name":"(anonymous_3)","line":72,"loc":{"start":{"line":72,"column":7},"end":{"line":72,"column":19}}},"4":{"name":"(anonymous_4)","line":81,"loc":{"start":{"line":81,"column":7},"end":{"line":81,"column":19}}},"5":{"name":"(anonymous_5)","line":96,"loc":{"start":{"line":96,"column":19},"end":{"line":96,"column":35}}},"6":{"name":"(anonymous_6)","line":104,"loc":{"start":{"line":104,"column":17},"end":{"line":104,"column":33}}},"7":{"name":"(anonymous_7)","line":135,"loc":{"start":{"line":135,"column":14},"end":{"line":135,"column":28}}},"8":{"name":"(anonymous_8)","line":145,"loc":{"start":{"line":145,"column":10},"end":{"line":145,"column":26}}},"9":{"name":"(anonymous_9)","line":167,"loc":{"start":{"line":167,"column":12},"end":{"line":167,"column":28}}},"10":{"name":"(anonymous_10)","line":201,"loc":{"start":{"line":201,"column":17},"end":{"line":201,"column":36}}},"11":{"name":"(anonymous_11)","line":206,"loc":{"start":{"line":206,"column":10},"end":{"line":206,"column":21}}}},"statementMap":{"1":{"start":{"line":27,"column":0},"end":{"line":216,"column":2}},"2":{"start":{"line":32,"column":4},"end":{"line":32,"column":30}},"3":{"start":{"line":32,"column":19},"end":{"line":32,"column":28}},"4":{"start":{"line":33,"column":4},"end":{"line":33,"column":33}},"5":{"start":{"line":33,"column":22},"end":{"line":33,"column":31}},"6":{"start":{"line":34,"column":4},"end":{"line":34,"column":13}},"7":{"start":{"line":37,"column":4},"end":{"line":37,"column":25}},"8":{"start":{"line":38,"column":4},"end":{"line":38,"column":14}},"9":{"start":{"line":39,"column":4},"end":{"line":47,"column":5}},"10":{"start":{"line":41,"column":6},"end":{"line":46,"column":7}},"11":{"start":{"line":42,"column":8},"end":{"line":42,"column":34}},"12":{"start":{"line":43,"column":8},"end":{"line":43,"column":25}},"13":{"start":{"line":44,"column":8},"end":{"line":44,"column":25}},"14":{"start":{"line":45,"column":8},"end":{"line":45,"column":12}},"15":{"start":{"line":48,"column":4},"end":{"line":58,"column":5}},"16":{"start":{"line":49,"column":6},"end":{"line":57,"column":7}},"17":{"start":{"line":50,"column":8},"end":{"line":50,"column":21}},"18":{"start":{"line":51,"column":8},"end":{"line":51,"column":20}},"19":{"start":{"line":52,"column":8},"end":{"line":52,"column":32}},"20":{"start":{"line":53,"column":8},"end":{"line":53,"column":56}},"21":{"start":{"line":54,"column":8},"end":{"line":54,"column":25}},"22":{"start":{"line":55,"column":8},"end":{"line":55,"column":25}},"23":{"start":{"line":56,"column":8},"end":{"line":56,"column":12}},"24":{"start":{"line":59,"column":4},"end":{"line":70,"column":5}},"25":{"start":{"line":60,"column":6},"end":{"line":69,"column":7}},"26":{"start":{"line":61,"column":8},"end":{"line":61,"column":27}},"27":{"start":{"line":62,"column":8},"end":{"line":62,"column":20}},"28":{"start":{"line":63,"column":8},"end":{"line":63,"column":37}},"29":{"start":{"line":64,"column":8},"end":{"line":64,"column":37}},"30":{"start":{"line":65,"column":8},"end":{"line":65,"column":79}},"31":{"start":{"line":66,"column":8},"end":{"line":66,"column":25}},"32":{"start":{"line":67,"column":8},"end":{"line":67,"column":25}},"33":{"start":{"line":68,"column":8},"end":{"line":68,"column":12}},"34":{"start":{"line":73,"column":4},"end":{"line":75,"column":5}},"35":{"start":{"line":74,"column":6},"end":{"line":74,"column":27}},"36":{"start":{"line":76,"column":4},"end":{"line":78,"column":5}},"37":{"start":{"line":77,"column":6},"end":{"line":77,"column":68}},"38":{"start":{"line":79,"column":4},"end":{"line":79,"column":24}},"39":{"start":{"line":82,"column":4},"end":{"line":84,"column":5}},"40":{"start":{"line":83,"column":6},"end":{"line":83,"column":92}},"41":{"start":{"line":85,"column":4},"end":{"line":87,"column":5}},"42":{"start":{"line":86,"column":6},"end":{"line":86,"column":33}},"43":{"start":{"line":88,"column":4},"end":{"line":88,"column":24}},"44":{"start":{"line":97,"column":4},"end":{"line":99,"column":5}},"45":{"start":{"line":98,"column":6},"end":{"line":98,"column":51}},"46":{"start":{"line":100,"column":4},"end":{"line":100,"column":16}},"47":{"start":{"line":105,"column":4},"end":{"line":105,"column":33}},"48":{"start":{"line":106,"column":4},"end":{"line":108,"column":5}},"49":{"start":{"line":107,"column":6},"end":{"line":107,"column":18}},"50":{"start":{"line":110,"column":4},"end":{"line":110,"column":39}},"51":{"start":{"line":111,"column":4},"end":{"line":111,"column":34}},"52":{"start":{"line":112,"column":4},"end":{"line":112,"column":36}},"53":{"start":{"line":113,"column":4},"end":{"line":113,"column":34}},"54":{"start":{"line":116,"column":4},"end":{"line":116,"column":22}},"55":{"start":{"line":118,"column":4},"end":{"line":123,"column":6}},"56":{"start":{"line":126,"column":4},"end":{"line":129,"column":5}},"57":{"start":{"line":127,"column":6},"end":{"line":127,"column":34}},"58":{"start":{"line":128,"column":6},"end":{"line":128,"column":45}},"59":{"start":{"line":131,"column":4},"end":{"line":131,"column":19}},"60":{"start":{"line":136,"column":4},"end":{"line":141,"column":5}},"61":{"start":{"line":137,"column":6},"end":{"line":137,"column":36}},"62":{"start":{"line":138,"column":6},"end":{"line":138,"column":41}},"63":{"start":{"line":140,"column":6},"end":{"line":140,"column":35}},"64":{"start":{"line":146,"column":4},"end":{"line":146,"column":33}},"65":{"start":{"line":147,"column":4},"end":{"line":163,"column":5}},"66":{"start":{"line":148,"column":6},"end":{"line":148,"column":44}},"67":{"start":{"line":149,"column":6},"end":{"line":149,"column":44}},"68":{"start":{"line":150,"column":6},"end":{"line":155,"column":8}},"69":{"start":{"line":157,"column":6},"end":{"line":157,"column":53}},"70":{"start":{"line":158,"column":6},"end":{"line":158,"column":57}},"71":{"start":{"line":159,"column":6},"end":{"line":159,"column":54}},"72":{"start":{"line":160,"column":6},"end":{"line":160,"column":20}},"73":{"start":{"line":162,"column":6},"end":{"line":162,"column":39}},"74":{"start":{"line":168,"column":4},"end":{"line":168,"column":79}},"75":{"start":{"line":170,"column":4},"end":{"line":170,"column":43}},"76":{"start":{"line":171,"column":4},"end":{"line":171,"column":30}},"77":{"start":{"line":173,"column":4},"end":{"line":173,"column":37}},"78":{"start":{"line":174,"column":4},"end":{"line":197,"column":5}},"79":{"start":{"line":175,"column":6},"end":{"line":175,"column":44}},"80":{"start":{"line":176,"column":6},"end":{"line":176,"column":44}},"81":{"start":{"line":177,"column":6},"end":{"line":177,"column":41}},"82":{"start":{"line":178,"column":6},"end":{"line":178,"column":42}},"83":{"start":{"line":179,"column":6},"end":{"line":179,"column":44}},"84":{"start":{"line":180,"column":6},"end":{"line":180,"column":43}},"85":{"start":{"line":182,"column":6},"end":{"line":182,"column":32}},"86":{"start":{"line":183,"column":6},"end":{"line":183,"column":36}},"87":{"start":{"line":185,"column":6},"end":{"line":191,"column":8}},"88":{"start":{"line":192,"column":11},"end":{"line":197,"column":5}},"89":{"start":{"line":193,"column":6},"end":{"line":193,"column":87}},"90":{"start":{"line":195,"column":6},"end":{"line":195,"column":50}},"91":{"start":{"line":196,"column":6},"end":{"line":196,"column":82}},"92":{"start":{"line":202,"column":4},"end":{"line":202,"column":35}},"93":{"start":{"line":207,"column":4},"end":{"line":214,"column":5}},"94":{"start":{"line":209,"column":8},"end":{"line":209,"column":66}},"95":{"start":{"line":211,"column":8},"end":{"line":211,"column":125}},"96":{"start":{"line":213,"column":8},"end":{"line":213,"column":65}}},"branchMap":{"1":{"line":32,"type":"if","locations":[{"start":{"line":32,"column":4},"end":{"line":32,"column":4}},{"start":{"line":32,"column":4},"end":{"line":32,"column":4}}]},"2":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"3":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"4":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":48,"column":4}},{"start":{"line":48,"column":4},"end":{"line":48,"column":4}}]},"5":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":4},"end":{"line":59,"column":4}},{"start":{"line":59,"column":4},"end":{"line":59,"column":4}}]},"6":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]},"7":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":4},"end":{"line":76,"column":4}},{"start":{"line":76,"column":4},"end":{"line":76,"column":4}}]},"8":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":82,"column":4}},{"start":{"line":82,"column":4},"end":{"line":82,"column":4}}]},"9":{"line":82,"type":"binary-expr","locations":[{"start":{"line":82,"column":9},"end":{"line":82,"column":14}},{"start":{"line":82,"column":20},"end":{"line":82,"column":29}}]},"10":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":85,"column":4}},{"start":{"line":85,"column":4},"end":{"line":85,"column":4}}]},"11":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":4},"end":{"line":97,"column":4}},{"start":{"line":97,"column":4},"end":{"line":97,"column":4}}]},"12":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":4},"end":{"line":106,"column":4}},{"start":{"line":106,"column":4},"end":{"line":106,"column":4}}]},"13":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":4},"end":{"line":126,"column":4}},{"start":{"line":126,"column":4},"end":{"line":126,"column":4}}]},"14":{"line":126,"type":"binary-expr","locations":[{"start":{"line":126,"column":9},"end":{"line":126,"column":25}},{"start":{"line":126,"column":31},"end":{"line":126,"column":47}}]},"15":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":4},"end":{"line":136,"column":4}},{"start":{"line":136,"column":4},"end":{"line":136,"column":4}}]},"16":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":4},"end":{"line":147,"column":4}},{"start":{"line":147,"column":4},"end":{"line":147,"column":4}}]},"17":{"line":170,"type":"binary-expr","locations":[{"start":{"line":170,"column":20},"end":{"line":170,"column":29}},{"start":{"line":170,"column":33},"end":{"line":170,"column":42}}]},"18":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":4},"end":{"line":174,"column":4}},{"start":{"line":174,"column":4},"end":{"line":174,"column":4}}]},"19":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":11},"end":{"line":192,"column":11}},{"start":{"line":192,"column":11},"end":{"line":192,"column":11}}]},"20":{"line":193,"type":"cond-expr","locations":[{"start":{"line":193,"column":25},"end":{"line":193,"column":65}},{"start":{"line":193,"column":68},"end":{"line":193,"column":86}}]},"21":{"line":196,"type":"cond-expr","locations":[{"start":{"line":196,"column":25},"end":{"line":196,"column":71}},{"start":{"line":196,"column":74},"end":{"line":196,"column":81}}]},"22":{"line":207,"type":"switch","locations":[{"start":{"line":208,"column":6},"end":{"line":209,"column":66}},{"start":{"line":210,"column":6},"end":{"line":211,"column":125}},{"start":{"line":212,"column":6},"end":{"line":213,"column":65}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","// =========================================================================","// Column Letter to Number conversion","var colCache = module.exports = {","  _dictionary: ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'],","  _l2n: {},","  _n2l: [],","  _level: function(n) {","    if (n <= 26) { return 1; }","    if (n <= 26*26) { return 2; }","    return 3;","  },","  _fill: function(level) {","    var c, v, l1, l2, l3;","    var n = 1;","    if (level >= 1) {","      //console.log('Level 1')","      while (n <= 26) {","        c = this._dictionary[n-1];","        this._n2l[n] = c;","        this._l2n[c] = n;","        n++;","      }","    }","    if (level >= 2) {","      while (n <= 26 + 26 * 26) {","        v = n-(26+1);","        l1 = v % 26;","        l2 = Math.floor(v / 26);","        c = this._dictionary[l2] + this._dictionary[l1];","        this._n2l[n] = c;","        this._l2n[c] = n;","        n++;","      }","    }","    if (level >= 3) {","      while (n <= 16384) {","        v = n-(26*26+26+1);","        l1 = v % 26;","        l2 = Math.floor(v / 26) % 26;","        l3 = Math.floor(v / (26*26));","        c = this._dictionary[l3] + this._dictionary[l2] + this._dictionary[l1];","        this._n2l[n] = c;","        this._l2n[c] = n;","        n++;","      }","    }","  },","  l2n: function(l) {","    if (!this._l2n[l]) {","      this._fill(l.length);","    }","    if (!this._l2n[l]) {","      throw new Error('Out of bounds. Invalid column letter: ' + l);","    }","    return this._l2n[l];","  },","  n2l: function(n) {","    if ((n < 1) || (n > 16384)) {","      throw new Error('' + n + ' is out of bounds. Excel supports columns from 1 to 16384');","    }","    if (!this._n2l[n]) {","      this._fill(this._level(n));","    }","    return this._n2l[n];","  },","","  // =========================================================================","  // Address processing","  _hash: {},","","  // check if value looks like an address","  validateAddress: function(value) {","    if (!value.match(/^[A-Z]+\\d+$/)) {","      throw new Error('Invalid Address: ' + value);","    }","    return true;","  },","","  // convert address string into structure","  decodeAddress: function(value) {","    var addr = this._hash[value];","    if (addr) {","      return addr;","    }","","    var col = value.match(/[A-Z]+/)[0];","    var colNumber = this.l2n(col);","    var row = value.match(/\\d+/)[0];","    var rowNumber = parseInt(row);","","    // in case $row$col","    value = col + row;","","    var address = {","      address: value,","      col: colNumber,","      row: rowNumber,","      $col$row: '$' + col + '$' + row","    };","","    // mem fix - cache only the tl 100x100 square","    if ((colNumber <= 100) && (rowNumber <= 100)) {","      this._hash[value] = address;","      this._hash[address.$col$row] = address;","    }","","    return address;","  },","","  // convert r,c into structure (if only 1 arg, assume r is address string)","  getAddress: function(r,c) {","    if (c) {","      var address = this.n2l(c) + r;","      return this.decodeAddress(address);","    } else {","      return this.decodeAddress(r);","    }","  },","","  // convert [address], [tl:br] into address structures","  decode: function(value) {","    var parts = value.split(':');","    if (parts.length == 2) {","      var tl = this.decodeAddress(parts[0]);","      var br = this.decodeAddress(parts[1]);","      var result = {","        top: Math.min(tl.row, br.row),","        left: Math.min(tl.col, br.col),","        bottom: Math.max(tl.row, br.row),","        right: Math.max(tl.col, br.col)","      };","      // reconstruct tl, br and dimensions","      result.tl = this.n2l(result.left) + result.top;","      result.br = this.n2l(result.right) + result.bottom;","      result.dimensions = result.tl + ':' + result.br;","      return result;","    } else {","      return this.decodeAddress(value);","    }","  },","","  // convert [sheetName!][$]col[$]row[[$]col[$]row] into address or range structures","  decodeEx: function(value) {","    var groups = value.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ ^!]*))!)?(.*)/);","","    var sheetName = groups[1] || groups[2]; // Qouted and unqouted groups","    var reference = groups[3]; // Remaining address","","    var parts = reference.split(':');","    if (parts.length > 1) {","      var tl = this.decodeAddress(parts[0]);","      var br = this.decodeAddress(parts[1]);","      var top = Math.min(tl.row, br.row);","      var left = Math.min(tl.col, br.col);","      var bottom = Math.max(tl.row, br.row);","      var right = Math.max(tl.col, br.col);","","      tl = this.n2l(left) + top;","      br = this.n2l(right) + bottom;","","      return {","        top: top, left: left, bottom: bottom, right: right,","        sheetName: sheetName,","        tl: { address: tl, col: left, row: top, $col$row: '$' + this.n2l(left) + '$' + top, sheetName: sheetName },","        br: { address: br, col: right, row: bottom, $col$row: '$' + this.n2l(right) + '$' + bottom, sheetName: sheetName },","        dimensions: tl + ':' + br","      };","    } else if (reference.startsWith('#')) {","      return sheetName ? {sheetName: sheetName, error: reference} : {error: reference};","    } else {","      var address = this.decodeAddress(reference);","      return sheetName ? Object.assign({sheetName: sheetName}, address) : address;","    }","  },","","  // convert row,col into address string","  encodeAddress: function(row, col) {","    return colCache.n2l(col) + row;","  },","","  // convert row,col into string address or t,l,b,r into range","  encode: function() {","    switch(arguments.length) {","      case 2:","        return colCache.encodeAddress(arguments[0], arguments[1]);","      case 4:","        return colCache.encodeAddress(arguments[0], arguments[1]) + ':' + colCache.encodeAddress(arguments[2], arguments[3]);","      default:","        throw new Error('Can only encode with 2 or 4 arguments');","    }","  }","};",""],"l":{"27":1,"32":0,"33":0,"34":0,"37":0,"38":0,"39":0,"41":0,"42":0,"43":0,"44":0,"45":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"73":0,"74":0,"76":0,"77":0,"79":0,"82":0,"83":0,"85":0,"86":0,"88":0,"97":0,"98":0,"100":0,"105":0,"106":0,"107":0,"110":0,"111":0,"112":0,"113":0,"116":0,"118":0,"126":0,"127":0,"128":0,"131":0,"136":0,"137":0,"138":0,"140":0,"146":0,"147":0,"148":0,"149":0,"150":0,"157":0,"158":0,"159":0,"160":0,"162":0,"168":0,"170":0,"171":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"182":0,"183":0,"185":0,"192":0,"193":0,"195":0,"196":0,"202":0,"207":0,"209":0,"211":0,"213":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/range.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/range.js","s":{"1":1,"2":1,"3":0,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0},"b":{"1":[0,0,0,0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0,0],"33":[0,0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":29},"end":{"line":28,"column":40}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":13},"end":{"line":33,"column":34}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":14},"end":{"line":42,"column":34}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":10},"end":{"line":47,"column":25}}},"5":{"name":"(anonymous_5)","line":119,"loc":{"start":{"line":119,"column":9},"end":{"line":119,"column":12}}},"6":{"name":"(anonymous_6)","line":120,"loc":{"start":{"line":120,"column":9},"end":{"line":120,"column":17}}},"7":{"name":"(anonymous_7)","line":121,"loc":{"start":{"line":121,"column":10},"end":{"line":121,"column":13}}},"8":{"name":"(anonymous_8)","line":122,"loc":{"start":{"line":122,"column":10},"end":{"line":122,"column":18}}},"9":{"name":"(anonymous_9)","line":123,"loc":{"start":{"line":123,"column":12},"end":{"line":123,"column":15}}},"10":{"name":"(anonymous_10)","line":124,"loc":{"start":{"line":124,"column":12},"end":{"line":124,"column":20}}},"11":{"name":"(anonymous_11)","line":125,"loc":{"start":{"line":125,"column":11},"end":{"line":125,"column":14}}},"12":{"name":"(anonymous_12)","line":126,"loc":{"start":{"line":126,"column":11},"end":{"line":126,"column":19}}},"13":{"name":"(anonymous_13)","line":127,"loc":{"start":{"line":127,"column":15},"end":{"line":127,"column":18}}},"14":{"name":"(anonymous_14)","line":128,"loc":{"start":{"line":128,"column":15},"end":{"line":128,"column":23}}},"15":{"name":"(anonymous_15)","line":130,"loc":{"start":{"line":130,"column":26},"end":{"line":130,"column":29}}},"16":{"name":"(anonymous_16)","line":143,"loc":{"start":{"line":143,"column":10},"end":{"line":143,"column":45}}},"17":{"name":"(anonymous_17)","line":149,"loc":{"start":{"line":149,"column":13},"end":{"line":149,"column":27}}},"18":{"name":"(anonymous_18)","line":157,"loc":{"start":{"line":157,"column":19},"end":{"line":157,"column":40}}},"19":{"name":"(anonymous_19)","line":162,"loc":{"start":{"line":162,"column":8},"end":{"line":162,"column":11}}},"20":{"name":"(anonymous_20)","line":165,"loc":{"start":{"line":165,"column":10},"end":{"line":165,"column":13}}},"21":{"name":"(anonymous_21)","line":168,"loc":{"start":{"line":168,"column":8},"end":{"line":168,"column":11}}},"22":{"name":"(anonymous_22)","line":171,"loc":{"start":{"line":171,"column":10},"end":{"line":171,"column":13}}},"23":{"name":"(anonymous_23)","line":175,"loc":{"start":{"line":175,"column":11},"end":{"line":175,"column":14}}},"24":{"name":"(anonymous_24)","line":178,"loc":{"start":{"line":178,"column":12},"end":{"line":178,"column":15}}},"25":{"name":"(anonymous_25)","line":181,"loc":{"start":{"line":181,"column":16},"end":{"line":181,"column":19}}},"26":{"name":"(anonymous_26)","line":185,"loc":{"start":{"line":185,"column":17},"end":{"line":185,"column":20}}},"27":{"name":"(anonymous_27)","line":189,"loc":{"start":{"line":189,"column":11},"end":{"line":189,"column":14}}},"28":{"name":"(anonymous_28)","line":193,"loc":{"start":{"line":193,"column":12},"end":{"line":193,"column":23}}},"29":{"name":"(anonymous_29)","line":197,"loc":{"start":{"line":197,"column":14},"end":{"line":197,"column":30}}},"30":{"name":"(anonymous_30)","line":205,"loc":{"start":{"line":205,"column":12},"end":{"line":205,"column":33}}},"31":{"name":"(anonymous_31)","line":209,"loc":{"start":{"line":209,"column":14},"end":{"line":209,"column":32}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":47}},"2":{"start":{"line":28,"column":0},"end":{"line":30,"column":2}},"3":{"start":{"line":29,"column":2},"end":{"line":29,"column":25}},"4":{"start":{"line":32,"column":0},"end":{"line":216,"column":2}},"5":{"start":{"line":34,"column":4},"end":{"line":40,"column":6}},"6":{"start":{"line":43,"column":4},"end":{"line":43,"column":36}},"7":{"start":{"line":44,"column":4},"end":{"line":44,"column":36}},"8":{"start":{"line":45,"column":4},"end":{"line":45,"column":54}},"9":{"start":{"line":48,"column":4},"end":{"line":116,"column":5}},"10":{"start":{"line":50,"column":8},"end":{"line":50,"column":68}},"11":{"start":{"line":51,"column":8},"end":{"line":51,"column":14}},"12":{"start":{"line":53,"column":8},"end":{"line":53,"column":59}},"13":{"start":{"line":54,"column":8},"end":{"line":54,"column":14}},"14":{"start":{"line":57,"column":8},"end":{"line":57,"column":51}},"15":{"start":{"line":58,"column":8},"end":{"line":58,"column":14}},"16":{"start":{"line":60,"column":8},"end":{"line":60,"column":42}},"17":{"start":{"line":61,"column":8},"end":{"line":61,"column":14}},"18":{"start":{"line":64,"column":8},"end":{"line":64,"column":28}},"19":{"start":{"line":65,"column":8},"end":{"line":102,"column":9}},"20":{"start":{"line":66,"column":10},"end":{"line":72,"column":12}},"21":{"start":{"line":73,"column":15},"end":{"line":102,"column":9}},"22":{"start":{"line":74,"column":10},"end":{"line":74,"column":29}},"23":{"start":{"line":75,"column":15},"end":{"line":102,"column":9}},"24":{"start":{"line":76,"column":10},"end":{"line":82,"column":12}},"25":{"start":{"line":84,"column":10},"end":{"line":84,"column":46}},"26":{"start":{"line":85,"column":10},"end":{"line":101,"column":11}},"27":{"start":{"line":86,"column":12},"end":{"line":92,"column":14}},"28":{"start":{"line":94,"column":12},"end":{"line":100,"column":14}},"29":{"start":{"line":103,"column":8},"end":{"line":103,"column":14}},"30":{"start":{"line":106,"column":8},"end":{"line":111,"column":10}},"31":{"start":{"line":112,"column":8},"end":{"line":112,"column":14}},"32":{"start":{"line":115,"column":8},"end":{"line":115,"column":92}},"33":{"start":{"line":119,"column":14},"end":{"line":119,"column":41}},"34":{"start":{"line":120,"column":19},"end":{"line":120,"column":42}},"35":{"start":{"line":121,"column":15},"end":{"line":121,"column":43}},"36":{"start":{"line":122,"column":20},"end":{"line":122,"column":44}},"37":{"start":{"line":123,"column":17},"end":{"line":123,"column":47}},"38":{"start":{"line":124,"column":22},"end":{"line":124,"column":48}},"39":{"start":{"line":125,"column":16},"end":{"line":125,"column":45}},"40":{"start":{"line":126,"column":21},"end":{"line":126,"column":46}},"41":{"start":{"line":127,"column":20},"end":{"line":127,"column":48}},"42":{"start":{"line":128,"column":25},"end":{"line":128,"column":54}},"43":{"start":{"line":131,"column":4},"end":{"line":131,"column":41}},"44":{"start":{"line":132,"column":4},"end":{"line":140,"column":5}},"45":{"start":{"line":133,"column":6},"end":{"line":137,"column":7}},"46":{"start":{"line":134,"column":8},"end":{"line":134,"column":31}},"47":{"start":{"line":136,"column":8},"end":{"line":136,"column":40}},"48":{"start":{"line":139,"column":6},"end":{"line":139,"column":16}},"49":{"start":{"line":144,"column":4},"end":{"line":144,"column":60}},"50":{"start":{"line":144,"column":45},"end":{"line":144,"column":60}},"51":{"start":{"line":145,"column":4},"end":{"line":145,"column":65}},"52":{"start":{"line":145,"column":48},"end":{"line":145,"column":65}},"53":{"start":{"line":146,"column":4},"end":{"line":146,"column":75}},"54":{"start":{"line":146,"column":54},"end":{"line":146,"column":75}},"55":{"start":{"line":147,"column":4},"end":{"line":147,"column":70}},"56":{"start":{"line":147,"column":51},"end":{"line":147,"column":70}},"57":{"start":{"line":150,"column":4},"end":{"line":155,"column":5}},"58":{"start":{"line":151,"column":6},"end":{"line":151,"column":38}},"59":{"start":{"line":152,"column":6},"end":{"line":154,"column":7}},"60":{"start":{"line":153,"column":8},"end":{"line":153,"column":76}},"61":{"start":{"line":158,"column":4},"end":{"line":158,"column":48}},"62":{"start":{"line":159,"column":4},"end":{"line":159,"column":68}},"63":{"start":{"line":163,"column":4},"end":{"line":163,"column":46}},"64":{"start":{"line":166,"column":4},"end":{"line":166,"column":58}},"65":{"start":{"line":169,"column":4},"end":{"line":169,"column":50}},"66":{"start":{"line":172,"column":4},"end":{"line":172,"column":62}},"67":{"start":{"line":176,"column":4},"end":{"line":176,"column":63}},"68":{"start":{"line":179,"column":4},"end":{"line":179,"column":67}},"69":{"start":{"line":182,"column":4},"end":{"line":183,"column":44}},"70":{"start":{"line":186,"column":4},"end":{"line":187,"column":46}},"71":{"start":{"line":190,"column":4},"end":{"line":190,"column":71}},"72":{"start":{"line":194,"column":4},"end":{"line":194,"column":22}},"73":{"start":{"line":198,"column":4},"end":{"line":198,"column":96}},"74":{"start":{"line":198,"column":83},"end":{"line":198,"column":96}},"75":{"start":{"line":199,"column":4},"end":{"line":199,"column":46}},"76":{"start":{"line":199,"column":33},"end":{"line":199,"column":46}},"77":{"start":{"line":200,"column":4},"end":{"line":200,"column":46}},"78":{"start":{"line":200,"column":33},"end":{"line":200,"column":46}},"79":{"start":{"line":201,"column":4},"end":{"line":201,"column":46}},"80":{"start":{"line":201,"column":33},"end":{"line":201,"column":46}},"81":{"start":{"line":202,"column":4},"end":{"line":202,"column":46}},"82":{"start":{"line":202,"column":33},"end":{"line":202,"column":46}},"83":{"start":{"line":203,"column":4},"end":{"line":203,"column":16}},"84":{"start":{"line":206,"column":4},"end":{"line":206,"column":48}},"85":{"start":{"line":207,"column":4},"end":{"line":207,"column":36}},"86":{"start":{"line":210,"column":4},"end":{"line":210,"column":100}},"87":{"start":{"line":210,"column":87},"end":{"line":210,"column":100}},"88":{"start":{"line":211,"column":4},"end":{"line":214,"column":39}}},"branchMap":{"1":{"line":48,"type":"switch","locations":[{"start":{"line":49,"column":6},"end":{"line":51,"column":14}},{"start":{"line":52,"column":6},"end":{"line":54,"column":14}},{"start":{"line":56,"column":6},"end":{"line":58,"column":14}},{"start":{"line":59,"column":6},"end":{"line":61,"column":14}},{"start":{"line":63,"column":6},"end":{"line":103,"column":14}},{"start":{"line":105,"column":6},"end":{"line":112,"column":14}},{"start":{"line":114,"column":6},"end":{"line":115,"column":92}}]},"2":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":8}},{"start":{"line":65,"column":8},"end":{"line":65,"column":8}}]},"3":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":15},"end":{"line":73,"column":15}},{"start":{"line":73,"column":15},"end":{"line":73,"column":15}}]},"4":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":15},"end":{"line":75,"column":15}},{"start":{"line":75,"column":15},"end":{"line":75,"column":15}}]},"5":{"line":75,"type":"binary-expr","locations":[{"start":{"line":75,"column":19},"end":{"line":75,"column":28}},{"start":{"line":75,"column":32},"end":{"line":75,"column":42}},{"start":{"line":75,"column":46},"end":{"line":75,"column":58}},{"start":{"line":75,"column":62},"end":{"line":75,"column":73}}]},"6":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":10},"end":{"line":85,"column":10}},{"start":{"line":85,"column":10},"end":{"line":85,"column":10}}]},"7":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":21},"end":{"line":119,"column":35}},{"start":{"line":119,"column":39},"end":{"line":119,"column":40}}]},"8":{"line":121,"type":"binary-expr","locations":[{"start":{"line":121,"column":22},"end":{"line":121,"column":37}},{"start":{"line":121,"column":41},"end":{"line":121,"column":42}}]},"9":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":24},"end":{"line":123,"column":41}},{"start":{"line":123,"column":45},"end":{"line":123,"column":46}}]},"10":{"line":125,"type":"binary-expr","locations":[{"start":{"line":125,"column":23},"end":{"line":125,"column":39}},{"start":{"line":125,"column":43},"end":{"line":125,"column":44}}]},"11":{"line":132,"type":"if","locations":[{"start":{"line":132,"column":4},"end":{"line":132,"column":4}},{"start":{"line":132,"column":4},"end":{"line":132,"column":4}}]},"12":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":6},"end":{"line":133,"column":6}},{"start":{"line":133,"column":6},"end":{"line":133,"column":6}}]},"13":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":4},"end":{"line":144,"column":4}},{"start":{"line":144,"column":4},"end":{"line":144,"column":4}}]},"14":{"line":144,"type":"binary-expr","locations":[{"start":{"line":144,"column":8},"end":{"line":144,"column":23}},{"start":{"line":144,"column":28},"end":{"line":144,"column":42}}]},"15":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"16":{"line":145,"type":"binary-expr","locations":[{"start":{"line":145,"column":8},"end":{"line":145,"column":24}},{"start":{"line":145,"column":29},"end":{"line":145,"column":45}}]},"17":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":4},"end":{"line":146,"column":4}},{"start":{"line":146,"column":4},"end":{"line":146,"column":4}}]},"18":{"line":146,"type":"binary-expr","locations":[{"start":{"line":146,"column":8},"end":{"line":146,"column":26}},{"start":{"line":146,"column":31},"end":{"line":146,"column":51}}]},"19":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":4},"end":{"line":147,"column":4}},{"start":{"line":147,"column":4},"end":{"line":147,"column":4}}]},"20":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":8},"end":{"line":147,"column":25}},{"start":{"line":147,"column":30},"end":{"line":147,"column":48}}]},"21":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":4},"end":{"line":150,"column":4}},{"start":{"line":150,"column":4},"end":{"line":150,"column":4}}]},"22":{"line":152,"type":"if","locations":[{"start":{"line":152,"column":6},"end":{"line":152,"column":6}},{"start":{"line":152,"column":6},"end":{"line":152,"column":6}}]},"23":{"line":182,"type":"cond-expr","locations":[{"start":{"line":182,"column":28},"end":{"line":182,"column":38}},{"start":{"line":183,"column":7},"end":{"line":183,"column":42}}]},"24":{"line":186,"type":"cond-expr","locations":[{"start":{"line":186,"column":28},"end":{"line":186,"column":39}},{"start":{"line":187,"column":7},"end":{"line":187,"column":44}}]},"25":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":4},"end":{"line":198,"column":4}},{"start":{"line":198,"column":4},"end":{"line":198,"column":4}}]},"26":{"line":198,"type":"binary-expr","locations":[{"start":{"line":198,"column":8},"end":{"line":198,"column":23}},{"start":{"line":198,"column":27},"end":{"line":198,"column":41}},{"start":{"line":198,"column":46},"end":{"line":198,"column":80}}]},"27":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":4},"end":{"line":199,"column":4}},{"start":{"line":199,"column":4},"end":{"line":199,"column":4}}]},"28":{"line":200,"type":"if","locations":[{"start":{"line":200,"column":4},"end":{"line":200,"column":4}},{"start":{"line":200,"column":4},"end":{"line":200,"column":4}}]},"29":{"line":201,"type":"if","locations":[{"start":{"line":201,"column":4},"end":{"line":201,"column":4}},{"start":{"line":201,"column":4},"end":{"line":201,"column":4}}]},"30":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":4},"end":{"line":202,"column":4}},{"start":{"line":202,"column":4},"end":{"line":202,"column":4}}]},"31":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":4},"end":{"line":210,"column":4}},{"start":{"line":210,"column":4},"end":{"line":210,"column":4}}]},"32":{"line":210,"type":"binary-expr","locations":[{"start":{"line":210,"column":8},"end":{"line":210,"column":25}},{"start":{"line":210,"column":29},"end":{"line":210,"column":43}},{"start":{"line":210,"column":48},"end":{"line":210,"column":84}}]},"33":{"line":211,"type":"binary-expr","locations":[{"start":{"line":211,"column":12},"end":{"line":211,"column":35}},{"start":{"line":212,"column":12},"end":{"line":212,"column":38}},{"start":{"line":213,"column":12},"end":{"line":213,"column":36}},{"start":{"line":214,"column":12},"end":{"line":214,"column":37}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var colCache = require('./../utils/col-cache');","","// used by worksheet to calculate sheet dimensions","var Range = module.exports = function() {","  this.decode(arguments);","};","","Range.prototype = {","  _set_tlbr: function(t,l,b,r, s) {","    this.model = {","      top: Math.min(t,b),","      left: Math.min(l,r),","      bottom: Math.max(t,b),","      right: Math.max(l,r),","      sheetName: s","    };","  },","  _set_tl_br: function(tl, br, s) {","    tl = colCache.decodeAddress(tl);","    br = colCache.decodeAddress(br);","    this._set_tlbr(tl.row, tl.col, br.row, br.col, s);","  },","  decode: function(argv) {","    switch (argv.length) {","      case 5: // [t,l,b,r,s]","        this._set_tlbr(argv[0], argv[1], argv[2], argv[3], argv[4]);","        break;","      case 4: // [t,l,b,r]","        this._set_tlbr(argv[0], argv[1], argv[2], argv[3]);","        break;","","      case 3: // [tl,br,s]","        this._set_tl_br(argv[0], argv[1], argv[2]);","        break;","      case 2: // [tl,br]","        this._set_tl_br(argv[0], argv[1]);","        break;","","      case 1:","        var value = argv[0];","        if (value instanceof Range) { // copy constructor","          this.model = {","            top: value.model.top,","            left: value.model.left,","            bottom: value.model.bottom,","            right: value.model.right,","            sheetName: value.sheetName","          };","        } else if (value instanceof Array) { // an arguments array","          this.decode(value);","        } else if (value.top && value.left && value.bottom && value.right) { // a model","          this.model = {","            top: value.top,","            left: value.left,","            bottom: value.bottom,","            right: value.right,","            sheetName: value.sheetName","          };","        } else { // [sheetName!]tl:br","          var tlbr = colCache.decodeEx(value);","          if (tlbr.top) {","            this.model = {","              top: tlbr.top,","              left: tlbr.left,","              bottom: tlbr.bottom,","              right: tlbr.right,","              sheetName: tlbr.sheetName","            };","          } else {","            this.model = {","              top: tlbr.row,","              left: tlbr.col,","              bottom: tlbr.row,","              right: tlbr.col,","              sheetName: tlbr.sheetName","            };","          }","        }","        break;","","      case 0:","        this.model = {","          top: 0,","          left: 0,","          bottom: 0,","          right: 0","        };","        break;","","      default:","        throw new Error('Invalid number of arguments to _getDimensions() - ' + argv.length);","    }","  },","","  get top() { return this.model.top || 1; },","  set top(value) { this.model.top = value; },","  get left() { return this.model.left || 1; },","  set left(value) { this.model.left = value; },","  get bottom() { return this.model.bottom || 1; },","  set bottom(value) { this.model.bottom = value; },","  get right() { return this.model.right || 1; },","  set right(value) { this.model.right = value; },","  get sheetName() { return this.model.sheetName; },","  set sheetName(value) { this.model.sheetName = value; },","","  get _serialisedSheetName() {","    var sheetName = this.model.sheetName;","    if (sheetName) {","      if (/^[a-zA-Z0-9]*$/.test(sheetName)) {","        return sheetName + '!';","      } else {","        return '\\'' + sheetName + '\\'!';","      }","    } else {","      return '';","    }","  },","","  expand: function(top, left, bottom, right) {","    if (!this.model.top || (top < this.top)) this.top = top;","    if (!this.model.left || (left < this.left)) this.left = left;","    if (!this.model.bottom || (bottom > this.bottom)) this.bottom = bottom;","    if (!this.model.right || (right > this.right)) this.right = right;","  },","  expandRow: function(row) {","    if (row) {","      var dimensions = row.dimensions;","      if (dimensions) {","        this.expand(row.number, dimensions.min, row.number, dimensions.max);","      }","    }","  },","  expandToAddress: function(addressStr) {","    var address = colCache.decodeEx(addressStr);","    this.expand(address.row, address.col, address.row, address.col);","  },","","  get tl() {","    return colCache.n2l(this.left) + this.top;","  },","  get $t$l() {","    return '$' + colCache.n2l(this.left) + '$' + this.top;","  },","  get br() {","    return colCache.n2l(this.right) + this.bottom;","  },","  get $b$r() {","    return '$' + colCache.n2l(this.right) + '$' + this.bottom;","  },","","  get range() {","    return this._serialisedSheetName + this.tl + ':' + this.br;","  },","  get $range() {","    return this._serialisedSheetName + this.$t$l + ':' + this.$b$r;","  },","  get shortRange() {","    return this.count > 1 ? this.range :","      (this._serialisedSheetName + this.tl);","  },","  get $shortRange() {","    return this.count > 1 ? this.$range :","      (this._serialisedSheetName + this.$t$l);","  },","  get count() {","    return (1 + this.bottom - this.top) * (1 + this.right - this.left);","  },","","  toString: function() {","    return this.range;","  },","","  intersects: function(other) {","    if (other.sheetName && this.sheetName && (other.sheetName !== this.sheetName)) return false;","    if (other.bottom < this.top) return false;","    if (other.top > this.bottom) return false;","    if (other.right < this.left) return false;","    if (other.left > this.right) return false;","    return true;","  },","  contains: function(addressStr) {","    var address = colCache.decodeEx(addressStr);","    return this.containsEx(address);","  },","  containsEx: function(address) {","    if (address.sheetName && this.sheetName && (address.sheetName !== this.sheetName)) return false;","    return (address.row >= this.top) &&","           (address.row <= this.bottom) &&","           (address.col >= this.left) &&","           (address.col <= this.right);","  }","};"],"l":{"25":1,"28":1,"29":0,"32":1,"34":0,"43":0,"44":0,"45":0,"48":0,"50":0,"51":0,"53":0,"54":0,"57":0,"58":0,"60":0,"61":0,"64":0,"65":0,"66":0,"73":0,"74":0,"75":0,"76":0,"84":0,"85":0,"86":0,"94":0,"103":0,"106":0,"112":0,"115":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"131":0,"132":0,"133":0,"134":0,"136":0,"139":0,"144":0,"145":0,"146":0,"147":0,"150":0,"151":0,"152":0,"153":0,"158":0,"159":0,"163":0,"166":0,"169":0,"172":0,"176":0,"179":0,"182":0,"186":0,"190":0,"194":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"206":0,"207":0,"210":0,"211":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/row.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/row.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":27},"end":{"line":31,"column":56}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":15}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":15},"end":{"line":45,"column":18}}},"4":{"name":"(anonymous_4)","line":51,"loc":{"start":{"line":51,"column":10},"end":{"line":51,"column":22}}},"5":{"name":"(anonymous_5)","line":56,"loc":{"start":{"line":56,"column":11},"end":{"line":56,"column":23}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":12},"end":{"line":62,"column":33}}},"7":{"name":"(anonymous_7)","line":67,"loc":{"start":{"line":67,"column":12},"end":{"line":67,"column":31}}},"8":{"name":"(anonymous_8)","line":78,"loc":{"start":{"line":78,"column":11},"end":{"line":78,"column":26}}},"9":{"name":"(anonymous_9)","line":97,"loc":{"start":{"line":97,"column":10},"end":{"line":97,"column":33}}},"10":{"name":"(anonymous_10)","line":136,"loc":{"start":{"line":136,"column":12},"end":{"line":136,"column":41}}},"11":{"name":"(anonymous_11)","line":147,"loc":{"start":{"line":147,"column":26},"end":{"line":147,"column":49}}},"12":{"name":"(anonymous_12)","line":156,"loc":{"start":{"line":156,"column":12},"end":{"line":156,"column":15}}},"13":{"name":"(anonymous_13)","line":158,"loc":{"start":{"line":158,"column":24},"end":{"line":158,"column":40}}},"14":{"name":"(anonymous_14)","line":167,"loc":{"start":{"line":167,"column":12},"end":{"line":167,"column":20}}},"15":{"name":"(anonymous_15)","line":180,"loc":{"start":{"line":180,"column":20},"end":{"line":180,"column":43}}},"16":{"name":"(anonymous_16)","line":191,"loc":{"start":{"line":191,"column":36},"end":{"line":191,"column":59}}},"17":{"name":"(anonymous_17)","line":204,"loc":{"start":{"line":204,"column":15},"end":{"line":204,"column":18}}},"18":{"name":"(anonymous_18)","line":205,"loc":{"start":{"line":205,"column":31},"end":{"line":205,"column":47}}},"19":{"name":"(anonymous_19)","line":210,"loc":{"start":{"line":210,"column":15},"end":{"line":210,"column":18}}},"20":{"name":"(anonymous_20)","line":213,"loc":{"start":{"line":213,"column":21},"end":{"line":213,"column":24}}},"21":{"name":"(anonymous_21)","line":215,"loc":{"start":{"line":215,"column":18},"end":{"line":215,"column":29}}},"22":{"name":"(anonymous_22)","line":222,"loc":{"start":{"line":222,"column":16},"end":{"line":222,"column":19}}},"23":{"name":"(anonymous_23)","line":225,"loc":{"start":{"line":225,"column":24},"end":{"line":225,"column":40}}},"24":{"name":"(anonymous_24)","line":243,"loc":{"start":{"line":243,"column":15},"end":{"line":243,"column":38}}},"25":{"name":"(anonymous_25)","line":245,"loc":{"start":{"line":245,"column":24},"end":{"line":245,"column":40}}},"26":{"name":"(anonymous_26)","line":251,"loc":{"start":{"line":251,"column":12},"end":{"line":251,"column":15}}},"27":{"name":"(anonymous_27)","line":254,"loc":{"start":{"line":254,"column":12},"end":{"line":254,"column":20}}},"28":{"name":"(anonymous_28)","line":257,"loc":{"start":{"line":257,"column":10},"end":{"line":257,"column":13}}},"29":{"name":"(anonymous_29)","line":260,"loc":{"start":{"line":260,"column":10},"end":{"line":260,"column":18}}},"30":{"name":"(anonymous_30)","line":263,"loc":{"start":{"line":263,"column":15},"end":{"line":263,"column":18}}},"31":{"name":"(anonymous_31)","line":266,"loc":{"start":{"line":266,"column":15},"end":{"line":266,"column":23}}},"32":{"name":"(anonymous_32)","line":269,"loc":{"start":{"line":269,"column":12},"end":{"line":269,"column":15}}},"33":{"name":"(anonymous_33)","line":272,"loc":{"start":{"line":272,"column":12},"end":{"line":272,"column":20}}},"34":{"name":"(anonymous_34)","line":275,"loc":{"start":{"line":275,"column":10},"end":{"line":275,"column":13}}},"35":{"name":"(anonymous_35)","line":278,"loc":{"start":{"line":278,"column":10},"end":{"line":278,"column":18}}},"36":{"name":"(anonymous_36)","line":282,"loc":{"start":{"line":282,"column":12},"end":{"line":282,"column":15}}},"37":{"name":"(anonymous_37)","line":285,"loc":{"start":{"line":285,"column":12},"end":{"line":285,"column":20}}},"38":{"name":"(anonymous_38)","line":289,"loc":{"start":{"line":289,"column":18},"end":{"line":289,"column":21}}},"39":{"name":"(anonymous_39)","line":292,"loc":{"start":{"line":292,"column":18},"end":{"line":292,"column":26}}},"40":{"name":"(anonymous_40)","line":295,"loc":{"start":{"line":295,"column":15},"end":{"line":295,"column":18}}},"41":{"name":"(anonymous_41)","line":300,"loc":{"start":{"line":300,"column":11},"end":{"line":300,"column":14}}},"42":{"name":"(anonymous_42)","line":304,"loc":{"start":{"line":304,"column":24},"end":{"line":304,"column":40}}},"43":{"name":"(anonymous_43)","line":331,"loc":{"start":{"line":331,"column":11},"end":{"line":331,"column":19}}},"44":{"name":"(anonymous_44)","line":337,"loc":{"start":{"line":337,"column":24},"end":{"line":337,"column":45}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":39}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":31}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":47}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":29}},"5":{"start":{"line":31,"column":0},"end":{"line":37,"column":2}},"6":{"start":{"line":32,"column":2},"end":{"line":32,"column":30}},"7":{"start":{"line":33,"column":2},"end":{"line":33,"column":24}},"8":{"start":{"line":34,"column":2},"end":{"line":34,"column":19}},"9":{"start":{"line":35,"column":2},"end":{"line":35,"column":18}},"10":{"start":{"line":36,"column":2},"end":{"line":36,"column":24}},"11":{"start":{"line":39,"column":0},"end":{"line":360,"column":2}},"12":{"start":{"line":42,"column":4},"end":{"line":42,"column":24}},"13":{"start":{"line":46,"column":4},"end":{"line":46,"column":27}},"14":{"start":{"line":52,"column":4},"end":{"line":52,"column":37}},"15":{"start":{"line":57,"column":4},"end":{"line":57,"column":27}},"16":{"start":{"line":58,"column":4},"end":{"line":58,"column":23}},"17":{"start":{"line":59,"column":4},"end":{"line":59,"column":22}},"18":{"start":{"line":63,"column":4},"end":{"line":63,"column":38}},"19":{"start":{"line":68,"column":4},"end":{"line":68,"column":44}},"20":{"start":{"line":69,"column":4},"end":{"line":73,"column":5}},"21":{"start":{"line":70,"column":6},"end":{"line":70,"column":58}},"22":{"start":{"line":71,"column":6},"end":{"line":71,"column":53}},"23":{"start":{"line":72,"column":6},"end":{"line":72,"column":42}},"24":{"start":{"line":74,"column":4},"end":{"line":74,"column":16}},"25":{"start":{"line":79,"column":4},"end":{"line":87,"column":5}},"26":{"start":{"line":81,"column":6},"end":{"line":81,"column":46}},"27":{"start":{"line":82,"column":6},"end":{"line":86,"column":7}},"28":{"start":{"line":83,"column":8},"end":{"line":83,"column":28}},"29":{"start":{"line":85,"column":8},"end":{"line":85,"column":32}},"30":{"start":{"line":88,"column":4},"end":{"line":93,"column":9}},"31":{"start":{"line":98,"column":4},"end":{"line":98,"column":59}},"32":{"start":{"line":99,"column":4},"end":{"line":99,"column":30}},"33":{"start":{"line":100,"column":4},"end":{"line":100,"column":41}},"34":{"start":{"line":101,"column":4},"end":{"line":101,"column":34}},"35":{"start":{"line":102,"column":4},"end":{"line":102,"column":22}},"36":{"start":{"line":103,"column":4},"end":{"line":127,"column":5}},"37":{"start":{"line":105,"column":6},"end":{"line":116,"column":7}},"38":{"start":{"line":106,"column":8},"end":{"line":106,"column":32}},"39":{"start":{"line":107,"column":8},"end":{"line":115,"column":9}},"40":{"start":{"line":108,"column":10},"end":{"line":108,"column":55}},"41":{"start":{"line":109,"column":10},"end":{"line":109,"column":28}},"42":{"start":{"line":111,"column":10},"end":{"line":111,"column":46}},"43":{"start":{"line":112,"column":10},"end":{"line":114,"column":11}},"44":{"start":{"line":113,"column":12},"end":{"line":113,"column":30}},"45":{"start":{"line":117,"column":11},"end":{"line":127,"column":5}},"46":{"start":{"line":119,"column":6},"end":{"line":126,"column":7}},"47":{"start":{"line":120,"column":8},"end":{"line":120,"column":32}},"48":{"start":{"line":121,"column":8},"end":{"line":125,"column":9}},"49":{"start":{"line":122,"column":10},"end":{"line":122,"column":55}},"50":{"start":{"line":124,"column":10},"end":{"line":124,"column":51}},"51":{"start":{"line":130,"column":4},"end":{"line":132,"column":5}},"52":{"start":{"line":131,"column":6},"end":{"line":131,"column":49}},"53":{"start":{"line":137,"column":4},"end":{"line":140,"column":5}},"54":{"start":{"line":138,"column":6},"end":{"line":138,"column":25}},"55":{"start":{"line":139,"column":6},"end":{"line":139,"column":21}},"56":{"start":{"line":141,"column":4},"end":{"line":152,"column":5}},"57":{"start":{"line":142,"column":6},"end":{"line":142,"column":33}},"58":{"start":{"line":143,"column":6},"end":{"line":145,"column":7}},"59":{"start":{"line":144,"column":8},"end":{"line":144,"column":37}},"60":{"start":{"line":147,"column":6},"end":{"line":151,"column":9}},"61":{"start":{"line":148,"column":8},"end":{"line":150,"column":9}},"62":{"start":{"line":149,"column":10},"end":{"line":149,"column":36}},"63":{"start":{"line":157,"column":4},"end":{"line":157,"column":20}},"64":{"start":{"line":158,"column":4},"end":{"line":162,"column":7}},"65":{"start":{"line":159,"column":6},"end":{"line":161,"column":7}},"66":{"start":{"line":160,"column":8},"end":{"line":160,"column":38}},"67":{"start":{"line":163,"column":4},"end":{"line":163,"column":18}},"68":{"start":{"line":168,"column":4},"end":{"line":168,"column":20}},"69":{"start":{"line":171,"column":4},"end":{"line":171,"column":21}},"70":{"start":{"line":172,"column":4},"end":{"line":200,"column":5}},"71":{"start":{"line":174,"column":11},"end":{"line":200,"column":5}},"72":{"start":{"line":175,"column":6},"end":{"line":175,"column":21}},"73":{"start":{"line":176,"column":6},"end":{"line":179,"column":7}},"74":{"start":{"line":178,"column":8},"end":{"line":178,"column":19}},"75":{"start":{"line":180,"column":6},"end":{"line":188,"column":9}},"76":{"start":{"line":181,"column":8},"end":{"line":187,"column":9}},"77":{"start":{"line":182,"column":10},"end":{"line":186,"column":26}},"78":{"start":{"line":191,"column":6},"end":{"line":199,"column":9}},"79":{"start":{"line":192,"column":8},"end":{"line":198,"column":9}},"80":{"start":{"line":193,"column":10},"end":{"line":197,"column":32}},"81":{"start":{"line":205,"column":4},"end":{"line":207,"column":7}},"82":{"start":{"line":206,"column":6},"end":{"line":206,"column":57}},"83":{"start":{"line":211,"column":4},"end":{"line":211,"column":30}},"84":{"start":{"line":214,"column":4},"end":{"line":214,"column":18}},"85":{"start":{"line":215,"column":4},"end":{"line":217,"column":7}},"86":{"start":{"line":216,"column":6},"end":{"line":216,"column":14}},"87":{"start":{"line":218,"column":4},"end":{"line":218,"column":17}},"88":{"start":{"line":223,"column":4},"end":{"line":223,"column":16}},"89":{"start":{"line":224,"column":4},"end":{"line":224,"column":16}},"90":{"start":{"line":225,"column":4},"end":{"line":234,"column":7}},"91":{"start":{"line":226,"column":6},"end":{"line":233,"column":7}},"92":{"start":{"line":227,"column":8},"end":{"line":229,"column":9}},"93":{"start":{"line":228,"column":10},"end":{"line":228,"column":25}},"94":{"start":{"line":230,"column":8},"end":{"line":232,"column":9}},"95":{"start":{"line":231,"column":10},"end":{"line":231,"column":25}},"96":{"start":{"line":235,"column":4},"end":{"line":238,"column":13}},"97":{"start":{"line":244,"column":4},"end":{"line":244,"column":29}},"98":{"start":{"line":245,"column":4},"end":{"line":247,"column":7}},"99":{"start":{"line":246,"column":6},"end":{"line":246,"column":39}},"100":{"start":{"line":246,"column":18},"end":{"line":246,"column":37}},"101":{"start":{"line":248,"column":4},"end":{"line":248,"column":17}},"102":{"start":{"line":252,"column":4},"end":{"line":252,"column":29}},"103":{"start":{"line":255,"column":4},"end":{"line":255,"column":38}},"104":{"start":{"line":258,"column":4},"end":{"line":258,"column":27}},"105":{"start":{"line":261,"column":4},"end":{"line":261,"column":36}},"106":{"start":{"line":264,"column":4},"end":{"line":264,"column":32}},"107":{"start":{"line":267,"column":4},"end":{"line":267,"column":41}},"108":{"start":{"line":270,"column":4},"end":{"line":270,"column":29}},"109":{"start":{"line":273,"column":4},"end":{"line":273,"column":38}},"110":{"start":{"line":276,"column":4},"end":{"line":276,"column":27}},"111":{"start":{"line":279,"column":4},"end":{"line":279,"column":36}},"112":{"start":{"line":283,"column":4},"end":{"line":283,"column":26}},"113":{"start":{"line":286,"column":4},"end":{"line":286,"column":25}},"114":{"start":{"line":290,"column":4},"end":{"line":290,"column":35}},"115":{"start":{"line":293,"column":4},"end":{"line":293,"column":31}},"116":{"start":{"line":296,"column":4},"end":{"line":296,"column":104}},"117":{"start":{"line":301,"column":4},"end":{"line":301,"column":19}},"118":{"start":{"line":302,"column":4},"end":{"line":302,"column":16}},"119":{"start":{"line":303,"column":4},"end":{"line":303,"column":16}},"120":{"start":{"line":304,"column":4},"end":{"line":317,"column":7}},"121":{"start":{"line":305,"column":6},"end":{"line":316,"column":7}},"122":{"start":{"line":306,"column":8},"end":{"line":306,"column":35}},"123":{"start":{"line":307,"column":8},"end":{"line":315,"column":9}},"124":{"start":{"line":308,"column":10},"end":{"line":310,"column":11}},"125":{"start":{"line":309,"column":12},"end":{"line":309,"column":27}},"126":{"start":{"line":311,"column":10},"end":{"line":313,"column":11}},"127":{"start":{"line":312,"column":12},"end":{"line":312,"column":27}},"128":{"start":{"line":314,"column":10},"end":{"line":314,"column":32}},"129":{"start":{"line":319,"column":4},"end":{"line":329,"column":13}},"130":{"start":{"line":332,"column":4},"end":{"line":334,"column":5}},"131":{"start":{"line":333,"column":6},"end":{"line":333,"column":53}},"132":{"start":{"line":335,"column":4},"end":{"line":335,"column":20}},"133":{"start":{"line":336,"column":4},"end":{"line":336,"column":21}},"134":{"start":{"line":337,"column":4},"end":{"line":347,"column":7}},"135":{"start":{"line":338,"column":6},"end":{"line":346,"column":7}},"136":{"start":{"line":341,"column":10},"end":{"line":341,"column":16}},"137":{"start":{"line":343,"column":10},"end":{"line":343,"column":78}},"138":{"start":{"line":344,"column":10},"end":{"line":344,"column":33}},"139":{"start":{"line":345,"column":10},"end":{"line":345,"column":16}},"140":{"start":{"line":349,"column":4},"end":{"line":353,"column":5}},"141":{"start":{"line":350,"column":6},"end":{"line":350,"column":33}},"142":{"start":{"line":352,"column":6},"end":{"line":352,"column":25}},"143":{"start":{"line":355,"column":4},"end":{"line":355,"column":31}},"144":{"start":{"line":356,"column":4},"end":{"line":356,"column":48}},"145":{"start":{"line":358,"column":4},"end":{"line":358,"column":35}}},"branchMap":{"1":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":69,"column":4}},{"start":{"line":69,"column":4},"end":{"line":69,"column":4}}]},"2":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"3":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":6},"end":{"line":82,"column":6}},{"start":{"line":82,"column":6},"end":{"line":82,"column":6}}]},"4":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":11},"end":{"line":88,"column":31}},{"start":{"line":89,"column":6},"end":{"line":93,"column":8}}]},"5":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]},"6":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":8},"end":{"line":107,"column":8}},{"start":{"line":107,"column":8},"end":{"line":107,"column":8}}]},"7":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":10},"end":{"line":112,"column":10}},{"start":{"line":112,"column":10},"end":{"line":112,"column":10}}]},"8":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":11},"end":{"line":117,"column":11}},{"start":{"line":117,"column":11},"end":{"line":117,"column":11}}]},"9":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":8},"end":{"line":121,"column":8}},{"start":{"line":121,"column":8},"end":{"line":121,"column":8}}]},"10":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":4},"end":{"line":137,"column":4}},{"start":{"line":137,"column":4},"end":{"line":137,"column":4}}]},"11":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":4},"end":{"line":141,"column":4}},{"start":{"line":141,"column":4},"end":{"line":141,"column":4}}]},"12":{"line":141,"type":"binary-expr","locations":[{"start":{"line":141,"column":8},"end":{"line":141,"column":15}},{"start":{"line":141,"column":19},"end":{"line":141,"column":39}}]},"13":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":8},"end":{"line":148,"column":8}},{"start":{"line":148,"column":8},"end":{"line":148,"column":8}}]},"14":{"line":148,"type":"binary-expr","locations":[{"start":{"line":148,"column":12},"end":{"line":148,"column":16}},{"start":{"line":148,"column":21},"end":{"line":148,"column":54}}]},"15":{"line":159,"type":"if","locations":[{"start":{"line":159,"column":6},"end":{"line":159,"column":6}},{"start":{"line":159,"column":6},"end":{"line":159,"column":6}}]},"16":{"line":159,"type":"binary-expr","locations":[{"start":{"line":159,"column":10},"end":{"line":159,"column":14}},{"start":{"line":159,"column":19},"end":{"line":159,"column":52}}]},"17":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":4},"end":{"line":172,"column":4}},{"start":{"line":172,"column":4},"end":{"line":172,"column":4}}]},"18":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":11},"end":{"line":174,"column":11}},{"start":{"line":174,"column":11},"end":{"line":174,"column":11}}]},"19":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":6},"end":{"line":176,"column":6}},{"start":{"line":176,"column":6},"end":{"line":176,"column":6}}]},"20":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":8},"end":{"line":181,"column":8}},{"start":{"line":181,"column":8},"end":{"line":181,"column":8}}]},"21":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":8},"end":{"line":192,"column":8}},{"start":{"line":192,"column":8},"end":{"line":192,"column":8}}]},"22":{"line":206,"type":"binary-expr","locations":[{"start":{"line":206,"column":13},"end":{"line":206,"column":17}},{"start":{"line":206,"column":22},"end":{"line":206,"column":55}}]},"23":{"line":226,"type":"if","locations":[{"start":{"line":226,"column":6},"end":{"line":226,"column":6}},{"start":{"line":226,"column":6},"end":{"line":226,"column":6}}]},"24":{"line":226,"type":"binary-expr","locations":[{"start":{"line":226,"column":10},"end":{"line":226,"column":14}},{"start":{"line":226,"column":19},"end":{"line":226,"column":52}}]},"25":{"line":227,"type":"if","locations":[{"start":{"line":227,"column":8},"end":{"line":227,"column":8}},{"start":{"line":227,"column":8},"end":{"line":227,"column":8}}]},"26":{"line":227,"type":"binary-expr","locations":[{"start":{"line":227,"column":12},"end":{"line":227,"column":16}},{"start":{"line":227,"column":21},"end":{"line":227,"column":35}}]},"27":{"line":230,"type":"if","locations":[{"start":{"line":230,"column":8},"end":{"line":230,"column":8}},{"start":{"line":230,"column":8},"end":{"line":230,"column":8}}]},"28":{"line":235,"type":"cond-expr","locations":[{"start":{"line":235,"column":21},"end":{"line":238,"column":5}},{"start":{"line":238,"column":8},"end":{"line":238,"column":12}}]},"29":{"line":246,"type":"if","locations":[{"start":{"line":246,"column":6},"end":{"line":246,"column":6}},{"start":{"line":246,"column":6},"end":{"line":246,"column":6}}]},"30":{"line":290,"type":"binary-expr","locations":[{"start":{"line":290,"column":11},"end":{"line":290,"column":29}},{"start":{"line":290,"column":33},"end":{"line":290,"column":34}}]},"31":{"line":296,"type":"binary-expr","locations":[{"start":{"line":296,"column":14},"end":{"line":296,"column":32}},{"start":{"line":296,"column":37},"end":{"line":296,"column":101}}]},"32":{"line":305,"type":"if","locations":[{"start":{"line":305,"column":6},"end":{"line":305,"column":6}},{"start":{"line":305,"column":6},"end":{"line":305,"column":6}}]},"33":{"line":307,"type":"if","locations":[{"start":{"line":307,"column":8},"end":{"line":307,"column":8}},{"start":{"line":307,"column":8},"end":{"line":307,"column":8}}]},"34":{"line":308,"type":"if","locations":[{"start":{"line":308,"column":10},"end":{"line":308,"column":10}},{"start":{"line":308,"column":10},"end":{"line":308,"column":10}}]},"35":{"line":308,"type":"binary-expr","locations":[{"start":{"line":308,"column":14},"end":{"line":308,"column":18}},{"start":{"line":308,"column":23},"end":{"line":308,"column":37}}]},"36":{"line":311,"type":"if","locations":[{"start":{"line":311,"column":10},"end":{"line":311,"column":10}},{"start":{"line":311,"column":10},"end":{"line":311,"column":10}}]},"37":{"line":319,"type":"cond-expr","locations":[{"start":{"line":319,"column":43},"end":{"line":329,"column":5}},{"start":{"line":329,"column":8},"end":{"line":329,"column":12}}]},"38":{"line":319,"type":"binary-expr","locations":[{"start":{"line":319,"column":12},"end":{"line":319,"column":23}},{"start":{"line":319,"column":27},"end":{"line":319,"column":39}}]},"39":{"line":332,"type":"if","locations":[{"start":{"line":332,"column":4},"end":{"line":332,"column":4}},{"start":{"line":332,"column":4},"end":{"line":332,"column":4}}]},"40":{"line":338,"type":"switch","locations":[{"start":{"line":339,"column":8},"end":{"line":341,"column":16}},{"start":{"line":342,"column":8},"end":{"line":345,"column":16}}]},"41":{"line":349,"type":"if","locations":[{"start":{"line":349,"column":4},"end":{"line":349,"column":4}},{"start":{"line":349,"column":4},"end":{"line":349,"column":4}}]},"42":{"line":356,"type":"binary-expr","locations":[{"start":{"line":356,"column":24},"end":{"line":356,"column":42}},{"start":{"line":356,"column":46},"end":{"line":356,"column":47}}]},"43":{"line":358,"type":"binary-expr","locations":[{"start":{"line":358,"column":17},"end":{"line":358,"column":28}},{"start":{"line":358,"column":32},"end":{"line":358,"column":34}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../utils/under-dash');","","var Enums = require('./enums');","var colCache = require('./../utils/col-cache');","var Cell = require('./cell');","","var Row = module.exports = function (worksheet, number) {","  this._worksheet = worksheet;","  this._number = number;","  this._cells = [];","  this.style = {};","  this.outlineLevel = 0;","};","","Row.prototype = {","  // return the row number","  get number() {","    return this._number;","  },","","  get worksheet() {","    return this._worksheet;","  },","","  // Inform Streaming Writer that this row (and all rows before it) are complete","  // and ready to write. Has no effect on Worksheet document","  commit: function () {","    this._worksheet._commitRow(this);","  },","","  // helps GC by breaking cyclic references","  destroy: function () {","    delete this._worksheet;","    delete this._cells;","    delete this.style;","  },","","  findCell: function (colNumber) {","    return this._cells[colNumber - 1];","  },","","  // given {address, row, col}, find or create new cell","  _getCell: function (address) {","    var cell = this._cells[address.col - 1];","    if (!cell) {","      var column = this._worksheet.getColumn(address.col);","      cell = new Cell(this, column, address.address);","      this._cells[address.col - 1] = cell;","    }","    return cell;","  },","","  // get cell by key, letter or column number","  getCell: function (col) {","    if (typeof col == 'string') {","      // is it a key?","      var column = this._worksheet._keys[col];","      if (column) {","        col = column.number;","      } else {","        col = colCache.l2n(col);","      }","    }","    return this._cells[col - 1] ||","      this._getCell({","        address: colCache.encodeAddress(this._number, col),","        row: this._number,","        col: col","      });","  },","","  // remove cell(s) and shift all higher cells down by count","  splice: function(start, count) {","    var inserts = Array.prototype.slice.call(arguments, 2);","    var nKeep = start + count;","    var nExpand = inserts.length - count;","    var nEnd = this._cells.length;","    var i, cSrc, cDst;","    if (nExpand < 0) {","      // remove cells","      for (i = nKeep; i <= nEnd; i++) {","        cSrc = this._cells[i-1];","        if (cSrc) {","          this.getCell(i + nExpand).value = cSrc.value;","          cSrc.value = null;","        } else {","          cDst = this._cells[i + nExpand - 1];","          if (cDst) {","            cDst.value = null;","          }","        }","      }","    } else if (nExpand > 0) {","      // insert new cells","      for (i = nEnd; i >= nKeep; i--) {","        cSrc = this._cells[i-1];","        if (cSrc) {","          this.getCell(i + nExpand).value = cSrc.value;","        } else {","          this._cells[i + nExpand - 1] = undefined;","        }","      }","    }","","    // now add the new values","    for (i = 0; i < inserts.length; i++) {","      this.getCell(start + i).value = inserts[i];","    }","  },","","  // Iterate over all non-null cells in this row","  eachCell: function (options, iteratee) {","    if (!iteratee) {","      iteratee = options;","      options = null;","    }","    if (options && options.includeEmpty) {","      var n = this._cells.length;","      for (var i = 1; i <= n; i++) {","        iteratee(this.getCell(i), i);","      }","    } else {","      this._cells.forEach(function (cell, index) {","        if (cell && (cell.type != Enums.ValueType.Null)) {","          iteratee(cell, index + 1);","        }","      });","    }","  },","","  // return a sparse array of cell values","  get values() {","    var values = [];","    this._cells.forEach(function (cell) {","      if (cell && (cell.type != Enums.ValueType.Null)) {","        values[cell.col] = cell.value;","      }","    });","    return values;","  },","","  // set the values by contiguous or sparse array, or by key'd object literal","  set values(value) {","    var self = this;","","    // this operation is not additive - any prior cells are removed","    this._cells = [];","    if (!value) {","      // empty row","    } else if (value instanceof Array) {","      var offset = 0;","      if (value.hasOwnProperty('0')) {","        // contiguous array - start at column 1","        offset = 1;","      }","      value.forEach(function (item, index) {","        if (item !== undefined) {","          self._getCell({","            address: colCache.encodeAddress(self._number, index + offset),","            row: self._number,","            col: index + offset","          }).value = item;","        }","      });","    } else {","      // assume object with column keys","      _.each(this._worksheet._keys, function (column, key) {","        if (value[key] !== undefined) {","          self._getCell({","            address: colCache.encodeAddress(self._number, column.number),","            row: self._number,","            col: column.number","          }).value = value[key];","        }","      });","    }","  },","","  // returns true if the row includes at least one cell with a value","  get hasValues() {","    return _.some(this._cells, function (cell) {","      return cell && (cell.type != Enums.ValueType.Null);","    });","  },","","  get cellCount() {","    return this._cells.length;","  },","  get actualCellCount() {","    var count = 0;","    this.eachCell(function() {","      count++;","    });","    return count;","  },","","  // get the min and max column number for the non-null cells in this row or null","  get dimensions() {","    var min = 0;","    var max = 0;","    this._cells.forEach(function (cell) {","      if (cell && (cell.type != Enums.ValueType.Null)) {","        if (!min || (min > cell.col)) {","          min = cell.col;","        }","        if (max < cell.col) {","          max = cell.col;","        }","      }","    });","    return min > 0 ? {","      min: min,","      max: max","    } : null;","  },","","  // =========================================================================","  // styles","  _applyStyle: function (name, value) {","    this.style[name] = value;","    this._cells.forEach(function (cell) {","      if (cell) { cell[name] = value; }","    });","    return value;","  },","","  get numFmt() {","    return this.style.numFmt;","  },","  set numFmt(value) {","    this._applyStyle('numFmt', value);","  },","  get font() {","    return this.style.font;","  },","  set font(value) {","    this._applyStyle('font', value);","  },","  get alignment() {","    return this.style.alignment;","  },","  set alignment(value) {","    this._applyStyle('alignment', value);","  },","  get border() {","    return this.style.border;","  },","  set border(value) {","    this._applyStyle('border', value);","  },","  get fill() {","    return this.style.fill;","  },","  set fill(value) {","    this._applyStyle('fill', value);","  },","","  get hidden() {","    return !!this._hidden;","  },","  set hidden(value) {","    this._hidden = value;","  },","","  get outlineLevel() {","    return this._outlineLevel || 0;","  },","  set outlineLevel(value) {","    this._outlineLevel = value;","  },","  get collapsed() {","    return !!(this._outlineLevel && (this._outlineLevel >= this._worksheet.properties.outlineLevelRow));","  },","","  // =========================================================================","  get model() {","    var cells = [];","    var min = 0;","    var max = 0;","    this._cells.forEach(function (cell) {","      if (cell) {","        var cellModel = cell.model;","        if (cellModel) {","          if (!min || (min > cell.col)) {","            min = cell.col;","          }","          if (max < cell.col) {","            max = cell.col;","          }","          cells.push(cellModel);","        }","      }","    });","","    return (this.height || cells.length) ? {","      cells: cells,","      number: this.number,","      min: min,","      max: max,","      height: this.height,","      style: this.style,","      hidden: this.hidden,","      outlineLevel: this.outlineLevel,","      collapsed: this.collapsed","    } : null;","  },","  set model(value) {","    if (value.number != this._number) {","      throw new Error('Invalid row number in model');","    }","    var self = this;","    this._cells = [];","    value.cells.forEach(function (cellModel) {","      switch (cellModel.type) {","        case Cell.Types.Merge:","          // special case - don't add this types","          break;","        default:","          var cell = self._getCell(colCache.decodeAddress(cellModel.address));","          cell.model = cellModel;","          break;","      }","    });","","    if (value.height) {","      this.height = value.height;","    } else {","      delete this.height;","    }","","    this.hidden = value.hidden;","    this.outlineLevel = value.outlineLevel || 0;","","    this.style = value.style || {};","  }","};"],"l":{"25":1,"27":1,"28":1,"29":1,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"39":1,"42":0,"46":0,"52":0,"57":0,"58":0,"59":0,"63":0,"68":0,"69":0,"70":0,"71":0,"72":0,"74":0,"79":0,"81":0,"82":0,"83":0,"85":0,"88":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"105":0,"106":0,"107":0,"108":0,"109":0,"111":0,"112":0,"113":0,"117":0,"119":0,"120":0,"121":0,"122":0,"124":0,"130":0,"131":0,"137":0,"138":0,"139":0,"141":0,"142":0,"143":0,"144":0,"147":0,"148":0,"149":0,"157":0,"158":0,"159":0,"160":0,"163":0,"168":0,"171":0,"172":0,"174":0,"175":0,"176":0,"178":0,"180":0,"181":0,"182":0,"191":0,"192":0,"193":0,"205":0,"206":0,"211":0,"214":0,"215":0,"216":0,"218":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"230":0,"231":0,"235":0,"244":0,"245":0,"246":0,"248":0,"252":0,"255":0,"258":0,"261":0,"264":0,"267":0,"270":0,"273":0,"276":0,"279":0,"283":0,"286":0,"290":0,"293":0,"296":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":0,"311":0,"312":0,"314":0,"319":0,"332":0,"333":0,"335":0,"336":0,"337":0,"338":0,"341":0,"343":0,"344":0,"345":0,"349":0,"350":0,"352":0,"355":0,"356":0,"358":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/enums.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/enums.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":65,"column":2}}},"branchMap":{},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","\"use strict\";","","module.exports = {","  ValueType: {","    Null: 0,","    Merge: 1,","    Number: 2,","    String: 3,","    Date: 4,","    Hyperlink: 5,","    Formula: 6,","    SharedString: 7,","    RichText: 8,","    Boolean: 9,","    Error: 10,","  },","  RelationshipType: {","    None: 0,","    OfficeDocument: 1,","    Worksheet: 2,","    CalcChain: 3,","    SharedStrings: 4,","    Styles: 5,","    Theme: 6,","    Hyperlink: 7","  },","  DocumentType: {","    Xlsx: 1","  },","  ReadingOrder: {","    RightToLeft: 1,","    LeftToRight: 2","  },","  ErrorValue: {","    NotApplicable: '#N/A',","    Ref: '#REF!',","    Name: '#NAME?',","    DivZero: '#DIV/0!',","    Null: '#NULL!',","    Value: '#VALUE!',","    Num: '#NUM!'","  },","};"],"l":{"25":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/cell.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/cell.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":1,"109":0,"110":1,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":1,"119":0,"120":1,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":1,"130":0,"131":1,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":1,"141":0,"142":1,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":1,"153":0,"154":1,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":1,"164":0,"165":1,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":1,"180":0,"181":0,"182":0,"183":0,"184":1,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":1,"202":0,"203":1,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":1,"237":0,"238":1,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":1,"248":0,"249":1,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":1,"259":0,"260":1,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":1,"270":0,"271":1,"272":0,"273":0,"274":0,"275":0,"276":0,"277":0,"278":0,"279":0,"280":0,"281":1,"282":0,"283":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":0,"290":0,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":12,"304":12,"305":0,"306":0,"307":0,"308":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0,0],"4":[0,0],"5":[0,0,0,0],"6":[0,0],"7":[0,0,0,0],"8":[0,0],"9":[0,0,0,0],"10":[0,0],"11":[0,0,0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0,0,0,0,0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":12,"186":0},"fnMap":{"1":{"name":"(anonymous_1)","line":34,"loc":{"start":{"line":34,"column":28},"end":{"line":34,"column":59}}},"2":{"name":"(anonymous_2)","line":63,"loc":{"start":{"line":63,"column":15},"end":{"line":63,"column":18}}},"3":{"name":"(anonymous_3)","line":66,"loc":{"start":{"line":66,"column":14},"end":{"line":66,"column":17}}},"4":{"name":"(anonymous_4)","line":71,"loc":{"start":{"line":71,"column":11},"end":{"line":71,"column":22}}},"5":{"name":"(anonymous_5)","line":81,"loc":{"start":{"line":81,"column":12},"end":{"line":81,"column":15}}},"6":{"name":"(anonymous_6)","line":84,"loc":{"start":{"line":84,"column":12},"end":{"line":84,"column":20}}},"7":{"name":"(anonymous_7)","line":87,"loc":{"start":{"line":87,"column":10},"end":{"line":87,"column":13}}},"8":{"name":"(anonymous_8)","line":90,"loc":{"start":{"line":90,"column":10},"end":{"line":90,"column":18}}},"9":{"name":"(anonymous_9)","line":93,"loc":{"start":{"line":93,"column":15},"end":{"line":93,"column":18}}},"10":{"name":"(anonymous_10)","line":96,"loc":{"start":{"line":96,"column":15},"end":{"line":96,"column":23}}},"11":{"name":"(anonymous_11)","line":99,"loc":{"start":{"line":99,"column":12},"end":{"line":99,"column":15}}},"12":{"name":"(anonymous_12)","line":102,"loc":{"start":{"line":102,"column":12},"end":{"line":102,"column":20}}},"13":{"name":"(anonymous_13)","line":105,"loc":{"start":{"line":105,"column":10},"end":{"line":105,"column":13}}},"14":{"name":"(anonymous_14)","line":108,"loc":{"start":{"line":108,"column":10},"end":{"line":108,"column":18}}},"15":{"name":"(anonymous_15)","line":112,"loc":{"start":{"line":112,"column":15},"end":{"line":112,"column":51}}},"16":{"name":"(anonymous_16)","line":133,"loc":{"start":{"line":133,"column":13},"end":{"line":133,"column":16}}},"17":{"name":"(anonymous_17)","line":137,"loc":{"start":{"line":137,"column":9},"end":{"line":137,"column":12}}},"18":{"name":"(anonymous_18)","line":140,"loc":{"start":{"line":140,"column":9},"end":{"line":140,"column":12}}},"19":{"name":"(anonymous_19)","line":144,"loc":{"start":{"line":144,"column":14},"end":{"line":144,"column":17}}},"20":{"name":"(anonymous_20)","line":152,"loc":{"start":{"line":152,"column":10},"end":{"line":152,"column":13}}},"21":{"name":"(anonymous_21)","line":156,"loc":{"start":{"line":156,"column":19},"end":{"line":156,"column":22}}},"22":{"name":"(anonymous_22)","line":160,"loc":{"start":{"line":160,"column":15},"end":{"line":160,"column":26}}},"23":{"name":"(anonymous_23)","line":167,"loc":{"start":{"line":167,"column":15},"end":{"line":167,"column":26}}},"24":{"name":"(anonymous_24)","line":170,"loc":{"start":{"line":170,"column":19},"end":{"line":170,"column":30}}},"25":{"name":"(anonymous_25)","line":173,"loc":{"start":{"line":173,"column":14},"end":{"line":173,"column":17}}},"26":{"name":"(anonymous_26)","line":176,"loc":{"start":{"line":176,"column":9},"end":{"line":176,"column":26}}},"27":{"name":"(anonymous_27)","line":181,"loc":{"start":{"line":181,"column":11},"end":{"line":181,"column":22}}},"28":{"name":"(anonymous_28)","line":188,"loc":{"start":{"line":188,"column":14},"end":{"line":188,"column":31}}},"29":{"name":"(anonymous_29)","line":192,"loc":{"start":{"line":192,"column":12},"end":{"line":192,"column":15}}},"30":{"name":"(anonymous_30)","line":197,"loc":{"start":{"line":197,"column":17},"end":{"line":197,"column":20}}},"31":{"name":"(anonymous_31)","line":200,"loc":{"start":{"line":200,"column":15},"end":{"line":200,"column":18}}},"32":{"name":"(anonymous_32)","line":205,"loc":{"start":{"line":205,"column":11},"end":{"line":205,"column":14}}},"33":{"name":"(anonymous_33)","line":209,"loc":{"start":{"line":209,"column":11},"end":{"line":209,"column":15}}},"34":{"name":"(anonymous_34)","line":220,"loc":{"start":{"line":220,"column":10},"end":{"line":220,"column":13}}},"35":{"name":"(anonymous_35)","line":223,"loc":{"start":{"line":223,"column":12},"end":{"line":223,"column":23}}},"36":{"name":"(anonymous_36)","line":227,"loc":{"start":{"line":227,"column":23},"end":{"line":227,"column":43}}},"37":{"name":"(anonymous_37)","line":239,"loc":{"start":{"line":239,"column":17},"end":{"line":239,"column":20}}},"38":{"name":"(anonymous_38)","line":248,"loc":{"start":{"line":248,"column":10},"end":{"line":248,"column":13}}},"39":{"name":"(anonymous_39)","line":251,"loc":{"start":{"line":251,"column":10},"end":{"line":251,"column":18}}},"40":{"name":"(anonymous_40)","line":254,"loc":{"start":{"line":254,"column":11},"end":{"line":254,"column":14}}},"41":{"name":"(anonymous_41)","line":257,"loc":{"start":{"line":257,"column":11},"end":{"line":257,"column":19}}},"42":{"name":"(anonymous_42)","line":261,"loc":{"start":{"line":261,"column":18},"end":{"line":261,"column":33}}},"43":{"name":"(anonymous_43)","line":265,"loc":{"start":{"line":265,"column":11},"end":{"line":265,"column":26}}},"44":{"name":"(anonymous_44)","line":268,"loc":{"start":{"line":268,"column":14},"end":{"line":268,"column":29}}},"45":{"name":"(anonymous_45)","line":271,"loc":{"start":{"line":271,"column":18},"end":{"line":271,"column":29}}},"46":{"name":"(anonymous_46)","line":277,"loc":{"start":{"line":277,"column":22},"end":{"line":277,"column":25}}},"47":{"name":"(anonymous_47)","line":281,"loc":{"start":{"line":281,"column":20},"end":{"line":281,"column":23}}},"48":{"name":"(anonymous_48)","line":285,"loc":{"start":{"line":285,"column":20},"end":{"line":285,"column":28}}},"49":{"name":"(anonymous_49)","line":293,"loc":{"start":{"line":293,"column":11},"end":{"line":293,"column":14}}},"50":{"name":"(anonymous_50)","line":298,"loc":{"start":{"line":298,"column":11},"end":{"line":298,"column":19}}},"51":{"name":"(anonymous_51)","line":313,"loc":{"start":{"line":313,"column":16},"end":{"line":313,"column":31}}},"52":{"name":"(anonymous_52)","line":320,"loc":{"start":{"line":320,"column":11},"end":{"line":320,"column":14}}},"53":{"name":"(anonymous_53)","line":323,"loc":{"start":{"line":323,"column":11},"end":{"line":323,"column":19}}},"54":{"name":"(anonymous_54)","line":325,"loc":{"start":{"line":325,"column":10},"end":{"line":325,"column":13}}},"55":{"name":"(anonymous_55)","line":328,"loc":{"start":{"line":328,"column":19},"end":{"line":328,"column":22}}},"56":{"name":"(anonymous_56)","line":331,"loc":{"start":{"line":331,"column":13},"end":{"line":331,"column":16}}},"57":{"name":"(anonymous_57)","line":334,"loc":{"start":{"line":334,"column":13},"end":{"line":334,"column":21}}},"58":{"name":"(anonymous_58)","line":337,"loc":{"start":{"line":337,"column":15},"end":{"line":337,"column":26}}},"59":{"name":"(anonymous_59)","line":340,"loc":{"start":{"line":340,"column":11},"end":{"line":340,"column":22}}},"60":{"name":"(anonymous_60)","line":342,"loc":{"start":{"line":342,"column":12},"end":{"line":342,"column":23}}},"61":{"name":"(anonymous_61)","line":347,"loc":{"start":{"line":347,"column":18},"end":{"line":347,"column":40}}},"62":{"name":"(anonymous_62)","line":355,"loc":{"start":{"line":355,"column":11},"end":{"line":355,"column":14}}},"63":{"name":"(anonymous_63)","line":358,"loc":{"start":{"line":358,"column":11},"end":{"line":358,"column":19}}},"64":{"name":"(anonymous_64)","line":361,"loc":{"start":{"line":361,"column":10},"end":{"line":361,"column":13}}},"65":{"name":"(anonymous_65)","line":364,"loc":{"start":{"line":364,"column":19},"end":{"line":364,"column":22}}},"66":{"name":"(anonymous_66)","line":367,"loc":{"start":{"line":367,"column":13},"end":{"line":367,"column":16}}},"67":{"name":"(anonymous_67)","line":370,"loc":{"start":{"line":370,"column":13},"end":{"line":370,"column":21}}},"68":{"name":"(anonymous_68)","line":373,"loc":{"start":{"line":373,"column":15},"end":{"line":373,"column":26}}},"69":{"name":"(anonymous_69)","line":376,"loc":{"start":{"line":376,"column":11},"end":{"line":376,"column":22}}},"70":{"name":"(anonymous_70)","line":378,"loc":{"start":{"line":378,"column":12},"end":{"line":378,"column":23}}},"71":{"name":"(anonymous_71)","line":383,"loc":{"start":{"line":383,"column":18},"end":{"line":383,"column":40}}},"72":{"name":"(anonymous_72)","line":391,"loc":{"start":{"line":391,"column":11},"end":{"line":391,"column":14}}},"73":{"name":"(anonymous_73)","line":394,"loc":{"start":{"line":394,"column":11},"end":{"line":394,"column":19}}},"74":{"name":"(anonymous_74)","line":397,"loc":{"start":{"line":397,"column":10},"end":{"line":397,"column":13}}},"75":{"name":"(anonymous_75)","line":400,"loc":{"start":{"line":400,"column":19},"end":{"line":400,"column":22}}},"76":{"name":"(anonymous_76)","line":403,"loc":{"start":{"line":403,"column":13},"end":{"line":403,"column":16}}},"77":{"name":"(anonymous_77)","line":406,"loc":{"start":{"line":406,"column":13},"end":{"line":406,"column":21}}},"78":{"name":"(anonymous_78)","line":409,"loc":{"start":{"line":409,"column":15},"end":{"line":409,"column":26}}},"79":{"name":"(anonymous_79)","line":412,"loc":{"start":{"line":412,"column":11},"end":{"line":412,"column":22}}},"80":{"name":"(anonymous_80)","line":414,"loc":{"start":{"line":414,"column":12},"end":{"line":414,"column":23}}},"81":{"name":"(anonymous_81)","line":419,"loc":{"start":{"line":419,"column":20},"end":{"line":419,"column":42}}},"82":{"name":"(anonymous_82)","line":427,"loc":{"start":{"line":427,"column":11},"end":{"line":427,"column":14}}},"83":{"name":"(anonymous_83)","line":430,"loc":{"start":{"line":430,"column":11},"end":{"line":430,"column":19}}},"84":{"name":"(anonymous_84)","line":433,"loc":{"start":{"line":433,"column":12},"end":{"line":433,"column":23}}},"85":{"name":"(anonymous_85)","line":434,"loc":{"start":{"line":434,"column":41},"end":{"line":434,"column":53}}},"86":{"name":"(anonymous_86)","line":438,"loc":{"start":{"line":438,"column":10},"end":{"line":438,"column":13}}},"87":{"name":"(anonymous_87)","line":441,"loc":{"start":{"line":441,"column":19},"end":{"line":441,"column":22}}},"88":{"name":"(anonymous_88)","line":444,"loc":{"start":{"line":444,"column":13},"end":{"line":444,"column":16}}},"89":{"name":"(anonymous_89)","line":447,"loc":{"start":{"line":447,"column":13},"end":{"line":447,"column":21}}},"90":{"name":"(anonymous_90)","line":450,"loc":{"start":{"line":450,"column":15},"end":{"line":450,"column":26}}},"91":{"name":"(anonymous_91)","line":453,"loc":{"start":{"line":453,"column":11},"end":{"line":453,"column":22}}},"92":{"name":"(anonymous_92)","line":457,"loc":{"start":{"line":457,"column":16},"end":{"line":457,"column":38}}},"93":{"name":"(anonymous_93)","line":465,"loc":{"start":{"line":465,"column":11},"end":{"line":465,"column":14}}},"94":{"name":"(anonymous_94)","line":468,"loc":{"start":{"line":468,"column":11},"end":{"line":468,"column":19}}},"95":{"name":"(anonymous_95)","line":471,"loc":{"start":{"line":471,"column":10},"end":{"line":471,"column":13}}},"96":{"name":"(anonymous_96)","line":474,"loc":{"start":{"line":474,"column":19},"end":{"line":474,"column":22}}},"97":{"name":"(anonymous_97)","line":477,"loc":{"start":{"line":477,"column":13},"end":{"line":477,"column":16}}},"98":{"name":"(anonymous_98)","line":480,"loc":{"start":{"line":480,"column":13},"end":{"line":480,"column":21}}},"99":{"name":"(anonymous_99)","line":483,"loc":{"start":{"line":483,"column":15},"end":{"line":483,"column":26}}},"100":{"name":"(anonymous_100)","line":486,"loc":{"start":{"line":486,"column":11},"end":{"line":486,"column":22}}},"101":{"name":"(anonymous_101)","line":488,"loc":{"start":{"line":488,"column":12},"end":{"line":488,"column":23}}},"102":{"name":"(anonymous_102)","line":493,"loc":{"start":{"line":493,"column":21},"end":{"line":493,"column":43}}},"103":{"name":"(anonymous_103)","line":502,"loc":{"start":{"line":502,"column":11},"end":{"line":502,"column":14}}},"104":{"name":"(anonymous_104)","line":508,"loc":{"start":{"line":508,"column":11},"end":{"line":508,"column":19}}},"105":{"name":"(anonymous_105)","line":513,"loc":{"start":{"line":513,"column":10},"end":{"line":513,"column":13}}},"106":{"name":"(anonymous_106)","line":516,"loc":{"start":{"line":516,"column":10},"end":{"line":516,"column":18}}},"107":{"name":"(anonymous_107)","line":519,"loc":{"start":{"line":519,"column":15},"end":{"line":519,"column":18}}},"108":{"name":"(anonymous_108)","line":522,"loc":{"start":{"line":522,"column":15},"end":{"line":522,"column":23}}},"109":{"name":"(anonymous_109)","line":525,"loc":{"start":{"line":525,"column":10},"end":{"line":525,"column":13}}},"110":{"name":"(anonymous_110)","line":528,"loc":{"start":{"line":528,"column":19},"end":{"line":528,"column":22}}},"111":{"name":"(anonymous_111)","line":531,"loc":{"start":{"line":531,"column":13},"end":{"line":531,"column":16}}},"112":{"name":"(anonymous_112)","line":534,"loc":{"start":{"line":534,"column":13},"end":{"line":534,"column":21}}},"113":{"name":"(anonymous_113)","line":537,"loc":{"start":{"line":537,"column":15},"end":{"line":537,"column":26}}},"114":{"name":"(anonymous_114)","line":540,"loc":{"start":{"line":540,"column":11},"end":{"line":540,"column":22}}},"115":{"name":"(anonymous_115)","line":542,"loc":{"start":{"line":542,"column":12},"end":{"line":542,"column":23}}},"116":{"name":"(anonymous_116)","line":547,"loc":{"start":{"line":547,"column":17},"end":{"line":547,"column":40}}},"117":{"name":"(anonymous_117)","line":559,"loc":{"start":{"line":559,"column":11},"end":{"line":559,"column":14}}},"118":{"name":"(anonymous_118)","line":562,"loc":{"start":{"line":562,"column":11},"end":{"line":562,"column":19}}},"119":{"name":"(anonymous_119)","line":574,"loc":{"start":{"line":574,"column":14},"end":{"line":574,"column":31}}},"120":{"name":"(anonymous_120)","line":577,"loc":{"start":{"line":577,"column":12},"end":{"line":577,"column":15}}},"121":{"name":"(anonymous_121)","line":580,"loc":{"start":{"line":580,"column":10},"end":{"line":580,"column":13}}},"122":{"name":"(anonymous_122)","line":583,"loc":{"start":{"line":583,"column":19},"end":{"line":583,"column":22}}},"123":{"name":"(anonymous_123)","line":586,"loc":{"start":{"line":586,"column":13},"end":{"line":586,"column":16}}},"124":{"name":"(anonymous_124)","line":589,"loc":{"start":{"line":589,"column":13},"end":{"line":589,"column":21}}},"125":{"name":"(anonymous_125)","line":592,"loc":{"start":{"line":592,"column":15},"end":{"line":592,"column":26}}},"126":{"name":"(anonymous_126)","line":595,"loc":{"start":{"line":595,"column":11},"end":{"line":595,"column":22}}},"127":{"name":"(anonymous_127)","line":598,"loc":{"start":{"line":598,"column":12},"end":{"line":598,"column":23}}},"128":{"name":"(anonymous_128)","line":603,"loc":{"start":{"line":603,"column":19},"end":{"line":603,"column":41}}},"129":{"name":"(anonymous_129)","line":612,"loc":{"start":{"line":612,"column":11},"end":{"line":612,"column":14}}},"130":{"name":"(anonymous_130)","line":618,"loc":{"start":{"line":618,"column":11},"end":{"line":618,"column":19}}},"131":{"name":"(anonymous_131)","line":622,"loc":{"start":{"line":622,"column":12},"end":{"line":622,"column":28}}},"132":{"name":"(anonymous_132)","line":635,"loc":{"start":{"line":635,"column":18},"end":{"line":635,"column":21}}},"133":{"name":"(anonymous_133)","line":644,"loc":{"start":{"line":644,"column":13},"end":{"line":644,"column":16}}},"134":{"name":"(anonymous_134)","line":647,"loc":{"start":{"line":647,"column":13},"end":{"line":647,"column":21}}},"135":{"name":"(anonymous_135)","line":650,"loc":{"start":{"line":650,"column":12},"end":{"line":650,"column":15}}},"136":{"name":"(anonymous_136)","line":653,"loc":{"start":{"line":653,"column":12},"end":{"line":653,"column":20}}},"137":{"name":"(anonymous_137)","line":656,"loc":{"start":{"line":656,"column":10},"end":{"line":656,"column":13}}},"138":{"name":"(anonymous_138)","line":659,"loc":{"start":{"line":659,"column":19},"end":{"line":659,"column":22}}},"139":{"name":"(anonymous_139)","line":677,"loc":{"start":{"line":677,"column":13},"end":{"line":677,"column":16}}},"140":{"name":"(anonymous_140)","line":680,"loc":{"start":{"line":680,"column":13},"end":{"line":680,"column":21}}},"141":{"name":"(anonymous_141)","line":683,"loc":{"start":{"line":683,"column":15},"end":{"line":683,"column":26}}},"142":{"name":"(anonymous_142)","line":686,"loc":{"start":{"line":686,"column":11},"end":{"line":686,"column":22}}},"143":{"name":"(anonymous_143)","line":688,"loc":{"start":{"line":688,"column":12},"end":{"line":688,"column":23}}},"144":{"name":"(anonymous_144)","line":693,"loc":{"start":{"line":693,"column":24},"end":{"line":693,"column":46}}},"145":{"name":"(anonymous_145)","line":701,"loc":{"start":{"line":701,"column":11},"end":{"line":701,"column":14}}},"146":{"name":"(anonymous_146)","line":704,"loc":{"start":{"line":704,"column":11},"end":{"line":704,"column":19}}},"147":{"name":"(anonymous_147)","line":707,"loc":{"start":{"line":707,"column":10},"end":{"line":707,"column":13}}},"148":{"name":"(anonymous_148)","line":710,"loc":{"start":{"line":710,"column":19},"end":{"line":710,"column":22}}},"149":{"name":"(anonymous_149)","line":713,"loc":{"start":{"line":713,"column":13},"end":{"line":713,"column":16}}},"150":{"name":"(anonymous_150)","line":716,"loc":{"start":{"line":716,"column":13},"end":{"line":716,"column":21}}},"151":{"name":"(anonymous_151)","line":719,"loc":{"start":{"line":719,"column":15},"end":{"line":719,"column":26}}},"152":{"name":"(anonymous_152)","line":722,"loc":{"start":{"line":722,"column":11},"end":{"line":722,"column":22}}},"153":{"name":"(anonymous_153)","line":724,"loc":{"start":{"line":724,"column":12},"end":{"line":724,"column":23}}},"154":{"name":"(anonymous_154)","line":729,"loc":{"start":{"line":729,"column":19},"end":{"line":729,"column":41}}},"155":{"name":"(anonymous_155)","line":737,"loc":{"start":{"line":737,"column":11},"end":{"line":737,"column":14}}},"156":{"name":"(anonymous_156)","line":740,"loc":{"start":{"line":740,"column":11},"end":{"line":740,"column":19}}},"157":{"name":"(anonymous_157)","line":743,"loc":{"start":{"line":743,"column":10},"end":{"line":743,"column":13}}},"158":{"name":"(anonymous_158)","line":746,"loc":{"start":{"line":746,"column":19},"end":{"line":746,"column":22}}},"159":{"name":"(anonymous_159)","line":749,"loc":{"start":{"line":749,"column":13},"end":{"line":749,"column":16}}},"160":{"name":"(anonymous_160)","line":752,"loc":{"start":{"line":752,"column":13},"end":{"line":752,"column":21}}},"161":{"name":"(anonymous_161)","line":755,"loc":{"start":{"line":755,"column":15},"end":{"line":755,"column":26}}},"162":{"name":"(anonymous_162)","line":758,"loc":{"start":{"line":758,"column":11},"end":{"line":758,"column":22}}},"163":{"name":"(anonymous_163)","line":760,"loc":{"start":{"line":760,"column":12},"end":{"line":760,"column":23}}},"164":{"name":"(anonymous_164)","line":765,"loc":{"start":{"line":765,"column":17},"end":{"line":765,"column":39}}},"165":{"name":"(anonymous_165)","line":773,"loc":{"start":{"line":773,"column":11},"end":{"line":773,"column":14}}},"166":{"name":"(anonymous_166)","line":776,"loc":{"start":{"line":776,"column":11},"end":{"line":776,"column":19}}},"167":{"name":"(anonymous_167)","line":779,"loc":{"start":{"line":779,"column":10},"end":{"line":779,"column":13}}},"168":{"name":"(anonymous_168)","line":782,"loc":{"start":{"line":782,"column":19},"end":{"line":782,"column":22}}},"169":{"name":"(anonymous_169)","line":785,"loc":{"start":{"line":785,"column":13},"end":{"line":785,"column":16}}},"170":{"name":"(anonymous_170)","line":788,"loc":{"start":{"line":788,"column":13},"end":{"line":788,"column":21}}},"171":{"name":"(anonymous_171)","line":791,"loc":{"start":{"line":791,"column":15},"end":{"line":791,"column":26}}},"172":{"name":"(anonymous_172)","line":794,"loc":{"start":{"line":794,"column":11},"end":{"line":794,"column":22}}},"173":{"name":"(anonymous_173)","line":796,"loc":{"start":{"line":796,"column":12},"end":{"line":796,"column":23}}},"174":{"name":"(anonymous_174)","line":801,"loc":{"start":{"line":801,"column":16},"end":{"line":801,"column":38}}},"175":{"name":"(anonymous_175)","line":810,"loc":{"start":{"line":810,"column":11},"end":{"line":810,"column":14}}},"176":{"name":"(anonymous_176)","line":813,"loc":{"start":{"line":813,"column":11},"end":{"line":813,"column":19}}},"177":{"name":"(anonymous_177)","line":817,"loc":{"start":{"line":817,"column":10},"end":{"line":817,"column":13}}},"178":{"name":"(anonymous_178)","line":820,"loc":{"start":{"line":820,"column":19},"end":{"line":820,"column":22}}},"179":{"name":"(anonymous_179)","line":823,"loc":{"start":{"line":823,"column":13},"end":{"line":823,"column":16}}},"180":{"name":"(anonymous_180)","line":826,"loc":{"start":{"line":826,"column":13},"end":{"line":826,"column":21}}},"181":{"name":"(anonymous_181)","line":829,"loc":{"start":{"line":829,"column":15},"end":{"line":829,"column":26}}},"182":{"name":"(anonymous_182)","line":832,"loc":{"start":{"line":832,"column":11},"end":{"line":832,"column":22}}},"183":{"name":"(anonymous_183)","line":834,"loc":{"start":{"line":834,"column":12},"end":{"line":834,"column":23}}},"184":{"name":"(anonymous_184)","line":841,"loc":{"start":{"line":841,"column":12},"end":{"line":841,"column":28}}},"185":{"name":"(anonymous_185)","line":883,"loc":{"start":{"line":883,"column":11},"end":{"line":883,"column":24}}},"186":{"name":"(anonymous_186)","line":885,"loc":{"start":{"line":885,"column":10},"end":{"line":885,"column":38}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":47}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":40}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":31}},"4":{"start":{"line":34,"column":0},"end":{"line":57,"column":2}},"5":{"start":{"line":35,"column":2},"end":{"line":37,"column":3}},"6":{"start":{"line":36,"column":4},"end":{"line":36,"column":42}},"7":{"start":{"line":46,"column":2},"end":{"line":46,"column":18}},"8":{"start":{"line":47,"column":2},"end":{"line":47,"column":24}},"9":{"start":{"line":49,"column":2},"end":{"line":49,"column":36}},"10":{"start":{"line":50,"column":2},"end":{"line":50,"column":26}},"11":{"start":{"line":52,"column":2},"end":{"line":52,"column":52}},"12":{"start":{"line":54,"column":2},"end":{"line":54,"column":61}},"13":{"start":{"line":56,"column":2},"end":{"line":56,"column":23}},"14":{"start":{"line":59,"column":0},"end":{"line":59,"column":29}},"15":{"start":{"line":61,"column":0},"end":{"line":308,"column":2}},"16":{"start":{"line":64,"column":4},"end":{"line":64,"column":31}},"17":{"start":{"line":67,"column":4},"end":{"line":67,"column":40}},"18":{"start":{"line":72,"column":4},"end":{"line":72,"column":22}},"19":{"start":{"line":73,"column":4},"end":{"line":73,"column":23}},"20":{"start":{"line":74,"column":4},"end":{"line":74,"column":21}},"21":{"start":{"line":75,"column":4},"end":{"line":75,"column":24}},"22":{"start":{"line":76,"column":4},"end":{"line":76,"column":25}},"23":{"start":{"line":82,"column":4},"end":{"line":82,"column":29}},"24":{"start":{"line":85,"column":4},"end":{"line":85,"column":30}},"25":{"start":{"line":88,"column":4},"end":{"line":88,"column":27}},"26":{"start":{"line":91,"column":4},"end":{"line":91,"column":28}},"27":{"start":{"line":94,"column":4},"end":{"line":94,"column":32}},"28":{"start":{"line":97,"column":4},"end":{"line":97,"column":33}},"29":{"start":{"line":100,"column":4},"end":{"line":100,"column":29}},"30":{"start":{"line":103,"column":4},"end":{"line":103,"column":30}},"31":{"start":{"line":106,"column":4},"end":{"line":106,"column":27}},"32":{"start":{"line":109,"column":4},"end":{"line":109,"column":28}},"33":{"start":{"line":113,"column":4},"end":{"line":113,"column":76}},"34":{"start":{"line":114,"column":4},"end":{"line":114,"column":38}},"35":{"start":{"line":114,"column":16},"end":{"line":114,"column":38}},"36":{"start":{"line":116,"column":4},"end":{"line":116,"column":70}},"37":{"start":{"line":117,"column":4},"end":{"line":117,"column":32}},"38":{"start":{"line":117,"column":14},"end":{"line":117,"column":32}},"39":{"start":{"line":119,"column":4},"end":{"line":119,"column":85}},"40":{"start":{"line":120,"column":4},"end":{"line":120,"column":47}},"41":{"start":{"line":120,"column":19},"end":{"line":120,"column":47}},"42":{"start":{"line":122,"column":4},"end":{"line":122,"column":76}},"43":{"start":{"line":123,"column":4},"end":{"line":123,"column":38}},"44":{"start":{"line":123,"column":16},"end":{"line":123,"column":38}},"45":{"start":{"line":125,"column":4},"end":{"line":125,"column":70}},"46":{"start":{"line":126,"column":4},"end":{"line":126,"column":32}},"47":{"start":{"line":126,"column":14},"end":{"line":126,"column":32}},"48":{"start":{"line":128,"column":4},"end":{"line":128,"column":17}},"49":{"start":{"line":134,"column":4},"end":{"line":134,"column":25}},"50":{"start":{"line":138,"column":4},"end":{"line":138,"column":28}},"51":{"start":{"line":141,"column":4},"end":{"line":141,"column":31}},"52":{"start":{"line":145,"column":4},"end":{"line":145,"column":54}},"53":{"start":{"line":153,"column":4},"end":{"line":153,"column":28}},"54":{"start":{"line":157,"column":4},"end":{"line":157,"column":37}},"55":{"start":{"line":161,"column":4},"end":{"line":161,"column":37}},"56":{"start":{"line":168,"column":4},"end":{"line":168,"column":23}},"57":{"start":{"line":171,"column":4},"end":{"line":171,"column":23}},"58":{"start":{"line":174,"column":4},"end":{"line":174,"column":69}},"59":{"start":{"line":177,"column":4},"end":{"line":177,"column":26}},"60":{"start":{"line":178,"column":4},"end":{"line":178,"column":63}},"61":{"start":{"line":179,"column":4},"end":{"line":179,"column":30}},"62":{"start":{"line":182,"column":4},"end":{"line":186,"column":5}},"63":{"start":{"line":183,"column":6},"end":{"line":183,"column":28}},"64":{"start":{"line":184,"column":6},"end":{"line":184,"column":56}},"65":{"start":{"line":185,"column":6},"end":{"line":185,"column":77}},"66":{"start":{"line":189,"column":4},"end":{"line":189,"column":59}},"67":{"start":{"line":189,"column":46},"end":{"line":189,"column":59}},"68":{"start":{"line":190,"column":4},"end":{"line":190,"column":42}},"69":{"start":{"line":193,"column":4},"end":{"line":194,"column":21}},"70":{"start":{"line":193,"column":40},"end":{"line":193,"column":66}},"71":{"start":{"line":194,"column":9},"end":{"line":194,"column":21}},"72":{"start":{"line":198,"column":4},"end":{"line":198,"column":52}},"73":{"start":{"line":201,"column":4},"end":{"line":201,"column":33}},"74":{"start":{"line":206,"column":4},"end":{"line":206,"column":29}},"75":{"start":{"line":211,"column":4},"end":{"line":213,"column":5}},"76":{"start":{"line":212,"column":6},"end":{"line":212,"column":42}},"77":{"start":{"line":215,"column":4},"end":{"line":215,"column":26}},"78":{"start":{"line":218,"column":4},"end":{"line":218,"column":58}},"79":{"start":{"line":221,"column":4},"end":{"line":221,"column":34}},"80":{"start":{"line":224,"column":4},"end":{"line":224,"column":21}},"81":{"start":{"line":229,"column":4},"end":{"line":234,"column":5}},"82":{"start":{"line":230,"column":6},"end":{"line":233,"column":9}},"83":{"start":{"line":240,"column":4},"end":{"line":240,"column":40}},"84":{"start":{"line":241,"column":4},"end":{"line":246,"column":6}},"85":{"start":{"line":249,"column":4},"end":{"line":249,"column":25}},"86":{"start":{"line":252,"column":4},"end":{"line":252,"column":25}},"87":{"start":{"line":255,"column":4},"end":{"line":255,"column":67}},"88":{"start":{"line":258,"column":4},"end":{"line":258,"column":20}},"89":{"start":{"line":259,"column":4},"end":{"line":259,"column":50}},"90":{"start":{"line":260,"column":4},"end":{"line":260,"column":64}},"91":{"start":{"line":261,"column":4},"end":{"line":263,"column":7}},"92":{"start":{"line":262,"column":6},"end":{"line":262,"column":49}},"93":{"start":{"line":266,"column":4},"end":{"line":266,"column":61}},"94":{"start":{"line":269,"column":4},"end":{"line":269,"column":64}},"95":{"start":{"line":272,"column":4},"end":{"line":272,"column":64}},"96":{"start":{"line":278,"column":4},"end":{"line":278,"column":42}},"97":{"start":{"line":282,"column":4},"end":{"line":282,"column":51}},"98":{"start":{"line":286,"column":4},"end":{"line":286,"column":51}},"99":{"start":{"line":294,"column":4},"end":{"line":294,"column":34}},"100":{"start":{"line":295,"column":4},"end":{"line":295,"column":29}},"101":{"start":{"line":296,"column":4},"end":{"line":296,"column":17}},"102":{"start":{"line":299,"column":4},"end":{"line":299,"column":26}},"103":{"start":{"line":300,"column":4},"end":{"line":300,"column":49}},"104":{"start":{"line":301,"column":4},"end":{"line":301,"column":30}},"105":{"start":{"line":302,"column":4},"end":{"line":306,"column":5}},"106":{"start":{"line":303,"column":6},"end":{"line":303,"column":31}},"107":{"start":{"line":305,"column":6},"end":{"line":305,"column":22}},"108":{"start":{"line":313,"column":0},"end":{"line":318,"column":2}},"109":{"start":{"line":314,"column":2},"end":{"line":317,"column":4}},"110":{"start":{"line":319,"column":0},"end":{"line":345,"column":2}},"111":{"start":{"line":321,"column":4},"end":{"line":321,"column":16}},"112":{"start":{"line":326,"column":4},"end":{"line":326,"column":27}},"113":{"start":{"line":329,"column":4},"end":{"line":329,"column":27}},"114":{"start":{"line":332,"column":4},"end":{"line":332,"column":30}},"115":{"start":{"line":335,"column":4},"end":{"line":335,"column":31}},"116":{"start":{"line":338,"column":4},"end":{"line":338,"column":14}},"117":{"start":{"line":343,"column":4},"end":{"line":343,"column":14}},"118":{"start":{"line":347,"column":0},"end":{"line":353,"column":2}},"119":{"start":{"line":348,"column":2},"end":{"line":352,"column":4}},"120":{"start":{"line":354,"column":0},"end":{"line":381,"column":2}},"121":{"start":{"line":356,"column":4},"end":{"line":356,"column":28}},"122":{"start":{"line":359,"column":4},"end":{"line":359,"column":29}},"123":{"start":{"line":362,"column":4},"end":{"line":362,"column":29}},"124":{"start":{"line":365,"column":4},"end":{"line":365,"column":29}},"125":{"start":{"line":368,"column":4},"end":{"line":368,"column":30}},"126":{"start":{"line":371,"column":4},"end":{"line":371,"column":31}},"127":{"start":{"line":374,"column":4},"end":{"line":374,"column":33}},"128":{"start":{"line":379,"column":4},"end":{"line":379,"column":39}},"129":{"start":{"line":383,"column":0},"end":{"line":389,"column":2}},"130":{"start":{"line":384,"column":2},"end":{"line":388,"column":4}},"131":{"start":{"line":390,"column":0},"end":{"line":417,"column":2}},"132":{"start":{"line":392,"column":4},"end":{"line":392,"column":28}},"133":{"start":{"line":395,"column":4},"end":{"line":395,"column":29}},"134":{"start":{"line":398,"column":4},"end":{"line":398,"column":29}},"135":{"start":{"line":401,"column":4},"end":{"line":401,"column":29}},"136":{"start":{"line":404,"column":4},"end":{"line":404,"column":30}},"137":{"start":{"line":407,"column":4},"end":{"line":407,"column":31}},"138":{"start":{"line":410,"column":4},"end":{"line":410,"column":60}},"139":{"start":{"line":415,"column":4},"end":{"line":415,"column":28}},"140":{"start":{"line":419,"column":0},"end":{"line":425,"column":2}},"141":{"start":{"line":420,"column":2},"end":{"line":424,"column":4}},"142":{"start":{"line":426,"column":0},"end":{"line":455,"column":2}},"143":{"start":{"line":428,"column":4},"end":{"line":428,"column":28}},"144":{"start":{"line":431,"column":4},"end":{"line":431,"column":29}},"145":{"start":{"line":434,"column":4},"end":{"line":436,"column":16}},"146":{"start":{"line":435,"column":6},"end":{"line":435,"column":20}},"147":{"start":{"line":439,"column":4},"end":{"line":439,"column":31}},"148":{"start":{"line":442,"column":4},"end":{"line":442,"column":31}},"149":{"start":{"line":445,"column":4},"end":{"line":445,"column":30}},"150":{"start":{"line":448,"column":4},"end":{"line":448,"column":31}},"151":{"start":{"line":451,"column":4},"end":{"line":451,"column":53}},"152":{"start":{"line":457,"column":0},"end":{"line":463,"column":2}},"153":{"start":{"line":458,"column":2},"end":{"line":462,"column":4}},"154":{"start":{"line":464,"column":0},"end":{"line":491,"column":2}},"155":{"start":{"line":466,"column":4},"end":{"line":466,"column":28}},"156":{"start":{"line":469,"column":4},"end":{"line":469,"column":29}},"157":{"start":{"line":472,"column":4},"end":{"line":472,"column":27}},"158":{"start":{"line":475,"column":4},"end":{"line":475,"column":27}},"159":{"start":{"line":478,"column":4},"end":{"line":478,"column":30}},"160":{"start":{"line":481,"column":4},"end":{"line":481,"column":31}},"161":{"start":{"line":484,"column":4},"end":{"line":484,"column":42}},"162":{"start":{"line":489,"column":4},"end":{"line":489,"column":39}},"163":{"start":{"line":493,"column":0},"end":{"line":500,"column":2}},"164":{"start":{"line":494,"column":2},"end":{"line":499,"column":4}},"165":{"start":{"line":501,"column":0},"end":{"line":545,"column":2}},"166":{"start":{"line":503,"column":4},"end":{"line":506,"column":6}},"167":{"start":{"line":509,"column":4},"end":{"line":509,"column":33}},"168":{"start":{"line":510,"column":4},"end":{"line":510,"column":43}},"169":{"start":{"line":514,"column":4},"end":{"line":514,"column":27}},"170":{"start":{"line":517,"column":4},"end":{"line":517,"column":28}},"171":{"start":{"line":520,"column":4},"end":{"line":520,"column":32}},"172":{"start":{"line":523,"column":4},"end":{"line":523,"column":33}},"173":{"start":{"line":526,"column":4},"end":{"line":526,"column":32}},"174":{"start":{"line":529,"column":4},"end":{"line":529,"column":32}},"175":{"start":{"line":532,"column":4},"end":{"line":532,"column":30}},"176":{"start":{"line":535,"column":4},"end":{"line":535,"column":31}},"177":{"start":{"line":538,"column":4},"end":{"line":538,"column":32}},"178":{"start":{"line":543,"column":4},"end":{"line":543,"column":27}},"179":{"start":{"line":547,"column":0},"end":{"line":557,"column":2}},"180":{"start":{"line":548,"column":2},"end":{"line":552,"column":4}},"181":{"start":{"line":553,"column":2},"end":{"line":553,"column":24}},"182":{"start":{"line":554,"column":2},"end":{"line":556,"column":3}},"183":{"start":{"line":555,"column":4},"end":{"line":555,"column":25}},"184":{"start":{"line":558,"column":0},"end":{"line":601,"column":2}},"185":{"start":{"line":560,"column":4},"end":{"line":560,"column":30}},"186":{"start":{"line":563,"column":4},"end":{"line":571,"column":5}},"187":{"start":{"line":564,"column":6},"end":{"line":566,"column":7}},"188":{"start":{"line":565,"column":8},"end":{"line":565,"column":39}},"189":{"start":{"line":567,"column":6},"end":{"line":567,"column":26}},"190":{"start":{"line":568,"column":6},"end":{"line":568,"column":27}},"191":{"start":{"line":570,"column":6},"end":{"line":570,"column":33}},"192":{"start":{"line":575,"column":4},"end":{"line":575,"column":35}},"193":{"start":{"line":578,"column":4},"end":{"line":578,"column":24}},"194":{"start":{"line":581,"column":4},"end":{"line":581,"column":28}},"195":{"start":{"line":584,"column":4},"end":{"line":584,"column":38}},"196":{"start":{"line":587,"column":4},"end":{"line":587,"column":30}},"197":{"start":{"line":590,"column":4},"end":{"line":590,"column":31}},"198":{"start":{"line":593,"column":4},"end":{"line":593,"column":14}},"199":{"start":{"line":596,"column":4},"end":{"line":596,"column":35}},"200":{"start":{"line":599,"column":4},"end":{"line":599,"column":33}},"201":{"start":{"line":603,"column":0},"end":{"line":610,"column":2}},"202":{"start":{"line":604,"column":2},"end":{"line":609,"column":4}},"203":{"start":{"line":611,"column":0},"end":{"line":691,"column":2}},"204":{"start":{"line":613,"column":4},"end":{"line":616,"column":6}},"205":{"start":{"line":619,"column":4},"end":{"line":619,"column":39}},"206":{"start":{"line":620,"column":4},"end":{"line":620,"column":37}},"207":{"start":{"line":623,"column":4},"end":{"line":633,"column":5}},"208":{"start":{"line":628,"column":8},"end":{"line":628,"column":14}},"209":{"start":{"line":632,"column":8},"end":{"line":632,"column":68}},"210":{"start":{"line":636,"column":4},"end":{"line":636,"column":92}},"211":{"start":{"line":637,"column":4},"end":{"line":638,"column":51}},"212":{"start":{"line":639,"column":4},"end":{"line":642,"column":6}},"213":{"start":{"line":645,"column":4},"end":{"line":645,"column":30}},"214":{"start":{"line":648,"column":4},"end":{"line":648,"column":31}},"215":{"start":{"line":651,"column":4},"end":{"line":651,"column":29}},"216":{"start":{"line":654,"column":4},"end":{"line":654,"column":30}},"217":{"start":{"line":657,"column":4},"end":{"line":657,"column":30}},"218":{"start":{"line":660,"column":4},"end":{"line":660,"column":30}},"219":{"start":{"line":661,"column":4},"end":{"line":675,"column":5}},"220":{"start":{"line":662,"column":6},"end":{"line":662,"column":34}},"221":{"start":{"line":663,"column":11},"end":{"line":675,"column":5}},"222":{"start":{"line":664,"column":6},"end":{"line":664,"column":36}},"223":{"start":{"line":665,"column":11},"end":{"line":675,"column":5}},"224":{"start":{"line":666,"column":6},"end":{"line":666,"column":36}},"225":{"start":{"line":667,"column":11},"end":{"line":675,"column":5}},"226":{"start":{"line":668,"column":6},"end":{"line":668,"column":34}},"227":{"start":{"line":669,"column":11},"end":{"line":675,"column":5}},"228":{"start":{"line":670,"column":6},"end":{"line":670,"column":39}},"229":{"start":{"line":671,"column":11},"end":{"line":675,"column":5}},"230":{"start":{"line":672,"column":6},"end":{"line":672,"column":37}},"231":{"start":{"line":674,"column":6},"end":{"line":674,"column":34}},"232":{"start":{"line":678,"column":4},"end":{"line":678,"column":30}},"233":{"start":{"line":681,"column":4},"end":{"line":681,"column":31}},"234":{"start":{"line":684,"column":4},"end":{"line":684,"column":42}},"235":{"start":{"line":689,"column":4},"end":{"line":689,"column":65}},"236":{"start":{"line":693,"column":0},"end":{"line":699,"column":2}},"237":{"start":{"line":694,"column":2},"end":{"line":698,"column":4}},"238":{"start":{"line":700,"column":0},"end":{"line":727,"column":2}},"239":{"start":{"line":702,"column":4},"end":{"line":702,"column":28}},"240":{"start":{"line":705,"column":4},"end":{"line":705,"column":29}},"241":{"start":{"line":708,"column":4},"end":{"line":708,"column":35}},"242":{"start":{"line":711,"column":4},"end":{"line":711,"column":35}},"243":{"start":{"line":714,"column":4},"end":{"line":714,"column":30}},"244":{"start":{"line":717,"column":4},"end":{"line":717,"column":31}},"245":{"start":{"line":720,"column":4},"end":{"line":720,"column":33}},"246":{"start":{"line":725,"column":4},"end":{"line":725,"column":39}},"247":{"start":{"line":729,"column":0},"end":{"line":735,"column":2}},"248":{"start":{"line":730,"column":2},"end":{"line":734,"column":4}},"249":{"start":{"line":736,"column":0},"end":{"line":763,"column":2}},"250":{"start":{"line":738,"column":4},"end":{"line":738,"column":28}},"251":{"start":{"line":741,"column":4},"end":{"line":741,"column":29}},"252":{"start":{"line":744,"column":4},"end":{"line":744,"column":30}},"253":{"start":{"line":747,"column":4},"end":{"line":747,"column":30}},"254":{"start":{"line":750,"column":4},"end":{"line":750,"column":30}},"255":{"start":{"line":753,"column":4},"end":{"line":753,"column":31}},"256":{"start":{"line":756,"column":4},"end":{"line":756,"column":36}},"257":{"start":{"line":761,"column":4},"end":{"line":761,"column":39}},"258":{"start":{"line":765,"column":0},"end":{"line":771,"column":2}},"259":{"start":{"line":766,"column":2},"end":{"line":770,"column":4}},"260":{"start":{"line":772,"column":0},"end":{"line":799,"column":2}},"261":{"start":{"line":774,"column":4},"end":{"line":774,"column":28}},"262":{"start":{"line":777,"column":4},"end":{"line":777,"column":29}},"263":{"start":{"line":780,"column":4},"end":{"line":780,"column":28}},"264":{"start":{"line":783,"column":4},"end":{"line":783,"column":28}},"265":{"start":{"line":786,"column":4},"end":{"line":786,"column":30}},"266":{"start":{"line":789,"column":4},"end":{"line":789,"column":31}},"267":{"start":{"line":792,"column":4},"end":{"line":792,"column":27}},"268":{"start":{"line":797,"column":4},"end":{"line":797,"column":45}},"269":{"start":{"line":801,"column":0},"end":{"line":808,"column":2}},"270":{"start":{"line":802,"column":2},"end":{"line":807,"column":4}},"271":{"start":{"line":809,"column":0},"end":{"line":837,"column":2}},"272":{"start":{"line":811,"column":4},"end":{"line":811,"column":31}},"273":{"start":{"line":814,"column":4},"end":{"line":814,"column":32}},"274":{"start":{"line":815,"column":4},"end":{"line":815,"column":45}},"275":{"start":{"line":818,"column":4},"end":{"line":818,"column":29}},"276":{"start":{"line":821,"column":4},"end":{"line":821,"column":29}},"277":{"start":{"line":824,"column":4},"end":{"line":824,"column":30}},"278":{"start":{"line":827,"column":4},"end":{"line":827,"column":31}},"279":{"start":{"line":830,"column":4},"end":{"line":830,"column":28}},"280":{"start":{"line":835,"column":4},"end":{"line":835,"column":28}},"281":{"start":{"line":840,"column":0},"end":{"line":892,"column":2}},"282":{"start":{"line":842,"column":4},"end":{"line":866,"column":5}},"283":{"start":{"line":843,"column":6},"end":{"line":843,"column":29}},"284":{"start":{"line":844,"column":11},"end":{"line":866,"column":5}},"285":{"start":{"line":845,"column":6},"end":{"line":845,"column":31}},"286":{"start":{"line":846,"column":11},"end":{"line":866,"column":5}},"287":{"start":{"line":847,"column":6},"end":{"line":847,"column":31}},"288":{"start":{"line":848,"column":11},"end":{"line":866,"column":5}},"289":{"start":{"line":849,"column":6},"end":{"line":849,"column":32}},"290":{"start":{"line":850,"column":11},"end":{"line":866,"column":5}},"291":{"start":{"line":851,"column":6},"end":{"line":851,"column":29}},"292":{"start":{"line":852,"column":11},"end":{"line":866,"column":5}},"293":{"start":{"line":853,"column":6},"end":{"line":853,"column":34}},"294":{"start":{"line":854,"column":11},"end":{"line":866,"column":5}},"295":{"start":{"line":855,"column":6},"end":{"line":855,"column":32}},"296":{"start":{"line":856,"column":11},"end":{"line":866,"column":5}},"297":{"start":{"line":857,"column":6},"end":{"line":857,"column":33}},"298":{"start":{"line":858,"column":11},"end":{"line":866,"column":5}},"299":{"start":{"line":859,"column":6},"end":{"line":859,"column":37}},"300":{"start":{"line":860,"column":11},"end":{"line":866,"column":5}},"301":{"start":{"line":861,"column":6},"end":{"line":861,"column":30}},"302":{"start":{"line":863,"column":6},"end":{"line":863,"column":29}},"303":{"start":{"line":883,"column":25},"end":{"line":883,"column":36}},"304":{"start":{"line":883,"column":37},"end":{"line":883,"column":46}},"305":{"start":{"line":886,"column":4},"end":{"line":886,"column":29}},"306":{"start":{"line":887,"column":4},"end":{"line":889,"column":5}},"307":{"start":{"line":888,"column":6},"end":{"line":888,"column":64}},"308":{"start":{"line":890,"column":4},"end":{"line":890,"column":30}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":2},"end":{"line":35,"column":2}},{"start":{"line":35,"column":2},"end":{"line":35,"column":2}}]},"2":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":6},"end":{"line":35,"column":10}},{"start":{"line":35,"column":14},"end":{"line":35,"column":21}}]},"3":{"line":113,"type":"binary-expr","locations":[{"start":{"line":113,"column":17},"end":{"line":113,"column":25}},{"start":{"line":113,"column":29},"end":{"line":113,"column":44}},{"start":{"line":113,"column":48},"end":{"line":113,"column":56}},{"start":{"line":113,"column":60},"end":{"line":113,"column":75}}]},"4":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":4},"end":{"line":114,"column":4}},{"start":{"line":114,"column":4},"end":{"line":114,"column":4}}]},"5":{"line":116,"type":"binary-expr","locations":[{"start":{"line":116,"column":15},"end":{"line":116,"column":23}},{"start":{"line":116,"column":27},"end":{"line":116,"column":40}},{"start":{"line":116,"column":44},"end":{"line":116,"column":52}},{"start":{"line":116,"column":56},"end":{"line":116,"column":69}}]},"6":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":117,"column":4}},{"start":{"line":117,"column":4},"end":{"line":117,"column":4}}]},"7":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":20},"end":{"line":119,"column":28}},{"start":{"line":119,"column":32},"end":{"line":119,"column":50}},{"start":{"line":119,"column":54},"end":{"line":119,"column":62}},{"start":{"line":119,"column":66},"end":{"line":119,"column":84}}]},"8":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":4},"end":{"line":120,"column":4}},{"start":{"line":120,"column":4},"end":{"line":120,"column":4}}]},"9":{"line":122,"type":"binary-expr","locations":[{"start":{"line":122,"column":17},"end":{"line":122,"column":25}},{"start":{"line":122,"column":29},"end":{"line":122,"column":44}},{"start":{"line":122,"column":48},"end":{"line":122,"column":56}},{"start":{"line":122,"column":60},"end":{"line":122,"column":75}}]},"10":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":4}},{"start":{"line":123,"column":4},"end":{"line":123,"column":4}}]},"11":{"line":125,"type":"binary-expr","locations":[{"start":{"line":125,"column":15},"end":{"line":125,"column":23}},{"start":{"line":125,"column":27},"end":{"line":125,"column":40}},{"start":{"line":125,"column":44},"end":{"line":125,"column":52}},{"start":{"line":125,"column":56},"end":{"line":125,"column":69}}]},"12":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":4},"end":{"line":126,"column":4}},{"start":{"line":126,"column":4},"end":{"line":126,"column":4}}]},"13":{"line":174,"type":"binary-expr","locations":[{"start":{"line":174,"column":12},"end":{"line":174,"column":32}},{"start":{"line":174,"column":38},"end":{"line":174,"column":67}}]},"14":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":4},"end":{"line":182,"column":4}},{"start":{"line":182,"column":4},"end":{"line":182,"column":4}}]},"15":{"line":189,"type":"if","locations":[{"start":{"line":189,"column":4},"end":{"line":189,"column":4}},{"start":{"line":189,"column":4},"end":{"line":189,"column":4}}]},"16":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":4},"end":{"line":193,"column":4}},{"start":{"line":193,"column":4},"end":{"line":193,"column":4}}]},"17":{"line":211,"type":"if","locations":[{"start":{"line":211,"column":4},"end":{"line":211,"column":4}},{"start":{"line":211,"column":4},"end":{"line":211,"column":4}}]},"18":{"line":229,"type":"if","locations":[{"start":{"line":229,"column":4},"end":{"line":229,"column":4}},{"start":{"line":229,"column":4},"end":{"line":229,"column":4}}]},"19":{"line":302,"type":"if","locations":[{"start":{"line":302,"column":4},"end":{"line":302,"column":4}},{"start":{"line":302,"column":4},"end":{"line":302,"column":4}}]},"20":{"line":497,"type":"cond-expr","locations":[{"start":{"line":497,"column":18},"end":{"line":497,"column":28}},{"start":{"line":497,"column":31},"end":{"line":497,"column":40}}]},"21":{"line":498,"type":"cond-expr","locations":[{"start":{"line":498,"column":23},"end":{"line":498,"column":38}},{"start":{"line":498,"column":41},"end":{"line":498,"column":50}}]},"22":{"line":551,"type":"cond-expr","locations":[{"start":{"line":551,"column":21},"end":{"line":551,"column":35}},{"start":{"line":551,"column":38},"end":{"line":551,"column":47}}]},"23":{"line":554,"type":"if","locations":[{"start":{"line":554,"column":2},"end":{"line":554,"column":2}},{"start":{"line":554,"column":2},"end":{"line":554,"column":2}}]},"24":{"line":563,"type":"if","locations":[{"start":{"line":563,"column":4},"end":{"line":563,"column":4}},{"start":{"line":563,"column":4},"end":{"line":563,"column":4}}]},"25":{"line":564,"type":"if","locations":[{"start":{"line":564,"column":6},"end":{"line":564,"column":6}},{"start":{"line":564,"column":6},"end":{"line":564,"column":6}}]},"26":{"line":607,"type":"cond-expr","locations":[{"start":{"line":607,"column":21},"end":{"line":607,"column":34}},{"start":{"line":607,"column":37},"end":{"line":607,"column":46}}]},"27":{"line":608,"type":"cond-expr","locations":[{"start":{"line":608,"column":20},"end":{"line":608,"column":32}},{"start":{"line":608,"column":35},"end":{"line":608,"column":44}}]},"28":{"line":623,"type":"switch","locations":[{"start":{"line":624,"column":6},"end":{"line":624,"column":27}},{"start":{"line":625,"column":6},"end":{"line":625,"column":29}},{"start":{"line":626,"column":6},"end":{"line":626,"column":29}},{"start":{"line":627,"column":6},"end":{"line":628,"column":14}},{"start":{"line":629,"column":6},"end":{"line":629,"column":32}},{"start":{"line":630,"column":6},"end":{"line":630,"column":30}},{"start":{"line":631,"column":6},"end":{"line":632,"column":68}}]},"29":{"line":661,"type":"if","locations":[{"start":{"line":661,"column":4},"end":{"line":661,"column":4}},{"start":{"line":661,"column":4},"end":{"line":661,"column":4}}]},"30":{"line":661,"type":"binary-expr","locations":[{"start":{"line":661,"column":9},"end":{"line":661,"column":19}},{"start":{"line":661,"column":25},"end":{"line":661,"column":40}}]},"31":{"line":663,"type":"if","locations":[{"start":{"line":663,"column":11},"end":{"line":663,"column":11}},{"start":{"line":663,"column":11},"end":{"line":663,"column":11}}]},"32":{"line":663,"type":"binary-expr","locations":[{"start":{"line":663,"column":16},"end":{"line":663,"column":35}},{"start":{"line":663,"column":41},"end":{"line":663,"column":61}}]},"33":{"line":665,"type":"if","locations":[{"start":{"line":665,"column":11},"end":{"line":665,"column":11}},{"start":{"line":665,"column":11},"end":{"line":665,"column":11}}]},"34":{"line":667,"type":"if","locations":[{"start":{"line":667,"column":11},"end":{"line":667,"column":11}},{"start":{"line":667,"column":11},"end":{"line":667,"column":11}}]},"35":{"line":669,"type":"if","locations":[{"start":{"line":669,"column":11},"end":{"line":669,"column":11}},{"start":{"line":669,"column":11},"end":{"line":669,"column":11}}]},"36":{"line":669,"type":"binary-expr","locations":[{"start":{"line":669,"column":15},"end":{"line":669,"column":21}},{"start":{"line":669,"column":25},"end":{"line":669,"column":36}}]},"37":{"line":671,"type":"if","locations":[{"start":{"line":671,"column":11},"end":{"line":671,"column":11}},{"start":{"line":671,"column":11},"end":{"line":671,"column":11}}]},"38":{"line":684,"type":"binary-expr","locations":[{"start":{"line":684,"column":17},"end":{"line":684,"column":34}},{"start":{"line":684,"column":38},"end":{"line":684,"column":40}}]},"39":{"line":689,"type":"cond-expr","locations":[{"start":{"line":689,"column":31},"end":{"line":689,"column":59}},{"start":{"line":689,"column":62},"end":{"line":689,"column":64}}]},"40":{"line":756,"type":"cond-expr","locations":[{"start":{"line":756,"column":30},"end":{"line":756,"column":31}},{"start":{"line":756,"column":34},"end":{"line":756,"column":35}}]},"41":{"line":842,"type":"if","locations":[{"start":{"line":842,"column":4},"end":{"line":842,"column":4}},{"start":{"line":842,"column":4},"end":{"line":842,"column":4}}]},"42":{"line":842,"type":"binary-expr","locations":[{"start":{"line":842,"column":9},"end":{"line":842,"column":23}},{"start":{"line":842,"column":29},"end":{"line":842,"column":48}}]},"43":{"line":844,"type":"if","locations":[{"start":{"line":844,"column":11},"end":{"line":844,"column":11}},{"start":{"line":844,"column":11},"end":{"line":844,"column":11}}]},"44":{"line":844,"type":"binary-expr","locations":[{"start":{"line":844,"column":16},"end":{"line":844,"column":39}},{"start":{"line":844,"column":45},"end":{"line":844,"column":70}}]},"45":{"line":846,"type":"if","locations":[{"start":{"line":846,"column":11},"end":{"line":846,"column":11}},{"start":{"line":846,"column":11},"end":{"line":846,"column":11}}]},"46":{"line":848,"type":"if","locations":[{"start":{"line":848,"column":11},"end":{"line":848,"column":11}},{"start":{"line":848,"column":11},"end":{"line":848,"column":11}}]},"47":{"line":850,"type":"if","locations":[{"start":{"line":850,"column":11},"end":{"line":850,"column":11}},{"start":{"line":850,"column":11},"end":{"line":850,"column":11}}]},"48":{"line":852,"type":"if","locations":[{"start":{"line":852,"column":11},"end":{"line":852,"column":11}},{"start":{"line":852,"column":11},"end":{"line":852,"column":11}}]},"49":{"line":852,"type":"binary-expr","locations":[{"start":{"line":852,"column":15},"end":{"line":852,"column":25}},{"start":{"line":852,"column":29},"end":{"line":852,"column":44}}]},"50":{"line":854,"type":"if","locations":[{"start":{"line":854,"column":11},"end":{"line":854,"column":11}},{"start":{"line":854,"column":11},"end":{"line":854,"column":11}}]},"51":{"line":856,"type":"if","locations":[{"start":{"line":856,"column":11},"end":{"line":856,"column":11}},{"start":{"line":856,"column":11},"end":{"line":856,"column":11}}]},"52":{"line":858,"type":"if","locations":[{"start":{"line":858,"column":11},"end":{"line":858,"column":11}},{"start":{"line":858,"column":11},"end":{"line":858,"column":11}}]},"53":{"line":860,"type":"if","locations":[{"start":{"line":860,"column":11},"end":{"line":860,"column":11}},{"start":{"line":860,"column":11},"end":{"line":860,"column":11}}]},"54":{"line":887,"type":"if","locations":[{"start":{"line":887,"column":4},"end":{"line":887,"column":4}},{"start":{"line":887,"column":4},"end":{"line":887,"column":4}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var colCache = require('./../utils/col-cache');","var utils = require('./../utils/utils');","var Enums = require('./enums');","","// Cell requirements","//  Operate inside a worksheet","//  Store and retrieve a value with a range of types: text, number, date, hyperlink, reference, formula, etc.","//  Manage/use and manipulate cell format either as local to cell or inherited from column or row.","","var Cell = module.exports = function(row, column, address) {","  if (!row || !column) {","    throw new Error('A Cell needs a Row');","  }","","  //if (!(row instanceof Row)) {","  //  throw new Error('Expected row to be Row, was ' + typeof row);","  //}","  //if (!(column instanceof Column)) {","  //  throw new Error('Expected col to be Column, was ' + typeof column);","  //}","","  this._row = row;","  this._column = column;","","  colCache.validateAddress(address);","  this._address = address;","","  this._value = Value.create(Cell.Types.Null, this);","","  this.style = this._mergeStyle(row.style, column.style, {});","","  this._mergeCount = 0;","};","","Cell.Types = Enums.ValueType;","","Cell.prototype = {","","  get worksheet() {","    return this._row.worksheet;","  },","  get workbook() {","    return this._row.worksheet.workbook;","  },","","  // help GC by removing cyclic (and other) references","  destroy: function() {","    delete this.style;","    delete this._value;","    delete this._row;","    delete this._column;","    delete this._address;","  },","","  // =========================================================================","  // Styles stuff","  get numFmt() {","    return this.style.numFmt;","  },","  set numFmt(value) {","    this.style.numFmt = value;","  },","  get font() {","    return this.style.font;","  },","  set font(value) {","    this.style.font = value;","  },","  get alignment() {","    return this.style.alignment;","  },","  set alignment(value) {","    this.style.alignment = value;","  },","  get border() {","    return this.style.border;","  },","  set border(value) {","    this.style.border = value;","  },","  get fill() {","    return this.style.fill;","  },","  set fill(value) {","    this.style.fill = value;","  },","","  _mergeStyle: function(rowStyle, colStyle, style) {","    var numFmt = rowStyle && rowStyle.numFmt || colStyle && colStyle.numFmt;","    if (numFmt) style.numFmt = numFmt;","","    var font = rowStyle && rowStyle.font || colStyle && colStyle.font;","    if (font) style.font = font;","","    var alignment = rowStyle && rowStyle.alignment || colStyle && colStyle.alignment;","    if (alignment) style.alignment = alignment;","","    var border = rowStyle && rowStyle.border || colStyle && colStyle.border;","    if (border) style.border = border;","","    var fill = rowStyle && rowStyle.fill || colStyle && colStyle.fill;","    if (fill) style.fill = fill;","","    return style;","  },","","  // =========================================================================","  // return the address for this cell","  get address() {","    return this._address;","  },","","  get row() {","    return this._row.number;","  },","  get col() {","    return this._column.number;","  },","","  get $col$row() {","    return '$' + this._column.letter + '$' + this.row;","  },","","","  // =========================================================================","  // Value stuff","","  get type() {","    return this._value.type;","  },","","  get effectiveType() {","    return this._value.effectiveType;","  },","","  toCsvString: function() {","    return this._value.toCsvString();","  },","","  // =========================================================================","  // Merge stuff","","  addMergeRef: function() {","    this._mergeCount++;","  },","  releaseMergeRef: function() {","    this._mergeCount--;","  },","  get isMerged() {","    return (this._mergeCount > 0) || (this.type == Cell.Types.Merge);","  },","  merge: function(master) {","    this._value.release();","    this._value = Value.create(Cell.Types.Merge, this, master);","    this.style = master.style;","  },","  unmerge: function() {","    if (this.type == Cell.Types.Merge) {","      this._value.release();","      this._value = Value.create(Cell.Types.Null, this);","      this.style = this._mergeStyle(this._row.style, this._column.style, {});","    }","  },","  isMergedTo: function(master) {","    if (this._value.type != Cell.Types.Merge) return false;","    return this._value.isMergedTo(master);","  },","  get master() {","    if (this.type === Cell.Types.Merge) return this._value.master;","    else return this; // an unmerged cell is its own master","  },","","  get isHyperlink() {","    return this._value.type == Cell.Types.Hyperlink;","  },","  get hyperlink() {","    return this._value.hyperlink;","  },","","  // return the value","  get value() {","    return this._value.value;","  },","  // set the value - can be number, string or raw","  set value(v) {","    // special case - merge cells set their master's value","    if (this.type === Cell.Types.Merge) {","      return this._value.master.value = v;","    }","","    this._value.release();","","    // assign value","    this._value = Value.create(Value.getType(v), this, v);","  },","  get text() {","    return this._value.toString();","  } ,","  toString: function() {","    return this.text;","  },","","  _upgradeToHyperlink: function(hyperlink) {","    // if this cell is a string, turn it into a Hyperlink","    if (this.type == Cell.Types.String) {","      this._value = Value.create(Cell.Types.Hyperlink, this, {","        text: this._value._value,","        hyperlink: hyperlink","      });","    }","  },","","  // =========================================================================","  // Name stuff","  get fullAddress() {","    var worksheet = this._row.worksheet;","    return {","      sheetName: worksheet.name,","      address: this.address,","      row: this.row,","      col: this.col","    };","  },","  get name() {","    return this.names[0];","  },","  set name(value) {","    this.names = [value];","  },","  get names() {","    return this.workbook.definedNames.getNamesEx(this.fullAddress);","  },","  set names(value) {","    var self = this;","    var definedNames = this.workbook.definedNames;","    this.workbook.definedNames.removeAllNames(self.fullAddress);","    value.forEach(function(name) {","      definedNames.addEx(self.fullAddress, name);","    });","  },","  addName: function(name) {","    this.workbook.definedNames.addEx(this.fullAddress, name);","  },","  removeName: function(name) {","    this.workbook.definedNames.removeEx(this.fullAddress, name);","  },","  removeAllNames: function() {","    this.workbook.definedNames.removeAllNames(this.fullAddress);","  },","","  // =========================================================================","  // Data Validation stuff","  get _dataValidations() {","    return this.worksheet.dataValidations;","  },","","  get dataValidation() {","    return this._dataValidations.find(this.address)","  },","","  set dataValidation(value) {","    this._dataValidations.add(this.address, value);","  },","","","  // =========================================================================","  // Model stuff","","  get model() {","    var model = this._value.model;","    model.style = this.style;","    return model;","  },","  set model(value) {","    this._value.release();","    this._value = Value.create(value.type, this);","    this._value.model = value;","    if (value.style) {","      this.style = value.style;","    } else {","      this.style = {};","    }","  }","};","","// =============================================================================","// Internal Value Types","","var NullValue = function(cell) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Null","  };","};","NullValue.prototype = {","  get value() {","    return null;","  },","  set value(value) {","  },","  get type() {","    return Cell.Types.Null;","  },","  get effectiveType() {","    return Cell.Types.Null;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return '';","  },","  release: function() {","  },","  toString: function() {","    return '';","  }","};","","var NumberValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Number,","    value: value","  };","};","NumberValue.prototype = {","  get value() {","    return this.model.value;","  },","  set value(value) {","    this.model.value = value;","  },","  get type() {","    return Cell.Types.Number;","  },","  get effectiveType() {","    return Cell.Types.Number;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return '' + this.model.value;","  },","  release: function() {","  },","  toString: function() {","    return this.model.value.toString();","  }","};","","var StringValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.String,","    value: value","  };","};","StringValue.prototype = {","  get value() {","    return this.model.value;","  },","  set value(value) {","    this.model.value = value;","  },","  get type() {","    return Cell.Types.String;","  },","  get effectiveType() {","    return Cell.Types.String;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return '\"' + this.model.value.replace(/\"/g, '\"\"') + '\"';","  },","  release: function() {","  },","  toString: function() {","    return this.model.value;","  }","};","","var RichTextValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.String,","    value: value","  };","};","RichTextValue.prototype = {","  get value() {","    return this.model.value;","  },","  set value(value) {","    this.model.value = value;","  },","  toString: function() {","    return this.model.value.richText.map(function(t) {","      return t.text;","    }).join('');","  },","  get type() {","    return Cell.Types.RichText;","  },","  get effectiveType() {","    return Cell.Types.RichText;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return '\"' + this.text.replace(/\"/g, '\"\"') + '\"';","  },","  release: function() {","  }","};","","var DateValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Date,","    value: value","  };","};","DateValue.prototype = {","  get value() {","    return this.model.value;","  },","  set value(value) {","    this.model.value = value;","  },","  get type() {","    return Cell.Types.Date;","  },","  get effectiveType() {","    return Cell.Types.Date;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return this.model.value.toISOString();","  },","  release: function() {","  },","  toString: function() {","    return this.model.value.toString();","  }","};","","var HyperlinkValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Hyperlink,","    text: value ? value.text : undefined,","    hyperlink: value ? value.hyperlink : undefined","  };","};","HyperlinkValue.prototype = {","  get value() {","    return {","      text: this.model.text,","      hyperlink: this.model.hyperlink","    };","  },","  set value(value) {","    this.model.text = value.text;","    this.model.hyperlink = value.hyperlink;","  },","","  get text() {","    return this.model.text;","  },","  set text(value) {","    this.model.text = value;","  },","  get hyperlink() {","    return this.model.hyperlink;","  },","  set hyperlink(value) {","    this.model.hyperlink = value;","  },","  get type() {","    return Cell.Types.Hyperlink;","  },","  get effectiveType() {","    return Cell.Types.Hyperlink;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return this.model.hyperlink;","  },","  release: function() {","  },","  toString: function() {","    return this.model.text;","  }","};","","var MergeValue = function(cell, master) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Merge,","    master: master ? master.address : undefined","  };","  this._master = master;","  if (master) {","    master.addMergeRef();","  }","};","MergeValue.prototype = {","  get value() {","    return this._master.value;","  },","  set value(value) {","    if (value instanceof Cell) {","      if (this._master) {","        this._master.releaseMergeRef();","      }","      value.addMergeRef();","      this._master = value;","    } else {","      this._master.value = value;","    }","  },","","  isMergedTo: function(master) {","    return master === this._master;","  },","  get master() {","    return this._master;","  },","  get type() {","    return Cell.Types.Merge;","  },","  get effectiveType() {","    return this._master.effectiveType;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return '';","  },","  release: function() {","    this._master.releaseMergeRef();","  },","  toString: function() {","    return this.value.toString();","  }","};","","var FormulaValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Formula,","    formula: value ? value.formula : undefined,","    result: value ? value.result : undefined","  };","};","FormulaValue.prototype = {","  get value() {","    return {","      formula: this.model.formula,","      result: this.model.result","    };","  },","  set value(value) {","    this.model.formula = value.formula;","    this.model.result = value.result;","  },","  validate: function(value) {","    switch (Value.getType(value)) {","      case Cell.Types.Null:","      case Cell.Types.String:","      case Cell.Types.Number:","      case Cell.Types.Date:","        break;","      case Cell.Types.Hyperlink:","      case Cell.Types.Formula:","      default:","        throw new Error('Cannot process that type of result value');","    }","  },","  get dependencies() {","    var ranges = this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}:[A-Z]{1,3}\\d{1,4}/g);","    var cells = this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}:[A-Z]{1,3}\\d{1,4}/g, '')","      .match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\\d{1,4}/g);","    return {","      ranges: ranges,","      cells: cells","    };","  },","  get formula() {","    return this.model.formula;","  },","  set formula(value) {","    this.model.formula = value;","  },","  get result() {","    return this.model.result;","  },","  set result(value) {","    this.model.result = value;","  },","  get type() {","    return Cell.Types.Formula;","  },","  get effectiveType() {","    var v = this.model.result;","    if ((v === null) || (v === undefined)) {","      return Enums.ValueType.Null;","    } else if ((v instanceof String) || (typeof v == 'string')) {","      return Enums.ValueType.String;","    } else if (typeof v == 'number') {","      return Enums.ValueType.Number;","    } else if (v instanceof Date) {","      return Enums.ValueType.Date;","    } else if (v.text && v.hyperlink) {","      return Enums.ValueType.Hyperlink;","    } else if (v.formula) {","      return Enums.ValueType.Formula;","    } else {","      return Enums.ValueType.Null;","    }","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return '' + (this.model.result || '');","  },","  release: function() {","  },","  toString: function() {","    return this.model.result ? this.model.result.toString() : '';","  }","};","","var SharedStringValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.SharedString,","    value: value","  };","};","SharedStringValue.prototype = {","  get value() {","    return this.model.value;","  },","  set value(value) {","    this.model.value = value;","  },","  get type() {","    return Cell.Types.SharedString;","  },","  get effectiveType() {","    return Cell.Types.SharedString;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return '' + this.model.value;","  },","  release: function() {","  },","  toString: function() {","    return this.model.value.toString();","  }","};","","var BooleanValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Boolean,","    value: value","  };","};","BooleanValue.prototype = {","  get value() {","    return this.model.value;","  },","  set value(value) {","    this.model.value = value;","  },","  get type() {","    return Cell.Types.Boolean;","  },","  get effectiveType() {","    return Cell.Types.Boolean;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return this.model.value ? 1 : 0;","  },","  release: function() {","  },","  toString: function() {","    return this.model.value.toString();","  }","};","","var ErrorValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.Error,","    value: value","  };","};","ErrorValue.prototype = {","  get value() {","    return this.model.value;","  },","  set value(value) {","    this.model.value = value;","  },","  get type() {","    return Cell.Types.Error;","  },","  get effectiveType() {","    return Cell.Types.Error;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return this.toString();","  },","  release: function() {","  },","  toString: function() {","    return this.model.value.error.toString();","  }","};","","var JSONValue = function(cell, value) {","  this.model = {","    address: cell.address,","    type: Cell.Types.String,","    value: JSON.stringify(value),","    rawValue: value","  };","};","JSONValue.prototype = {","  get value() {","    return this.model.rawValue;","  },","  set value(value) {","    this.model.rawValue = value;","    this.model.value = JSON.stringify(value);","  },","  get type() {","    return Cell.Types.String;","  },","  get effectiveType() {","    return Cell.Types.String;","  },","  get address() {","    return this.model.address;","  },","  set address(value) {","    this.model.address = value;","  },","  toCsvString: function() {","    return this.model.value;","  },","  release: function() {","  },","  toString: function() {","    return this.model.value;","  }","};","","// Value is a place to hold common static Value type functions","var Value = {","  getType:  function(value) {","    if ((value === null) || (value === undefined)) {","      return Cell.Types.Null;","    } else if ((value instanceof String) || (typeof value === 'string')) {","      return Cell.Types.String;","    } else if (typeof value === 'number') {","      return Cell.Types.Number;","    } else if (typeof value === 'boolean') {","      return Cell.Types.Boolean;","    } else if (value instanceof Date) {","      return Cell.Types.Date;","    } else if (value.text && value.hyperlink) {","      return Cell.Types.Hyperlink;","    } else if (value.formula) {","      return Cell.Types.Formula;","    } else if (value.richText) {","      return Cell.Types.RichText;","    } else if (value.sharedString) {","      return Cell.Types.SharedString;","    } else if (value.error) {","      return Cell.Types.Error;","    } else {","      return Cell.Types.JSON;","      //console.log('Error: value=' + value + ', type=' + typeof value)","      // throw new Error('I could not understand type of value: ' +  JSON.stringify(value) + ' - typeof: ' + typeof value);","    }","  },","","  // map valueType to constructor","  types: [","    {t:Cell.Types.Null, f:NullValue},","    {t:Cell.Types.Number, f:NumberValue},","    {t:Cell.Types.String, f:StringValue},","    {t:Cell.Types.Date, f:DateValue},","    {t:Cell.Types.Hyperlink, f:HyperlinkValue},","    {t:Cell.Types.Formula, f:FormulaValue},","    {t:Cell.Types.Merge, f:MergeValue},","    {t:Cell.Types.JSON, f:JSONValue},","    {t:Cell.Types.SharedString, f:SharedStringValue},","    {t:Cell.Types.RichText, f:RichTextValue},","    {t:Cell.Types.Boolean, f:BooleanValue},","    {t:Cell.Types.Error, f:ErrorValue},","  ].reduce(function(p,t){p[t.t]=t.f; return p;}, []),","","  create: function(type, cell, value) {","    var t = this.types[type];","    if (!t) {","      throw new Error('Could not create Value of type ' + type);","    }","    return new t(cell, value);","  }","};",""],"l":{"25":1,"26":1,"27":1,"34":1,"35":0,"36":0,"46":0,"47":0,"49":0,"50":0,"52":0,"54":0,"56":0,"59":1,"61":1,"64":0,"67":0,"72":0,"73":0,"74":0,"75":0,"76":0,"82":0,"85":0,"88":0,"91":0,"94":0,"97":0,"100":0,"103":0,"106":0,"109":0,"113":0,"114":0,"116":0,"117":0,"119":0,"120":0,"122":0,"123":0,"125":0,"126":0,"128":0,"134":0,"138":0,"141":0,"145":0,"153":0,"157":0,"161":0,"168":0,"171":0,"174":0,"177":0,"178":0,"179":0,"182":0,"183":0,"184":0,"185":0,"189":0,"190":0,"193":0,"194":0,"198":0,"201":0,"206":0,"211":0,"212":0,"215":0,"218":0,"221":0,"224":0,"229":0,"230":0,"240":0,"241":0,"249":0,"252":0,"255":0,"258":0,"259":0,"260":0,"261":0,"262":0,"266":0,"269":0,"272":0,"278":0,"282":0,"286":0,"294":0,"295":0,"296":0,"299":0,"300":0,"301":0,"302":0,"303":0,"305":0,"313":1,"314":0,"319":1,"321":0,"326":0,"329":0,"332":0,"335":0,"338":0,"343":0,"347":1,"348":0,"354":1,"356":0,"359":0,"362":0,"365":0,"368":0,"371":0,"374":0,"379":0,"383":1,"384":0,"390":1,"392":0,"395":0,"398":0,"401":0,"404":0,"407":0,"410":0,"415":0,"419":1,"420":0,"426":1,"428":0,"431":0,"434":0,"435":0,"439":0,"442":0,"445":0,"448":0,"451":0,"457":1,"458":0,"464":1,"466":0,"469":0,"472":0,"475":0,"478":0,"481":0,"484":0,"489":0,"493":1,"494":0,"501":1,"503":0,"509":0,"510":0,"514":0,"517":0,"520":0,"523":0,"526":0,"529":0,"532":0,"535":0,"538":0,"543":0,"547":1,"548":0,"553":0,"554":0,"555":0,"558":1,"560":0,"563":0,"564":0,"565":0,"567":0,"568":0,"570":0,"575":0,"578":0,"581":0,"584":0,"587":0,"590":0,"593":0,"596":0,"599":0,"603":1,"604":0,"611":1,"613":0,"619":0,"620":0,"623":0,"628":0,"632":0,"636":0,"637":0,"639":0,"645":0,"648":0,"651":0,"654":0,"657":0,"660":0,"661":0,"662":0,"663":0,"664":0,"665":0,"666":0,"667":0,"668":0,"669":0,"670":0,"671":0,"672":0,"674":0,"678":0,"681":0,"684":0,"689":0,"693":1,"694":0,"700":1,"702":0,"705":0,"708":0,"711":0,"714":0,"717":0,"720":0,"725":0,"729":1,"730":0,"736":1,"738":0,"741":0,"744":0,"747":0,"750":0,"753":0,"756":0,"761":0,"765":1,"766":0,"772":1,"774":0,"777":0,"780":0,"783":0,"786":0,"789":0,"792":0,"797":0,"801":1,"802":0,"809":1,"811":0,"814":0,"815":0,"818":0,"821":0,"824":0,"827":0,"830":0,"835":0,"840":1,"842":0,"843":0,"844":0,"845":0,"846":0,"847":0,"848":0,"849":0,"850":0,"851":0,"852":0,"853":0,"854":0,"855":0,"856":0,"857":0,"858":0,"859":0,"860":0,"861":0,"863":0,"883":12,"886":0,"887":0,"888":0,"890":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/column.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/column.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":1,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":1,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0,0,0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":30},"end":{"line":31,"column":65}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":12},"end":{"line":41,"column":15}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":15},"end":{"line":44,"column":18}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":12},"end":{"line":47,"column":15}}},"5":{"name":"(anonymous_5)","line":50,"loc":{"start":{"line":50,"column":19},"end":{"line":50,"column":22}}},"6":{"name":"(anonymous_6)","line":53,"loc":{"start":{"line":53,"column":10},"end":{"line":53,"column":13}}},"7":{"name":"(anonymous_7)","line":63,"loc":{"start":{"line":63,"column":10},"end":{"line":63,"column":18}}},"8":{"name":"(anonymous_8)","line":86,"loc":{"start":{"line":86,"column":13},"end":{"line":86,"column":16}}},"9":{"name":"(anonymous_9)","line":89,"loc":{"start":{"line":89,"column":12},"end":{"line":89,"column":15}}},"10":{"name":"(anonymous_10)","line":92,"loc":{"start":{"line":92,"column":12},"end":{"line":92,"column":20}}},"11":{"name":"(anonymous_11)","line":96,"loc":{"start":{"line":96,"column":27},"end":{"line":96,"column":50}}},"12":{"name":"(anonymous_12)","line":103,"loc":{"start":{"line":103,"column":9},"end":{"line":103,"column":12}}},"13":{"name":"(anonymous_13)","line":106,"loc":{"start":{"line":106,"column":9},"end":{"line":106,"column":17}}},"14":{"name":"(anonymous_14)","line":115,"loc":{"start":{"line":115,"column":12},"end":{"line":115,"column":15}}},"15":{"name":"(anonymous_15)","line":118,"loc":{"start":{"line":118,"column":12},"end":{"line":118,"column":20}}},"16":{"name":"(anonymous_16)","line":121,"loc":{"start":{"line":121,"column":18},"end":{"line":121,"column":21}}},"17":{"name":"(anonymous_17)","line":124,"loc":{"start":{"line":124,"column":18},"end":{"line":124,"column":26}}},"18":{"name":"(anonymous_18)","line":127,"loc":{"start":{"line":127,"column":15},"end":{"line":127,"column":18}}},"19":{"name":"(anonymous_19)","line":131,"loc":{"start":{"line":131,"column":12},"end":{"line":131,"column":24}}},"20":{"name":"(anonymous_20)","line":138,"loc":{"start":{"line":138,"column":16},"end":{"line":138,"column":33}}},"21":{"name":"(anonymous_21)","line":144,"loc":{"start":{"line":144,"column":15},"end":{"line":144,"column":18}}},"22":{"name":"(anonymous_22)","line":160,"loc":{"start":{"line":160,"column":17},"end":{"line":160,"column":20}}},"23":{"name":"(anonymous_23)","line":164,"loc":{"start":{"line":164,"column":12},"end":{"line":164,"column":41}}},"24":{"name":"(anonymous_24)","line":171,"loc":{"start":{"line":171,"column":39},"end":{"line":171,"column":65}}},"25":{"name":"(anonymous_25)","line":175,"loc":{"start":{"line":175,"column":30},"end":{"line":175,"column":56}}},"26":{"name":"(anonymous_26)","line":186,"loc":{"start":{"line":186,"column":15},"end":{"line":186,"column":38}}},"27":{"name":"(anonymous_27)","line":188,"loc":{"start":{"line":188,"column":18},"end":{"line":188,"column":34}}},"28":{"name":"(anonymous_28)","line":194,"loc":{"start":{"line":194,"column":12},"end":{"line":194,"column":15}}},"29":{"name":"(anonymous_29)","line":197,"loc":{"start":{"line":197,"column":12},"end":{"line":197,"column":20}}},"30":{"name":"(anonymous_30)","line":200,"loc":{"start":{"line":200,"column":10},"end":{"line":200,"column":13}}},"31":{"name":"(anonymous_31)","line":203,"loc":{"start":{"line":203,"column":10},"end":{"line":203,"column":18}}},"32":{"name":"(anonymous_32)","line":206,"loc":{"start":{"line":206,"column":15},"end":{"line":206,"column":18}}},"33":{"name":"(anonymous_33)","line":209,"loc":{"start":{"line":209,"column":15},"end":{"line":209,"column":23}}},"34":{"name":"(anonymous_34)","line":212,"loc":{"start":{"line":212,"column":12},"end":{"line":212,"column":15}}},"35":{"name":"(anonymous_35)","line":215,"loc":{"start":{"line":215,"column":12},"end":{"line":215,"column":20}}},"36":{"name":"(anonymous_36)","line":218,"loc":{"start":{"line":218,"column":10},"end":{"line":218,"column":13}}},"37":{"name":"(anonymous_37)","line":221,"loc":{"start":{"line":221,"column":10},"end":{"line":221,"column":18}}},"38":{"name":"(anonymous_38)","line":229,"loc":{"start":{"line":229,"column":17},"end":{"line":229,"column":36}}},"39":{"name":"(anonymous_39)","line":234,"loc":{"start":{"line":234,"column":20},"end":{"line":234,"column":45}}},"40":{"name":"(anonymous_40)","line":261,"loc":{"start":{"line":261,"column":19},"end":{"line":261,"column":46}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":39}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":45}},"3":{"start":{"line":31,"column":0},"end":{"line":38,"column":2}},"4":{"start":{"line":32,"column":2},"end":{"line":32,"column":30}},"5":{"start":{"line":33,"column":2},"end":{"line":33,"column":24}},"6":{"start":{"line":34,"column":2},"end":{"line":37,"column":3}},"7":{"start":{"line":36,"column":4},"end":{"line":36,"column":21}},"8":{"start":{"line":40,"column":0},"end":{"line":224,"column":2}},"9":{"start":{"line":42,"column":4},"end":{"line":42,"column":24}},"10":{"start":{"line":45,"column":4},"end":{"line":45,"column":27}},"11":{"start":{"line":48,"column":4},"end":{"line":48,"column":38}},"12":{"start":{"line":51,"column":4},"end":{"line":51,"column":60}},"13":{"start":{"line":54,"column":4},"end":{"line":61,"column":6}},"14":{"start":{"line":64,"column":4},"end":{"line":84,"column":5}},"15":{"start":{"line":65,"column":6},"end":{"line":65,"column":27}},"16":{"start":{"line":66,"column":6},"end":{"line":66,"column":31}},"17":{"start":{"line":67,"column":6},"end":{"line":67,"column":45}},"18":{"start":{"line":68,"column":6},"end":{"line":73,"column":7}},"19":{"start":{"line":69,"column":8},"end":{"line":69,"column":33}},"20":{"start":{"line":72,"column":8},"end":{"line":72,"column":23}},"21":{"start":{"line":76,"column":6},"end":{"line":76,"column":33}},"22":{"start":{"line":77,"column":6},"end":{"line":77,"column":36}},"23":{"start":{"line":79,"column":6},"end":{"line":79,"column":26}},"24":{"start":{"line":80,"column":6},"end":{"line":80,"column":22}},"25":{"start":{"line":81,"column":6},"end":{"line":81,"column":24}},"26":{"start":{"line":82,"column":6},"end":{"line":82,"column":22}},"27":{"start":{"line":83,"column":6},"end":{"line":83,"column":28}},"28":{"start":{"line":87,"column":4},"end":{"line":87,"column":91}},"29":{"start":{"line":90,"column":4},"end":{"line":90,"column":24}},"30":{"start":{"line":93,"column":4},"end":{"line":101,"column":5}},"31":{"start":{"line":94,"column":6},"end":{"line":94,"column":22}},"32":{"start":{"line":95,"column":6},"end":{"line":95,"column":27}},"33":{"start":{"line":96,"column":6},"end":{"line":98,"column":9}},"34":{"start":{"line":97,"column":8},"end":{"line":97,"column":69}},"35":{"start":{"line":100,"column":6},"end":{"line":100,"column":24}},"36":{"start":{"line":104,"column":4},"end":{"line":104,"column":21}},"37":{"start":{"line":107,"column":4},"end":{"line":109,"column":5}},"38":{"start":{"line":108,"column":6},"end":{"line":108,"column":46}},"39":{"start":{"line":110,"column":4},"end":{"line":110,"column":22}},"40":{"start":{"line":111,"column":4},"end":{"line":113,"column":5}},"41":{"start":{"line":112,"column":6},"end":{"line":112,"column":46}},"42":{"start":{"line":116,"column":4},"end":{"line":116,"column":26}},"43":{"start":{"line":119,"column":4},"end":{"line":119,"column":25}},"44":{"start":{"line":122,"column":4},"end":{"line":122,"column":35}},"45":{"start":{"line":125,"column":4},"end":{"line":125,"column":31}},"46":{"start":{"line":128,"column":4},"end":{"line":128,"column":104}},"47":{"start":{"line":132,"column":4},"end":{"line":136,"column":7}},"48":{"start":{"line":139,"column":4},"end":{"line":142,"column":47}},"49":{"start":{"line":145,"column":4},"end":{"line":147,"column":5}},"50":{"start":{"line":146,"column":6},"end":{"line":146,"column":19}},"51":{"start":{"line":148,"column":4},"end":{"line":150,"column":5}},"52":{"start":{"line":149,"column":6},"end":{"line":149,"column":19}},"53":{"start":{"line":151,"column":4},"end":{"line":153,"column":5}},"54":{"start":{"line":152,"column":6},"end":{"line":152,"column":19}},"55":{"start":{"line":154,"column":4},"end":{"line":154,"column":23}},"56":{"start":{"line":155,"column":4},"end":{"line":157,"column":5}},"57":{"start":{"line":156,"column":6},"end":{"line":156,"column":19}},"58":{"start":{"line":158,"column":4},"end":{"line":158,"column":16}},"59":{"start":{"line":161,"column":4},"end":{"line":161,"column":31}},"60":{"start":{"line":165,"column":4},"end":{"line":165,"column":32}},"61":{"start":{"line":166,"column":4},"end":{"line":169,"column":5}},"62":{"start":{"line":167,"column":6},"end":{"line":167,"column":25}},"63":{"start":{"line":168,"column":6},"end":{"line":168,"column":21}},"64":{"start":{"line":170,"column":4},"end":{"line":181,"column":5}},"65":{"start":{"line":171,"column":6},"end":{"line":173,"column":9}},"66":{"start":{"line":172,"column":8},"end":{"line":172,"column":52}},"67":{"start":{"line":175,"column":6},"end":{"line":180,"column":9}},"68":{"start":{"line":176,"column":8},"end":{"line":176,"column":43}},"69":{"start":{"line":177,"column":8},"end":{"line":179,"column":9}},"70":{"start":{"line":178,"column":10},"end":{"line":178,"column":36}},"71":{"start":{"line":187,"column":4},"end":{"line":187,"column":29}},"72":{"start":{"line":188,"column":4},"end":{"line":190,"column":7}},"73":{"start":{"line":189,"column":6},"end":{"line":189,"column":25}},"74":{"start":{"line":191,"column":4},"end":{"line":191,"column":17}},"75":{"start":{"line":195,"column":4},"end":{"line":195,"column":29}},"76":{"start":{"line":198,"column":4},"end":{"line":198,"column":38}},"77":{"start":{"line":201,"column":4},"end":{"line":201,"column":27}},"78":{"start":{"line":204,"column":4},"end":{"line":204,"column":36}},"79":{"start":{"line":207,"column":4},"end":{"line":207,"column":32}},"80":{"start":{"line":210,"column":4},"end":{"line":210,"column":41}},"81":{"start":{"line":213,"column":4},"end":{"line":213,"column":29}},"82":{"start":{"line":216,"column":4},"end":{"line":216,"column":38}},"83":{"start":{"line":219,"column":4},"end":{"line":219,"column":27}},"84":{"start":{"line":222,"column":4},"end":{"line":222,"column":36}},"85":{"start":{"line":229,"column":0},"end":{"line":259,"column":2}},"86":{"start":{"line":231,"column":2},"end":{"line":231,"column":16}},"87":{"start":{"line":232,"column":2},"end":{"line":232,"column":17}},"88":{"start":{"line":233,"column":2},"end":{"line":257,"column":3}},"89":{"start":{"line":234,"column":4},"end":{"line":256,"column":7}},"90":{"start":{"line":235,"column":6},"end":{"line":255,"column":7}},"91":{"start":{"line":236,"column":8},"end":{"line":238,"column":9}},"92":{"start":{"line":237,"column":10},"end":{"line":237,"column":21}},"93":{"start":{"line":240,"column":8},"end":{"line":254,"column":9}},"94":{"start":{"line":241,"column":10},"end":{"line":250,"column":12}},"95":{"start":{"line":251,"column":10},"end":{"line":251,"column":25}},"96":{"start":{"line":253,"column":10},"end":{"line":253,"column":30}},"97":{"start":{"line":258,"column":2},"end":{"line":258,"column":40}},"98":{"start":{"line":261,"column":0},"end":{"line":276,"column":2}},"99":{"start":{"line":262,"column":2},"end":{"line":262,"column":20}},"100":{"start":{"line":263,"column":2},"end":{"line":263,"column":19}},"101":{"start":{"line":264,"column":2},"end":{"line":264,"column":16}},"102":{"start":{"line":265,"column":2},"end":{"line":265,"column":16}},"103":{"start":{"line":266,"column":2},"end":{"line":274,"column":3}},"104":{"start":{"line":267,"column":4},"end":{"line":267,"column":28}},"105":{"start":{"line":268,"column":4},"end":{"line":270,"column":5}},"106":{"start":{"line":269,"column":6},"end":{"line":269,"column":51}},"107":{"start":{"line":271,"column":4},"end":{"line":273,"column":5}},"108":{"start":{"line":272,"column":6},"end":{"line":272,"column":56}},"109":{"start":{"line":275,"column":2},"end":{"line":275,"column":41}}},"branchMap":{"1":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":2},"end":{"line":34,"column":2}},{"start":{"line":34,"column":2},"end":{"line":34,"column":2}}]},"2":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":12},"end":{"line":51,"column":36}},{"start":{"line":51,"column":42},"end":{"line":51,"column":58}}]},"3":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":64,"column":4}},{"start":{"line":64,"column":4},"end":{"line":64,"column":4}}]},"4":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":6},"end":{"line":68,"column":6}},{"start":{"line":68,"column":6},"end":{"line":68,"column":6}}]},"5":{"line":87,"type":"cond-expr","locations":[{"start":{"line":87,"column":61},"end":{"line":87,"column":73}},{"start":{"line":87,"column":76},"end":{"line":87,"column":90}}]},"6":{"line":87,"type":"binary-expr","locations":[{"start":{"line":87,"column":11},"end":{"line":87,"column":23}},{"start":{"line":87,"column":28},"end":{"line":87,"column":57}}]},"7":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":4},"end":{"line":93,"column":4}},{"start":{"line":93,"column":4},"end":{"line":93,"column":4}}]},"8":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":4},"end":{"line":107,"column":4}},{"start":{"line":107,"column":4},"end":{"line":107,"column":4}}]},"9":{"line":107,"type":"binary-expr","locations":[{"start":{"line":107,"column":8},"end":{"line":107,"column":17}},{"start":{"line":107,"column":22},"end":{"line":107,"column":63}}]},"10":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":4},"end":{"line":111,"column":4}},{"start":{"line":111,"column":4},"end":{"line":111,"column":4}}]},"11":{"line":122,"type":"binary-expr","locations":[{"start":{"line":122,"column":11},"end":{"line":122,"column":29}},{"start":{"line":122,"column":33},"end":{"line":122,"column":34}}]},"12":{"line":128,"type":"binary-expr","locations":[{"start":{"line":128,"column":14},"end":{"line":128,"column":32}},{"start":{"line":128,"column":37},"end":{"line":128,"column":101}}]},"13":{"line":135,"type":"cond-expr","locations":[{"start":{"line":135,"column":37},"end":{"line":135,"column":49}},{"start":{"line":135,"column":52},"end":{"line":135,"column":61}}]},"14":{"line":139,"type":"binary-expr","locations":[{"start":{"line":139,"column":12},"end":{"line":139,"column":37}},{"start":{"line":140,"column":13},"end":{"line":140,"column":40}},{"start":{"line":141,"column":13},"end":{"line":141,"column":52}},{"start":{"line":142,"column":12},"end":{"line":142,"column":46}}]},"15":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"16":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":4},"end":{"line":148,"column":4}},{"start":{"line":148,"column":4},"end":{"line":148,"column":4}}]},"17":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":4},"end":{"line":151,"column":4}},{"start":{"line":151,"column":4},"end":{"line":151,"column":4}}]},"18":{"line":155,"type":"if","locations":[{"start":{"line":155,"column":4},"end":{"line":155,"column":4}},{"start":{"line":155,"column":4},"end":{"line":155,"column":4}}]},"19":{"line":155,"type":"binary-expr","locations":[{"start":{"line":155,"column":8},"end":{"line":155,"column":9}},{"start":{"line":155,"column":14},"end":{"line":155,"column":20}},{"start":{"line":155,"column":24},"end":{"line":155,"column":32}},{"start":{"line":155,"column":36},"end":{"line":155,"column":47}},{"start":{"line":155,"column":51},"end":{"line":155,"column":59}},{"start":{"line":155,"column":63},"end":{"line":155,"column":69}}]},"20":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"21":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":4},"end":{"line":170,"column":4}},{"start":{"line":170,"column":4},"end":{"line":170,"column":4}}]},"22":{"line":170,"type":"binary-expr","locations":[{"start":{"line":170,"column":8},"end":{"line":170,"column":15}},{"start":{"line":170,"column":19},"end":{"line":170,"column":39}}]},"23":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":8},"end":{"line":177,"column":8}},{"start":{"line":177,"column":8},"end":{"line":177,"column":8}}]},"24":{"line":233,"type":"if","locations":[{"start":{"line":233,"column":2},"end":{"line":233,"column":2}},{"start":{"line":233,"column":2},"end":{"line":233,"column":2}}]},"25":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":6},"end":{"line":235,"column":6}},{"start":{"line":235,"column":6},"end":{"line":235,"column":6}}]},"26":{"line":236,"type":"if","locations":[{"start":{"line":236,"column":8},"end":{"line":236,"column":8}},{"start":{"line":236,"column":8},"end":{"line":236,"column":8}}]},"27":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":8},"end":{"line":240,"column":8}},{"start":{"line":240,"column":8},"end":{"line":240,"column":8}}]},"28":{"line":240,"type":"binary-expr","locations":[{"start":{"line":240,"column":12},"end":{"line":240,"column":16}},{"start":{"line":240,"column":20},"end":{"line":240,"column":45}}]},"29":{"line":258,"type":"cond-expr","locations":[{"start":{"line":258,"column":23},"end":{"line":258,"column":27}},{"start":{"line":258,"column":30},"end":{"line":258,"column":39}}]},"30":{"line":262,"type":"binary-expr","locations":[{"start":{"line":262,"column":9},"end":{"line":262,"column":13}},{"start":{"line":262,"column":17},"end":{"line":262,"column":19}}]},"31":{"line":275,"type":"cond-expr","locations":[{"start":{"line":275,"column":26},"end":{"line":275,"column":33}},{"start":{"line":275,"column":36},"end":{"line":275,"column":40}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../utils/under-dash');","","var colCache = require('../utils/col-cache');","// Column defines the column properties for 1 column.","// This includes header rows, widths, key, (style), etc.","// Worksheet will condense the columns as appropriate during serialization","var Column = module.exports = function (worksheet, number, defn) {","  this._worksheet = worksheet;","  this._number = number;","  if (defn !== false) {","    // sometimes defn will follow","    this.defn = defn;","  }","};","","Column.prototype = {","  get number() {","    return this._number;","  },","  get worksheet() {","    return this._worksheet;","  },","  get letter() {","    return colCache.n2l(this._number);","  },","  get isCustomWidth() {","    return (this.width !== undefined) && (this.width !== 8);","  },","  get defn() {","    return {","      header: this._header,","      key: this.key,","      width: this.width,","      style: this.style,","      hidden: this.hidden,","      outlineLevel: this.outlineLevel","    };","  },","  set defn(value) {","    if (value) {","      this.key = value.key;","      this.width = value.width;","      this.outlineLevel = value.outlineLevel;","      if (value.style) {","        this.style = value.style;","      }","      else {","        this.style = {}","      }","","      // headers must be set after style","      this.header = value.header;","      this._hidden = !!value.hidden;","    } else {","      delete this._header;","      delete this.key;","      delete this.width;","      this.style = {};","      this.outlineLevel = 0;","    }","  },","  get headers() {","    return this._header && (this._header instanceof Array) ? this._header : [this._header];","  },","  get header() {","    return this._header;","  },","  set header(value) {","    if (value != undefined) {","      var self = this;","      this._header = value;","      this.headers.forEach(function (text, index) {","        self._worksheet.getCell(index + 1, self.number).value = text;","      });","    } else {","      this._header = [];","    }","  },","  get key() {","    return this._key;","  },","  set key(value) {","    if (this._key && (this._worksheet._keys[this._key] === this)) {","      delete this._worksheet._keys[this._key];","    }","    this._key = value;","    if (value) {","      this._worksheet._keys[this._key] = this;","    }","  },","  get hidden() {","    return !!this._hidden;","  },","  set hidden(value) {","    this._hidden = value;","  },","  get outlineLevel() {","    return this._outlineLevel || 0;","  },","  set outlineLevel(value) {","    this._outlineLevel = value;","  },","  get collapsed() {","    return !!(this._outlineLevel && (this._outlineLevel >= this._worksheet.properties.outlineLevelCol));","  },","","  toString: function () {","    return JSON.stringify({","      key: this.key,","      width: this.width,","      headers: this.headers.length ? this.headers : undefined","    });","  },","  equivalentTo: function (other) {","    return (this.width == other.width) &&","            (this.hidden == other.hidden) &&","            (this.outlineLevel == other.outlineLevel) &&","            _.isEqual(this.style, other.style);","  },","  get isDefault() {","    if (this.isCustomWidth) {","      return false;","    }","    if (this.hidden) {","      return false;","    }","    if (this.outlineLevel) {","      return false;","    }","    var s = this.style;","    if (s && (s.font || s.numFmt || s.alignment || s.border || s.fill)) {","      return false;","    }","    return true;","  },","  get headerCount() {","    return this.headers.length;","  },","","  eachCell: function (options, iteratee) {","    var colNumber = this.number;","    if (!iteratee) {","      iteratee = options;","      options = null;","    }","    if (options && options.includeEmpty) {","      this._worksheet.eachRow(options, function (row, rowNumber) {","        iteratee(row.getCell(colNumber), rowNumber);","      });","    } else {","      this._worksheet.eachRow(function (row, rowNumber) {","        var cell = row.findCell(colNumber);","        if (cell) {","          iteratee(cell, rowNumber);","        }","      });","    }","  },","","  // =========================================================================","  // styles","  _applyStyle: function (name, value) {","    this.style[name] = value;","    this.eachCell(function (cell) {","      cell[name] = value;","    });","    return value;","  },","","  get numFmt() {","    return this.style.numFmt;","  },","  set numFmt(value) {","    this._applyStyle('numFmt', value);","  },","  get font() {","    return this.style.font;","  },","  set font(value) {","    this._applyStyle('font', value);","  },","  get alignment() {","    return this.style.alignment;","  },","  set alignment(value) {","    this._applyStyle('alignment', value);","  },","  get border() {","    return this.style.border;","  },","  set border(value) {","    this._applyStyle('border', value);","  },","  get fill() {","    return this.style.fill;","  },","  set fill(value) {","    this._applyStyle('fill', value);","  }","};","","// =============================================================================","// static functions","","Column.toModel = function (columns) {","  // Convert array of Column into compressed list cols","  var cols = [];","  var col = null;","  if (columns) {","    columns.forEach(function (column, index) {","      if (column.isDefault) {","        if (col) {","          col = null;","        }","      } else {","        if (!col || !column.equivalentTo(col)) {","          col = {","            min: index + 1,","            max: index + 1,","            width: column.width,","            style: column.style,","            isCustomWidth: column.isCustomWidth,","            hidden: column.hidden,","            outlineLevel: column.outlineLevel,","            collapsed: column.collapsed","          };","          cols.push(col);","        } else {","          col.max = index + 1;","        }","      }","    });","  }","  return cols.length ? cols : undefined;","};","","Column.fromModel = function (worksheet, cols) {","  cols = cols || [];","  var columns = [];","  var count = 1;","  var index = 0;","  while (index < cols.length) {","    var col = cols[index++];","    while (count < col.min) {","      columns.push(new Column(worksheet, count++));","    }","    while (count <= col.max) {","      columns.push(new Column(worksheet, count++, col));","    }","  }","  return columns.length ? columns : null;","};"],"l":{"25":1,"27":1,"31":1,"32":0,"33":0,"34":0,"36":0,"40":1,"42":0,"45":0,"48":0,"51":0,"54":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"72":0,"76":0,"77":0,"79":0,"80":0,"81":0,"82":0,"83":0,"87":0,"90":0,"93":0,"94":0,"95":0,"96":0,"97":0,"100":0,"104":0,"107":0,"108":0,"110":0,"111":0,"112":0,"116":0,"119":0,"122":0,"125":0,"128":0,"132":0,"139":0,"145":0,"146":0,"148":0,"149":0,"151":0,"152":0,"154":0,"155":0,"156":0,"158":0,"161":0,"165":0,"166":0,"167":0,"168":0,"170":0,"171":0,"172":0,"175":0,"176":0,"177":0,"178":0,"187":0,"188":0,"189":0,"191":0,"195":0,"198":0,"201":0,"204":0,"207":0,"210":0,"213":0,"216":0,"219":0,"222":0,"229":1,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"240":0,"241":0,"251":0,"253":0,"258":0,"261":1,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"271":0,"272":0,"275":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/data-validations.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/data-validations.js","s":{"1":1,"2":0,"3":1,"4":0,"5":0,"6":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":25,"loc":{"start":{"line":25,"column":39},"end":{"line":25,"column":55}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":7},"end":{"line":30,"column":37}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":8},"end":{"line":33,"column":26}}},"4":{"name":"(anonymous_4)","line":36,"loc":{"start":{"line":36,"column":10},"end":{"line":36,"column":28}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":27,"column":2}},"2":{"start":{"line":26,"column":2},"end":{"line":26,"column":27}},"3":{"start":{"line":29,"column":0},"end":{"line":39,"column":2}},"4":{"start":{"line":31,"column":4},"end":{"line":31,"column":44}},"5":{"start":{"line":34,"column":4},"end":{"line":34,"column":31}},"6":{"start":{"line":37,"column":4},"end":{"line":37,"column":36}}},"branchMap":{"1":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":15},"end":{"line":26,"column":20}},{"start":{"line":26,"column":24},"end":{"line":26,"column":26}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var DataValidations = module.exports = function(model) {","  this.model = model || {};","};","","DataValidations.prototype = {","  add: function(address, validation) {","    return this.model[address] = validation;","  },","  find: function(address) {","    return this.model[address];","  },","  remove: function(address) {","    this.model[address] = undefined;","  }","};","",""],"l":{"25":1,"26":0,"29":1,"31":0,"34":0,"37":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/defined-names.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/defined-names.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":36},"end":{"line":31,"column":47}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":13},"end":{"line":36,"column":28}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":7},"end":{"line":41,"column":30}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":9},"end":{"line":45,"column":34}}},"5":{"name":"(anonymous_5)","line":65,"loc":{"start":{"line":65,"column":10},"end":{"line":65,"column":33}}},"6":{"name":"(anonymous_6)","line":69,"loc":{"start":{"line":69,"column":12},"end":{"line":69,"column":37}}},"7":{"name":"(anonymous_7)","line":73,"loc":{"start":{"line":73,"column":18},"end":{"line":73,"column":37}}},"8":{"name":"(anonymous_8)","line":74,"loc":{"start":{"line":74,"column":27},"end":{"line":74,"column":44}}},"9":{"name":"(anonymous_9)","line":79,"loc":{"start":{"line":79,"column":11},"end":{"line":79,"column":30}}},"10":{"name":"(anonymous_10)","line":80,"loc":{"start":{"line":80,"column":27},"end":{"line":80,"column":50}}},"11":{"name":"(anonymous_11)","line":81,"loc":{"start":{"line":81,"column":21},"end":{"line":81,"column":36}}},"12":{"name":"(anonymous_12)","line":88,"loc":{"start":{"line":88,"column":12},"end":{"line":88,"column":33}}},"13":{"name":"(anonymous_13)","line":91,"loc":{"start":{"line":91,"column":14},"end":{"line":91,"column":32}}},"14":{"name":"(anonymous_14)","line":92,"loc":{"start":{"line":92,"column":33},"end":{"line":92,"column":56}}},"15":{"name":"(anonymous_15)","line":96,"loc":{"start":{"line":96,"column":14},"end":{"line":96,"column":29}}},"16":{"name":"(anonymous_16)","line":99,"loc":{"start":{"line":99,"column":12},"end":{"line":99,"column":35}}},"17":{"name":"vGrow","line":107,"loc":{"start":{"line":107,"column":4},"end":{"line":107,"column":28}}},"18":{"name":"hGrow","line":118,"loc":{"start":{"line":118,"column":4},"end":{"line":118,"column":28}}},"19":{"name":"(anonymous_19)","line":140,"loc":{"start":{"line":140,"column":13},"end":{"line":140,"column":36}}},"20":{"name":"(anonymous_20)","line":149,"loc":{"start":{"line":149,"column":19},"end":{"line":149,"column":34}}},"21":{"name":"(anonymous_21)","line":150,"loc":{"start":{"line":150,"column":28},"end":{"line":150,"column":43}}},"22":{"name":"(anonymous_22)","line":153,"loc":{"start":{"line":153,"column":14},"end":{"line":153,"column":30}}},"23":{"name":"(anonymous_23)","line":154,"loc":{"start":{"line":154,"column":11},"end":{"line":154,"column":27}}},"24":{"name":"(anonymous_24)","line":161,"loc":{"start":{"line":161,"column":11},"end":{"line":161,"column":14}}},"25":{"name":"(anonymous_25)","line":164,"loc":{"start":{"line":164,"column":33},"end":{"line":164,"column":56}}},"26":{"name":"(anonymous_26)","line":167,"loc":{"start":{"line":167,"column":14},"end":{"line":167,"column":36}}},"27":{"name":"(anonymous_27)","line":171,"loc":{"start":{"line":171,"column":11},"end":{"line":171,"column":19}}},"28":{"name":"(anonymous_28)","line":174,"loc":{"start":{"line":174,"column":18},"end":{"line":174,"column":40}}},"29":{"name":"(anonymous_29)","line":176,"loc":{"start":{"line":176,"column":33},"end":{"line":176,"column":52}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":39}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":45}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":49}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":31}},"5":{"start":{"line":29,"column":0},"end":{"line":29,"column":53}},"6":{"start":{"line":31,"column":0},"end":{"line":33,"column":2}},"7":{"start":{"line":32,"column":2},"end":{"line":32,"column":22}},"8":{"start":{"line":35,"column":0},"end":{"line":183,"column":2}},"9":{"start":{"line":37,"column":4},"end":{"line":37,"column":77}},"10":{"start":{"line":42,"column":4},"end":{"line":42,"column":45}},"11":{"start":{"line":43,"column":4},"end":{"line":43,"column":31}},"12":{"start":{"line":46,"column":4},"end":{"line":46,"column":38}},"13":{"start":{"line":47,"column":4},"end":{"line":62,"column":5}},"14":{"start":{"line":48,"column":6},"end":{"line":59,"column":7}},"15":{"start":{"line":49,"column":8},"end":{"line":58,"column":9}},"16":{"start":{"line":50,"column":10},"end":{"line":55,"column":12}},"17":{"start":{"line":57,"column":10},"end":{"line":57,"column":36}},"18":{"start":{"line":61,"column":6},"end":{"line":61,"column":33}},"19":{"start":{"line":66,"column":4},"end":{"line":66,"column":45}},"20":{"start":{"line":67,"column":4},"end":{"line":67,"column":34}},"21":{"start":{"line":70,"column":4},"end":{"line":70,"column":38}},"22":{"start":{"line":71,"column":4},"end":{"line":71,"column":34}},"23":{"start":{"line":74,"column":4},"end":{"line":76,"column":7}},"24":{"start":{"line":75,"column":6},"end":{"line":75,"column":36}},"25":{"start":{"line":80,"column":4},"end":{"line":84,"column":7}},"26":{"start":{"line":81,"column":6},"end":{"line":83,"column":9}},"27":{"start":{"line":82,"column":8},"end":{"line":82,"column":29}},"28":{"start":{"line":89,"column":4},"end":{"line":89,"column":58}},"29":{"start":{"line":92,"column":4},"end":{"line":96,"column":47}},"30":{"start":{"line":93,"column":6},"end":{"line":95,"column":7}},"31":{"start":{"line":94,"column":8},"end":{"line":94,"column":20}},"32":{"start":{"line":96,"column":31},"end":{"line":96,"column":43}},"33":{"start":{"line":100,"column":4},"end":{"line":100,"column":22}},"34":{"start":{"line":101,"column":4},"end":{"line":101,"column":35}},"35":{"start":{"line":103,"column":4},"end":{"line":103,"column":77}},"36":{"start":{"line":104,"column":4},"end":{"line":104,"column":13}},"37":{"start":{"line":107,"column":4},"end":{"line":113,"column":5}},"38":{"start":{"line":108,"column":6},"end":{"line":108,"column":56}},"39":{"start":{"line":109,"column":6},"end":{"line":109,"column":42}},"40":{"start":{"line":109,"column":27},"end":{"line":109,"column":40}},"41":{"start":{"line":110,"column":6},"end":{"line":110,"column":22}},"42":{"start":{"line":111,"column":6},"end":{"line":111,"column":21}},"43":{"start":{"line":112,"column":6},"end":{"line":112,"column":18}},"44":{"start":{"line":114,"column":4},"end":{"line":114,"column":51}},"45":{"start":{"line":115,"column":4},"end":{"line":115,"column":54}},"46":{"start":{"line":118,"column":4},"end":{"line":133,"column":5}},"47":{"start":{"line":119,"column":6},"end":{"line":119,"column":24}},"48":{"start":{"line":120,"column":6},"end":{"line":127,"column":7}},"49":{"start":{"line":121,"column":8},"end":{"line":121,"column":47}},"50":{"start":{"line":122,"column":8},"end":{"line":126,"column":9}},"51":{"start":{"line":123,"column":10},"end":{"line":123,"column":24}},"52":{"start":{"line":125,"column":10},"end":{"line":125,"column":23}},"53":{"start":{"line":128,"column":6},"end":{"line":128,"column":22}},"54":{"start":{"line":129,"column":6},"end":{"line":131,"column":7}},"55":{"start":{"line":130,"column":8},"end":{"line":130,"column":30}},"56":{"start":{"line":132,"column":6},"end":{"line":132,"column":18}},"57":{"start":{"line":134,"column":4},"end":{"line":134,"column":52}},"58":{"start":{"line":135,"column":4},"end":{"line":135,"column":53}},"59":{"start":{"line":137,"column":4},"end":{"line":137,"column":17}},"60":{"start":{"line":141,"column":4},"end":{"line":141,"column":20}},"61":{"start":{"line":142,"column":4},"end":{"line":142,"column":44}},"62":{"start":{"line":144,"column":4},"end":{"line":146,"column":5}},"63":{"start":{"line":145,"column":6},"end":{"line":145,"column":40}},"64":{"start":{"line":149,"column":4},"end":{"line":149,"column":57}},"65":{"start":{"line":149,"column":36},"end":{"line":149,"column":53}},"66":{"start":{"line":150,"column":4},"end":{"line":154,"column":58}},"67":{"start":{"line":151,"column":8},"end":{"line":151,"column":56}},"68":{"start":{"line":153,"column":32},"end":{"line":153,"column":45}},"69":{"start":{"line":154,"column":29},"end":{"line":154,"column":54}},"70":{"start":{"line":156,"column":4},"end":{"line":158,"column":6}},"71":{"start":{"line":162,"column":4},"end":{"line":162,"column":20}},"72":{"start":{"line":164,"column":4},"end":{"line":169,"column":9}},"73":{"start":{"line":165,"column":8},"end":{"line":165,"column":44}},"74":{"start":{"line":168,"column":8},"end":{"line":168,"column":41}},"75":{"start":{"line":173,"column":4},"end":{"line":173,"column":40}},"76":{"start":{"line":174,"column":4},"end":{"line":181,"column":7}},"77":{"start":{"line":175,"column":6},"end":{"line":175,"column":66}},"78":{"start":{"line":176,"column":6},"end":{"line":180,"column":9}},"79":{"start":{"line":177,"column":8},"end":{"line":179,"column":9}},"80":{"start":{"line":178,"column":10},"end":{"line":178,"column":35}}},"branchMap":{"1":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":11},"end":{"line":37,"column":31}},{"start":{"line":37,"column":36},"end":{"line":37,"column":75}}]},"2":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]},"3":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":6},"end":{"line":93,"column":6}},{"start":{"line":93,"column":6},"end":{"line":93,"column":6}}]},"4":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":6},"end":{"line":109,"column":6}},{"start":{"line":109,"column":6},"end":{"line":109,"column":6}}]},"5":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":10},"end":{"line":109,"column":12}},{"start":{"line":109,"column":16},"end":{"line":109,"column":23}}]},"6":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":8},"end":{"line":122,"column":8}},{"start":{"line":122,"column":8},"end":{"line":122,"column":8}}]},"7":{"line":122,"type":"binary-expr","locations":[{"start":{"line":122,"column":12},"end":{"line":122,"column":13}},{"start":{"line":122,"column":17},"end":{"line":122,"column":23}}]},"8":{"line":142,"type":"binary-expr","locations":[{"start":{"line":142,"column":13},"end":{"line":142,"column":19}},{"start":{"line":142,"column":23},"end":{"line":142,"column":43}}]},"9":{"line":144,"type":"if","locations":[{"start":{"line":144,"column":4},"end":{"line":144,"column":4}},{"start":{"line":144,"column":4},"end":{"line":144,"column":4}}]},"10":{"line":151,"type":"binary-expr","locations":[{"start":{"line":151,"column":15},"end":{"line":151,"column":24}},{"start":{"line":151,"column":28},"end":{"line":151,"column":55}}]},"11":{"line":177,"type":"if","locations":[{"start":{"line":177,"column":8},"end":{"line":177,"column":8}},{"start":{"line":177,"column":8},"end":{"line":177,"column":8}}]},"12":{"line":177,"type":"binary-expr","locations":[{"start":{"line":177,"column":28},"end":{"line":177,"column":53}},{"start":{"line":177,"column":57},"end":{"line":177,"column":59}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../utils/under-dash');","var colCache = require('../utils/col-cache');","var CellMatrix = require('../utils/cell-matrix');","var Range = require('./range');","var rangeRegexp = /\\$(\\w+)\\$(\\d+)(:\\$(\\w+)\\$(\\d+))?/;","","var DefinedNames = module.exports = function() {","  this.matrixMap = {};","};","","DefinedNames.prototype = {","  getMatrix: function(name) {","    return this.matrixMap[name] || (this.matrixMap[name] = new CellMatrix());","  },","","  // add a name to a cell. locStr in the form SheetName!$col$row or SheetName!$c1$r1:$c2:$r2","  add: function(locStr, name) {","    var location = colCache.decodeEx(locStr);","    this.addEx(location, name);","  },","  addEx: function(location, name) {","    var matrix = this.getMatrix(name);","    if (location.top) {","      for (var col = location.left; col <= location.right; col++) {","        for (var row = location.top; row <= location.bottom; row++) {","          var address = {","            sheetName: location.sheetName,","            address: colCache.n2l(col) + row,","            row: row,","            col: col","          };","","          matrix.addCellEx(address);","        }","      }","    } else {","      matrix.addCellEx(location);","    }","  },","","  remove: function(locStr, name) {","    var location = colCache.decodeEx(locStr);","    this.removeEx(location, name);","  },","  removeEx: function(location, name) {","    var matrix = this.getMatrix(name);","    matrix.removeCellEx(location);","  },","  removeAllNames: function(location) {","    _.each(this.matrixMap, function(matrix) {","      matrix.removeCellEx(location);","    });","  },","","  forEach: function(callback) {","    _.each(this.matrixMap, function(matrix, name) {","      matrix.forEach(function(cell) {","        callback(name, cell);","      });","    });","  },","","  // get all the names of a cell","  getNames: function(addressStr) {","    return this.getNamesEx(colCache.decodeEx(addressStr));","  },","  getNamesEx: function(address) {","    return _.map(this.matrixMap, function(matrix, name) {","      if (matrix.findCellEx(address)) {","        return name;","      }","    }).filter(function(name) { return name; });","  },","","  _explore: function(matrix, cell) {","    cell.mark = false;","    var sheetName = cell.sheetName;","","    var range = new Range(cell.row, cell.col, cell.row, cell.col, sheetName);","    var x, y;","","    // grow vertical - only one col to worry about","    function vGrow(y, edge) {","      var c = matrix.findCellAt(sheetName, y, cell.col);","      if (!c || !c.mark) { return false; }","      range[edge] = y;","      c.mark = false;","      return true;","    }","    for (y = cell.row - 1; vGrow(y, 'top'); y--) {}","    for (y = cell.row + 1; vGrow(y, 'bottom'); y++) {}","","    // grow horizontal - ensure all rows can grow","    function hGrow(x, edge) {","      var c, cells = [];","      for (y = range.top; y <= range.bottom; y++) {","        c = matrix.findCellAt(sheetName, y, x);","        if (c && c.mark) {","          cells.push(c);","        } else {","          return false;","        }","      }","      range[edge] = x;","      for (var i = 0; i < cells.length; i++) {","        cells[i].mark = false;","      }","      return true;","    }","    for (x = cell.col - 1; hGrow(x, 'left'); x--) {}","    for (x = cell.col + 1; hGrow(x, 'right'); x++) {}","","    return range;","  },","","  getRanges: function(name, matrix) {","    var self = this;","    matrix = matrix || this.matrixMap[name];","","    if (!matrix) {","      return { name: name, ranges: [] };","    }","","    // mark and sweep!","    matrix.forEach(function(cell) { cell.mark = true; });","    var ranges = matrix.map(function(cell) {","        return cell.mark && self._explore(matrix, cell);","      })","      .filter(function(range) { return range; })","      .map(function(range) { return range.$shortRange; });","","    return {","      name: name, ranges: ranges","    };","  },","","  get model() {","    var self = this;","    // To get names per cell - just iterate over all names finding cells if they exist","    return _.map(this.matrixMap, function(matrix, name) {","        return self.getRanges(name, matrix);","      })","      .filter(function(definedName) {","        return definedName.ranges.length;","      });","  },","  set model(value) {","    // value is [ { name, ranges }, ... ]","    var matrixMap = this.matrixMap = {};","    value.forEach(function(definedName) {","      var matrix = matrixMap[definedName.name] = new CellMatrix();","      definedName.ranges.forEach(function(rangeStr) {","        if(rangeRegexp.test(rangeStr.split('!').pop() || '')) {","          matrix.addCell(rangeStr);","        }","      });","    });","  }","};","","//<definedNames>","//  <definedName name=\"Corners\">Sheet1!$H$1,Sheet1!$H$3,Sheet1!$J$3,Sheet1!$J$1</definedName>","//  <definedName name=\"CrossSheet\">Sheet2!$A$1,Sheet1!$A$4,Sheet2!$C$1</definedName>","//  <definedName name=\"Ducks\">Sheet1!$A$1:$A$3</definedName>","//  <definedName name=\"Intersection\">Sheet1!$H$1,Sheet1!$L$1</definedName>","//</definedNames>",""],"l":{"25":1,"26":1,"27":1,"28":1,"29":1,"31":1,"32":0,"35":1,"37":0,"42":0,"43":0,"46":0,"47":0,"48":0,"49":0,"50":0,"57":0,"61":0,"66":0,"67":0,"70":0,"71":0,"74":0,"75":0,"80":0,"81":0,"82":0,"89":0,"92":0,"93":0,"94":0,"96":0,"100":0,"101":0,"103":0,"104":0,"107":1,"108":0,"109":0,"110":0,"111":0,"112":0,"114":0,"115":0,"118":1,"119":0,"120":0,"121":0,"122":0,"123":0,"125":0,"128":0,"129":0,"130":0,"132":0,"134":0,"135":0,"137":0,"141":0,"142":0,"144":0,"145":0,"149":0,"150":0,"151":0,"153":0,"154":0,"156":0,"162":0,"164":0,"165":0,"168":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/cell-matrix.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/cell-matrix.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":17},"end":{"line":30,"column":36}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":11},"end":{"line":36,"column":32}}},"3":{"name":"(anonymous_3)","line":39,"loc":{"start":{"line":39,"column":11},"end":{"line":39,"column":32}}},"4":{"name":"(anonymous_4)","line":42,"loc":{"start":{"line":42,"column":12},"end":{"line":42,"column":33}}},"5":{"name":"(anonymous_5)","line":46,"loc":{"start":{"line":46,"column":14},"end":{"line":46,"column":56}}},"6":{"name":"(anonymous_6)","line":51,"loc":{"start":{"line":51,"column":13},"end":{"line":51,"column":31}}},"7":{"name":"(anonymous_7)","line":62,"loc":{"start":{"line":62,"column":13},"end":{"line":62,"column":31}}},"8":{"name":"(anonymous_8)","line":65,"loc":{"start":{"line":65,"column":14},"end":{"line":65,"column":40}}},"9":{"name":"(anonymous_9)","line":70,"loc":{"start":{"line":70,"column":13},"end":{"line":70,"column":55}}},"10":{"name":"(anonymous_10)","line":81,"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":34}}},"11":{"name":"(anonymous_11)","line":89,"loc":{"start":{"line":89,"column":11},"end":{"line":89,"column":30}}},"12":{"name":"(anonymous_12)","line":90,"loc":{"start":{"line":90,"column":24},"end":{"line":90,"column":40}}},"13":{"name":"(anonymous_13)","line":91,"loc":{"start":{"line":91,"column":31},"end":{"line":91,"column":45}}},"14":{"name":"(anonymous_14)","line":92,"loc":{"start":{"line":92,"column":29},"end":{"line":92,"column":44}}},"15":{"name":"(anonymous_15)","line":98,"loc":{"start":{"line":98,"column":7},"end":{"line":98,"column":26}}},"16":{"name":"(anonymous_16)","line":100,"loc":{"start":{"line":100,"column":17},"end":{"line":100,"column":32}}},"17":{"name":"(anonymous_17)","line":104,"loc":{"start":{"line":104,"column":13},"end":{"line":104,"column":39}}},"18":{"name":"(anonymous_18)","line":113,"loc":{"start":{"line":113,"column":16},"end":{"line":113,"column":49}}},"19":{"name":"(anonymous_19)","line":122,"loc":{"start":{"line":122,"column":15},"end":{"line":122,"column":46}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":32}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":31}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":38}},"4":{"start":{"line":30,"column":0},"end":{"line":33,"column":2}},"5":{"start":{"line":31,"column":2},"end":{"line":31,"column":27}},"6":{"start":{"line":32,"column":2},"end":{"line":32,"column":19}},"7":{"start":{"line":35,"column":0},"end":{"line":131,"column":2}},"8":{"start":{"line":37,"column":4},"end":{"line":37,"column":50}},"9":{"start":{"line":40,"column":4},"end":{"line":40,"column":64}},"10":{"start":{"line":43,"column":4},"end":{"line":43,"column":65}},"11":{"start":{"line":47,"column":4},"end":{"line":47,"column":39}},"12":{"start":{"line":48,"column":4},"end":{"line":48,"column":40}},"13":{"start":{"line":49,"column":4},"end":{"line":49,"column":33}},"14":{"start":{"line":52,"column":4},"end":{"line":60,"column":5}},"15":{"start":{"line":53,"column":6},"end":{"line":57,"column":7}},"16":{"start":{"line":54,"column":8},"end":{"line":56,"column":9}},"17":{"start":{"line":55,"column":10},"end":{"line":55,"column":54}},"18":{"start":{"line":59,"column":6},"end":{"line":59,"column":37}},"19":{"start":{"line":63,"column":4},"end":{"line":63,"column":42}},"20":{"start":{"line":66,"column":4},"end":{"line":66,"column":48}},"21":{"start":{"line":67,"column":4},"end":{"line":67,"column":56}},"22":{"start":{"line":68,"column":4},"end":{"line":68,"column":50}},"23":{"start":{"line":71,"column":4},"end":{"line":71,"column":72}},"24":{"start":{"line":72,"column":4},"end":{"line":72,"column":58}},"25":{"start":{"line":73,"column":4},"end":{"line":78,"column":7}},"26":{"start":{"line":82,"column":4},"end":{"line":82,"column":40}},"27":{"start":{"line":83,"column":4},"end":{"line":83,"column":27}},"28":{"start":{"line":83,"column":18},"end":{"line":83,"column":25}},"29":{"start":{"line":84,"column":4},"end":{"line":84,"column":48}},"30":{"start":{"line":85,"column":4},"end":{"line":85,"column":25}},"31":{"start":{"line":85,"column":16},"end":{"line":85,"column":23}},"32":{"start":{"line":86,"column":4},"end":{"line":86,"column":28}},"33":{"start":{"line":90,"column":4},"end":{"line":96,"column":7}},"34":{"start":{"line":91,"column":6},"end":{"line":95,"column":9}},"35":{"start":{"line":91,"column":17},"end":{"line":95,"column":9}},"36":{"start":{"line":92,"column":8},"end":{"line":94,"column":11}},"37":{"start":{"line":92,"column":17},"end":{"line":94,"column":11}},"38":{"start":{"line":93,"column":10},"end":{"line":93,"column":35}},"39":{"start":{"line":93,"column":20},"end":{"line":93,"column":35}},"40":{"start":{"line":99,"column":4},"end":{"line":99,"column":21}},"41":{"start":{"line":100,"column":4},"end":{"line":100,"column":67}},"42":{"start":{"line":100,"column":34},"end":{"line":100,"column":63}},"43":{"start":{"line":101,"column":4},"end":{"line":101,"column":19}},"44":{"start":{"line":105,"column":4},"end":{"line":105,"column":33}},"45":{"start":{"line":106,"column":4},"end":{"line":108,"column":5}},"46":{"start":{"line":107,"column":6},"end":{"line":107,"column":31}},"47":{"start":{"line":109,"column":4},"end":{"line":111,"column":5}},"48":{"start":{"line":110,"column":6},"end":{"line":110,"column":38}},"49":{"start":{"line":114,"column":4},"end":{"line":114,"column":26}},"50":{"start":{"line":115,"column":4},"end":{"line":117,"column":5}},"51":{"start":{"line":116,"column":6},"end":{"line":116,"column":24}},"52":{"start":{"line":118,"column":4},"end":{"line":120,"column":5}},"53":{"start":{"line":119,"column":6},"end":{"line":119,"column":31}},"54":{"start":{"line":123,"column":4},"end":{"line":123,"column":26}},"55":{"start":{"line":124,"column":4},"end":{"line":126,"column":5}},"56":{"start":{"line":125,"column":6},"end":{"line":125,"column":22}},"57":{"start":{"line":127,"column":4},"end":{"line":129,"column":5}},"58":{"start":{"line":128,"column":6},"end":{"line":128,"column":118}},"59":{"start":{"line":133,"column":0},"end":{"line":133,"column":28}}},"branchMap":{"1":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":14},"end":{"line":48,"column":19}},{"start":{"line":48,"column":23},"end":{"line":48,"column":39}}]},"2":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":11},"end":{"line":49,"column":14}},{"start":{"line":49,"column":18},"end":{"line":49,"column":32}}]},"3":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"4":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":16},"end":{"line":71,"column":38}},{"start":{"line":71,"column":43},"end":{"line":71,"column":70}}]},"5":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":14},"end":{"line":72,"column":30}},{"start":{"line":72,"column":35},"end":{"line":72,"column":56}}]},"6":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":11},"end":{"line":73,"column":25}},{"start":{"line":73,"column":30},"end":{"line":78,"column":5}}]},"7":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":83,"column":4}},{"start":{"line":83,"column":4},"end":{"line":83,"column":4}}]},"8":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":85,"column":4}},{"start":{"line":85,"column":4},"end":{"line":85,"column":4}}]},"9":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":6},"end":{"line":91,"column":6}},{"start":{"line":91,"column":6},"end":{"line":91,"column":6}}]},"10":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":8},"end":{"line":92,"column":8}},{"start":{"line":92,"column":8},"end":{"line":92,"column":8}}]},"11":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":10},"end":{"line":93,"column":10}},{"start":{"line":93,"column":10},"end":{"line":93,"column":10}}]},"12":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":4},"end":{"line":106,"column":4}},{"start":{"line":106,"column":4},"end":{"line":106,"column":4}}]},"13":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":4},"end":{"line":109,"column":4}},{"start":{"line":109,"column":4},"end":{"line":109,"column":4}}]},"14":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":4},"end":{"line":115,"column":4}},{"start":{"line":115,"column":4},"end":{"line":115,"column":4}}]},"15":{"line":115,"type":"binary-expr","locations":[{"start":{"line":115,"column":8},"end":{"line":115,"column":13}},{"start":{"line":115,"column":17},"end":{"line":115,"column":27}}]},"16":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]},"17":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":4},"end":{"line":124,"column":4}},{"start":{"line":124,"column":4},"end":{"line":124,"column":4}}]},"18":{"line":124,"type":"binary-expr","locations":[{"start":{"line":124,"column":8},"end":{"line":124,"column":11}},{"start":{"line":124,"column":15},"end":{"line":124,"column":23}}]},"19":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":4},"end":{"line":127,"column":4}},{"start":{"line":127,"column":4},"end":{"line":127,"column":4}}]},"20":{"line":128,"type":"cond-expr","locations":[{"start":{"line":128,"column":41},"end":{"line":128,"column":106}},{"start":{"line":128,"column":109},"end":{"line":128,"column":116}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('./under-dash');","","var utils = require('./utils');","var colCache = require('./col-cache');","","var CellMatrix = function(template) {","  this.template = template;","  this.sheets = {};","};","","CellMatrix.prototype = {","  addCell: function(addressStr) {","    this.addCellEx(colCache.decodeEx(addressStr));","  },","  getCell: function(addressStr) {","    return this.findCellEx(colCache.decodeEx(addressStr), true);","  },","  findCell: function(addressStr) {","    return this.findCellEx(colCache.decodeEx(addressStr), false);","  },","","  findCellAt: function(sheetName, rowNumber, colNumber) {","    var sheet = this.sheets[sheetName];","    var row = sheet && sheet[rowNumber];","    return row && row[colNumber];","  },","  addCellEx: function(address) {","    if (address.top) {","      for (var row = address.top; row <= address.bottom; row++) {","        for (var col = address.left; col <= address.right; col++) {","          this.getCellAt(address.sheetName, row, col);","        }","      }","    } else {","      this.findCellEx(address, true);","    }","  },","  getCellEx: function(address) {","    return this.findCellEx(address, true);","  },","  findCellEx: function(address, create) {","    var sheet = this.findSheet(address, create);","    var row = this.findSheetRow(sheet, address, create);","    return this.findRowCell(row, address, create);","  },","  getCellAt: function(sheetName, rowNumber, colNumber) {","    var sheet = this.sheets[sheetName] || (this.sheets[sheetName] = []);","    var row = sheet[rowNumber] || (sheet[rowNumber] = []);","    return row[colNumber] || (row[colNumber] = {","      sheetName: sheetName,","      address: colCache.n2l(colNumber) + rowNumber,","      row: rowNumber,","      col: colNumber","    });","  },","","  removeCellEx: function(address) {","    var sheet = this.findSheet(address);","    if (!sheet) { return; }","    var row = this.findSheetRow(sheet, address);","    if (!row) { return; }","    delete row[address.col];","  },","","  forEach: function(callback) {","    _.each(this.sheets, function(sheet) {","      if (sheet) sheet.forEach(function(row) {","        if (row) row.forEach(function(cell) {","          if (cell) callback(cell);","        });","      });","    });","  },","  map: function(callback) {","    var results = [];","    this.forEach(function(cell) { results.push(callback(cell)); });","    return results;","  },","","  findSheet: function(address, create) {","    var name = address.sheetName;","    if (this.sheets[name]) {","      return this.sheets[name];","    }","    if (create) {","      return (this.sheets[name] = []);","    }","  },","  findSheetRow: function(sheet, address, create) {","    var row = address.row;","    if (sheet && sheet[row]) {","      return sheet[row];","    }","    if (create) {","      return (sheet[row] = []);","    }","  },","  findRowCell: function(row, address, create) {","    var col = address.col;","    if (row && row[col]) {","      return row[col];","    }","    if (create) {","      return (row[col] = this.template ? Object.assign(address, JSON.parse(JSON.stringify(this.template))) : address);","    }","  }","};","","module.exports = CellMatrix;"],"l":{"25":1,"27":1,"28":1,"30":1,"31":0,"32":0,"35":1,"37":0,"40":0,"43":0,"47":0,"48":0,"49":0,"52":0,"53":0,"54":0,"55":0,"59":0,"63":0,"66":0,"67":0,"68":0,"71":0,"72":0,"73":0,"82":0,"83":0,"84":0,"85":0,"86":0,"90":0,"91":0,"92":0,"93":0,"99":0,"100":0,"101":0,"105":0,"106":0,"107":0,"109":0,"110":0,"114":0,"115":0,"116":0,"118":0,"119":0,"123":0,"124":0,"125":0,"127":0,"128":0,"133":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xlsx.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xlsx.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":2,"18":1,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0,0,0,0,0,0],"7":[0,0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0]},"f":{"1":2,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0},"fnMap":{"1":{"name":"(anonymous_1)","line":45,"loc":{"start":{"line":45,"column":28},"end":{"line":45,"column":48}}},"2":{"name":"(anonymous_2)","line":60,"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":32}}},"3":{"name":"(anonymous_3)","line":64,"loc":{"start":{"line":64,"column":12},"end":{"line":64,"column":30}}},"4":{"name":"(anonymous_4)","line":71,"loc":{"start":{"line":71,"column":12},"end":{"line":71,"column":32}}},"5":{"name":"(anonymous_5)","line":76,"loc":{"start":{"line":76,"column":13},"end":{"line":76,"column":31}}},"6":{"name":"(anonymous_6)","line":80,"loc":{"start":{"line":80,"column":17},"end":{"line":80,"column":35}}},"7":{"name":"(anonymous_7)","line":84,"loc":{"start":{"line":84,"column":22},"end":{"line":84,"column":40}}},"8":{"name":"(anonymous_8)","line":88,"loc":{"start":{"line":88,"column":13},"end":{"line":88,"column":30}}},"9":{"name":"(anonymous_9)","line":98,"loc":{"start":{"line":98,"column":29},"end":{"line":98,"column":50}}},"10":{"name":"(anonymous_10)","line":112,"loc":{"start":{"line":112,"column":25},"end":{"line":112,"column":48}}},"11":{"name":"(anonymous_11)","line":118,"loc":{"start":{"line":118,"column":14},"end":{"line":118,"column":35}}},"12":{"name":"(anonymous_12)","line":125,"loc":{"start":{"line":125,"column":29},"end":{"line":125,"column":52}}},"13":{"name":"(anonymous_13)","line":131,"loc":{"start":{"line":131,"column":14},"end":{"line":131,"column":38}}},"14":{"name":"(anonymous_14)","line":136,"loc":{"start":{"line":136,"column":21},"end":{"line":136,"column":44}}},"15":{"name":"(anonymous_15)","line":139,"loc":{"start":{"line":139,"column":36},"end":{"line":139,"column":62}}},"16":{"name":"(anonymous_16)","line":145,"loc":{"start":{"line":145,"column":28},"end":{"line":145,"column":39}}},"17":{"name":"(anonymous_17)","line":153,"loc":{"start":{"line":153,"column":22},"end":{"line":153,"column":38}}},"18":{"name":"(anonymous_18)","line":156,"loc":{"start":{"line":156,"column":21},"end":{"line":156,"column":33}}},"19":{"name":"(anonymous_19)","line":168,"loc":{"start":{"line":168,"column":23},"end":{"line":168,"column":40}}},"20":{"name":"(anonymous_20)","line":178,"loc":{"start":{"line":178,"column":18},"end":{"line":178,"column":43}}},"21":{"name":"(anonymous_21)","line":185,"loc":{"start":{"line":185,"column":18},"end":{"line":185,"column":38}}},"22":{"name":"(anonymous_22)","line":195,"loc":{"start":{"line":195,"column":18},"end":{"line":195,"column":43}}},"23":{"name":"(anonymous_23)","line":213,"loc":{"start":{"line":213,"column":18},"end":{"line":213,"column":42}}},"24":{"name":"(anonymous_24)","line":224,"loc":{"start":{"line":224,"column":18},"end":{"line":224,"column":43}}},"25":{"name":"(anonymous_25)","line":243,"loc":{"start":{"line":243,"column":26},"end":{"line":243,"column":38}}},"26":{"name":"(anonymous_26)","line":245,"loc":{"start":{"line":245,"column":14},"end":{"line":245,"column":26}}},"27":{"name":"(anonymous_27)","line":251,"loc":{"start":{"line":251,"column":14},"end":{"line":251,"column":26}}},"28":{"name":"(anonymous_28)","line":254,"loc":{"start":{"line":254,"column":15},"end":{"line":254,"column":32}}},"29":{"name":"(anonymous_29)","line":261,"loc":{"start":{"line":261,"column":8},"end":{"line":261,"column":26}}},"30":{"name":"(anonymous_30)","line":264,"loc":{"start":{"line":264,"column":34},"end":{"line":264,"column":60}}},"31":{"name":"(anonymous_31)","line":265,"loc":{"start":{"line":265,"column":27},"end":{"line":265,"column":39}}},"32":{"name":"(anonymous_32)","line":267,"loc":{"start":{"line":267,"column":21},"end":{"line":267,"column":38}}},"33":{"name":"(anonymous_33)","line":274,"loc":{"start":{"line":274,"column":8},"end":{"line":274,"column":32}}},"34":{"name":"(anonymous_34)","line":280,"loc":{"start":{"line":280,"column":34},"end":{"line":280,"column":60}}},"35":{"name":"(anonymous_35)","line":281,"loc":{"start":{"line":281,"column":27},"end":{"line":281,"column":39}}},"36":{"name":"(anonymous_36)","line":283,"loc":{"start":{"line":283,"column":21},"end":{"line":283,"column":38}}},"37":{"name":"(anonymous_37)","line":300,"loc":{"start":{"line":300,"column":19},"end":{"line":300,"column":41}}},"38":{"name":"(anonymous_38)","line":301,"loc":{"start":{"line":301,"column":34},"end":{"line":301,"column":52}}},"39":{"name":"(anonymous_39)","line":309,"loc":{"start":{"line":309,"column":10},"end":{"line":309,"column":32}}},"40":{"name":"(anonymous_40)","line":310,"loc":{"start":{"line":310,"column":34},"end":{"line":310,"column":52}}},"41":{"name":"(anonymous_41)","line":318,"loc":{"start":{"line":318,"column":11},"end":{"line":318,"column":33}}},"42":{"name":"(anonymous_42)","line":319,"loc":{"start":{"line":319,"column":34},"end":{"line":319,"column":52}}},"43":{"name":"(anonymous_43)","line":326,"loc":{"start":{"line":326,"column":13},"end":{"line":326,"column":35}}},"44":{"name":"(anonymous_44)","line":327,"loc":{"start":{"line":327,"column":34},"end":{"line":327,"column":52}}},"45":{"name":"(anonymous_45)","line":329,"loc":{"start":{"line":329,"column":34},"end":{"line":329,"column":49}}},"46":{"name":"(anonymous_46)","line":338,"loc":{"start":{"line":338,"column":17},"end":{"line":338,"column":32}}},"47":{"name":"(anonymous_47)","line":339,"loc":{"start":{"line":339,"column":34},"end":{"line":339,"column":52}}},"48":{"name":"(anonymous_48)","line":349,"loc":{"start":{"line":349,"column":19},"end":{"line":349,"column":41}}},"49":{"name":"(anonymous_49)","line":360,"loc":{"start":{"line":360,"column":29},"end":{"line":360,"column":50}}},"50":{"name":"(anonymous_50)","line":366,"loc":{"start":{"line":366,"column":34},"end":{"line":366,"column":52}}},"51":{"name":"(anonymous_51)","line":373,"loc":{"start":{"line":373,"column":20},"end":{"line":373,"column":42}}},"52":{"name":"(anonymous_52)","line":377,"loc":{"start":{"line":377,"column":36},"end":{"line":377,"column":54}}},"53":{"name":"(anonymous_53)","line":383,"loc":{"start":{"line":383,"column":13},"end":{"line":383,"column":34}}},"54":{"name":"(anonymous_54)","line":384,"loc":{"start":{"line":384,"column":34},"end":{"line":384,"column":52}}},"55":{"name":"(anonymous_55)","line":392,"loc":{"start":{"line":392,"column":15},"end":{"line":392,"column":44}}},"56":{"name":"(anonymous_56)","line":393,"loc":{"start":{"line":393,"column":34},"end":{"line":393,"column":52}}},"57":{"name":"(anonymous_57)","line":398,"loc":{"start":{"line":398,"column":17},"end":{"line":398,"column":55}}},"58":{"name":"(anonymous_58)","line":399,"loc":{"start":{"line":399,"column":34},"end":{"line":399,"column":52}}},"59":{"name":"(anonymous_59)","line":405,"loc":{"start":{"line":405,"column":31},"end":{"line":405,"column":52}}},"60":{"name":"(anonymous_60)","line":420,"loc":{"start":{"line":420,"column":13},"end":{"line":420,"column":28}}},"61":{"name":"(anonymous_61)","line":423,"loc":{"start":{"line":423,"column":34},"end":{"line":423,"column":60}}},"62":{"name":"(anonymous_62)","line":425,"loc":{"start":{"line":425,"column":23},"end":{"line":425,"column":35}}},"63":{"name":"(anonymous_63)","line":428,"loc":{"start":{"line":428,"column":22},"end":{"line":428,"column":39}}},"64":{"name":"(anonymous_64)","line":435,"loc":{"start":{"line":435,"column":9},"end":{"line":435,"column":36}}},"65":{"name":"(anonymous_65)","line":470,"loc":{"start":{"line":470,"column":29},"end":{"line":470,"column":50}}},"66":{"name":"(anonymous_66)","line":483,"loc":{"start":{"line":483,"column":12},"end":{"line":483,"column":24}}},"67":{"name":"(anonymous_67)","line":486,"loc":{"start":{"line":486,"column":12},"end":{"line":486,"column":24}}},"68":{"name":"(anonymous_68)","line":495,"loc":{"start":{"line":495,"column":12},"end":{"line":495,"column":24}}},"69":{"name":"(anonymous_69)","line":498,"loc":{"start":{"line":498,"column":12},"end":{"line":498,"column":24}}},"70":{"name":"(anonymous_70)","line":502,"loc":{"start":{"line":502,"column":13},"end":{"line":502,"column":42}}},"71":{"name":"(anonymous_71)","line":506,"loc":{"start":{"line":506,"column":34},"end":{"line":506,"column":60}}},"72":{"name":"(anonymous_72)","line":507,"loc":{"start":{"line":507,"column":26},"end":{"line":507,"column":38}}},"73":{"name":"(anonymous_73)","line":510,"loc":{"start":{"line":510,"column":25},"end":{"line":510,"column":42}}},"74":{"name":"(anonymous_74)","line":515,"loc":{"start":{"line":515,"column":14},"end":{"line":515,"column":26}}},"75":{"name":"(anonymous_75)","line":518,"loc":{"start":{"line":518,"column":15},"end":{"line":518,"column":32}}},"76":{"name":"(anonymous_76)","line":523,"loc":{"start":{"line":523,"column":15},"end":{"line":523,"column":33}}},"77":{"name":"(anonymous_77)","line":527,"loc":{"start":{"line":527,"column":12},"end":{"line":527,"column":23}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":23}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":47}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":47}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":45}},"5":{"start":{"line":30,"column":0},"end":{"line":30,"column":38}},"6":{"start":{"line":31,"column":0},"end":{"line":31,"column":47}},"7":{"start":{"line":33,"column":0},"end":{"line":33,"column":56}},"8":{"start":{"line":35,"column":0},"end":{"line":35,"column":51}},"9":{"start":{"line":36,"column":0},"end":{"line":36,"column":73}},"10":{"start":{"line":37,"column":0},"end":{"line":37,"column":69}},"11":{"start":{"line":38,"column":0},"end":{"line":38,"column":68}},"12":{"start":{"line":39,"column":0},"end":{"line":39,"column":49}},"13":{"start":{"line":40,"column":0},"end":{"line":40,"column":59}},"14":{"start":{"line":41,"column":0},"end":{"line":41,"column":62}},"15":{"start":{"line":43,"column":0},"end":{"line":43,"column":47}},"16":{"start":{"line":45,"column":0},"end":{"line":47,"column":2}},"17":{"start":{"line":46,"column":2},"end":{"line":46,"column":27}},"18":{"start":{"line":50,"column":0},"end":{"line":50,"column":37}},"19":{"start":{"line":53,"column":0},"end":{"line":531,"column":2}},"20":{"start":{"line":61,"column":4},"end":{"line":61,"column":20}},"21":{"start":{"line":62,"column":4},"end":{"line":62,"column":15}},"22":{"start":{"line":63,"column":4},"end":{"line":74,"column":9}},"23":{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},"24":{"start":{"line":66,"column":10},"end":{"line":66,"column":57}},"25":{"start":{"line":68,"column":8},"end":{"line":68,"column":47}},"26":{"start":{"line":69,"column":8},"end":{"line":69,"column":33}},"27":{"start":{"line":72,"column":8},"end":{"line":72,"column":23}},"28":{"start":{"line":73,"column":8},"end":{"line":73,"column":24}},"29":{"start":{"line":77,"column":4},"end":{"line":77,"column":41}},"30":{"start":{"line":78,"column":4},"end":{"line":78,"column":37}},"31":{"start":{"line":81,"column":4},"end":{"line":81,"column":36}},"32":{"start":{"line":82,"column":4},"end":{"line":82,"column":37}},"33":{"start":{"line":85,"column":4},"end":{"line":85,"column":41}},"34":{"start":{"line":86,"column":4},"end":{"line":86,"column":37}},"35":{"start":{"line":89,"column":4},"end":{"line":89,"column":44}},"36":{"start":{"line":90,"column":4},"end":{"line":90,"column":46}},"37":{"start":{"line":92,"column":4},"end":{"line":92,"column":35}},"38":{"start":{"line":93,"column":4},"end":{"line":97,"column":6}},"39":{"start":{"line":98,"column":4},"end":{"line":101,"column":7}},"40":{"start":{"line":99,"column":6},"end":{"line":99,"column":71}},"41":{"start":{"line":100,"column":6},"end":{"line":100,"column":56}},"42":{"start":{"line":104,"column":4},"end":{"line":104,"column":36}},"43":{"start":{"line":105,"column":4},"end":{"line":105,"column":36}},"44":{"start":{"line":106,"column":4},"end":{"line":106,"column":33}},"45":{"start":{"line":107,"column":4},"end":{"line":107,"column":36}},"46":{"start":{"line":108,"column":4},"end":{"line":108,"column":35}},"47":{"start":{"line":109,"column":4},"end":{"line":109,"column":32}},"48":{"start":{"line":110,"column":4},"end":{"line":110,"column":29}},"49":{"start":{"line":113,"column":4},"end":{"line":113,"column":68}},"50":{"start":{"line":114,"column":4},"end":{"line":123,"column":5}},"51":{"start":{"line":115,"column":6},"end":{"line":115,"column":29}},"52":{"start":{"line":116,"column":6},"end":{"line":116,"column":39}},"53":{"start":{"line":117,"column":6},"end":{"line":122,"column":11}},"54":{"start":{"line":119,"column":10},"end":{"line":119,"column":38}},"55":{"start":{"line":120,"column":10},"end":{"line":120,"column":54}},"56":{"start":{"line":121,"column":10},"end":{"line":121,"column":43}},"57":{"start":{"line":126,"column":4},"end":{"line":126,"column":80}},"58":{"start":{"line":127,"column":4},"end":{"line":134,"column":5}},"59":{"start":{"line":128,"column":6},"end":{"line":128,"column":29}},"60":{"start":{"line":129,"column":6},"end":{"line":129,"column":43}},"61":{"start":{"line":130,"column":6},"end":{"line":133,"column":11}},"62":{"start":{"line":132,"column":10},"end":{"line":132,"column":55}},"63":{"start":{"line":137,"column":4},"end":{"line":137,"column":67}},"64":{"start":{"line":138,"column":4},"end":{"line":151,"column":5}},"65":{"start":{"line":139,"column":6},"end":{"line":150,"column":9}},"66":{"start":{"line":140,"column":8},"end":{"line":140,"column":28}},"67":{"start":{"line":142,"column":8},"end":{"line":142,"column":37}},"68":{"start":{"line":143,"column":8},"end":{"line":143,"column":34}},"69":{"start":{"line":144,"column":8},"end":{"line":144,"column":35}},"70":{"start":{"line":145,"column":8},"end":{"line":148,"column":11}},"71":{"start":{"line":146,"column":10},"end":{"line":146,"column":56}},"72":{"start":{"line":147,"column":10},"end":{"line":147,"column":20}},"73":{"start":{"line":149,"column":8},"end":{"line":149,"column":27}},"74":{"start":{"line":154,"column":4},"end":{"line":154,"column":22}},"75":{"start":{"line":157,"column":4},"end":{"line":157,"column":20}},"76":{"start":{"line":158,"column":4},"end":{"line":163,"column":6}},"77":{"start":{"line":166,"column":4},"end":{"line":166,"column":22}},"78":{"start":{"line":167,"column":4},"end":{"line":167,"column":43}},"79":{"start":{"line":168,"column":4},"end":{"line":242,"column":7}},"80":{"start":{"line":169,"column":6},"end":{"line":169,"column":25}},"81":{"start":{"line":171,"column":6},"end":{"line":171,"column":33}},"82":{"start":{"line":172,"column":6},"end":{"line":174,"column":7}},"83":{"start":{"line":173,"column":8},"end":{"line":173,"column":40}},"84":{"start":{"line":175,"column":6},"end":{"line":236,"column":7}},"85":{"start":{"line":177,"column":10},"end":{"line":180,"column":15}},"86":{"start":{"line":179,"column":14},"end":{"line":179,"column":47}},"87":{"start":{"line":181,"column":10},"end":{"line":181,"column":16}},"88":{"start":{"line":184,"column":10},"end":{"line":190,"column":15}},"89":{"start":{"line":186,"column":14},"end":{"line":186,"column":45}},"90":{"start":{"line":187,"column":14},"end":{"line":187,"column":57}},"91":{"start":{"line":188,"column":14},"end":{"line":188,"column":43}},"92":{"start":{"line":189,"column":14},"end":{"line":189,"column":53}},"93":{"start":{"line":191,"column":10},"end":{"line":191,"column":16}},"94":{"start":{"line":194,"column":10},"end":{"line":197,"column":15}},"95":{"start":{"line":196,"column":14},"end":{"line":196,"column":49}},"96":{"start":{"line":198,"column":10},"end":{"line":198,"column":16}},"97":{"start":{"line":201,"column":10},"end":{"line":201,"column":57}},"98":{"start":{"line":202,"column":10},"end":{"line":202,"column":59}},"99":{"start":{"line":203,"column":10},"end":{"line":203,"column":16}},"100":{"start":{"line":206,"column":10},"end":{"line":206,"column":43}},"101":{"start":{"line":207,"column":10},"end":{"line":207,"column":52}},"102":{"start":{"line":208,"column":10},"end":{"line":208,"column":16}},"103":{"start":{"line":211,"column":10},"end":{"line":211,"column":40}},"104":{"start":{"line":212,"column":10},"end":{"line":218,"column":15}},"105":{"start":{"line":214,"column":14},"end":{"line":217,"column":17}},"106":{"start":{"line":219,"column":10},"end":{"line":219,"column":16}},"107":{"start":{"line":222,"column":10},"end":{"line":222,"column":42}},"108":{"start":{"line":223,"column":10},"end":{"line":226,"column":15}},"109":{"start":{"line":225,"column":14},"end":{"line":225,"column":51}},"110":{"start":{"line":227,"column":10},"end":{"line":227,"column":16}},"111":{"start":{"line":230,"column":10},"end":{"line":234,"column":43}},"112":{"start":{"line":235,"column":10},"end":{"line":235,"column":16}},"113":{"start":{"line":238,"column":6},"end":{"line":241,"column":7}},"114":{"start":{"line":239,"column":8},"end":{"line":239,"column":31}},"115":{"start":{"line":240,"column":8},"end":{"line":240,"column":23}},"116":{"start":{"line":243,"column":4},"end":{"line":257,"column":7}},"117":{"start":{"line":244,"column":6},"end":{"line":256,"column":11}},"118":{"start":{"line":246,"column":10},"end":{"line":246,"column":32}},"119":{"start":{"line":249,"column":10},"end":{"line":249,"column":38}},"120":{"start":{"line":252,"column":10},"end":{"line":252,"column":30}},"121":{"start":{"line":255,"column":10},"end":{"line":255,"column":38}},"122":{"start":{"line":258,"column":4},"end":{"line":258,"column":18}},"123":{"start":{"line":262,"column":4},"end":{"line":262,"column":20}},"124":{"start":{"line":263,"column":4},"end":{"line":263,"column":45}},"125":{"start":{"line":264,"column":4},"end":{"line":271,"column":7}},"126":{"start":{"line":265,"column":6},"end":{"line":269,"column":9}},"127":{"start":{"line":266,"column":8},"end":{"line":266,"column":31}},"128":{"start":{"line":268,"column":8},"end":{"line":268,"column":22}},"129":{"start":{"line":270,"column":6},"end":{"line":270,"column":29}},"130":{"start":{"line":275,"column":4},"end":{"line":275,"column":20}},"131":{"start":{"line":276,"column":4},"end":{"line":278,"column":5}},"132":{"start":{"line":277,"column":6},"end":{"line":277,"column":19}},"133":{"start":{"line":279,"column":4},"end":{"line":279,"column":45}},"134":{"start":{"line":280,"column":4},"end":{"line":294,"column":7}},"135":{"start":{"line":281,"column":6},"end":{"line":285,"column":9}},"136":{"start":{"line":282,"column":8},"end":{"line":282,"column":31}},"137":{"start":{"line":284,"column":8},"end":{"line":284,"column":22}},"138":{"start":{"line":287,"column":6},"end":{"line":292,"column":7}},"139":{"start":{"line":288,"column":8},"end":{"line":288,"column":59}},"140":{"start":{"line":289,"column":8},"end":{"line":289,"column":32}},"141":{"start":{"line":291,"column":8},"end":{"line":291,"column":30}},"142":{"start":{"line":293,"column":6},"end":{"line":293,"column":22}},"143":{"start":{"line":301,"column":4},"end":{"line":306,"column":7}},"144":{"start":{"line":302,"column":6},"end":{"line":302,"column":42}},"145":{"start":{"line":303,"column":6},"end":{"line":303,"column":35}},"146":{"start":{"line":304,"column":6},"end":{"line":304,"column":53}},"147":{"start":{"line":305,"column":6},"end":{"line":305,"column":16}},"148":{"start":{"line":310,"column":4},"end":{"line":315,"column":7}},"149":{"start":{"line":311,"column":6},"end":{"line":311,"column":33}},"150":{"start":{"line":312,"column":6},"end":{"line":312,"column":35}},"151":{"start":{"line":313,"column":6},"end":{"line":313,"column":50}},"152":{"start":{"line":314,"column":6},"end":{"line":314,"column":16}},"153":{"start":{"line":319,"column":4},"end":{"line":323,"column":7}},"154":{"start":{"line":320,"column":6},"end":{"line":320,"column":38}},"155":{"start":{"line":321,"column":6},"end":{"line":321,"column":70}},"156":{"start":{"line":322,"column":6},"end":{"line":322,"column":16}},"157":{"start":{"line":327,"column":4},"end":{"line":335,"column":7}},"158":{"start":{"line":328,"column":6},"end":{"line":328,"column":57}},"159":{"start":{"line":329,"column":6},"end":{"line":333,"column":9}},"160":{"start":{"line":330,"column":8},"end":{"line":330,"column":31}},"161":{"start":{"line":331,"column":8},"end":{"line":331,"column":47}},"162":{"start":{"line":332,"column":8},"end":{"line":332,"column":38}},"163":{"start":{"line":334,"column":6},"end":{"line":334,"column":16}},"164":{"start":{"line":339,"column":4},"end":{"line":346,"column":7}},"165":{"start":{"line":340,"column":6},"end":{"line":340,"column":43}},"166":{"start":{"line":341,"column":6},"end":{"line":343,"column":11}},"167":{"start":{"line":344,"column":6},"end":{"line":344,"column":45}},"168":{"start":{"line":345,"column":6},"end":{"line":345,"column":16}},"169":{"start":{"line":350,"column":4},"end":{"line":350,"column":18}},"170":{"start":{"line":351,"column":4},"end":{"line":354,"column":6}},"171":{"start":{"line":355,"column":4},"end":{"line":359,"column":5}},"172":{"start":{"line":356,"column":6},"end":{"line":358,"column":8}},"173":{"start":{"line":360,"column":4},"end":{"line":365,"column":7}},"174":{"start":{"line":361,"column":6},"end":{"line":361,"column":40}},"175":{"start":{"line":362,"column":6},"end":{"line":364,"column":8}},"176":{"start":{"line":366,"column":4},"end":{"line":371,"column":7}},"177":{"start":{"line":367,"column":6},"end":{"line":367,"column":43}},"178":{"start":{"line":368,"column":6},"end":{"line":368,"column":43}},"179":{"start":{"line":369,"column":6},"end":{"line":369,"column":60}},"180":{"start":{"line":370,"column":6},"end":{"line":370,"column":16}},"181":{"start":{"line":374,"column":4},"end":{"line":381,"column":5}},"182":{"start":{"line":375,"column":6},"end":{"line":375,"column":42}},"183":{"start":{"line":377,"column":6},"end":{"line":380,"column":9}},"184":{"start":{"line":378,"column":8},"end":{"line":378,"column":76}},"185":{"start":{"line":379,"column":8},"end":{"line":379,"column":18}},"186":{"start":{"line":384,"column":4},"end":{"line":390,"column":7}},"187":{"start":{"line":385,"column":6},"end":{"line":385,"column":33}},"188":{"start":{"line":386,"column":6},"end":{"line":388,"column":7}},"189":{"start":{"line":387,"column":8},"end":{"line":387,"column":49}},"190":{"start":{"line":389,"column":6},"end":{"line":389,"column":16}},"191":{"start":{"line":393,"column":4},"end":{"line":396,"column":7}},"192":{"start":{"line":394,"column":6},"end":{"line":394,"column":64}},"193":{"start":{"line":395,"column":6},"end":{"line":395,"column":16}},"194":{"start":{"line":399,"column":4},"end":{"line":418,"column":7}},"195":{"start":{"line":402,"column":6},"end":{"line":402,"column":56}},"196":{"start":{"line":405,"column":6},"end":{"line":415,"column":9}},"197":{"start":{"line":406,"column":8},"end":{"line":406,"column":40}},"198":{"start":{"line":407,"column":8},"end":{"line":407,"column":52}},"199":{"start":{"line":408,"column":8},"end":{"line":408,"column":89}},"200":{"start":{"line":410,"column":8},"end":{"line":414,"column":9}},"201":{"start":{"line":411,"column":10},"end":{"line":411,"column":38}},"202":{"start":{"line":412,"column":10},"end":{"line":412,"column":69}},"203":{"start":{"line":413,"column":10},"end":{"line":413,"column":102}},"204":{"start":{"line":417,"column":6},"end":{"line":417,"column":16}},"205":{"start":{"line":421,"column":4},"end":{"line":421,"column":20}},"206":{"start":{"line":423,"column":4},"end":{"line":433,"column":7}},"207":{"start":{"line":425,"column":6},"end":{"line":427,"column":9}},"208":{"start":{"line":426,"column":8},"end":{"line":426,"column":22}},"209":{"start":{"line":428,"column":6},"end":{"line":430,"column":9}},"210":{"start":{"line":429,"column":8},"end":{"line":429,"column":22}},"211":{"start":{"line":432,"column":6},"end":{"line":432,"column":21}},"212":{"start":{"line":436,"column":4},"end":{"line":436,"column":28}},"213":{"start":{"line":437,"column":4},"end":{"line":437,"column":20}},"214":{"start":{"line":438,"column":4},"end":{"line":438,"column":36}},"215":{"start":{"line":439,"column":4},"end":{"line":439,"column":40}},"216":{"start":{"line":440,"column":4},"end":{"line":440,"column":21}},"217":{"start":{"line":443,"column":4},"end":{"line":443,"column":47}},"218":{"start":{"line":444,"column":4},"end":{"line":444,"column":61}},"219":{"start":{"line":445,"column":4},"end":{"line":445,"column":48}},"220":{"start":{"line":446,"column":4},"end":{"line":446,"column":50}},"221":{"start":{"line":448,"column":4},"end":{"line":450,"column":11}},"222":{"start":{"line":451,"column":4},"end":{"line":453,"column":11}},"223":{"start":{"line":456,"column":4},"end":{"line":456,"column":51}},"224":{"start":{"line":459,"column":4},"end":{"line":459,"column":84}},"225":{"start":{"line":462,"column":4},"end":{"line":462,"column":44}},"226":{"start":{"line":463,"column":4},"end":{"line":463,"column":46}},"227":{"start":{"line":464,"column":4},"end":{"line":468,"column":6}},"228":{"start":{"line":469,"column":4},"end":{"line":469,"column":33}},"229":{"start":{"line":470,"column":4},"end":{"line":472,"column":7}},"230":{"start":{"line":471,"column":6},"end":{"line":471,"column":56}},"231":{"start":{"line":475,"column":4},"end":{"line":481,"column":6}},"232":{"start":{"line":482,"column":4},"end":{"line":500,"column":9}},"233":{"start":{"line":484,"column":8},"end":{"line":484,"column":62}},"234":{"start":{"line":488,"column":8},"end":{"line":492,"column":10}},"235":{"start":{"line":493,"column":8},"end":{"line":493,"column":46}},"236":{"start":{"line":496,"column":8},"end":{"line":496,"column":59}},"237":{"start":{"line":499,"column":8},"end":{"line":499,"column":35}},"238":{"start":{"line":503,"column":4},"end":{"line":503,"column":20}},"239":{"start":{"line":504,"column":4},"end":{"line":504,"column":48}},"240":{"start":{"line":506,"column":4},"end":{"line":521,"column":7}},"241":{"start":{"line":507,"column":6},"end":{"line":509,"column":9}},"242":{"start":{"line":508,"column":8},"end":{"line":508,"column":18}},"243":{"start":{"line":510,"column":6},"end":{"line":512,"column":9}},"244":{"start":{"line":511,"column":8},"end":{"line":511,"column":22}},"245":{"start":{"line":514,"column":6},"end":{"line":520,"column":11}},"246":{"start":{"line":516,"column":10},"end":{"line":516,"column":23}},"247":{"start":{"line":519,"column":10},"end":{"line":519,"column":24}},"248":{"start":{"line":524,"column":4},"end":{"line":524,"column":20}},"249":{"start":{"line":525,"column":4},"end":{"line":525,"column":33}},"250":{"start":{"line":526,"column":4},"end":{"line":529,"column":9}},"251":{"start":{"line":528,"column":8},"end":{"line":528,"column":29}}},"branchMap":{"1":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":8}},{"start":{"line":65,"column":8},"end":{"line":65,"column":8}}]},"2":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":4},"end":{"line":114,"column":4}},{"start":{"line":114,"column":4},"end":{"line":114,"column":4}}]},"3":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":4},"end":{"line":127,"column":4}},{"start":{"line":127,"column":4},"end":{"line":127,"column":4}}]},"4":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":4},"end":{"line":138,"column":4}},{"start":{"line":138,"column":4},"end":{"line":138,"column":4}}]},"5":{"line":172,"type":"if","locations":[{"start":{"line":172,"column":6},"end":{"line":172,"column":6}},{"start":{"line":172,"column":6},"end":{"line":172,"column":6}}]},"6":{"line":175,"type":"switch","locations":[{"start":{"line":176,"column":8},"end":{"line":181,"column":16}},{"start":{"line":183,"column":8},"end":{"line":191,"column":16}},{"start":{"line":193,"column":8},"end":{"line":198,"column":16}},{"start":{"line":200,"column":8},"end":{"line":203,"column":16}},{"start":{"line":205,"column":8},"end":{"line":208,"column":16}},{"start":{"line":210,"column":8},"end":{"line":219,"column":16}},{"start":{"line":221,"column":8},"end":{"line":227,"column":16}},{"start":{"line":229,"column":8},"end":{"line":235,"column":16}}]},"7":{"line":231,"type":"binary-expr","locations":[{"start":{"line":231,"column":12},"end":{"line":231,"column":52}},{"start":{"line":232,"column":12},"end":{"line":232,"column":56}},{"start":{"line":233,"column":12},"end":{"line":233,"column":48}},{"start":{"line":234,"column":12},"end":{"line":234,"column":42}}]},"8":{"line":238,"type":"if","locations":[{"start":{"line":238,"column":6},"end":{"line":238,"column":6}},{"start":{"line":238,"column":6},"end":{"line":238,"column":6}}]},"9":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":4},"end":{"line":276,"column":4}},{"start":{"line":276,"column":4},"end":{"line":276,"column":4}}]},"10":{"line":287,"type":"if","locations":[{"start":{"line":287,"column":6},"end":{"line":287,"column":6}},{"start":{"line":287,"column":6},"end":{"line":287,"column":6}}]},"11":{"line":328,"type":"binary-expr","locations":[{"start":{"line":328,"column":19},"end":{"line":328,"column":31}},{"start":{"line":328,"column":35},"end":{"line":328,"column":56}}]},"12":{"line":355,"type":"if","locations":[{"start":{"line":355,"column":4},"end":{"line":355,"column":4}},{"start":{"line":355,"column":4},"end":{"line":355,"column":4}}]},"13":{"line":374,"type":"if","locations":[{"start":{"line":374,"column":4},"end":{"line":374,"column":4}},{"start":{"line":374,"column":4},"end":{"line":374,"column":4}}]},"14":{"line":374,"type":"binary-expr","locations":[{"start":{"line":374,"column":8},"end":{"line":374,"column":28}},{"start":{"line":374,"column":32},"end":{"line":374,"column":58}}]},"15":{"line":386,"type":"if","locations":[{"start":{"line":386,"column":6},"end":{"line":386,"column":6}},{"start":{"line":386,"column":6},"end":{"line":386,"column":6}}]},"16":{"line":410,"type":"if","locations":[{"start":{"line":410,"column":8},"end":{"line":410,"column":8}},{"start":{"line":410,"column":8},"end":{"line":410,"column":8}}]},"17":{"line":410,"type":"binary-expr","locations":[{"start":{"line":410,"column":12},"end":{"line":410,"column":32}},{"start":{"line":410,"column":36},"end":{"line":410,"column":63}}]},"18":{"line":436,"type":"binary-expr","locations":[{"start":{"line":436,"column":14},"end":{"line":436,"column":21}},{"start":{"line":436,"column":25},"end":{"line":436,"column":27}}]},"19":{"line":443,"type":"binary-expr","locations":[{"start":{"line":443,"column":20},"end":{"line":443,"column":33}},{"start":{"line":443,"column":37},"end":{"line":443,"column":46}}]},"20":{"line":444,"type":"binary-expr","locations":[{"start":{"line":444,"column":27},"end":{"line":444,"column":47}},{"start":{"line":444,"column":51},"end":{"line":444,"column":60}}]},"21":{"line":445,"type":"binary-expr","locations":[{"start":{"line":445,"column":20},"end":{"line":445,"column":33}},{"start":{"line":445,"column":37},"end":{"line":445,"column":47}}]},"22":{"line":446,"type":"binary-expr","locations":[{"start":{"line":446,"column":21},"end":{"line":446,"column":35}},{"start":{"line":446,"column":39},"end":{"line":446,"column":49}}]},"23":{"line":448,"type":"cond-expr","locations":[{"start":{"line":449,"column":6},"end":{"line":449,"column":30}},{"start":{"line":450,"column":6},"end":{"line":450,"column":10}}]},"24":{"line":451,"type":"cond-expr","locations":[{"start":{"line":452,"column":6},"end":{"line":452,"column":23}},{"start":{"line":453,"column":6},"end":{"line":453,"column":10}}]},"25":{"line":459,"type":"cond-expr","locations":[{"start":{"line":459,"column":37},"end":{"line":459,"column":58}},{"start":{"line":459,"column":61},"end":{"line":459,"column":83}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var fs = require('fs');","var ZipStream = require('../utils/zip-stream');","var StreamBuf = require('../utils/stream-buf');","var PromishLib = require('../utils/promish');","","var utils = require('../utils/utils');","var XmlStream = require('../utils/xml-stream');","","var StylesXform = require('./xform/style/styles-xform');","","var CoreXform = require('./xform/core/core-xform');","var SharedStringsXform = require('./xform/strings/shared-strings-xform');","var RelationshipsXform = require('./xform/core/relationships-xform');","var ContentTypesXform = require('./xform/core/content-types-xform');","var AppXform = require('./xform/core/app-xform');","var WorkbookXform = require('./xform/book/workbook-xform');","var WorksheetXform = require('./xform/sheet/worksheet-xform');","","var theme1Xml = require('./xml/theme1.xml.js');","","var XLSX = module.exports = function (workbook) {","  this.workbook = workbook;","};","","","XLSX.RelType = require('./rel-type');","","","XLSX.prototype = {","","// ===============================================================================","// Workbook","  // =========================================================================","  // Read","","  readFile: function (filename) {","    var self = this;","    var stream;","    return utils.fs.exists(filename)","      .then(function (exists) {","        if (!exists) {","          throw new Error('File not found: ' + filename);","        }","        stream = fs.createReadStream(filename);","        return self.read(stream);","      })","      .then(function (workbook) {","        stream.close();","        return workbook;","      });","  },","  parseRels: function (stream) {","    var xform = new RelationshipsXform();","    return xform.parseStream(stream);","  },","  parseWorkbook: function (stream) {","    var xform = new WorkbookXform();","    return xform.parseStream(stream);","  },","  parseSharedStrings: function (stream) {","    var xform = new SharedStringsXform();","    return xform.parseStream(stream);","  },","  reconcile: function (model) {","    var workbookXform = new WorkbookXform();","    var worksheetXform = new WorksheetXform();","    ","    workbookXform.reconcile(model);","    var sheetOptions = {","      styles: model.styles,","      sharedStrings: model.sharedStrings,","      date1904: model.properties.date1904","    };","    model.worksheets.forEach(function (worksheet) {","      worksheet.relationships = model.worksheetRels[worksheet.sheetNo];","      worksheetXform.reconcile(worksheet, sheetOptions);","    });","","    // delete unnecessary parts","    model.worksheetHash = undefined;","    model.worksheetRels = undefined;","    model.globalRels = undefined;","    model.sharedStrings = undefined;","    model.workbookRels = undefined;","    model.sheetDefs = undefined;","    model.styles = undefined;","  },","  processWorksheetEntry: function(entry, model) {","    var match = entry.path.match(/xl\\/worksheets\\/sheet(\\d+)\\.xml/);","    if (match) {","      var sheetNo = match[1];","      var xform = new WorksheetXform();","      return xform.parseStream(entry)","        .then(function (worksheet) {","          worksheet.sheetNo = sheetNo;","          model.worksheetHash[entry.path] = worksheet;","          model.worksheets.push(worksheet);","        });","    }","  },","  processWorksheetRelsEntry: function(entry, model) {","    var match = entry.path.match(/xl\\/worksheets\\/_rels\\/sheet(\\d+)\\.xml.rels/);","    if (match) {","      var sheetNo = match[1];","      var xform = new RelationshipsXform();","      return xform.parseStream(entry)","        .then(function(relationships) {","          model.worksheetRels[sheetNo] = relationships;","        });","    }","  },","  processThemeEntry: function(entry, model) {","    var match = entry.path.match(/xl\\/theme\\/([a-zA-Z0-9]+)\\.xml/);","    if (match) {","      return new PromishLib.Promish(function(resolve, reject) {","        var name = match[1];","        // TODO: stream entry into buffer and store the xml in the model.themes[]","        var stream = new StreamBuf();","        entry.on('error', reject);","        stream.on('error', reject);","        stream.on('finish', function() {","          model.themes[name] = stream.read().toString();","          resolve();","        });","        entry.pipe(stream);","      });","    }","  },","  processIgnoreEntry: function(entry) {","    entry.autodrain();","  },","  createInputStream: function () {","    var self = this;","    var model = {","      worksheets: [],","      worksheetHash: {},","      worksheetRels: [],","      themes: {},","    };","","    // we have to be prepared to read the zip entries in whatever order they arrive","    var promises = [];","    var stream = new ZipStream.ZipReader();","    stream.on('entry', function (entry) {","      var promise = null;","","      var entryPath = entry.path;","      if (entryPath[0] === '/') {","        entryPath = entryPath.substr(1);","      }","      switch (entryPath) {","        case '_rels/.rels':","          promise = self.parseRels(entry)","            .then(function (relationships) {","              model.globalRels = relationships;","            });","          break;","","        case 'xl/workbook.xml':","          promise = self.parseWorkbook(entry)","            .then(function (workbook) {","              model.sheets = workbook.sheets;","              model.definedNames = workbook.definedNames;","              model.views = workbook.views;","              model.properties = workbook.properties;","            });","          break;","","        case 'xl/_rels/workbook.xml.rels':","          promise = self.parseRels(entry)","            .then(function (relationships) {","              model.workbookRels = relationships;","            });","          break;","","        case 'xl/sharedStrings.xml':","          model.sharedStrings = new SharedStringsXform();","          promise = model.sharedStrings.parseStream(entry);","          break;","","        case 'xl/styles.xml':","          model.styles = new StylesXform();","          promise = model.styles.parseStream(entry);","          break;","","        case 'docProps/app.xml':","          var appXform = new AppXform();","          promise = appXform.parseStream(entry)","            .then(function(appProperties) {","              Object.assign(model, {","                company: appProperties.company,","                manager: appProperties.manager","              });","            });","          break;","","        case 'docProps/core.xml':","          var coreXform = new CoreXform();","          promise = coreXform.parseStream(entry)","            .then(function(coreProperties) {","              Object.assign(model, coreProperties);","            });","          break;","","        default:","          promise =","            self.processWorksheetEntry(entry, model) ||","            self.processWorksheetRelsEntry(entry, model) ||","            self.processThemeEntry(entry, model) ||","            self.processIgnoreEntry(entry);","          break;","      }","","      if (promise) {","        promises.push(promise);","        promise = null;","      }","    });","    stream.on('finished', function () {","      PromishLib.Promish.all(promises)","        .then(function () {","          self.reconcile(model);","","          // apply model","          self.workbook.model = model;","        })","        .then(function () {","          stream.emit('done');","        })","        .catch(function (error) {","          stream.emit('error', error);","        });","    });","    return stream;","  },","","  read: function (stream) {","    var self = this;","    var zipStream = this.createInputStream();","    return new PromishLib.Promish(function(resolve, reject) {","      zipStream.on('done', function () {","        resolve(self.workbook);","      }).on('error', function (error) {","        reject(error);","      });","      stream.pipe(zipStream);","    });","  },","","  load: function(data, options) {","    var self = this;","    if (options === undefined) {","      options = {};","    }","    var zipStream = this.createInputStream();","    return new PromishLib.Promish(function(resolve, reject) {","      zipStream.on('done', function () {","        resolve(self.workbook);","      }).on('error', function (error) {","        reject(error);","      });","","      if (options.base64) {","        var buffer = new Buffer(data.toString(), 'base64');","        zipStream.write(buffer);","      } else {","        zipStream.write(data);","      }","      zipStream.end();","    });","  },","","  // =========================================================================","  // Write","","  addContentTypes: function (zip, model) {","    return new PromishLib.Promish(function(resolve) {","      var xform = new ContentTypesXform();","      var xml = xform.toXml(model);","      zip.append(xml, {name: '[Content_Types].xml'});","      resolve();","    });","  },","","  addApp: function (zip, model) {","    return new PromishLib.Promish(function(resolve) {","      var xform = new AppXform();","      var xml = xform.toXml(model);","      zip.append(xml, {name: 'docProps/app.xml'});","      resolve();","    });","  },","","  addCore: function (zip, model) {","    return new PromishLib.Promish(function(resolve) {","      var coreXform = new CoreXform();","      zip.append(coreXform.toXml(model), {name: 'docProps/core.xml'});","      resolve();","    });","  },","","  addThemes: function (zip, model) {","    return new PromishLib.Promish(function(resolve) {","      var themes = model.themes || { theme1: theme1Xml };","      Object.keys(themes).forEach(function(name) {","        var xml = themes[name];","        var path = 'xl/theme/' + name + '.xml';","        zip.append(xml, {name: path});","      });","      resolve();","    });","  },","","  addOfficeRels: function (zip) {","    return new PromishLib.Promish(function(resolve) {","      var xform = new RelationshipsXform();","      var xml = xform.toXml([","          {rId: 'rId1', type: XLSX.RelType.OfficeDocument, target: 'xl/workbook.xml'}","        ]);","      zip.append(xml, {name: '_rels/.rels'});","      resolve();","    });","  },","","  addWorkbookRels: function (zip, model) {","    var count = 1;","    var relationships = [","        {rId: 'rId' + (count++), type: XLSX.RelType.Styles, target: 'styles.xml'},","        {rId: 'rId' + (count++), type: XLSX.RelType.Theme, target: 'theme/theme1.xml'}","    ];","    if (model.sharedStrings.count) {","      relationships.push(","        {rId: 'rId' + (count++), type: XLSX.RelType.SharedStrings, target: 'sharedStrings.xml'}","      );","    }","    model.worksheets.forEach(function (worksheet) {","      worksheet.rId = 'rId' + (count++);","      relationships.push(","        {rId: worksheet.rId, type: XLSX.RelType.Worksheet, target: 'worksheets/sheet' + worksheet.id + '.xml'}","      );","    });","    return new PromishLib.Promish(function(resolve) {","      var xform = new RelationshipsXform();","      var xml = xform.toXml(relationships);","      zip.append(xml, {name: 'xl/_rels/workbook.xml.rels'});","      resolve();","    });","  },","  addSharedStrings: function (zip, model) {","    if (!model.sharedStrings || !model.sharedStrings.count) {","      return PromishLib.Promish.resolve();","    } else {","      return new PromishLib.Promish(function(resolve) {","        zip.append(model.sharedStrings.xml, {name: 'xl/sharedStrings.xml'});","        resolve();","      });","    }","  },","  addStyles: function(zip, model) {","    return new PromishLib.Promish(function(resolve) {","      var xml = model.styles.xml;","      if (xml) {","        zip.append(xml, {name: 'xl/styles.xml'});","      }","      resolve();","    });","  },","  addWorkbook: function (zip, model, xform) {","    return new PromishLib.Promish(function(resolve) {","      zip.append(xform.toXml(model), {name: 'xl/workbook.xml'});","      resolve();","    });","  },","  addWorksheets: function (zip, model, worksheetXform) {","    return new PromishLib.Promish(function(resolve) {","","      // preparation phase","      var relationshipsXform = new RelationshipsXform();","","      // write sheets","      model.worksheets.forEach(function (worksheet) {","        var xmlStream = new XmlStream();","        worksheetXform.render(xmlStream, worksheet);","        zip.append(xmlStream.xml, {name: 'xl/worksheets/sheet' + worksheet.id + '.xml'});","","        if (worksheet.hyperlinks && worksheet.hyperlinks.length) {","          xmlStream = new XmlStream();","          relationshipsXform.render(xmlStream, worksheet.hyperlinks);","          zip.append(xmlStream.xml, {name: 'xl/worksheets/_rels/sheet' + worksheet.id + '.xml.rels'});","        }","      });","","      resolve();","    });","  },","  _finalize: function (zip) {","    var self = this;","","    return new PromishLib.Promish(function(resolve, reject) {","","      zip.on('finish', function () {","        resolve(self);","      });","      zip.on('error', function (error) {","        reject(error);","      });","","      zip.finalize();","    });","  },","  write: function (stream, options) {","    options = options || {};","    var self = this;","    var model = self.workbook.model;","    var zip = new ZipStream.ZipWriter();","    zip.pipe(stream);","","    // ensure following properties have sane values","    model.creator = model.creator || 'ExcelJS';","    model.lastModifiedBy = model.lastModifiedBy || 'ExcelJS';","    model.created = model.created || new Date();","    model.modified = model.modified || new Date();","","    model.useSharedStrings = options.useSharedStrings !== undefined ?","      options.useSharedStrings :","      true;","    model.useStyles = options.useStyles !== undefined ?","      options.useStyles :","      true;","","    // Manage the shared strings","    model.sharedStrings = new SharedStringsXform();","","    // add a style manager to handle cell formats, fonts, etc.","    model.styles = model.useStyles ? new StylesXform(true) : new StylesXform.Mock();","","    // prepare all of the things before the render","    var workbookXform = new WorkbookXform();","    var worksheetXform = new WorksheetXform();","    var prepareOptions = {","      sharedStrings: model.sharedStrings,","      styles: model.styles,","      date1904: model.properties.date1904","    };","    workbookXform.prepare(model);","    model.worksheets.forEach(function (worksheet) {","      worksheetXform.prepare(worksheet, prepareOptions);","    });","","    // render","    var promises = [","      self.addContentTypes(zip, model),","      self.addApp(zip, model),","      self.addCore(zip, model),","      self.addThemes(zip, model),","      self.addOfficeRels(zip, model)","    ];","    return PromishLib.Promish.all(promises)","      .then(function () {","        return self.addWorksheets(zip, model, worksheetXform);","      })","      .then(function () {","        // Some things can only be done after all the worksheets have been processed","        var afters = [","          self.addSharedStrings(zip, model),","          self.addStyles(zip, model),","          self.addWorkbookRels(zip, model)","        ];","        return PromishLib.Promish.all(afters);","      })","      .then(function () {","        return self.addWorkbook(zip, model, workbookXform);","      })","      .then(function () {","        return self._finalize(zip);","      });","  },","  writeFile: function (filename, options) {","    var self = this;","    var stream = fs.createWriteStream(filename);","","    return new PromishLib.Promish(function(resolve, reject) {","      stream.on('finish', function () {","        resolve();","      });","      stream.on('error', function (error) {","        reject(error);","      });","","      self.write(stream, options)","        .then(function () {","          stream.end();","        })","        .catch(function (error) {","          reject(error);","        });","    });","  },","  writeBuffer: function(options) {","    var self = this;","    var stream = new StreamBuf();","    return self.write(stream, options)","      .then(function() {","        return stream.read();","      });","  }","};",""],"l":{"25":1,"26":1,"27":1,"28":1,"30":1,"31":1,"33":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"43":1,"45":1,"46":2,"50":1,"53":1,"61":0,"62":0,"63":0,"65":0,"66":0,"68":0,"69":0,"72":0,"73":0,"77":0,"78":0,"81":0,"82":0,"85":0,"86":0,"89":0,"90":0,"92":0,"93":0,"98":0,"99":0,"100":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"113":0,"114":0,"115":0,"116":0,"117":0,"119":0,"120":0,"121":0,"126":0,"127":0,"128":0,"129":0,"130":0,"132":0,"137":0,"138":0,"139":0,"140":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"149":0,"154":0,"157":0,"158":0,"166":0,"167":0,"168":0,"169":0,"171":0,"172":0,"173":0,"175":0,"177":0,"179":0,"181":0,"184":0,"186":0,"187":0,"188":0,"189":0,"191":0,"194":0,"196":0,"198":0,"201":0,"202":0,"203":0,"206":0,"207":0,"208":0,"211":0,"212":0,"214":0,"219":0,"222":0,"223":0,"225":0,"227":0,"230":0,"235":0,"238":0,"239":0,"240":0,"243":0,"244":0,"246":0,"249":0,"252":0,"255":0,"258":0,"262":0,"263":0,"264":0,"265":0,"266":0,"268":0,"270":0,"275":0,"276":0,"277":0,"279":0,"280":0,"281":0,"282":0,"284":0,"287":0,"288":0,"289":0,"291":0,"293":0,"301":0,"302":0,"303":0,"304":0,"305":0,"310":0,"311":0,"312":0,"313":0,"314":0,"319":0,"320":0,"321":0,"322":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"334":0,"339":0,"340":0,"341":0,"344":0,"345":0,"350":0,"351":0,"355":0,"356":0,"360":0,"361":0,"362":0,"366":0,"367":0,"368":0,"369":0,"370":0,"374":0,"375":0,"377":0,"378":0,"379":0,"384":0,"385":0,"386":0,"387":0,"389":0,"393":0,"394":0,"395":0,"399":0,"402":0,"405":0,"406":0,"407":0,"408":0,"410":0,"411":0,"412":0,"413":0,"417":0,"421":0,"423":0,"425":0,"426":0,"428":0,"429":0,"432":0,"436":0,"437":0,"438":0,"439":0,"440":0,"443":0,"444":0,"445":0,"446":0,"448":0,"451":0,"456":0,"459":0,"462":0,"463":0,"464":0,"469":0,"470":0,"471":0,"475":0,"482":0,"484":0,"488":0,"493":0,"496":0,"499":0,"503":0,"504":0,"506":0,"507":0,"508":0,"510":0,"511":0,"514":0,"516":0,"519":0,"524":0,"525":0,"526":0,"528":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/zip-stream.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/zip-stream.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},"fnMap":{"1":{"name":"(anonymous_1)","line":41,"loc":{"start":{"line":41,"column":16},"end":{"line":41,"column":27}}},"2":{"name":"(anonymous_2)","line":46,"loc":{"start":{"line":46,"column":27},"end":{"line":46,"column":38}}},"3":{"name":"(anonymous_3)","line":52,"loc":{"start":{"line":52,"column":13},"end":{"line":52,"column":24}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":14},"end":{"line":56,"column":25}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":12},"end":{"line":61,"column":23}}},"6":{"name":"(anonymous_6)","line":65,"loc":{"start":{"line":65,"column":12},"end":{"line":65,"column":26}}},"7":{"name":"(anonymous_7)","line":66,"loc":{"start":{"line":66,"column":20},"end":{"line":66,"column":42}}},"8":{"name":"(anonymous_8)","line":70,"loc":{"start":{"line":70,"column":20},"end":{"line":70,"column":36}}},"9":{"name":"(anonymous_9)","line":75,"loc":{"start":{"line":75,"column":40},"end":{"line":75,"column":52}}},"10":{"name":"(anonymous_10)","line":78,"loc":{"start":{"line":78,"column":41},"end":{"line":78,"column":53}}},"11":{"name":"(anonymous_11)","line":84,"loc":{"start":{"line":84,"column":21},"end":{"line":84,"column":38}}},"12":{"name":"(anonymous_12)","line":90,"loc":{"start":{"line":90,"column":13},"end":{"line":90,"column":30}}},"13":{"name":"(anonymous_13)","line":97,"loc":{"start":{"line":97,"column":9},"end":{"line":97,"column":44}}},"14":{"name":"(anonymous_14)","line":100,"loc":{"start":{"line":100,"column":8},"end":{"line":100,"column":19}}},"15":{"name":"(anonymous_15)","line":103,"loc":{"start":{"line":103,"column":10},"end":{"line":103,"column":21}}},"16":{"name":"(anonymous_16)","line":106,"loc":{"start":{"line":106,"column":7},"end":{"line":106,"column":18}}},"17":{"name":"(anonymous_17)","line":114,"loc":{"start":{"line":114,"column":16},"end":{"line":114,"column":27}}},"18":{"name":"(anonymous_18)","line":121,"loc":{"start":{"line":121,"column":10},"end":{"line":121,"column":34}}},"19":{"name":"(anonymous_19)","line":124,"loc":{"start":{"line":124,"column":12},"end":{"line":124,"column":23}}},"20":{"name":"(anonymous_20)","line":132,"loc":{"start":{"line":132,"column":12},"end":{"line":132,"column":30}}},"21":{"name":"(anonymous_21)","line":141,"loc":{"start":{"line":141,"column":8},"end":{"line":141,"column":23}}},"22":{"name":"(anonymous_22)","line":144,"loc":{"start":{"line":144,"column":15},"end":{"line":144,"column":34}}},"23":{"name":"(anonymous_23)","line":147,"loc":{"start":{"line":147,"column":9},"end":{"line":147,"column":20}}},"24":{"name":"(anonymous_24)","line":150,"loc":{"start":{"line":150,"column":10},"end":{"line":150,"column":21}}},"25":{"name":"(anonymous_25)","line":153,"loc":{"start":{"line":153,"column":12},"end":{"line":153,"column":23}}},"26":{"name":"(anonymous_26)","line":156,"loc":{"start":{"line":156,"column":8},"end":{"line":156,"column":39}}},"27":{"name":"(anonymous_27)","line":159,"loc":{"start":{"line":159,"column":10},"end":{"line":159,"column":32}}},"28":{"name":"(anonymous_28)","line":162,"loc":{"start":{"line":162,"column":11},"end":{"line":162,"column":27}}},"29":{"name":"(anonymous_29)","line":165,"loc":{"start":{"line":165,"column":8},"end":{"line":165,"column":25}}}},"statementMap":{"1":{"start":{"line":29,"column":0},"end":{"line":29,"column":31}},"2":{"start":{"line":30,"column":0},"end":{"line":30,"column":38}},"3":{"start":{"line":32,"column":0},"end":{"line":32,"column":29}},"4":{"start":{"line":34,"column":0},"end":{"line":34,"column":31}},"5":{"start":{"line":35,"column":0},"end":{"line":35,"column":40}},"6":{"start":{"line":41,"column":0},"end":{"line":49,"column":2}},"7":{"start":{"line":42,"column":2},"end":{"line":42,"column":18}},"8":{"start":{"line":43,"column":2},"end":{"line":43,"column":17}},"9":{"start":{"line":44,"column":2},"end":{"line":44,"column":27}},"10":{"start":{"line":45,"column":2},"end":{"line":45,"column":32}},"11":{"start":{"line":46,"column":2},"end":{"line":48,"column":5}},"12":{"start":{"line":47,"column":4},"end":{"line":47,"column":20}},"13":{"start":{"line":51,"column":0},"end":{"line":109,"column":3}},"14":{"start":{"line":53,"column":4},"end":{"line":53,"column":20}},"15":{"start":{"line":54,"column":4},"end":{"line":59,"column":5}},"16":{"start":{"line":55,"column":6},"end":{"line":58,"column":11}},"17":{"start":{"line":57,"column":10},"end":{"line":57,"column":32}},"18":{"start":{"line":62,"column":4},"end":{"line":62,"column":20}},"19":{"start":{"line":63,"column":4},"end":{"line":63,"column":37}},"20":{"start":{"line":64,"column":4},"end":{"line":92,"column":9}},"21":{"start":{"line":66,"column":8},"end":{"line":88,"column":11}},"22":{"start":{"line":67,"column":10},"end":{"line":87,"column":11}},"23":{"start":{"line":68,"column":12},"end":{"line":68,"column":25}},"24":{"start":{"line":69,"column":12},"end":{"line":86,"column":17}},"25":{"start":{"line":71,"column":16},"end":{"line":71,"column":50}},"26":{"start":{"line":72,"column":16},"end":{"line":72,"column":40}},"27":{"start":{"line":74,"column":16},"end":{"line":74,"column":40}},"28":{"start":{"line":75,"column":16},"end":{"line":77,"column":18}},"29":{"start":{"line":76,"column":18},"end":{"line":76,"column":35}},"30":{"start":{"line":78,"column":16},"end":{"line":80,"column":19}},"31":{"start":{"line":79,"column":18},"end":{"line":79,"column":35}},"32":{"start":{"line":82,"column":16},"end":{"line":82,"column":48}},"33":{"start":{"line":85,"column":16},"end":{"line":85,"column":42}},"34":{"start":{"line":91,"column":8},"end":{"line":91,"column":34}},"35":{"start":{"line":98,"column":4},"end":{"line":98,"column":55}},"36":{"start":{"line":101,"column":4},"end":{"line":101,"column":30}},"37":{"start":{"line":104,"column":4},"end":{"line":104,"column":32}},"38":{"start":{"line":107,"column":4},"end":{"line":107,"column":29}},"39":{"start":{"line":114,"column":0},"end":{"line":117,"column":2}},"40":{"start":{"line":115,"column":2},"end":{"line":115,"column":25}},"41":{"start":{"line":116,"column":2},"end":{"line":116,"column":32}},"42":{"start":{"line":119,"column":0},"end":{"line":168,"column":3}},"43":{"start":{"line":122,"column":4},"end":{"line":122,"column":38}},"44":{"start":{"line":125,"column":4},"end":{"line":125,"column":20}},"45":{"start":{"line":127,"column":4},"end":{"line":130,"column":6}},"46":{"start":{"line":131,"column":4},"end":{"line":136,"column":9}},"47":{"start":{"line":134,"column":8},"end":{"line":134,"column":33}},"48":{"start":{"line":135,"column":8},"end":{"line":135,"column":28}},"49":{"start":{"line":142,"column":4},"end":{"line":142,"column":34}},"50":{"start":{"line":145,"column":4},"end":{"line":145,"column":45}},"51":{"start":{"line":148,"column":4},"end":{"line":148,"column":31}},"52":{"start":{"line":151,"column":4},"end":{"line":151,"column":32}},"53":{"start":{"line":154,"column":4},"end":{"line":154,"column":34}},"54":{"start":{"line":157,"column":4},"end":{"line":157,"column":50}},"55":{"start":{"line":160,"column":4},"end":{"line":160,"column":43}},"56":{"start":{"line":163,"column":4},"end":{"line":163,"column":38}},"57":{"start":{"line":166,"column":4},"end":{"line":166,"column":36}},"58":{"start":{"line":172,"column":0},"end":{"line":175,"column":2}}},"branchMap":{"1":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":4},"end":{"line":54,"column":4}},{"start":{"line":54,"column":4},"end":{"line":54,"column":4}}]},"2":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":10},"end":{"line":67,"column":10}},{"start":{"line":67,"column":10},"end":{"line":67,"column":10}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","// The purpose of this module is to wrap the js-zip library into a streaming zip library","// since most of the exceljs code uses streams.","// One day I might find (or build) a properly streaming browser safe zip lib","","var events = require('events');","var PromishLib = require('./promish');","","var JSZip = require('jszip');","","var utils = require('./utils');","var StreamBuf = require('./stream-buf');","","","// =============================================================================","// The ZipReader class","// Unpacks an incoming zip stream","var ZipReader = function() {","  var self = this;","  this.count = 0;","  this.jsZip = new JSZip();","  this.stream = new StreamBuf();","  this.stream.on('finish', function() {","    self._process();","  });","};","","utils.inherits(ZipReader, events.EventEmitter, {","  _finished: function() {","    var self = this;","    if (!--this.count) {","      PromishLib.Promish.resolve()","        .then(function() {","          self.emit('finished');","        });","    }","  },","  _process: function() {","    var self = this;","    var content = this.stream.read();","    this.jsZip.loadAsync(content)","      .then(function(zip) {","        zip.forEach(function(path, entry) {","          if (!entry.dir) {","            self.count++;","            entry.async('string')","              .then(function (data) {","                var entryStream = new StreamBuf();","                entryStream.path = path;","                // console.log('data', path, data.toString())","                entryStream.write(data);","                entryStream.autodrain = function () {","                  self._finished();","                };","                entryStream.on('finish', function () {","                  self._finished();","                });","","                self.emit('entry', entryStream);","              })","              .catch(function (error) {","                self.emit('error', error);","              });","          }","        });","      })","      .catch(function (error) {","        self.emit('error', error);","      });","  },","","  // ==========================================================================","  // Stream.Writable interface","  write: function(data, encoding, callback) {","    return this.stream.write(data, encoding, callback);","  },","  cork: function() {","    return this.stream.cork();","  },","  uncork: function() {","    return this.stream.uncork();","  },","  end: function() {","    return this.stream.end();","  }","});","","// =============================================================================","// The ZipWriter class","// Packs streamed data into an output zip stream","var ZipWriter = function() {","  this.zip = new JSZip();","  this.stream = new StreamBuf();","};","","utils.inherits(ZipWriter, events.EventEmitter, {","","  append: function(data, options) {","    this.zip.file(options.name, data);","  },","  finalize: function() {","    var self = this;","","    var options = {","      type: 'nodebuffer',","      compression: 'DEFLATE'","    };","    return this.zip.generateAsync(options)","      .then(function(content) {","        // console.log('zip finalize', typeof content, content)","        self.stream.end(content);","        self.emit('finish');","      });","  },","","  // ==========================================================================","  // Stream.Readable interface","  read: function(size) {","    return this.stream.read(size);","  },","  setEncoding: function(encoding) {","    return this.stream.setEncoding(encoding);","  },","  pause: function() {","    return this.stream.pause();","  },","  resume: function() {","    return this.stream.resume();","  },","  isPaused: function() {","    return this.stream.isPaused();","  },","  pipe: function(destination, options) {","    return this.stream.pipe(destination, options);","  },","  unpipe: function(destination) {","    return this.stream.unpipe(destination);","  },","  unshift: function(chunk) {","    return this.stream.unshift(chunk);","  },","  wrap: function(stream) {","    return this.stream.wrap(stream);","  }","});","","// =============================================================================","","module.exports = {","  ZipReader: ZipReader,","  ZipWriter: ZipWriter","};"],"l":{"29":1,"30":1,"32":1,"34":1,"35":1,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"51":1,"53":0,"54":0,"55":0,"57":0,"62":0,"63":0,"64":0,"66":0,"67":0,"68":0,"69":0,"71":0,"72":0,"74":0,"75":0,"76":0,"78":0,"79":0,"82":0,"85":0,"91":0,"98":0,"101":0,"104":0,"107":0,"114":1,"115":0,"116":0,"119":1,"122":0,"125":0,"127":0,"131":0,"134":0,"135":0,"142":0,"145":0,"148":0,"151":0,"154":0,"157":0,"160":0,"163":0,"166":0,"172":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/stream-buf.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/stream-buf.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":1,"17":0,"18":0,"19":0,"20":1,"21":0,"22":1,"23":0,"24":0,"25":0,"26":1,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":1,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":1,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0},"fnMap":{"1":{"name":"(anonymous_1)","line":34,"loc":{"start":{"line":34,"column":18},"end":{"line":34,"column":43}}},"2":{"name":"(anonymous_2)","line":39,"loc":{"start":{"line":39,"column":12},"end":{"line":39,"column":15}}},"3":{"name":"(anonymous_3)","line":43,"loc":{"start":{"line":43,"column":8},"end":{"line":43,"column":55}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":12},"end":{"line":46,"column":23}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":21},"end":{"line":53,"column":36}}},"6":{"name":"(anonymous_6)","line":57,"loc":{"start":{"line":57,"column":12},"end":{"line":57,"column":15}}},"7":{"name":"(anonymous_7)","line":61,"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":55}}},"8":{"name":"(anonymous_8)","line":64,"loc":{"start":{"line":64,"column":12},"end":{"line":64,"column":23}}},"9":{"name":"(anonymous_9)","line":68,"loc":{"start":{"line":68,"column":18},"end":{"line":68,"column":33}}},"10":{"name":"(anonymous_10)","line":72,"loc":{"start":{"line":72,"column":12},"end":{"line":72,"column":15}}},"11":{"name":"(anonymous_11)","line":76,"loc":{"start":{"line":76,"column":8},"end":{"line":76,"column":55}}},"12":{"name":"(anonymous_12)","line":79,"loc":{"start":{"line":79,"column":12},"end":{"line":79,"column":23}}},"13":{"name":"(anonymous_13)","line":86,"loc":{"start":{"line":86,"column":19},"end":{"line":86,"column":34}}},"14":{"name":"(anonymous_14)","line":96,"loc":{"start":{"line":96,"column":12},"end":{"line":96,"column":23}}},"15":{"name":"(anonymous_15)","line":105,"loc":{"start":{"line":105,"column":12},"end":{"line":105,"column":15}}},"16":{"name":"(anonymous_16)","line":108,"loc":{"start":{"line":108,"column":9},"end":{"line":108,"column":12}}},"17":{"name":"(anonymous_17)","line":111,"loc":{"start":{"line":111,"column":10},"end":{"line":111,"column":13}}},"18":{"name":"(anonymous_18)","line":114,"loc":{"start":{"line":114,"column":8},"end":{"line":114,"column":23}}},"19":{"name":"(anonymous_19)","line":132,"loc":{"start":{"line":132,"column":9},"end":{"line":132,"column":41}}},"20":{"name":"(anonymous_20)","line":147,"loc":{"start":{"line":147,"column":33},"end":{"line":147,"column":51}}},"21":{"name":"(anonymous_21)","line":180,"loc":{"start":{"line":180,"column":22},"end":{"line":180,"column":33}}},"22":{"name":"(anonymous_22)","line":192,"loc":{"start":{"line":192,"column":9},"end":{"line":192,"column":25}}},"23":{"name":"(anonymous_23)","line":193,"loc":{"start":{"line":193,"column":16},"end":{"line":193,"column":31}}},"24":{"name":"(anonymous_24)","line":194,"loc":{"start":{"line":194,"column":36},"end":{"line":194,"column":62}}},"25":{"name":"(anonymous_25)","line":195,"loc":{"start":{"line":195,"column":37},"end":{"line":195,"column":48}}},"26":{"name":"(anonymous_26)","line":205,"loc":{"start":{"line":205,"column":19},"end":{"line":205,"column":35}}},"27":{"name":"(anonymous_27)","line":216,"loc":{"start":{"line":216,"column":9},"end":{"line":216,"column":44}}},"28":{"name":"(anonymous_28)","line":260,"loc":{"start":{"line":260,"column":8},"end":{"line":260,"column":19}}},"29":{"name":"(anonymous_29)","line":263,"loc":{"start":{"line":263,"column":10},"end":{"line":263,"column":32}}},"30":{"name":"(anonymous_30)","line":272,"loc":{"start":{"line":272,"column":10},"end":{"line":272,"column":21}}},"31":{"name":"(anonymous_31)","line":276,"loc":{"start":{"line":276,"column":7},"end":{"line":276,"column":43}}},"32":{"name":"(anonymous_32)","line":278,"loc":{"start":{"line":278,"column":24},"end":{"line":278,"column":40}}},"33":{"name":"(anonymous_33)","line":283,"loc":{"start":{"line":283,"column":27},"end":{"line":283,"column":42}}},"34":{"name":"(anonymous_34)","line":302,"loc":{"start":{"line":302,"column":8},"end":{"line":302,"column":23}}},"35":{"name":"(anonymous_35)","line":317,"loc":{"start":{"line":317,"column":37},"end":{"line":317,"column":54}}},"36":{"name":"(anonymous_36)","line":319,"loc":{"start":{"line":319,"column":16},"end":{"line":319,"column":31}}},"37":{"name":"(anonymous_37)","line":326,"loc":{"start":{"line":326,"column":15},"end":{"line":326,"column":34}}},"38":{"name":"(anonymous_38)","line":330,"loc":{"start":{"line":330,"column":9},"end":{"line":330,"column":20}}},"39":{"name":"(anonymous_39)","line":333,"loc":{"start":{"line":333,"column":10},"end":{"line":333,"column":21}}},"40":{"name":"(anonymous_40)","line":336,"loc":{"start":{"line":336,"column":12},"end":{"line":336,"column":23}}},"41":{"name":"(anonymous_41)","line":339,"loc":{"start":{"line":339,"column":8},"end":{"line":339,"column":39}}},"42":{"name":"(anonymous_42)","line":346,"loc":{"start":{"line":346,"column":10},"end":{"line":346,"column":32}}},"43":{"name":"(anonymous_43)","line":348,"loc":{"start":{"line":348,"column":35},"end":{"line":348,"column":50}}},"44":{"name":"(anonymous_44)","line":352,"loc":{"start":{"line":352,"column":11},"end":{"line":352,"column":27}}},"45":{"name":"(anonymous_45)","line":357,"loc":{"start":{"line":357,"column":8},"end":{"line":357,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":38}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":31}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":40}},"5":{"start":{"line":34,"column":0},"end":{"line":37,"column":2}},"6":{"start":{"line":35,"column":2},"end":{"line":35,"column":20}},"7":{"start":{"line":36,"column":2},"end":{"line":36,"column":28}},"8":{"start":{"line":38,"column":0},"end":{"line":52,"column":2}},"9":{"start":{"line":40,"column":4},"end":{"line":40,"column":34}},"10":{"start":{"line":44,"column":4},"end":{"line":44,"column":70}},"11":{"start":{"line":47,"column":4},"end":{"line":49,"column":5}},"12":{"start":{"line":48,"column":6},"end":{"line":48,"column":60}},"13":{"start":{"line":50,"column":4},"end":{"line":50,"column":24}},"14":{"start":{"line":53,"column":0},"end":{"line":55,"column":2}},"15":{"start":{"line":54,"column":2},"end":{"line":54,"column":20}},"16":{"start":{"line":56,"column":0},"end":{"line":67,"column":2}},"17":{"start":{"line":58,"column":4},"end":{"line":58,"column":29}},"18":{"start":{"line":62,"column":4},"end":{"line":62,"column":70}},"19":{"start":{"line":65,"column":4},"end":{"line":65,"column":33}},"20":{"start":{"line":68,"column":0},"end":{"line":70,"column":2}},"21":{"start":{"line":69,"column":2},"end":{"line":69,"column":20}},"22":{"start":{"line":71,"column":0},"end":{"line":82,"column":2}},"23":{"start":{"line":73,"column":4},"end":{"line":73,"column":29}},"24":{"start":{"line":77,"column":4},"end":{"line":77,"column":58}},"25":{"start":{"line":80,"column":4},"end":{"line":80,"column":22}},"26":{"start":{"line":86,"column":0},"end":{"line":94,"column":2}},"27":{"start":{"line":87,"column":2},"end":{"line":87,"column":19}},"28":{"start":{"line":89,"column":2},"end":{"line":89,"column":33}},"29":{"start":{"line":91,"column":2},"end":{"line":91,"column":17}},"30":{"start":{"line":93,"column":2},"end":{"line":93,"column":18}},"31":{"start":{"line":95,"column":0},"end":{"line":140,"column":2}},"32":{"start":{"line":97,"column":4},"end":{"line":103,"column":5}},"33":{"start":{"line":98,"column":6},"end":{"line":98,"column":25}},"34":{"start":{"line":100,"column":6},"end":{"line":100,"column":53}},"35":{"start":{"line":101,"column":6},"end":{"line":101,"column":56}},"36":{"start":{"line":102,"column":6},"end":{"line":102,"column":17}},"37":{"start":{"line":106,"column":4},"end":{"line":106,"column":36}},"38":{"start":{"line":109,"column":4},"end":{"line":109,"column":38}},"39":{"start":{"line":112,"column":4},"end":{"line":112,"column":37}},"40":{"start":{"line":116,"column":4},"end":{"line":130,"column":5}},"41":{"start":{"line":118,"column":6},"end":{"line":118,"column":18}},"42":{"start":{"line":119,"column":11},"end":{"line":130,"column":5}},"43":{"start":{"line":121,"column":6},"end":{"line":121,"column":32}},"44":{"start":{"line":122,"column":6},"end":{"line":122,"column":31}},"45":{"start":{"line":123,"column":6},"end":{"line":123,"column":17}},"46":{"start":{"line":126,"column":6},"end":{"line":126,"column":33}},"47":{"start":{"line":127,"column":6},"end":{"line":127,"column":49}},"48":{"start":{"line":128,"column":6},"end":{"line":128,"column":25}},"49":{"start":{"line":129,"column":6},"end":{"line":129,"column":17}},"50":{"start":{"line":135,"column":4},"end":{"line":135,"column":57}},"51":{"start":{"line":136,"column":4},"end":{"line":136,"column":64}},"52":{"start":{"line":137,"column":4},"end":{"line":137,"column":24}},"53":{"start":{"line":138,"column":4},"end":{"line":138,"column":16}},"54":{"start":{"line":147,"column":0},"end":{"line":170,"column":2}},"55":{"start":{"line":148,"column":2},"end":{"line":148,"column":26}},"56":{"start":{"line":149,"column":2},"end":{"line":149,"column":48}},"57":{"start":{"line":150,"column":2},"end":{"line":150,"column":20}},"58":{"start":{"line":154,"column":2},"end":{"line":154,"column":38}},"59":{"start":{"line":156,"column":2},"end":{"line":156,"column":22}},"60":{"start":{"line":158,"column":2},"end":{"line":158,"column":17}},"61":{"start":{"line":161,"column":2},"end":{"line":161,"column":18}},"62":{"start":{"line":164,"column":2},"end":{"line":164,"column":18}},"63":{"start":{"line":167,"column":2},"end":{"line":167,"column":22}},"64":{"start":{"line":169,"column":2},"end":{"line":169,"column":23}},"65":{"start":{"line":172,"column":0},"end":{"line":361,"column":3}},"66":{"start":{"line":181,"column":4},"end":{"line":186,"column":5}},"67":{"start":{"line":182,"column":6},"end":{"line":182,"column":55}},"68":{"start":{"line":183,"column":6},"end":{"line":185,"column":7}},"69":{"start":{"line":184,"column":8},"end":{"line":184,"column":20}},"70":{"start":{"line":187,"column":4},"end":{"line":187,"column":45}},"71":{"start":{"line":188,"column":4},"end":{"line":188,"column":27}},"72":{"start":{"line":189,"column":4},"end":{"line":189,"column":15}},"73":{"start":{"line":193,"column":4},"end":{"line":199,"column":6}},"74":{"start":{"line":194,"column":6},"end":{"line":198,"column":9}},"75":{"start":{"line":195,"column":8},"end":{"line":197,"column":11}},"76":{"start":{"line":196,"column":10},"end":{"line":196,"column":20}},"77":{"start":{"line":200,"column":4},"end":{"line":200,"column":41}},"78":{"start":{"line":201,"column":4},"end":{"line":203,"column":35}},"79":{"start":{"line":206,"column":4},"end":{"line":206,"column":18}},"80":{"start":{"line":207,"column":4},"end":{"line":207,"column":29}},"81":{"start":{"line":208,"column":4},"end":{"line":214,"column":5}},"82":{"start":{"line":210,"column":6},"end":{"line":210,"column":45}},"83":{"start":{"line":213,"column":6},"end":{"line":213,"column":57}},"84":{"start":{"line":217,"column":4},"end":{"line":220,"column":5}},"85":{"start":{"line":218,"column":6},"end":{"line":218,"column":26}},"86":{"start":{"line":219,"column":6},"end":{"line":219,"column":24}},"87":{"start":{"line":221,"column":4},"end":{"line":221,"column":37}},"88":{"start":{"line":224,"column":4},"end":{"line":224,"column":14}},"89":{"start":{"line":225,"column":4},"end":{"line":232,"column":5}},"90":{"start":{"line":226,"column":6},"end":{"line":226,"column":39}},"91":{"start":{"line":227,"column":11},"end":{"line":232,"column":5}},"92":{"start":{"line":228,"column":6},"end":{"line":228,"column":36}},"93":{"start":{"line":231,"column":6},"end":{"line":231,"column":46}},"94":{"start":{"line":235,"column":4},"end":{"line":256,"column":5}},"95":{"start":{"line":236,"column":6},"end":{"line":248,"column":7}},"96":{"start":{"line":237,"column":8},"end":{"line":237,"column":36}},"97":{"start":{"line":238,"column":8},"end":{"line":240,"column":9}},"98":{"start":{"line":239,"column":10},"end":{"line":239,"column":43}},"99":{"start":{"line":242,"column":8},"end":{"line":247,"column":9}},"100":{"start":{"line":243,"column":10},"end":{"line":243,"column":43}},"101":{"start":{"line":245,"column":10},"end":{"line":245,"column":38}},"102":{"start":{"line":246,"column":10},"end":{"line":246,"column":37}},"103":{"start":{"line":250,"column":6},"end":{"line":252,"column":7}},"104":{"start":{"line":251,"column":8},"end":{"line":251,"column":44}},"105":{"start":{"line":254,"column":6},"end":{"line":254,"column":34}},"106":{"start":{"line":255,"column":6},"end":{"line":255,"column":28}},"107":{"start":{"line":258,"column":4},"end":{"line":258,"column":16}},"108":{"start":{"line":261,"column":4},"end":{"line":261,"column":23}},"109":{"start":{"line":265,"column":4},"end":{"line":270,"column":5}},"110":{"start":{"line":267,"column":6},"end":{"line":269,"column":7}},"111":{"start":{"line":268,"column":8},"end":{"line":268,"column":41}},"112":{"start":{"line":273,"column":4},"end":{"line":273,"column":24}},"113":{"start":{"line":274,"column":4},"end":{"line":274,"column":18}},"114":{"start":{"line":277,"column":4},"end":{"line":277,"column":20}},"115":{"start":{"line":278,"column":4},"end":{"line":288,"column":6}},"116":{"start":{"line":279,"column":6},"end":{"line":287,"column":7}},"117":{"start":{"line":280,"column":8},"end":{"line":280,"column":24}},"118":{"start":{"line":282,"column":8},"end":{"line":282,"column":22}},"119":{"start":{"line":283,"column":8},"end":{"line":285,"column":11}},"120":{"start":{"line":284,"column":10},"end":{"line":284,"column":21}},"121":{"start":{"line":286,"column":8},"end":{"line":286,"column":28}},"122":{"start":{"line":289,"column":4},"end":{"line":293,"column":5}},"123":{"start":{"line":290,"column":6},"end":{"line":290,"column":49}},"124":{"start":{"line":292,"column":6},"end":{"line":292,"column":22}},"125":{"start":{"line":304,"column":4},"end":{"line":324,"column":5}},"126":{"start":{"line":305,"column":6},"end":{"line":305,"column":23}},"127":{"start":{"line":306,"column":6},"end":{"line":314,"column":7}},"128":{"start":{"line":307,"column":8},"end":{"line":307,"column":36}},"129":{"start":{"line":308,"column":8},"end":{"line":308,"column":38}},"130":{"start":{"line":309,"column":8},"end":{"line":309,"column":30}},"131":{"start":{"line":310,"column":8},"end":{"line":310,"column":29}},"132":{"start":{"line":311,"column":8},"end":{"line":313,"column":9}},"133":{"start":{"line":312,"column":10},"end":{"line":312,"column":31}},"134":{"start":{"line":315,"column":6},"end":{"line":315,"column":36}},"135":{"start":{"line":317,"column":6},"end":{"line":321,"column":9}},"136":{"start":{"line":318,"column":8},"end":{"line":318,"column":33}},"137":{"start":{"line":320,"column":8},"end":{"line":320,"column":20}},"138":{"start":{"line":322,"column":6},"end":{"line":322,"column":24}},"139":{"start":{"line":323,"column":6},"end":{"line":323,"column":36}},"140":{"start":{"line":328,"column":4},"end":{"line":328,"column":29}},"141":{"start":{"line":331,"column":4},"end":{"line":331,"column":23}},"142":{"start":{"line":334,"column":4},"end":{"line":334,"column":24}},"143":{"start":{"line":337,"column":4},"end":{"line":337,"column":38}},"144":{"start":{"line":341,"column":4},"end":{"line":341,"column":33}},"145":{"start":{"line":342,"column":4},"end":{"line":344,"column":5}},"146":{"start":{"line":343,"column":6},"end":{"line":343,"column":17}},"147":{"start":{"line":348,"column":4},"end":{"line":350,"column":7}},"148":{"start":{"line":349,"column":6},"end":{"line":349,"column":34}},"149":{"start":{"line":355,"column":4},"end":{"line":355,"column":39}},"150":{"start":{"line":359,"column":4},"end":{"line":359,"column":39}}},"branchMap":{"1":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":4},"end":{"line":47,"column":4}},{"start":{"line":47,"column":4},"end":{"line":47,"column":4}}]},"2":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":4},"end":{"line":97,"column":4}},{"start":{"line":97,"column":4},"end":{"line":97,"column":4}}]},"3":{"line":97,"type":"binary-expr","locations":[{"start":{"line":97,"column":9},"end":{"line":97,"column":25}},{"start":{"line":97,"column":31},"end":{"line":97,"column":56}}]},"4":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":4},"end":{"line":116,"column":4}},{"start":{"line":116,"column":4},"end":{"line":116,"column":4}}]},"5":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":11},"end":{"line":119,"column":11}},{"start":{"line":119,"column":11},"end":{"line":119,"column":11}}]},"6":{"line":119,"type":"binary-expr","locations":[{"start":{"line":119,"column":16},"end":{"line":119,"column":34}},{"start":{"line":119,"column":40},"end":{"line":119,"column":59}}]},"7":{"line":148,"type":"binary-expr","locations":[{"start":{"line":148,"column":12},"end":{"line":148,"column":19}},{"start":{"line":148,"column":23},"end":{"line":148,"column":25}}]},"8":{"line":149,"type":"binary-expr","locations":[{"start":{"line":149,"column":17},"end":{"line":149,"column":32}},{"start":{"line":149,"column":36},"end":{"line":149,"column":47}}]},"9":{"line":154,"type":"binary-expr","locations":[{"start":{"line":154,"column":15},"end":{"line":154,"column":28}},{"start":{"line":154,"column":32},"end":{"line":154,"column":37}}]},"10":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":4},"end":{"line":181,"column":4}},{"start":{"line":181,"column":4},"end":{"line":181,"column":4}}]},"11":{"line":183,"type":"if","locations":[{"start":{"line":183,"column":6},"end":{"line":183,"column":6}},{"start":{"line":183,"column":6},"end":{"line":183,"column":6}}]},"12":{"line":201,"type":"cond-expr","locations":[{"start":{"line":202,"column":6},"end":{"line":202,"column":54}},{"start":{"line":203,"column":6},"end":{"line":203,"column":34}}]},"13":{"line":217,"type":"if","locations":[{"start":{"line":217,"column":4},"end":{"line":217,"column":4}},{"start":{"line":217,"column":4},"end":{"line":217,"column":4}}]},"14":{"line":221,"type":"binary-expr","locations":[{"start":{"line":221,"column":15},"end":{"line":221,"column":23}},{"start":{"line":221,"column":27},"end":{"line":221,"column":36}}]},"15":{"line":225,"type":"if","locations":[{"start":{"line":225,"column":4},"end":{"line":225,"column":4}},{"start":{"line":225,"column":4},"end":{"line":225,"column":4}}]},"16":{"line":227,"type":"if","locations":[{"start":{"line":227,"column":11},"end":{"line":227,"column":11}},{"start":{"line":227,"column":11},"end":{"line":227,"column":11}}]},"17":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":4},"end":{"line":235,"column":4}},{"start":{"line":235,"column":4},"end":{"line":235,"column":4}}]},"18":{"line":236,"type":"if","locations":[{"start":{"line":236,"column":6},"end":{"line":236,"column":6}},{"start":{"line":236,"column":6},"end":{"line":236,"column":6}}]},"19":{"line":238,"type":"binary-expr","locations":[{"start":{"line":238,"column":15},"end":{"line":238,"column":27}},{"start":{"line":238,"column":32},"end":{"line":238,"column":55}}]},"20":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":8},"end":{"line":242,"column":8}},{"start":{"line":242,"column":8},"end":{"line":242,"column":8}}]},"21":{"line":250,"type":"if","locations":[{"start":{"line":250,"column":6},"end":{"line":250,"column":6}},{"start":{"line":250,"column":6},"end":{"line":250,"column":6}}]},"22":{"line":265,"type":"if","locations":[{"start":{"line":265,"column":4},"end":{"line":265,"column":4}},{"start":{"line":265,"column":4},"end":{"line":265,"column":4}}]},"23":{"line":279,"type":"if","locations":[{"start":{"line":279,"column":6},"end":{"line":279,"column":6}},{"start":{"line":279,"column":6},"end":{"line":279,"column":6}}]},"24":{"line":289,"type":"if","locations":[{"start":{"line":289,"column":4},"end":{"line":289,"column":4}},{"start":{"line":289,"column":4},"end":{"line":289,"column":4}}]},"25":{"line":304,"type":"if","locations":[{"start":{"line":304,"column":4},"end":{"line":304,"column":4}},{"start":{"line":304,"column":4},"end":{"line":304,"column":4}}]},"26":{"line":306,"type":"binary-expr","locations":[{"start":{"line":306,"column":13},"end":{"line":306,"column":17}},{"start":{"line":306,"column":21},"end":{"line":306,"column":40}},{"start":{"line":306,"column":44},"end":{"line":306,"column":64}}]},"27":{"line":311,"type":"if","locations":[{"start":{"line":311,"column":8},"end":{"line":311,"column":8}},{"start":{"line":311,"column":8},"end":{"line":311,"column":8}}]},"28":{"line":311,"type":"binary-expr","locations":[{"start":{"line":311,"column":12},"end":{"line":311,"column":21}},{"start":{"line":311,"column":25},"end":{"line":311,"column":35}}]},"29":{"line":337,"type":"cond-expr","locations":[{"start":{"line":337,"column":25},"end":{"line":337,"column":29}},{"start":{"line":337,"column":32},"end":{"line":337,"column":37}}]},"30":{"line":342,"type":"if","locations":[{"start":{"line":342,"column":4},"end":{"line":342,"column":4}},{"start":{"line":342,"column":4},"end":{"line":342,"column":4}}]},"31":{"line":342,"type":"binary-expr","locations":[{"start":{"line":342,"column":8},"end":{"line":342,"column":20}},{"start":{"line":342,"column":24},"end":{"line":342,"column":43}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var Stream = require('stream');","var PromishLib = require('./promish');","","var utils = require('./utils');","var StringBuf = require('./string-buf');","","","// =============================================================================","// data chunks - encapsulating incoming data","var StringChunk = function(data, encoding) {","  this._data = data;","  this._encoding = encoding;","};","StringChunk.prototype = {","  get length() {","    return this.toBuffer().length;","  },","  // copy to target buffer","  copy: function(target, targetOffset, offset, length) {","    return this.toBuffer().copy(target, targetOffset, offset, length);","  },","  toBuffer: function() {","    if (!this._buffer) {","      this._buffer = new Buffer(this._data, this._encoding);","    }","    return this._buffer;","  }","};","var StringBufChunk = function(data) {","  this._data = data;","};","StringBufChunk.prototype = {","  get length() {","    return this._data.length;","  },","  // copy to target buffer","  copy: function(target, targetOffset, offset, length) {","    return this._data._buf.copy(target, targetOffset, offset, length);","  },","  toBuffer: function() {","    return this._data.toBuffer();","  }","};","var BufferChunk = function(data) {","  this._data = data;","};","BufferChunk.prototype = {","  get length() {","    return this._data.length;","  },","  // copy to target buffer","  copy: function(target, targetOffset, offset, length) {","    this._data.copy(target, targetOffset, offset, length);","  },","  toBuffer: function() {","    return this._data;","  }","};","","// =============================================================================","// ReadWriteBuf - a single buffer supporting simple read-write","var ReadWriteBuf = function(size) {","  this.size = size;","  // the buffer","  this.buffer = new Buffer(size);","  // read index","  this.iRead = 0;","  // write index","  this.iWrite = 0;","};","ReadWriteBuf.prototype = {","  toBuffer: function() {","    if ((this.iRead === 0) && (this.iWrite === this.size)) {","      return this.buffer;","    } else {","      var buf = new Buffer(this.iWrite - this.iRead);","      this.buffer.copy(buf, 0, this.iRead, this.iWrite);","      return buf;","    }","  },","  get length() {","    return this.iWrite - this.iRead;","  },","  get eod() {","    return this.iRead === this.iWrite;","  },","  get full() {","    return this.iWrite === this.size;","  },","  read: function(size) {","    // read size bytes from buffer and return buffer","    if (size === 0) {","      // special case - return null if no data requested","      return null;","    } else if ((size === undefined) || (size >= this.length)) {","      // if no size specified or size is at least what we have then return all of the bytes","      var buf = this.toBuffer();","      this.iRead = this.iWrite;","      return buf;","    } else {","      // otherwise return a chunk","      var buf = new Buffer(size);","      this.buffer.copy(buf, 0, this.iRead, size);","      this.iRead += size;","      return buf;","    }","  },","  write: function(chunk, offset, length) {","    // write as many bytes from data from optional source offset","    // and return number of bytes written","    var size = Math.min(length, this.size - this.iWrite);","    chunk.copy(this.buffer, this.iWrite, offset, offset + size);","    this.iWrite += size;","    return size;","  }","};","","// =============================================================================","// StreamBuf - a multi-purpose read-write stream","//  As MemBuf - write as much data as you like. Then call toBuffer() to consolidate","//  As StreamHub - pipe to multiple writables","//  As readable stream - feed data into the writable part and have some other code read from it.","var StreamBuf = module.exports = function(options) {","  options = options || {};","  this.bufSize = options.bufSize || 1024 * 1024;","  this.buffers = [];","","  // batch mode fills a buffer completely before passing the data on","  // to pipes or 'readable' event listeners","  this.batch = options.batch || false;","","  this.corked = false;","  // where in the current writable buffer we're up to","  this.inPos = 0;","","  // where in the current readable buffer we've read up to","  this.outPos = 0;","","  // consuming pipe streams go here","  this.pipes = [];","","  // controls emit('data') ","  this.paused = false;","","  this.encoding = null;","};","","utils.inherits(StreamBuf, Stream.Duplex, {","  // writable","  // event drain - if write returns false (which it won't), indicates when safe to write again.","  // finish - end() has been called","  // pipe(src) - pipe() has been called on readable","  // unpipe(src) - unpipe() has been called on readable","  // error - duh","","  _getWritableBuffer: function() {","    if (this.buffers.length) {","      var last = this.buffers[this.buffers.length - 1];","      if (!last.full) {","        return last;","      }","    }","    var buf = new ReadWriteBuf(this.bufSize);","    this.buffers.push(buf);","    return buf;","  },","","  _pipe: function(chunk) {","    var write = function(pipe) {","      return new PromishLib.Promish(function(resolve, reject) {","        pipe.write(chunk.toBuffer(), function() {","          resolve();","        });","      });","    };","    var promises = this.pipes.map(write);","    return promises.length ?","      PromishLib.Promish.all(promises).then(utils.nop) :","      PromishLib.Promish.resolve();","  },","  _writeToBuffers: function(chunk) {","    var inPos = 0;","    var inLen = chunk.length;","    while (inPos < inLen) {","      // find writable buffer","      var buffer = this._getWritableBuffer();","","      // write some data","      inPos += buffer.write(chunk, inPos, inLen - inPos);","    }","  },","  write: function(data, encoding, callback) {","    if (encoding instanceof Function) {","      callback = encoding;","      encoding = 'utf8';","    }","    callback = callback || utils.nop;","","    // encapsulate data into a chunk","    var chunk;","    if (data instanceof StringBuf) {","      chunk = new StringBufChunk(data);","    } else if (data instanceof Buffer) {","      chunk = new BufferChunk(data);","    } else {","      // assume string","      chunk = new StringChunk(data, encoding);","    }","","    // now, do something with the chunk","    if (this.pipes.length) {","      if (this.batch) {","        this._writeToBuffers(chunk);","        while (!this.corked && (this.buffers.length > 1)) {","          this._pipe(this.buffers.shift());","        }","      } else {","        if (!this.corked) {","          this._pipe(chunk).then(callback);","        } else {","          this._writeToBuffers(chunk);","          process.nextTick(callback);","        }","      }","    } else {","      if (!this.paused) {","        this.emit('data', chunk.toBuffer());","      }","","      this._writeToBuffers(chunk);","      this.emit('readable');","    }","","    return true;","  },","  cork: function() {","    this.corked = true;","  },","  _flush: function(destination) {","    // if we have comsumers...","    if (this.pipes.length) {","      // and there's stuff not written","      while (this.buffers.length) {","        this._pipe(this.buffers.shift());","      }","    }","  },","  uncork: function() {","    this.corked = false;","    this._flush();","  },","  end: function(chunk, encoding, callback) {","    var self = this;","    var writeComplete = function(error) {","      if (error) {","        callback(error);","      } else {","        self._flush();","        self.pipes.forEach(function(pipe) {","          pipe.end();","        });","        self.emit('finish');","      }","    };","    if (chunk) {","      this.write(chunk, encoding, writeComplete);","    } else {","      writeComplete();","    }","  },","","  // readable","  // event readable - some data is now available","  // event data - switch to flowing mode - feeds chunks to handler","  // event end - no more data","  // event close - optional, indicates upstream close","  // event error - duh","  read: function(size) {","    // read min(buffer, size || infinity)","    if (size) {","      var buffers = [];","      while (size && this.buffers.length && !this.buffers[0].eod) {","        var first = this.buffers[0];","        var buffer = first.read(size);","        size -= buffer.length;","        buffers.push(buffer);","        if (first.eod && first.full) {","          this.buffers.shift();","        }","      }","      return Buffer.concat(buffers);","    } else {","      var buffers = this.buffers.map(function(buffer) {","        return buffer.toBuffer();","      }).filter(function(data) {","        return data;","      });","      this.buffers = [];","      return Buffer.concat(buffers);","    }","  },","  setEncoding: function(encoding) {","    // causes stream.read or stream.on('data) to return strings of encoding instead of Buffer objects","    this.encoding = encoding;","  },","  pause: function() {","    this.paused = true;","  },","  resume: function() {","    this.paused = false;","  },","  isPaused: function() {","    return this.paused ? true : false;","  },","  pipe: function(destination, options) {","    // add destination to pipe list & write current buffer","    this.pipes.push(destination);","    if (!this.paused && this.buffers.length) {","      this.end();","    }","  },","  unpipe: function(destination) {","    // remove destination from pipe list","    this.pipes = this.pipes.filter(function(pipe) {","      return pipe !== destination;","    });","  },","  unshift: function(chunk) {","    // some numpty has read some data that's not for them and they want to put it back!","    // Might implement this some day","    throw new Error('Not Implemented');","  },","  wrap: function(stream) {","    // not implemented","    throw new Error('Not Implemented');","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":1,"34":1,"35":0,"36":0,"38":1,"40":0,"44":0,"47":0,"48":0,"50":0,"53":1,"54":0,"56":1,"58":0,"62":0,"65":0,"68":1,"69":0,"71":1,"73":0,"77":0,"80":0,"86":1,"87":0,"89":0,"91":0,"93":0,"95":1,"97":0,"98":0,"100":0,"101":0,"102":0,"106":0,"109":0,"112":0,"116":0,"118":0,"119":0,"121":0,"122":0,"123":0,"126":0,"127":0,"128":0,"129":0,"135":0,"136":0,"137":0,"138":0,"147":1,"148":0,"149":0,"150":0,"154":0,"156":0,"158":0,"161":0,"164":0,"167":0,"169":0,"172":1,"181":0,"182":0,"183":0,"184":0,"187":0,"188":0,"189":0,"193":0,"194":0,"195":0,"196":0,"200":0,"201":0,"206":0,"207":0,"208":0,"210":0,"213":0,"217":0,"218":0,"219":0,"221":0,"224":0,"225":0,"226":0,"227":0,"228":0,"231":0,"235":0,"236":0,"237":0,"238":0,"239":0,"242":0,"243":0,"245":0,"246":0,"250":0,"251":0,"254":0,"255":0,"258":0,"261":0,"265":0,"267":0,"268":0,"273":0,"274":0,"277":0,"278":0,"279":0,"280":0,"282":0,"283":0,"284":0,"286":0,"289":0,"290":0,"292":0,"304":0,"305":0,"306":0,"307":0,"308":0,"309":0,"310":0,"311":0,"312":0,"315":0,"317":0,"318":0,"320":0,"322":0,"323":0,"328":0,"331":0,"334":0,"337":0,"341":0,"342":0,"343":0,"348":0,"349":0,"355":0,"359":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/string-buf.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/string-buf.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0},"b":{"1":[1,0,1],"2":[1,0,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":29,"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":51}}},"2":{"name":"(anonymous_2)","line":42,"loc":{"start":{"line":42,"column":12},"end":{"line":42,"column":15}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":14},"end":{"line":45,"column":17}}},"4":{"name":"(anonymous_4)","line":48,"loc":{"start":{"line":48,"column":12},"end":{"line":48,"column":15}}},"5":{"name":"(anonymous_5)","line":52,"loc":{"start":{"line":52,"column":12},"end":{"line":52,"column":23}}},"6":{"name":"(anonymous_6)","line":61,"loc":{"start":{"line":61,"column":9},"end":{"line":61,"column":28}}},"7":{"name":"(anonymous_7)","line":67,"loc":{"start":{"line":67,"column":9},"end":{"line":67,"column":23}}},"8":{"name":"(anonymous_8)","line":75,"loc":{"start":{"line":75,"column":11},"end":{"line":75,"column":26}}},"9":{"name":"(anonymous_9)","line":92,"loc":{"start":{"line":92,"column":16},"end":{"line":92,"column":32}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}},"2":{"start":{"line":29,"column":0},"end":{"line":38,"column":2}},"3":{"start":{"line":30,"column":2},"end":{"line":30,"column":61}},"4":{"start":{"line":31,"column":2},"end":{"line":31,"column":59}},"5":{"start":{"line":34,"column":2},"end":{"line":34,"column":18}},"6":{"start":{"line":37,"column":2},"end":{"line":37,"column":27}},"7":{"start":{"line":40,"column":0},"end":{"line":103,"column":2}},"8":{"start":{"line":43,"column":4},"end":{"line":43,"column":23}},"9":{"start":{"line":46,"column":4},"end":{"line":46,"column":28}},"10":{"start":{"line":49,"column":4},"end":{"line":49,"column":21}},"11":{"start":{"line":54,"column":4},"end":{"line":57,"column":5}},"12":{"start":{"line":55,"column":6},"end":{"line":55,"column":45}},"13":{"start":{"line":56,"column":6},"end":{"line":56,"column":54}},"14":{"start":{"line":58,"column":4},"end":{"line":58,"column":24}},"15":{"start":{"line":62,"column":4},"end":{"line":62,"column":29}},"16":{"start":{"line":63,"column":4},"end":{"line":63,"column":29}},"17":{"start":{"line":64,"column":4},"end":{"line":64,"column":27}},"18":{"start":{"line":68,"column":4},"end":{"line":68,"column":65}},"19":{"start":{"line":70,"column":4},"end":{"line":70,"column":31}},"20":{"start":{"line":71,"column":4},"end":{"line":71,"column":27}},"21":{"start":{"line":72,"column":4},"end":{"line":72,"column":20}},"22":{"start":{"line":76,"column":4},"end":{"line":76,"column":29}},"23":{"start":{"line":79,"column":4},"end":{"line":79,"column":81}},"24":{"start":{"line":82,"column":4},"end":{"line":87,"column":5}},"25":{"start":{"line":83,"column":6},"end":{"line":83,"column":44}},"26":{"start":{"line":86,"column":6},"end":{"line":86,"column":79}},"27":{"start":{"line":89,"column":4},"end":{"line":89,"column":24}},"28":{"start":{"line":93,"column":4},"end":{"line":101,"column":5}},"29":{"start":{"line":94,"column":6},"end":{"line":94,"column":31}},"30":{"start":{"line":96,"column":6},"end":{"line":98,"column":7}},"31":{"start":{"line":97,"column":8},"end":{"line":97,"column":47}},"32":{"start":{"line":99,"column":6},"end":{"line":99,"column":63}},"33":{"start":{"line":100,"column":6},"end":{"line":100,"column":34}}},"branchMap":{"1":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":26},"end":{"line":30,"column":33}},{"start":{"line":30,"column":37},"end":{"line":30,"column":49}},{"start":{"line":30,"column":54},"end":{"line":30,"column":59}}]},"2":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":20},"end":{"line":31,"column":27}},{"start":{"line":31,"column":31},"end":{"line":31,"column":47}},{"start":{"line":31,"column":52},"end":{"line":31,"column":58}}]},"3":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":4},"end":{"line":54,"column":4}},{"start":{"line":54,"column":4},"end":{"line":54,"column":4}}]},"4":{"line":62,"type":"binary-expr","locations":[{"start":{"line":62,"column":15},"end":{"line":62,"column":23}},{"start":{"line":62,"column":27},"end":{"line":62,"column":28}}]},"5":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":4},"end":{"line":93,"column":4}},{"start":{"line":93,"column":4},"end":{"line":93,"column":4}}]},"6":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":6},"end":{"line":96,"column":6}},{"start":{"line":96,"column":6},"end":{"line":96,"column":6}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('./utils');","","// StringBuf - a way to keep string memory operations to a minimum","// while building the strings for the xml files","var StringBuf = module.exports = function(options) {","  this._buf = new Buffer((options && options.size) || 16384);","  this._encoding = (options && options.encoding) || 'utf8';","","  // where in the buffer we are at","  this._inPos = 0;","","  // for use by toBuffer()","  this._buffer = undefined;","};","","StringBuf.prototype = {","","  get length() {","    return this._inPos;","  },","  get capacity() {","    return this._buf.length;","  },","  get buffer() {","    return this._buf;","  },","","  toBuffer: function() {","    // return the current data as a single enclosing buffer","    if (!this._buffer) {","      this._buffer = new Buffer(this.length);","      this._buf.copy(this._buffer, 0, 0, this.length);","    }","    return this._buffer;","  },","","  reset: function(position) {","    position = position || 0;","    this._buffer = undefined;","    this._inPos = position;","  },","","  _grow: function(min) {","    for (var size = this._buf.length * 2; size < min; size *= 2);","    //console.log(\"Grow: min=\"+min + \", size=\"+size);","    var buf = new Buffer(size);","    this._buf.copy(buf, 0);","    this._buf = buf;","  },","","  addText: function(text) {","    this._buffer = undefined;","","    //console.log(\"addText: writing \" + text.length + ' at ' + this._inPos + \", size= \"+ this._buf.length);","    var inPos = this._inPos + this._buf.write(text, this._inPos, this._encoding);","","    // if we've hit (or nearing capacity), grow the buf","    while (inPos >= this._buf.length - 4) {","      this._grow(this._inPos + text.length);","","      // keep trying to write until we've completely written the text","      inPos = this._inPos + this._buf.write(text, this._inPos, this._encoding);","    }","","    this._inPos = inPos;","  },","","  addStringBuf: function(inBuf) {","    if (inBuf.length) {","      this._buffer = undefined;","","      if (this.length + inBuf.length > this.capacity) {","        this._grow(this.length + inBuf.length);","      }","      inBuf._buf.copy(this._buf, this._inPos, 0, inBuf.length);","      this._inPos += inBuf.length;","    }","  }","};",""],"l":{"25":1,"29":1,"30":1,"31":1,"34":1,"37":1,"40":1,"43":0,"46":0,"49":0,"54":0,"55":0,"56":0,"58":0,"62":0,"63":0,"64":0,"68":0,"70":0,"71":0,"72":0,"76":0,"79":0,"82":0,"83":0,"86":0,"89":0,"93":0,"94":0,"96":0,"97":0,"99":0,"100":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/xml-stream.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/xml-stream.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"fnMap":{"1":{"name":"pushAttribute","line":38,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":41}}},"2":{"name":"pushAttributes","line":45,"loc":{"start":{"line":45,"column":0},"end":{"line":45,"column":41}}},"3":{"name":"(anonymous_3)","line":47,"loc":{"start":{"line":47,"column":23},"end":{"line":47,"column":45}}},"4":{"name":"(anonymous_4)","line":55,"loc":{"start":{"line":55,"column":33},"end":{"line":55,"column":44}}},"5":{"name":"(anonymous_5)","line":68,"loc":{"start":{"line":68,"column":9},"end":{"line":68,"column":12}}},"6":{"name":"(anonymous_6)","line":72,"loc":{"start":{"line":72,"column":11},"end":{"line":72,"column":35}}},"7":{"name":"(anonymous_7)","line":80,"loc":{"start":{"line":80,"column":12},"end":{"line":80,"column":39}}},"8":{"name":"(anonymous_8)","line":96,"loc":{"start":{"line":96,"column":16},"end":{"line":96,"column":38}}},"9":{"name":"(anonymous_9)","line":102,"loc":{"start":{"line":102,"column":17},"end":{"line":102,"column":33}}},"10":{"name":"(anonymous_10)","line":108,"loc":{"start":{"line":108,"column":13},"end":{"line":108,"column":28}}},"11":{"name":"(anonymous_11)","line":117,"loc":{"start":{"line":117,"column":12},"end":{"line":117,"column":26}}},"12":{"name":"(anonymous_12)","line":125,"loc":{"start":{"line":125,"column":13},"end":{"line":125,"column":24}}},"13":{"name":"(anonymous_13)","line":138,"loc":{"start":{"line":138,"column":12},"end":{"line":138,"column":45}}},"14":{"name":"(anonymous_14)","line":146,"loc":{"start":{"line":146,"column":12},"end":{"line":146,"column":23}}},"15":{"name":"(anonymous_15)","line":152,"loc":{"start":{"line":152,"column":15},"end":{"line":152,"column":26}}},"16":{"name":"(anonymous_16)","line":160,"loc":{"start":{"line":160,"column":10},"end":{"line":160,"column":21}}},"17":{"name":"(anonymous_17)","line":163,"loc":{"start":{"line":163,"column":12},"end":{"line":163,"column":23}}},"18":{"name":"(anonymous_18)","line":175,"loc":{"start":{"line":175,"column":9},"end":{"line":175,"column":12}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":32}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":31}},"3":{"start":{"line":30,"column":0},"end":{"line":30,"column":21}},"4":{"start":{"line":31,"column":0},"end":{"line":31,"column":22}},"5":{"start":{"line":32,"column":0},"end":{"line":32,"column":28}},"6":{"start":{"line":33,"column":0},"end":{"line":33,"column":29}},"7":{"start":{"line":34,"column":0},"end":{"line":34,"column":24}},"8":{"start":{"line":35,"column":0},"end":{"line":35,"column":16}},"9":{"start":{"line":36,"column":0},"end":{"line":36,"column":16}},"10":{"start":{"line":38,"column":0},"end":{"line":44,"column":1}},"11":{"start":{"line":39,"column":2},"end":{"line":39,"column":18}},"12":{"start":{"line":40,"column":2},"end":{"line":40,"column":17}},"13":{"start":{"line":41,"column":2},"end":{"line":41,"column":25}},"14":{"start":{"line":42,"column":2},"end":{"line":42,"column":46}},"15":{"start":{"line":43,"column":2},"end":{"line":43,"column":18}},"16":{"start":{"line":45,"column":0},"end":{"line":53,"column":1}},"17":{"start":{"line":46,"column":2},"end":{"line":52,"column":3}},"18":{"start":{"line":47,"column":4},"end":{"line":51,"column":7}},"19":{"start":{"line":48,"column":6},"end":{"line":50,"column":7}},"20":{"start":{"line":49,"column":8},"end":{"line":49,"column":40}},"21":{"start":{"line":55,"column":0},"end":{"line":59,"column":2}},"22":{"start":{"line":56,"column":2},"end":{"line":56,"column":17}},"23":{"start":{"line":57,"column":2},"end":{"line":57,"column":19}},"24":{"start":{"line":58,"column":2},"end":{"line":58,"column":23}},"25":{"start":{"line":61,"column":0},"end":{"line":65,"column":2}},"26":{"start":{"line":67,"column":0},"end":{"line":179,"column":2}},"27":{"start":{"line":69,"column":4},"end":{"line":69,"column":78}},"28":{"start":{"line":73,"column":4},"end":{"line":73,"column":24}},"29":{"start":{"line":75,"column":4},"end":{"line":75,"column":22}},"30":{"start":{"line":76,"column":4},"end":{"line":76,"column":39}},"31":{"start":{"line":77,"column":4},"end":{"line":77,"column":21}},"32":{"start":{"line":81,"column":4},"end":{"line":81,"column":26}},"33":{"start":{"line":82,"column":4},"end":{"line":82,"column":24}},"34":{"start":{"line":83,"column":4},"end":{"line":85,"column":5}},"35":{"start":{"line":84,"column":6},"end":{"line":84,"column":28}},"36":{"start":{"line":87,"column":4},"end":{"line":87,"column":27}},"37":{"start":{"line":90,"column":4},"end":{"line":90,"column":25}},"38":{"start":{"line":91,"column":4},"end":{"line":91,"column":19}},"39":{"start":{"line":92,"column":4},"end":{"line":92,"column":36}},"40":{"start":{"line":93,"column":4},"end":{"line":93,"column":21}},"41":{"start":{"line":94,"column":4},"end":{"line":94,"column":21}},"42":{"start":{"line":97,"column":4},"end":{"line":99,"column":5}},"43":{"start":{"line":98,"column":6},"end":{"line":98,"column":75}},"44":{"start":{"line":100,"column":4},"end":{"line":100,"column":42}},"45":{"start":{"line":103,"column":4},"end":{"line":105,"column":5}},"46":{"start":{"line":104,"column":6},"end":{"line":104,"column":75}},"47":{"start":{"line":106,"column":4},"end":{"line":106,"column":37}},"48":{"start":{"line":109,"column":4},"end":{"line":109,"column":24}},"49":{"start":{"line":110,"column":4},"end":{"line":113,"column":5}},"50":{"start":{"line":111,"column":6},"end":{"line":111,"column":28}},"51":{"start":{"line":112,"column":6},"end":{"line":112,"column":24}},"52":{"start":{"line":114,"column":4},"end":{"line":114,"column":22}},"53":{"start":{"line":115,"column":4},"end":{"line":115,"column":47}},"54":{"start":{"line":118,"column":4},"end":{"line":121,"column":5}},"55":{"start":{"line":119,"column":6},"end":{"line":119,"column":34}},"56":{"start":{"line":120,"column":6},"end":{"line":120,"column":24}},"57":{"start":{"line":122,"column":4},"end":{"line":122,"column":22}},"58":{"start":{"line":123,"column":4},"end":{"line":123,"column":24}},"59":{"start":{"line":126,"column":4},"end":{"line":126,"column":33}},"60":{"start":{"line":127,"column":4},"end":{"line":127,"column":24}},"61":{"start":{"line":128,"column":4},"end":{"line":134,"column":5}},"62":{"start":{"line":129,"column":6},"end":{"line":129,"column":34}},"63":{"start":{"line":131,"column":6},"end":{"line":131,"column":33}},"64":{"start":{"line":132,"column":6},"end":{"line":132,"column":21}},"65":{"start":{"line":133,"column":6},"end":{"line":133,"column":28}},"66":{"start":{"line":135,"column":4},"end":{"line":135,"column":22}},"67":{"start":{"line":136,"column":4},"end":{"line":136,"column":22}},"68":{"start":{"line":139,"column":4},"end":{"line":139,"column":36}},"69":{"start":{"line":140,"column":4},"end":{"line":142,"column":5}},"70":{"start":{"line":141,"column":6},"end":{"line":141,"column":27}},"71":{"start":{"line":143,"column":4},"end":{"line":143,"column":21}},"72":{"start":{"line":147,"column":4},"end":{"line":149,"column":5}},"73":{"start":{"line":148,"column":6},"end":{"line":148,"column":23}},"74":{"start":{"line":153,"column":4},"end":{"line":158,"column":7}},"75":{"start":{"line":161,"column":4},"end":{"line":161,"column":26}},"76":{"start":{"line":164,"column":4},"end":{"line":164,"column":34}},"77":{"start":{"line":165,"column":4},"end":{"line":167,"column":5}},"78":{"start":{"line":166,"column":6},"end":{"line":166,"column":56}},"79":{"start":{"line":168,"column":4},"end":{"line":170,"column":5}},"80":{"start":{"line":169,"column":6},"end":{"line":169,"column":64}},"81":{"start":{"line":171,"column":4},"end":{"line":171,"column":23}},"82":{"start":{"line":172,"column":4},"end":{"line":172,"column":23}},"83":{"start":{"line":176,"column":4},"end":{"line":176,"column":20}},"84":{"start":{"line":177,"column":4},"end":{"line":177,"column":30}}},"branchMap":{"1":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":2},"end":{"line":46,"column":2}},{"start":{"line":46,"column":2},"end":{"line":46,"column":2}}]},"2":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":6},"end":{"line":48,"column":6}},{"start":{"line":48,"column":6},"end":{"line":48,"column":6}}]},"3":{"line":69,"type":"cond-expr","locations":[{"start":{"line":69,"column":32},"end":{"line":69,"column":65}},{"start":{"line":69,"column":68},"end":{"line":69,"column":77}}]},"4":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":83,"column":4}},{"start":{"line":83,"column":4},"end":{"line":83,"column":4}}]},"5":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":8},"end":{"line":83,"column":14}},{"start":{"line":83,"column":18},"end":{"line":83,"column":27}}]},"6":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":4},"end":{"line":97,"column":4}},{"start":{"line":97,"column":4},"end":{"line":97,"column":4}}]},"7":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]},"8":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":4},"end":{"line":110,"column":4}},{"start":{"line":110,"column":4},"end":{"line":110,"column":4}}]},"9":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]},"10":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":4},"end":{"line":128,"column":4}},{"start":{"line":128,"column":4},"end":{"line":128,"column":4}}]},"11":{"line":140,"type":"if","locations":[{"start":{"line":140,"column":4},"end":{"line":140,"column":4}},{"start":{"line":140,"column":4},"end":{"line":140,"column":4}}]},"12":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":4},"end":{"line":165,"column":4}},{"start":{"line":165,"column":4},"end":{"line":165,"column":4}}]},"13":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":4},"end":{"line":168,"column":4}},{"start":{"line":168,"column":4},"end":{"line":168,"column":4}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('./under-dash');","","var utils = require('./utils');","","// constants","var OPEN_ANGLE = '<';","var CLOSE_ANGLE = '>';","var OPEN_ANGLE_SLASH = '</';","var CLOSE_SLASH_ANGLE = '/>';","var EQUALS_QUOTE = '=\"';","var QUOTE = '\"';","var SPACE = ' ';","","function pushAttribute(xml, name, value) {","  xml.push(SPACE);","  xml.push(name);","  xml.push(EQUALS_QUOTE);","  xml.push(utils.xmlEncode(value.toString()));","  xml.push(QUOTE);","}","function pushAttributes(xml, attributes) {","  if (attributes) {","    _.each(attributes, function(value, name) {","      if (value !== undefined) {","        pushAttribute(xml, name, value);","      }","    });","  }","}","","var XmlStream = module.exports = function() {","  this._xml = [];","  this._stack = [];","  this._rollbacks = [];","};","","XmlStream.StdDocAttributes = {","  version: '1.0',","  encoding: 'UTF-8',","  standalone: 'yes'","};","","XmlStream.prototype = {","  get tos() {","    return this._stack.length ? this._stack[this._stack.length-1] : undefined;","  },","  ","  openXml: function(docAttributes) {","    var xml = this._xml;","    // <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>","    xml.push('<?xml');","    pushAttributes(xml, docAttributes);","    xml.push('?>\\n');","  },","  ","  openNode: function(name, attributes) {","    var parent = this.tos;","    var xml = this._xml;","    if (parent && this.open) {","      xml.push(CLOSE_ANGLE);","    }","","    this._stack.push(name);","","    // start streaming node","    xml.push(OPEN_ANGLE);","    xml.push(name);","    pushAttributes(xml, attributes);","    this.leaf = true;","    this.open = true;","  },","  addAttribute: function(name, value) {","    if (!this.open) {","      throw new Error('Cannot write attributes to node if it is not open');","    }","    pushAttribute(this._xml, name, value);","  },","  addAttributes: function(attrs) {","    if (!this.open) {","      throw new Error('Cannot write attributes to node if it is not open');","    }","    pushAttributes(this._xml, attrs);","  },","  writeText: function(text) {","    var xml = this._xml;","    if (this.open) {","      xml.push(CLOSE_ANGLE);","      this.open = false;","    }","    this.leaf = false;","    xml.push(utils.xmlEncode(text.toString()));","  },","  writeXml: function(xml) {","    if (this.open) {","      this._xml.push(CLOSE_ANGLE);","      this.open = false;","    }","    this.leaf = false;","    this._xml.push(xml);","  },","  closeNode: function() {","    var node = this._stack.pop();","    var xml = this._xml;","    if (this.leaf) {","      xml.push(CLOSE_SLASH_ANGLE);","    } else {","      xml.push(OPEN_ANGLE_SLASH);","      xml.push(node);","      xml.push(CLOSE_ANGLE);","    }","    this.open = false;","    this.leaf = false;","  },","  leafNode: function(name, attributes, text) {","    this.openNode(name, attributes);","    if (text !== undefined) { // zeros need to be written","      this.writeText(text);","    }","    this.closeNode();","  },","","  closeAll: function() {","    while (this._stack.length) {","      this.closeNode();","    }","  },","","  addRollback: function() {","    this._rollbacks.push({","      xml: this._xml.length,","      stack: this._stack.length,","      leaf: this.leaf,","      open: this.open","    });","  },","  commit: function() {","    this._rollbacks.pop();","  },","  rollback: function() {","    var r = this._rollbacks.pop();","    if (this._xml.length > r.xml) {","      this._xml.splice(r.xml, this._xml.length - r.xml);","    }","    if (this._stack.length > r.stack) {","      this._stack.splice(r.stack, this._stack.length - r.stack);","    }","    this.leaf = r.leaf;","    this.open = r.open;","  },","","  get xml() {","    this.closeAll();","    return this._xml.join('');","  }","};"],"l":{"25":1,"27":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"38":1,"39":0,"40":0,"41":0,"42":0,"43":0,"45":1,"46":0,"47":0,"48":0,"49":0,"55":1,"56":0,"57":0,"58":0,"61":1,"67":1,"69":0,"73":0,"75":0,"76":0,"77":0,"81":0,"82":0,"83":0,"84":0,"87":0,"90":0,"91":0,"92":0,"93":0,"94":0,"97":0,"98":0,"100":0,"103":0,"104":0,"106":0,"109":0,"110":0,"111":0,"112":0,"114":0,"115":0,"118":0,"119":0,"120":0,"122":0,"123":0,"126":0,"127":0,"128":0,"129":0,"131":0,"132":0,"133":0,"135":0,"136":0,"139":0,"140":0,"141":0,"143":0,"147":0,"148":0,"153":0,"161":0,"164":0,"165":0,"166":0,"168":0,"169":0,"171":0,"172":0,"176":0,"177":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/styles-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/styles-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":1,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":1,"180":0,"181":0,"182":1,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},"fnMap":{"1":{"name":"(anonymous_1)","line":47,"loc":{"start":{"line":47,"column":35},"end":{"line":47,"column":56}}},"2":{"name":"(anonymous_2)","line":98,"loc":{"start":{"line":98,"column":13},"end":{"line":98,"column":24}}},"3":{"name":"(anonymous_3)","line":109,"loc":{"start":{"line":109,"column":8},"end":{"line":109,"column":19}}},"4":{"name":"(anonymous_4)","line":135,"loc":{"start":{"line":135,"column":10},"end":{"line":135,"column":37}}},"5":{"name":"(anonymous_5)","line":147,"loc":{"start":{"line":147,"column":30},"end":{"line":147,"column":50}}},"6":{"name":"(anonymous_6)","line":154,"loc":{"start":{"line":154,"column":26},"end":{"line":154,"column":44}}},"7":{"name":"(anonymous_7)","line":160,"loc":{"start":{"line":160,"column":26},"end":{"line":160,"column":44}}},"8":{"name":"(anonymous_8)","line":166,"loc":{"start":{"line":166,"column":28},"end":{"line":166,"column":48}}},"9":{"name":"(anonymous_9)","line":174,"loc":{"start":{"line":174,"column":27},"end":{"line":174,"column":46}}},"10":{"name":"(anonymous_10)","line":197,"loc":{"start":{"line":197,"column":13},"end":{"line":197,"column":28}}},"11":{"name":"(anonymous_11)","line":215,"loc":{"start":{"line":215,"column":13},"end":{"line":215,"column":28}}},"12":{"name":"(anonymous_12)","line":220,"loc":{"start":{"line":220,"column":14},"end":{"line":220,"column":29}}},"13":{"name":"(anonymous_13)","line":230,"loc":{"start":{"line":230,"column":20},"end":{"line":230,"column":42}}},"14":{"name":"(anonymous_14)","line":248,"loc":{"start":{"line":248,"column":34},"end":{"line":248,"column":52}}},"15":{"name":"(anonymous_15)","line":264,"loc":{"start":{"line":264,"column":17},"end":{"line":264,"column":43}}},"16":{"name":"(anonymous_16)","line":315,"loc":{"start":{"line":315,"column":17},"end":{"line":315,"column":30}}},"17":{"name":"addStyle","line":336,"loc":{"start":{"line":336,"column":4},"end":{"line":336,"column":39}}},"18":{"name":"(anonymous_18)","line":360,"loc":{"start":{"line":360,"column":13},"end":{"line":360,"column":29}}},"19":{"name":"(anonymous_19)","line":372,"loc":{"start":{"line":372,"column":17},"end":{"line":372,"column":38}}},"20":{"name":"(anonymous_20)","line":390,"loc":{"start":{"line":390,"column":12},"end":{"line":390,"column":27}}},"21":{"name":"(anonymous_21)","line":402,"loc":{"start":{"line":402,"column":14},"end":{"line":402,"column":31}}},"22":{"name":"(anonymous_22)","line":414,"loc":{"start":{"line":414,"column":12},"end":{"line":414,"column":27}}},"23":{"name":"(anonymous_23)","line":428,"loc":{"start":{"line":428,"column":19},"end":{"line":428,"column":30}}},"24":{"name":"(anonymous_24)","line":447,"loc":{"start":{"line":447,"column":15},"end":{"line":447,"column":32}}},"25":{"name":"(anonymous_25)","line":455,"loc":{"start":{"line":455,"column":17},"end":{"line":455,"column":43}}},"26":{"name":"(anonymous_26)","line":464,"loc":{"start":{"line":464,"column":17},"end":{"line":464,"column":20}}},"27":{"name":"(anonymous_27)","line":477,"loc":{"start":{"line":477,"column":17},"end":{"line":477,"column":34}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":51}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":44}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":42}},"5":{"start":{"line":30,"column":0},"end":{"line":30,"column":53}},"6":{"start":{"line":32,"column":0},"end":{"line":32,"column":41}},"7":{"start":{"line":33,"column":0},"end":{"line":33,"column":45}},"8":{"start":{"line":34,"column":0},"end":{"line":34,"column":41}},"9":{"start":{"line":35,"column":0},"end":{"line":35,"column":40}},"10":{"start":{"line":36,"column":0},"end":{"line":36,"column":40}},"11":{"start":{"line":37,"column":0},"end":{"line":37,"column":44}},"12":{"start":{"line":38,"column":0},"end":{"line":38,"column":44}},"13":{"start":{"line":39,"column":0},"end":{"line":39,"column":42}},"14":{"start":{"line":42,"column":0},"end":{"line":42,"column":22}},"15":{"start":{"line":47,"column":0},"end":{"line":73,"column":2}},"16":{"start":{"line":48,"column":2},"end":{"line":67,"column":4}},"17":{"start":{"line":69,"column":2},"end":{"line":72,"column":3}},"18":{"start":{"line":71,"column":4},"end":{"line":71,"column":16}},"19":{"start":{"line":75,"column":0},"end":{"line":425,"column":3}},"20":{"start":{"line":99,"column":4},"end":{"line":106,"column":6}},"21":{"start":{"line":111,"column":4},"end":{"line":117,"column":6}},"22":{"start":{"line":119,"column":4},"end":{"line":119,"column":21}},"23":{"start":{"line":122,"column":4},"end":{"line":122,"column":91}},"24":{"start":{"line":125,"column":4},"end":{"line":125,"column":24}},"25":{"start":{"line":128,"column":4},"end":{"line":128,"column":78}},"26":{"start":{"line":131,"column":4},"end":{"line":131,"column":53}},"27":{"start":{"line":132,"column":4},"end":{"line":132,"column":56}},"28":{"start":{"line":136,"column":4},"end":{"line":136,"column":32}},"29":{"start":{"line":139,"column":4},"end":{"line":139,"column":50}},"30":{"start":{"line":141,"column":4},"end":{"line":141,"column":72}},"31":{"start":{"line":143,"column":4},"end":{"line":186,"column":5}},"32":{"start":{"line":145,"column":6},"end":{"line":151,"column":7}},"33":{"start":{"line":146,"column":8},"end":{"line":146,"column":69}},"34":{"start":{"line":147,"column":8},"end":{"line":149,"column":11}},"35":{"start":{"line":148,"column":10},"end":{"line":148,"column":40}},"36":{"start":{"line":150,"column":8},"end":{"line":150,"column":30}},"37":{"start":{"line":153,"column":6},"end":{"line":153,"column":63}},"38":{"start":{"line":154,"column":6},"end":{"line":156,"column":9}},"39":{"start":{"line":155,"column":8},"end":{"line":155,"column":36}},"40":{"start":{"line":157,"column":6},"end":{"line":157,"column":28}},"41":{"start":{"line":159,"column":6},"end":{"line":159,"column":63}},"42":{"start":{"line":160,"column":6},"end":{"line":162,"column":9}},"43":{"start":{"line":161,"column":8},"end":{"line":161,"column":36}},"44":{"start":{"line":163,"column":6},"end":{"line":163,"column":28}},"45":{"start":{"line":165,"column":6},"end":{"line":165,"column":67}},"46":{"start":{"line":166,"column":6},"end":{"line":168,"column":9}},"47":{"start":{"line":167,"column":8},"end":{"line":167,"column":38}},"48":{"start":{"line":169,"column":6},"end":{"line":169,"column":28}},"49":{"start":{"line":171,"column":6},"end":{"line":171,"column":107}},"50":{"start":{"line":173,"column":6},"end":{"line":173,"column":66}},"51":{"start":{"line":174,"column":6},"end":{"line":176,"column":9}},"52":{"start":{"line":175,"column":8},"end":{"line":175,"column":37}},"53":{"start":{"line":177,"column":6},"end":{"line":177,"column":28}},"54":{"start":{"line":180,"column":6},"end":{"line":180,"column":56}},"55":{"start":{"line":181,"column":6},"end":{"line":181,"column":52}},"56":{"start":{"line":182,"column":6},"end":{"line":182,"column":52}},"57":{"start":{"line":183,"column":6},"end":{"line":183,"column":56}},"58":{"start":{"line":184,"column":6},"end":{"line":184,"column":107}},"59":{"start":{"line":185,"column":6},"end":{"line":185,"column":55}},"60":{"start":{"line":189,"column":4},"end":{"line":189,"column":59}},"61":{"start":{"line":190,"column":4},"end":{"line":190,"column":53}},"62":{"start":{"line":191,"column":4},"end":{"line":191,"column":60}},"63":{"start":{"line":192,"column":4},"end":{"line":192,"column":55}},"64":{"start":{"line":194,"column":4},"end":{"line":194,"column":26}},"65":{"start":{"line":198,"column":4},"end":{"line":213,"column":5}},"66":{"start":{"line":199,"column":6},"end":{"line":199,"column":34}},"67":{"start":{"line":200,"column":6},"end":{"line":200,"column":18}},"68":{"start":{"line":202,"column":6},"end":{"line":212,"column":7}},"69":{"start":{"line":204,"column":10},"end":{"line":204,"column":27}},"70":{"start":{"line":205,"column":10},"end":{"line":205,"column":22}},"71":{"start":{"line":207,"column":10},"end":{"line":207,"column":44}},"72":{"start":{"line":208,"column":10},"end":{"line":210,"column":11}},"73":{"start":{"line":209,"column":12},"end":{"line":209,"column":40}},"74":{"start":{"line":211,"column":10},"end":{"line":211,"column":22}},"75":{"start":{"line":216,"column":4},"end":{"line":218,"column":5}},"76":{"start":{"line":217,"column":6},"end":{"line":217,"column":34}},"77":{"start":{"line":221,"column":4},"end":{"line":258,"column":5}},"78":{"start":{"line":222,"column":6},"end":{"line":224,"column":7}},"79":{"start":{"line":223,"column":8},"end":{"line":223,"column":32}},"80":{"start":{"line":225,"column":6},"end":{"line":225,"column":18}},"81":{"start":{"line":227,"column":6},"end":{"line":257,"column":7}},"82":{"start":{"line":229,"column":10},"end":{"line":229,"column":38}},"83":{"start":{"line":230,"column":10},"end":{"line":234,"column":12}},"84":{"start":{"line":231,"column":12},"end":{"line":233,"column":13}},"85":{"start":{"line":232,"column":14},"end":{"line":232,"column":40}},"86":{"start":{"line":235,"column":10},"end":{"line":235,"column":43}},"87":{"start":{"line":236,"column":10},"end":{"line":236,"column":39}},"88":{"start":{"line":237,"column":10},"end":{"line":237,"column":39}},"89":{"start":{"line":238,"column":10},"end":{"line":238,"column":43}},"90":{"start":{"line":239,"column":10},"end":{"line":239,"column":42}},"91":{"start":{"line":242,"column":10},"end":{"line":245,"column":12}},"92":{"start":{"line":246,"column":10},"end":{"line":251,"column":11}},"93":{"start":{"line":247,"column":12},"end":{"line":247,"column":48}},"94":{"start":{"line":248,"column":12},"end":{"line":250,"column":15}},"95":{"start":{"line":249,"column":14},"end":{"line":249,"column":57}},"96":{"start":{"line":253,"column":10},"end":{"line":253,"column":23}},"97":{"start":{"line":256,"column":10},"end":{"line":256,"column":22}},"98":{"start":{"line":265,"column":4},"end":{"line":267,"column":5}},"99":{"start":{"line":266,"column":6},"end":{"line":266,"column":15}},"100":{"start":{"line":270,"column":4},"end":{"line":272,"column":5}},"101":{"start":{"line":271,"column":6},"end":{"line":271,"column":37}},"102":{"start":{"line":274,"column":4},"end":{"line":274,"column":19}},"103":{"start":{"line":275,"column":4},"end":{"line":275,"column":50}},"104":{"start":{"line":277,"column":4},"end":{"line":288,"column":5}},"105":{"start":{"line":278,"column":6},"end":{"line":278,"column":56}},"106":{"start":{"line":280,"column":6},"end":{"line":287,"column":7}},"107":{"start":{"line":282,"column":10},"end":{"line":282,"column":57}},"108":{"start":{"line":283,"column":10},"end":{"line":283,"column":16}},"109":{"start":{"line":285,"column":10},"end":{"line":285,"column":58}},"110":{"start":{"line":286,"column":10},"end":{"line":286,"column":16}},"111":{"start":{"line":290,"column":4},"end":{"line":292,"column":5}},"112":{"start":{"line":291,"column":6},"end":{"line":291,"column":47}},"113":{"start":{"line":294,"column":4},"end":{"line":296,"column":5}},"114":{"start":{"line":295,"column":6},"end":{"line":295,"column":53}},"115":{"start":{"line":298,"column":4},"end":{"line":300,"column":5}},"116":{"start":{"line":299,"column":6},"end":{"line":299,"column":47}},"117":{"start":{"line":302,"column":4},"end":{"line":304,"column":5}},"118":{"start":{"line":303,"column":6},"end":{"line":303,"column":41}},"119":{"start":{"line":306,"column":4},"end":{"line":306,"column":40}},"120":{"start":{"line":307,"column":4},"end":{"line":309,"column":5}},"121":{"start":{"line":308,"column":6},"end":{"line":308,"column":39}},"122":{"start":{"line":310,"column":4},"end":{"line":310,"column":19}},"123":{"start":{"line":317,"column":4},"end":{"line":317,"column":37}},"124":{"start":{"line":318,"column":4},"end":{"line":318,"column":28}},"125":{"start":{"line":318,"column":15},"end":{"line":318,"column":28}},"126":{"start":{"line":321,"column":4},"end":{"line":321,"column":38}},"127":{"start":{"line":322,"column":4},"end":{"line":322,"column":28}},"128":{"start":{"line":322,"column":16},"end":{"line":322,"column":28}},"129":{"start":{"line":325,"column":4},"end":{"line":325,"column":38}},"130":{"start":{"line":329,"column":4},"end":{"line":334,"column":5}},"131":{"start":{"line":330,"column":6},"end":{"line":330,"column":102}},"132":{"start":{"line":331,"column":6},"end":{"line":333,"column":7}},"133":{"start":{"line":332,"column":8},"end":{"line":332,"column":30}},"134":{"start":{"line":336,"column":4},"end":{"line":343,"column":5}},"135":{"start":{"line":337,"column":6},"end":{"line":342,"column":7}},"136":{"start":{"line":338,"column":8},"end":{"line":338,"column":29}},"137":{"start":{"line":339,"column":8},"end":{"line":341,"column":9}},"138":{"start":{"line":340,"column":10},"end":{"line":340,"column":29}},"139":{"start":{"line":345,"column":4},"end":{"line":345,"column":53}},"140":{"start":{"line":346,"column":4},"end":{"line":346,"column":59}},"141":{"start":{"line":347,"column":4},"end":{"line":347,"column":53}},"142":{"start":{"line":351,"column":4},"end":{"line":353,"column":5}},"143":{"start":{"line":352,"column":6},"end":{"line":352,"column":40}},"144":{"start":{"line":355,"column":4},"end":{"line":355,"column":17}},"145":{"start":{"line":361,"column":4},"end":{"line":361,"column":42}},"146":{"start":{"line":362,"column":4},"end":{"line":362,"column":38}},"147":{"start":{"line":363,"column":4},"end":{"line":366,"column":5}},"148":{"start":{"line":364,"column":6},"end":{"line":364,"column":63}},"149":{"start":{"line":365,"column":6},"end":{"line":365,"column":34}},"150":{"start":{"line":367,"column":4},"end":{"line":367,"column":17}},"151":{"start":{"line":374,"column":4},"end":{"line":374,"column":56}},"152":{"start":{"line":375,"column":4},"end":{"line":375,"column":42}},"153":{"start":{"line":375,"column":29},"end":{"line":375,"column":42}},"154":{"start":{"line":378,"column":4},"end":{"line":378,"column":42}},"155":{"start":{"line":379,"column":4},"end":{"line":379,"column":42}},"156":{"start":{"line":379,"column":29},"end":{"line":379,"column":42}},"157":{"start":{"line":382,"column":4},"end":{"line":382,"column":84}},"158":{"start":{"line":383,"column":4},"end":{"line":383,"column":73}},"159":{"start":{"line":384,"column":4},"end":{"line":384,"column":33}},"160":{"start":{"line":385,"column":4},"end":{"line":385,"column":17}},"161":{"start":{"line":391,"column":4},"end":{"line":391,"column":40}},"162":{"start":{"line":392,"column":4},"end":{"line":392,"column":37}},"163":{"start":{"line":393,"column":4},"end":{"line":396,"column":5}},"164":{"start":{"line":394,"column":6},"end":{"line":394,"column":61}},"165":{"start":{"line":395,"column":6},"end":{"line":395,"column":33}},"166":{"start":{"line":397,"column":4},"end":{"line":397,"column":17}},"167":{"start":{"line":403,"column":4},"end":{"line":403,"column":44}},"168":{"start":{"line":404,"column":4},"end":{"line":404,"column":39}},"169":{"start":{"line":405,"column":4},"end":{"line":408,"column":5}},"170":{"start":{"line":406,"column":6},"end":{"line":406,"column":65}},"171":{"start":{"line":407,"column":6},"end":{"line":407,"column":35}},"172":{"start":{"line":409,"column":4},"end":{"line":409,"column":17}},"173":{"start":{"line":415,"column":4},"end":{"line":415,"column":40}},"174":{"start":{"line":416,"column":4},"end":{"line":416,"column":37}},"175":{"start":{"line":417,"column":4},"end":{"line":420,"column":5}},"176":{"start":{"line":418,"column":6},"end":{"line":418,"column":61}},"177":{"start":{"line":419,"column":6},"end":{"line":419,"column":33}},"178":{"start":{"line":421,"column":4},"end":{"line":421,"column":17}},"179":{"start":{"line":428,"column":0},"end":{"line":440,"column":2}},"180":{"start":{"line":429,"column":2},"end":{"line":429,"column":25}},"181":{"start":{"line":430,"column":2},"end":{"line":439,"column":4}},"182":{"start":{"line":442,"column":0},"end":{"line":480,"column":3}},"183":{"start":{"line":448,"column":4},"end":{"line":448,"column":23}},"184":{"start":{"line":449,"column":4},"end":{"line":449,"column":40}},"185":{"start":{"line":456,"column":4},"end":{"line":461,"column":5}},"186":{"start":{"line":458,"column":8},"end":{"line":458,"column":32}},"187":{"start":{"line":460,"column":8},"end":{"line":460,"column":17}},"188":{"start":{"line":465,"column":4},"end":{"line":471,"column":5}},"189":{"start":{"line":466,"column":6},"end":{"line":468,"column":8}},"190":{"start":{"line":469,"column":6},"end":{"line":469,"column":51}},"191":{"start":{"line":470,"column":6},"end":{"line":470,"column":40}},"192":{"start":{"line":472,"column":4},"end":{"line":472,"column":29}},"193":{"start":{"line":478,"column":4},"end":{"line":478,"column":13}}},"branchMap":{"1":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":2},"end":{"line":69,"column":2}},{"start":{"line":69,"column":2},"end":{"line":69,"column":2}}]},"2":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":12},"end":{"line":136,"column":17}},{"start":{"line":136,"column":21},"end":{"line":136,"column":31}}]},"3":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":143,"column":4}},{"start":{"line":143,"column":4},"end":{"line":143,"column":4}}]},"4":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":6},"end":{"line":145,"column":6}},{"start":{"line":145,"column":6},"end":{"line":145,"column":6}}]},"5":{"line":145,"type":"binary-expr","locations":[{"start":{"line":145,"column":10},"end":{"line":145,"column":23}},{"start":{"line":145,"column":27},"end":{"line":145,"column":47}}]},"6":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":4},"end":{"line":198,"column":4}},{"start":{"line":198,"column":4},"end":{"line":198,"column":4}}]},"7":{"line":202,"type":"switch","locations":[{"start":{"line":203,"column":8},"end":{"line":205,"column":22}},{"start":{"line":206,"column":8},"end":{"line":211,"column":22}}]},"8":{"line":208,"type":"if","locations":[{"start":{"line":208,"column":10},"end":{"line":208,"column":10}},{"start":{"line":208,"column":10},"end":{"line":208,"column":10}}]},"9":{"line":216,"type":"if","locations":[{"start":{"line":216,"column":4},"end":{"line":216,"column":4}},{"start":{"line":216,"column":4},"end":{"line":216,"column":4}}]},"10":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":4},"end":{"line":221,"column":4}},{"start":{"line":221,"column":4},"end":{"line":221,"column":4}}]},"11":{"line":222,"type":"if","locations":[{"start":{"line":222,"column":6},"end":{"line":222,"column":6}},{"start":{"line":222,"column":6},"end":{"line":222,"column":6}}]},"12":{"line":227,"type":"switch","locations":[{"start":{"line":228,"column":8},"end":{"line":253,"column":23}},{"start":{"line":254,"column":8},"end":{"line":256,"column":22}}]},"13":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":12},"end":{"line":231,"column":12}},{"start":{"line":231,"column":12},"end":{"line":231,"column":12}}]},"14":{"line":231,"type":"binary-expr","locations":[{"start":{"line":231,"column":16},"end":{"line":231,"column":27}},{"start":{"line":231,"column":31},"end":{"line":231,"column":49}}]},"15":{"line":246,"type":"if","locations":[{"start":{"line":246,"column":10},"end":{"line":246,"column":10}},{"start":{"line":246,"column":10},"end":{"line":246,"column":10}}]},"16":{"line":265,"type":"if","locations":[{"start":{"line":265,"column":4},"end":{"line":265,"column":4}},{"start":{"line":265,"column":4},"end":{"line":265,"column":4}}]},"17":{"line":270,"type":"if","locations":[{"start":{"line":270,"column":4},"end":{"line":270,"column":4}},{"start":{"line":270,"column":4},"end":{"line":270,"column":4}}]},"18":{"line":270,"type":"binary-expr","locations":[{"start":{"line":270,"column":8},"end":{"line":270,"column":20}},{"start":{"line":270,"column":24},"end":{"line":270,"column":47}}]},"19":{"line":275,"type":"binary-expr","locations":[{"start":{"line":275,"column":15},"end":{"line":275,"column":23}},{"start":{"line":275,"column":27},"end":{"line":275,"column":49}}]},"20":{"line":277,"type":"if","locations":[{"start":{"line":277,"column":4},"end":{"line":277,"column":4}},{"start":{"line":277,"column":4},"end":{"line":277,"column":4}}]},"21":{"line":280,"type":"switch","locations":[{"start":{"line":281,"column":8},"end":{"line":283,"column":16}},{"start":{"line":284,"column":8},"end":{"line":286,"column":16}}]},"22":{"line":290,"type":"if","locations":[{"start":{"line":290,"column":4},"end":{"line":290,"column":4}},{"start":{"line":290,"column":4},"end":{"line":290,"column":4}}]},"23":{"line":294,"type":"if","locations":[{"start":{"line":294,"column":4},"end":{"line":294,"column":4}},{"start":{"line":294,"column":4},"end":{"line":294,"column":4}}]},"24":{"line":298,"type":"if","locations":[{"start":{"line":298,"column":4},"end":{"line":298,"column":4}},{"start":{"line":298,"column":4},"end":{"line":298,"column":4}}]},"25":{"line":302,"type":"if","locations":[{"start":{"line":302,"column":4},"end":{"line":302,"column":4}},{"start":{"line":302,"column":4},"end":{"line":302,"column":4}}]},"26":{"line":307,"type":"if","locations":[{"start":{"line":307,"column":4},"end":{"line":307,"column":4}},{"start":{"line":307,"column":4},"end":{"line":307,"column":4}}]},"27":{"line":318,"type":"if","locations":[{"start":{"line":318,"column":4},"end":{"line":318,"column":4}},{"start":{"line":318,"column":4},"end":{"line":318,"column":4}}]},"28":{"line":322,"type":"if","locations":[{"start":{"line":322,"column":4},"end":{"line":322,"column":4}},{"start":{"line":322,"column":4},"end":{"line":322,"column":4}}]},"29":{"line":329,"type":"if","locations":[{"start":{"line":329,"column":4},"end":{"line":329,"column":4}},{"start":{"line":329,"column":4},"end":{"line":329,"column":4}}]},"30":{"line":330,"type":"binary-expr","locations":[{"start":{"line":330,"column":19},"end":{"line":330,"column":52}},{"start":{"line":330,"column":56},"end":{"line":330,"column":101}}]},"31":{"line":331,"type":"if","locations":[{"start":{"line":331,"column":6},"end":{"line":331,"column":6}},{"start":{"line":331,"column":6},"end":{"line":331,"column":6}}]},"32":{"line":337,"type":"if","locations":[{"start":{"line":337,"column":6},"end":{"line":337,"column":6}},{"start":{"line":337,"column":6},"end":{"line":337,"column":6}}]},"33":{"line":339,"type":"if","locations":[{"start":{"line":339,"column":8},"end":{"line":339,"column":8}},{"start":{"line":339,"column":8},"end":{"line":339,"column":8}}]},"34":{"line":351,"type":"if","locations":[{"start":{"line":351,"column":4},"end":{"line":351,"column":4}},{"start":{"line":351,"column":4},"end":{"line":351,"column":4}}]},"35":{"line":363,"type":"if","locations":[{"start":{"line":363,"column":4},"end":{"line":363,"column":4}},{"start":{"line":363,"column":4},"end":{"line":363,"column":4}}]},"36":{"line":375,"type":"if","locations":[{"start":{"line":375,"column":4},"end":{"line":375,"column":4}},{"start":{"line":375,"column":4},"end":{"line":375,"column":4}}]},"37":{"line":379,"type":"if","locations":[{"start":{"line":379,"column":4},"end":{"line":379,"column":4}},{"start":{"line":379,"column":4},"end":{"line":379,"column":4}}]},"38":{"line":393,"type":"if","locations":[{"start":{"line":393,"column":4},"end":{"line":393,"column":4}},{"start":{"line":393,"column":4},"end":{"line":393,"column":4}}]},"39":{"line":405,"type":"if","locations":[{"start":{"line":405,"column":4},"end":{"line":405,"column":4}},{"start":{"line":405,"column":4},"end":{"line":405,"column":4}}]},"40":{"line":417,"type":"if","locations":[{"start":{"line":417,"column":4},"end":{"line":417,"column":4}},{"start":{"line":417,"column":4},"end":{"line":417,"column":4}}]},"41":{"line":456,"type":"switch","locations":[{"start":{"line":457,"column":6},"end":{"line":458,"column":32}},{"start":{"line":459,"column":6},"end":{"line":460,"column":17}}]},"42":{"line":465,"type":"if","locations":[{"start":{"line":465,"column":4},"end":{"line":465,"column":4}},{"start":{"line":465,"column":4},"end":{"line":465,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var events = require('events');","var PromishLib = require('../../../utils/promish');","","var utils = require('../../../utils/utils');","var Enums = require('../../../doc/enums');","var XmlStream = require('../../../utils/xml-stream');","","var BaseXform = require('../base-xform');","var StaticXform = require('../static-xform');","var ListXform = require('../list-xform');","var FontXform = require('./font-xform');","var FillXform = require('./fill-xform');","var BorderXform = require('./border-xform');","var NumFmtXform = require('./numfmt-xform');","var StyleXform = require('./style-xform');","","// custom numfmt ids start here","var NUMFMT_BASE = 164;","","// =============================================================================","// StylesXform is used to generate and parse the styles.xml file","// it manages the collections of fonts, number formats, alignments, etc","var StylesXform = module.exports = function(initialise) {","  this.map = {","    numFmts: new ListXform({tag: 'numFmts', count: true, childXform: new NumFmtXform()}),","    fonts: new ListXform({tag: 'fonts', count: true, childXform: new FontXform(), $: {\"x14ac:knownFonts\": 1}}),","    fills: new ListXform({tag: 'fills', count: true, childXform: new FillXform()}),","    borders: new ListXform({tag: 'borders', count: true, childXform: new BorderXform()}),","    cellStyleXfs: new ListXform({tag: 'cellStyleXfs', count: true, childXform: new StyleXform()}),","    cellXfs: new ListXform({tag: 'cellXfs', count: true, childXform: new StyleXform({xfId: true})}),","    ","    // for style manager","    numFmt: new NumFmtXform(),","    font: new FontXform(),","    fill: new FillXform(),","    border:  new BorderXform(),","    style: new StyleXform({xfId: true}),","","    cellStyles: StylesXform.STATIC_XFORMS.cellStyles,","    dxfs: StylesXform.STATIC_XFORMS.dxfs,","    tableStyles: StylesXform.STATIC_XFORMS.tableStyles,","    extLst: StylesXform.STATIC_XFORMS.extLst","  };","","  if (initialise) {","    // StylesXform also acts as style manager and is used to build up styles-model during worksheet processing","    this.init();","  }","};","","utils.inherits(StylesXform, BaseXform, {","  STYLESHEET_ATTRIBUTES: {","    'xmlns': \"http://schemas.openxmlformats.org/spreadsheetml/2006/main\",","    'xmlns:mc': \"http://schemas.openxmlformats.org/markup-compatibility/2006\",","    'mc:Ignorable': \"x14ac x16r2\",","    'xmlns:x14ac': \"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\",","    'xmlns:x16r2': \"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main\"","  },","  STATIC_XFORMS: {","    cellStyles: new StaticXform({tag: 'cellStyles', $: {count:1}, c: [{tag:'cellStyle', $: {name:'Normal', xfId:0, builtinId:0}}]}),","    dxfs: new StaticXform({tag: 'dxfs', $: {count:0}}),","    tableStyles: new StaticXform({tag: 'tableStyles', $: {count: 0, defaultTableStyle: 'TableStyleMedium2', defaultPivotStyle: 'PivotStyleLight16'}}),","    extLst: new StaticXform({tag: 'extLst', c: [","      {tag: 'ext', $: {uri:'{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}', 'xmlns:x14': 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/main'}, c: [","        {tag: 'x14:slicerStyles', $:{defaultSlicerStyle: 'SlicerStyleLight1'}}","      ]},","      {tag: 'ext', $: {uri:'{9260A510-F301-46a8-8635-F512D64BE5F5}', 'xmlns:x15': 'http://schemas.microsoft.com/office/spreadsheetml/2010/11/main'}, c: [","        {tag: 'x15:timelineStyles', $:{defaultTimelineStyle: 'TimeSlicerStyleLight1'}}","      ]}","    ]})","  }","},{","","  initIndex: function() {","    this.index = {","      style: {},","      numFmt: {},","      numFmtNextId: 164, // start custom format ids here","      font: {},","      border: {},","      fill: {}","    };","  },","","  init: function() {","    // Prepare for Style Manager role","    this.model = {","      styles: [],","      numFmts: [],","      fonts: [],","      borders: [],","      fills: []","    };","","    this.initIndex();","","    // default (zero) font","    this._addFont({size: 11, color: {theme:1}, name: 'Calibri', family:2, scheme:'minor'});","","    // default (zero) border","    this._addBorder({});","","    // add default (all zero) style","    this._addStyle({numFmtId: 0, fontId: 0, fillId: 0, borderId: 0, xfId: 0});","","    // add default fills","    this._addFill({type: 'pattern', pattern:'none'});","    this._addFill({type: 'pattern', pattern:'gray125'});","  },","","  render: function(xmlStream, model) {","    model = model || this.model;","    //","    //   <fonts count=\"2\" x14ac:knownFonts=\"1\">","    xmlStream.openXml(XmlStream.StdDocAttributes);","","    xmlStream.openNode('styleSheet', StylesXform.STYLESHEET_ATTRIBUTES);","","    if (this.index) {","      // model has been built by style manager role (contains xml)","      if (model.numFmts && model.numFmts.length) {","        xmlStream.openNode('numFmts', {count: model.numFmts.length});","        model.numFmts.forEach(function(numFmtXml) {","          xmlStream.writeXml(numFmtXml);","        });","        xmlStream.closeNode();","      }","","      xmlStream.openNode('fonts', {count: model.fonts.length});","      model.fonts.forEach(function(fontXml) {","        xmlStream.writeXml(fontXml);","      });","      xmlStream.closeNode();","","      xmlStream.openNode('fills', {count: model.fills.length});","      model.fills.forEach(function(fillXml) {","        xmlStream.writeXml(fillXml);","      });","      xmlStream.closeNode();","","      xmlStream.openNode('borders', {count: model.borders.length});","      model.borders.forEach(function(borderXml) {","        xmlStream.writeXml(borderXml);","      });","      xmlStream.closeNode();","","      this.map.cellStyleXfs.render(xmlStream, [{numFmtId: 0, fontId: 0, fillId: 0, borderId: 0, xfId: 0}]);","","      xmlStream.openNode('cellXfs', {count: model.styles.length});","      model.styles.forEach(function(styleXml) {","        xmlStream.writeXml(styleXml);","      });","      xmlStream.closeNode();","    } else {","      // model is plain JSON and needs to be xformed","      this.map.numFmts.render(xmlStream, model.numFmts);","      this.map.fonts.render(xmlStream, model.fonts);","      this.map.fills.render(xmlStream, model.fills);","      this.map.borders.render(xmlStream, model.borders);","      this.map.cellStyleXfs.render(xmlStream, [{numFmtId: 0, fontId: 0, fillId: 0, borderId: 0, xfId: 0}]);","      this.map.cellXfs.render(xmlStream, model.styles);","    }","","    // trailing static stuff","    StylesXform.STATIC_XFORMS.cellStyles.render(xmlStream);","    StylesXform.STATIC_XFORMS.dxfs.render(xmlStream);","    StylesXform.STATIC_XFORMS.tableStyles.render(xmlStream);","    StylesXform.STATIC_XFORMS.extLst.render(xmlStream);","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'styleSheet':","          this.initIndex();","          return true;","        default:","          this.parser = this.map[node.name];","          if (this.parser) {","            this.parser.parseOpen(node);","          }","          return true;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case 'styleSheet':","          var model = this.model = {};","          var add = function(name, xform) {","            if (xform.model && xform.model.length) {","              model[name] = xform.model;","            }","          };","          add('numFmts', this.map.numFmts);","          add('fonts', this.map.fonts);","          add('fills', this.map.fills);","          add('borders', this.map.borders);","          add('styles', this.map.cellXfs);","","          // index numFmts","          this.index = {","            model:[],","            numFmt:  []","          };","          if (model.numFmts) {","            var numFmtIndex = this.index.numFmt;","            model.numFmts.forEach(function (numFmt) {","              numFmtIndex[numFmt.id] = numFmt.formatCode;","            });","          }","","          return false;","        default:","          // not quite sure how we get here!","          return true;","      }","    }","  },","","  // add a cell's style model to the collection","  // each style property is processed and cross-referenced, etc.","  // the styleId is returned. Note: cellType is used when numFmt not defined","  addStyleModel: function(model, cellType) {","    if (!model) {","      return 0;","    }","","    // if we have seen this style object before, assume it has the same styleId","    if (this.weakMap && this.weakMap.has(model)) {","      return this.weakMap.get(model);","    }","","    var style = {};","    cellType = cellType || Enums.ValueType.Number;","","    if (model.numFmt) {","      style.numFmtId = this._addNumFmtStr(model.numFmt);","    } else {","      switch(cellType) {","        case Enums.ValueType.Number:","          style.numFmtId = this._addNumFmtStr('General');","          break;","        case Enums.ValueType.Date:","          style.numFmtId = this._addNumFmtStr('mm-dd-yy');","          break;","      }","    }","","    if (model.font) {","      style.fontId = this._addFont(model.font);","    }","","    if (model.border) {","      style.borderId = this._addBorder(model.border);","    }","","    if (model.fill) {","      style.fillId = this._addFill(model.fill);","    }","","    if (model.alignment) {","      style.alignment =  model.alignment;","    }","","    var styleId = this._addStyle(style);","    if (this.weakMap) {","      this.weakMap.set(model, styleId);","    }","    return styleId;","  },","","  // given a styleId (i.e. s=\"n\"), get the cell's style model","  // objects are shared where possible.","  getStyleModel: function(id) {","    // have we built this model before?","    var model = this.index.model[id];","    if (model) return model;","","    // if the style doesn't exist return null","    var style = this.model.styles[id];","    if (!style) return null;","","    // build a new model","    model = this.index.model[id] = {};","","    // -------------------------------------------------------","    // number format","    if (style.numFmtId) {","      var numFmt = this.index.numFmt[style.numFmtId] || NumFmtXform.getDefaultFmtCode(style.numFmtId);","      if (numFmt) {","        model.numFmt = numFmt;","      }","    }","","    function addStyle(name, group, id) {","      if (id) {","        var part = group[id];","        if (part) {","          model[name] = part;","        }","      }","    }","","    addStyle('font', this.model.fonts, style.fontId);","    addStyle('border', this.model.borders, style.borderId);","    addStyle('fill', this.model.fills, style.fillId);","","    // -------------------------------------------------------","    // alignment","    if (style.alignment) {","      model.alignment = style.alignment;","    }","","    return model;","  },","","  // =========================================================================","  // Private Interface","  _addStyle: function(style) {","    var xml = this.map.style.toXml(style);","    var index = this.index.style[xml];","    if (index === undefined) {","      index = this.index.style[xml] = this.model.styles.length;","      this.model.styles.push(xml);","    }","    return index;","  },","","  // =========================================================================","  // Number Formats","  _addNumFmtStr: function(formatCode) {","    // check if default format","    var index = NumFmtXform.getDefaultFmtId(formatCode);","    if (index !== undefined) return index;","","    // check if already in","    index = this.index.numFmt[formatCode];","    if (index !== undefined) return index;","","","    index = this.index.numFmt[formatCode] = NUMFMT_BASE + this.model.numFmts.length;","    var xml = this.map.numFmt.toXml({id: index, formatCode: formatCode});","    this.model.numFmts.push(xml);","    return index;","  },","","  // =========================================================================","  // Fonts","  _addFont: function(font) {","    var xml = this.map.font.toXml(font);","    var index = this.index.font[xml];","    if (index === undefined) {","      index = this.index.font[xml] = this.model.fonts.length;","      this.model.fonts.push(xml);","    }","    return index;","  },","","  // =========================================================================","  // Borders","  _addBorder: function(border) {","    var xml = this.map.border.toXml(border);","    var index = this.index.border[xml];","    if (index === undefined) {","      index = this.index.border[xml] = this.model.borders.length;","      this.model.borders.push(xml);","    }","    return index;","  },","","  // =========================================================================","  // Fills","  _addFill: function(fill) {","    var xml = this.map.fill.toXml(fill);","    var index = this.index.fill[xml];","    if (index === undefined) {","      index = this.index.fill[xml] = this.model.fills.length;","      this.model.fills.push(xml);","    }","    return index;","  }","","  // =========================================================================","});","","// the stylemanager mock acts like StyleManager except that it always returns 0 or {}","StylesXform.Mock = function() {","  StylesXform.call(this);","  this.model = {","    styles: [{numFmtId: 0, fontId: 0, fillId: 0, borderId: 0, xfId: 0}],","    numFmts: [],","    fonts: [{size: 11, color: {theme:1}, name: 'Calibri', family:2, scheme:'minor'}],","    borders: [{}],","    fills:  [","      {type: 'pattern', pattern:'none'},","      {type: 'pattern', pattern:'gray125'}","    ]","  };","};","","utils.inherits(StylesXform.Mock, StylesXform, {","  // =========================================================================","  // Style Manager Interface","","  // override normal behaviour - consume and dispose","  parseStream: function(stream) {","    stream.autodrain();","    return PromishLib.Promish.resolve();","  },","","  // add a cell's style model to the collection","  // each style property is processed and cross-referenced, etc.","  // the styleId is returned. Note: cellType is used when numFmt not defined","  addStyleModel: function(model, cellType) {","    switch (cellType) {","      case Enums.ValueType.Date:","        return this.dateStyleId;","      default:","        return 0;","    }","  },","","  get dateStyleId() {","    if (!this._dateStyleId) {","      var dateStyle = {","        numFmtId: NumFmtXform.getDefaultFmtId('mm-dd-yy')","      };","      this._dateStyleId = this.model.styles.length;","      this.model.styles.push(dateStyle);","    }","    return this._dateStyleId;","  },","","  // given a styleId (i.e. s=\"n\"), get the cell's style model","  // objects are shared where possible.","  getStyleModel: function(/*id*/) {","    return {}","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":1,"30":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"42":1,"47":1,"48":0,"69":0,"71":0,"75":1,"99":0,"111":0,"119":0,"122":0,"125":0,"128":0,"131":0,"132":0,"136":0,"139":0,"141":0,"143":0,"145":0,"146":0,"147":0,"148":0,"150":0,"153":0,"154":0,"155":0,"157":0,"159":0,"160":0,"161":0,"163":0,"165":0,"166":0,"167":0,"169":0,"171":0,"173":0,"174":0,"175":0,"177":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"189":0,"190":0,"191":0,"192":0,"194":0,"198":0,"199":0,"200":0,"202":0,"204":0,"205":0,"207":0,"208":0,"209":0,"211":0,"216":0,"217":0,"221":0,"222":0,"223":0,"225":0,"227":0,"229":0,"230":0,"231":0,"232":0,"235":0,"236":0,"237":0,"238":0,"239":0,"242":0,"246":0,"247":0,"248":0,"249":0,"253":0,"256":0,"265":0,"266":0,"270":0,"271":0,"274":0,"275":0,"277":0,"278":0,"280":0,"282":0,"283":0,"285":0,"286":0,"290":0,"291":0,"294":0,"295":0,"298":0,"299":0,"302":0,"303":0,"306":0,"307":0,"308":0,"310":0,"317":0,"318":0,"321":0,"322":0,"325":0,"329":0,"330":0,"331":0,"332":0,"336":1,"337":0,"338":0,"339":0,"340":0,"345":0,"346":0,"347":0,"351":0,"352":0,"355":0,"361":0,"362":0,"363":0,"364":0,"365":0,"367":0,"374":0,"375":0,"378":0,"379":0,"382":0,"383":0,"384":0,"385":0,"391":0,"392":0,"393":0,"394":0,"395":0,"397":0,"403":0,"404":0,"405":0,"406":0,"407":0,"409":0,"415":0,"416":0,"417":0,"418":0,"419":0,"421":0,"428":1,"429":0,"430":0,"442":1,"448":0,"449":0,"456":0,"458":0,"460":0,"465":0,"466":0,"469":0,"470":0,"472":0,"478":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/base-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/base-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":33},"end":{"line":31,"column":55}}},"2":{"name":"(anonymous_2)","line":37,"loc":{"start":{"line":37,"column":12},"end":{"line":37,"column":37}}},"3":{"name":"(anonymous_3)","line":40,"loc":{"start":{"line":40,"column":10},"end":{"line":40,"column":37}}},"4":{"name":"(anonymous_4)","line":43,"loc":{"start":{"line":43,"column":14},"end":{"line":43,"column":29}}},"5":{"name":"(anonymous_5)","line":46,"loc":{"start":{"line":46,"column":13},"end":{"line":46,"column":28}}},"6":{"name":"(anonymous_6)","line":49,"loc":{"start":{"line":49,"column":14},"end":{"line":49,"column":29}}},"7":{"name":"(anonymous_7)","line":52,"loc":{"start":{"line":52,"column":13},"end":{"line":52,"column":38}}},"8":{"name":"(anonymous_8)","line":57,"loc":{"start":{"line":57,"column":9},"end":{"line":57,"column":25}}},"9":{"name":"(anonymous_9)","line":61,"loc":{"start":{"line":61,"column":9},"end":{"line":61,"column":26}}},"10":{"name":"(anonymous_10)","line":63,"loc":{"start":{"line":63,"column":34},"end":{"line":63,"column":59}}},"11":{"name":"(anonymous_11)","line":64,"loc":{"start":{"line":64,"column":27},"end":{"line":64,"column":42}}},"12":{"name":"(anonymous_12)","line":67,"loc":{"start":{"line":67,"column":24},"end":{"line":67,"column":39}}},"13":{"name":"(anonymous_13)","line":70,"loc":{"start":{"line":70,"column":28},"end":{"line":70,"column":43}}},"14":{"name":"(anonymous_14)","line":75,"loc":{"start":{"line":75,"column":23},"end":{"line":75,"column":34}}},"15":{"name":"(anonymous_15)","line":78,"loc":{"start":{"line":78,"column":25},"end":{"line":78,"column":41}}},"16":{"name":"(anonymous_16)","line":83,"loc":{"start":{"line":83,"column":15},"end":{"line":83,"column":32}}},"17":{"name":"(anonymous_17)","line":90,"loc":{"start":{"line":90,"column":9},"end":{"line":90,"column":12}}},"18":{"name":"(anonymous_18)","line":96,"loc":{"start":{"line":96,"column":9},"end":{"line":96,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":25}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":48}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":50}},"4":{"start":{"line":31,"column":0},"end":{"line":32,"column":2}},"5":{"start":{"line":34,"column":0},"end":{"line":101,"column":2}},"6":{"start":{"line":59,"column":4},"end":{"line":59,"column":23}},"7":{"start":{"line":62,"column":4},"end":{"line":62,"column":20}},"8":{"start":{"line":63,"column":4},"end":{"line":81,"column":7}},"9":{"start":{"line":64,"column":6},"end":{"line":66,"column":9}},"10":{"start":{"line":65,"column":8},"end":{"line":65,"column":29}},"11":{"start":{"line":67,"column":6},"end":{"line":69,"column":9}},"12":{"start":{"line":68,"column":8},"end":{"line":68,"column":29}},"13":{"start":{"line":70,"column":6},"end":{"line":74,"column":9}},"14":{"start":{"line":71,"column":8},"end":{"line":73,"column":9}},"15":{"start":{"line":72,"column":10},"end":{"line":72,"column":30}},"16":{"start":{"line":75,"column":6},"end":{"line":77,"column":9}},"17":{"start":{"line":76,"column":8},"end":{"line":76,"column":28}},"18":{"start":{"line":78,"column":6},"end":{"line":80,"column":9}},"19":{"start":{"line":79,"column":8},"end":{"line":79,"column":22}},"20":{"start":{"line":84,"column":4},"end":{"line":84,"column":44}},"21":{"start":{"line":85,"column":4},"end":{"line":85,"column":37}},"22":{"start":{"line":86,"column":4},"end":{"line":86,"column":24}},"23":{"start":{"line":87,"column":4},"end":{"line":87,"column":19}},"24":{"start":{"line":93,"column":4},"end":{"line":93,"column":34}},"25":{"start":{"line":97,"column":4},"end":{"line":97,"column":36}},"26":{"start":{"line":98,"column":4},"end":{"line":98,"column":34}},"27":{"start":{"line":99,"column":4},"end":{"line":99,"column":25}}},"branchMap":{"1":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":8},"end":{"line":71,"column":8}},{"start":{"line":71,"column":8},"end":{"line":71,"column":8}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var Sax = require('sax');","var PromishLib = require('../../utils/promish');","","var XmlStream = require('../../utils/xml-stream');","","// Base class for Xforms","var BaseXform = module.exports = function(model, name) {","};","","BaseXform.prototype = {","  // ============================================================","  // Virtual Interface","  prepare:  function(model, options) {","    // optional preparation (mutation) of model so it is ready for write","  },","  render: function(xmlStream, model) {","    // convert model to xml","  },","  parseOpen:  function(node) {","    // Sax Open Node event","  },","  parseText: function(node) {","    // Sax Text event","  },","  parseClose: function(name) {","    // Sax Close Node event","  },","  reconcile: function(model, options) {","    // optional post-parse step (opposite to prepare)","  },","  ","  // ============================================================","  reset: function(model) {","    // to make sure parses don't bleed to next iteration","    this.model = model;","  },","  parse: function(parser) {","    var self = this;","    return new PromishLib.Promish(function(resolve, reject){","      parser.on('opentag', function(node) {","        self.parseOpen(node);","      });","      parser.on('text', function(text) {","        self.parseText(text);","      });","      parser.on('closetag', function(name) {","        if (!self.parseClose(name)) {","          resolve(self.model);","        }","      });","      parser.on('end', function() {","        resolve(self.model);","      });","      parser.on('error', function(error) {","        reject(error);","      });","    });","  },","  parseStream: function(stream) {","    var parser = Sax.createStream(true, {});","    var promise = this.parse(parser);","    stream.pipe(parser);","    return promise;","  },","  ","  get xml() {","    // convenience function to get the xml of this.model","    // useful for manager types that are built during the prepare phase","    return this.toXml(this.model);","  },","  ","  toXml: function(model) {","    var xmlStream = new XmlStream();","    this.render(xmlStream, model);","    return xmlStream.xml;","  }","};"],"l":{"25":1,"26":1,"28":1,"31":1,"34":1,"59":0,"62":0,"63":0,"64":0,"65":0,"67":0,"68":0,"70":0,"71":0,"72":0,"75":0,"76":0,"78":0,"79":0,"84":0,"85":0,"86":0,"87":0,"93":0,"97":0,"98":0,"99":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/static-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/static-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":6,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":6,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"build","line":38,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":33}}},"2":{"name":"(anonymous_2)","line":41,"loc":{"start":{"line":41,"column":20},"end":{"line":41,"column":37}}},"3":{"name":"(anonymous_3)","line":51,"loc":{"start":{"line":51,"column":35},"end":{"line":51,"column":51}}},"4":{"name":"(anonymous_4)","line":62,"loc":{"start":{"line":62,"column":10},"end":{"line":62,"column":30}}},"5":{"name":"(anonymous_5)","line":71,"loc":{"start":{"line":71,"column":13},"end":{"line":71,"column":24}}},"6":{"name":"(anonymous_6)","line":74,"loc":{"start":{"line":74,"column":13},"end":{"line":74,"column":24}}},"7":{"name":"(anonymous_7)","line":76,"loc":{"start":{"line":76,"column":14},"end":{"line":76,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":41}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":40}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":50}},"4":{"start":{"line":38,"column":0},"end":{"line":49,"column":1}},"5":{"start":{"line":39,"column":2},"end":{"line":39,"column":41}},"6":{"start":{"line":40,"column":2},"end":{"line":44,"column":3}},"7":{"start":{"line":41,"column":4},"end":{"line":43,"column":7}},"8":{"start":{"line":42,"column":6},"end":{"line":42,"column":30}},"9":{"start":{"line":45,"column":2},"end":{"line":47,"column":3}},"10":{"start":{"line":46,"column":4},"end":{"line":46,"column":33}},"11":{"start":{"line":48,"column":2},"end":{"line":48,"column":24}},"12":{"start":{"line":51,"column":0},"end":{"line":59,"column":2}},"13":{"start":{"line":58,"column":2},"end":{"line":58,"column":22}},"14":{"start":{"line":61,"column":0},"end":{"line":84,"column":3}},"15":{"start":{"line":63,"column":4},"end":{"line":67,"column":5}},"16":{"start":{"line":64,"column":6},"end":{"line":64,"column":35}},"17":{"start":{"line":65,"column":6},"end":{"line":65,"column":33}},"18":{"start":{"line":66,"column":6},"end":{"line":66,"column":29}},"19":{"start":{"line":68,"column":4},"end":{"line":68,"column":34}},"20":{"start":{"line":72,"column":4},"end":{"line":72,"column":16}},"21":{"start":{"line":77,"column":4},"end":{"line":82,"column":5}},"22":{"start":{"line":79,"column":8},"end":{"line":79,"column":21}},"23":{"start":{"line":81,"column":8},"end":{"line":81,"column":20}}},"branchMap":{"1":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":2},"end":{"line":40,"column":2}},{"start":{"line":40,"column":2},"end":{"line":40,"column":2}}]},"2":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":2},"end":{"line":45,"column":2}},{"start":{"line":45,"column":2},"end":{"line":45,"column":2}}]},"3":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"4":{"line":77,"type":"switch","locations":[{"start":{"line":78,"column":6},"end":{"line":79,"column":21}},{"start":{"line":80,"column":6},"end":{"line":81,"column":20}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../utils/utils');","var BaseXform = require('./base-xform');","var XmlStream = require('../../utils/xml-stream');","","// var model = {","//   tag: 'name',","//   $: {attr: 'value'},","//   c: [","//     { tag: 'child' }","//   ],","//   t: 'some text'","// };","","function build(xmlStream, model) {","  xmlStream.openNode(model.tag, model.$);","  if (model.c) {","    model.c.forEach(function (child) {","      build(xmlStream, child);","    });","  }","  if (model.t) {","    xmlStream.writeText(model.t);","  }","  xmlStream.closeNode();","}","","var StaticXform = module.exports = function(model) {","  // This class is an optimisation for static (unimportant and unchanging) xml","  // It is stateless - apart from its static model and so can be used as a singleton","  // Being stateless - it will only track entry to and exit from it's root xml tag during parsing and nothing else","  // Known issues:","  //    since stateless - parseOpen always returns true. Parent xform must know when to start using this xform","  //    if the root tag is recursive, the parsing will behave unpredictably","  this._model = model;","};","","utils.inherits(StaticXform, BaseXform, {","  render: function(xmlStream) {","    if (!this._xml) {","      var stream = new XmlStream();","      build(stream, this._model);","      this._xml = stream.xml;","    }","    xmlStream.writeXml(this._xml);","  },","","  parseOpen: function() {","    return true;","  },","  parseText: function() {","  },","  parseClose: function(name) {","    switch(name) {","      case this._model.tag:","        return false;","      default:","        return true;","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"38":1,"39":0,"40":0,"41":0,"42":0,"45":0,"46":0,"48":0,"51":1,"58":6,"61":1,"63":0,"64":0,"65":0,"66":0,"68":0,"72":0,"77":0,"79":0,"81":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/list-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/list-xform.js","s":{"1":1,"2":1,"3":1,"4":3,"5":3,"6":3,"7":3,"8":3,"9":3,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0},"b":{"1":[3,3],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":3,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":33},"end":{"line":28,"column":51}}},"2":{"name":"(anonymous_2)","line":38,"loc":{"start":{"line":38,"column":11},"end":{"line":38,"column":36}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":20},"end":{"line":41,"column":42}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":10},"end":{"line":47,"column":37}}},"5":{"name":"(anonymous_5)","line":55,"loc":{"start":{"line":55,"column":20},"end":{"line":55,"column":42}}},"6":{"name":"(anonymous_6)","line":65,"loc":{"start":{"line":65,"column":13},"end":{"line":65,"column":28}}},"7":{"name":"(anonymous_7)","line":84,"loc":{"start":{"line":84,"column":13},"end":{"line":84,"column":28}}},"8":{"name":"(anonymous_8)","line":89,"loc":{"start":{"line":89,"column":14},"end":{"line":89,"column":29}}},"9":{"name":"(anonymous_9)","line":100,"loc":{"start":{"line":100,"column":13},"end":{"line":100,"column":38}}},"10":{"name":"(anonymous_10)","line":103,"loc":{"start":{"line":103,"column":20},"end":{"line":103,"column":42}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":41}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":40}},"3":{"start":{"line":28,"column":0},"end":{"line":35,"column":2}},"4":{"start":{"line":29,"column":2},"end":{"line":29,"column":25}},"5":{"start":{"line":30,"column":2},"end":{"line":30,"column":29}},"6":{"start":{"line":31,"column":2},"end":{"line":31,"column":29}},"7":{"start":{"line":32,"column":2},"end":{"line":32,"column":42}},"8":{"start":{"line":33,"column":2},"end":{"line":33,"column":21}},"9":{"start":{"line":34,"column":2},"end":{"line":34,"column":39}},"10":{"start":{"line":37,"column":0},"end":{"line":108,"column":3}},"11":{"start":{"line":39,"column":4},"end":{"line":39,"column":37}},"12":{"start":{"line":40,"column":4},"end":{"line":44,"column":5}},"13":{"start":{"line":41,"column":6},"end":{"line":43,"column":9}},"14":{"start":{"line":42,"column":8},"end":{"line":42,"column":48}},"15":{"start":{"line":48,"column":4},"end":{"line":62,"column":5}},"16":{"start":{"line":49,"column":6},"end":{"line":49,"column":43}},"17":{"start":{"line":50,"column":6},"end":{"line":52,"column":7}},"18":{"start":{"line":51,"column":8},"end":{"line":51,"column":58}},"19":{"start":{"line":54,"column":6},"end":{"line":54,"column":39}},"20":{"start":{"line":55,"column":6},"end":{"line":57,"column":9}},"21":{"start":{"line":56,"column":8},"end":{"line":56,"column":49}},"22":{"start":{"line":59,"column":6},"end":{"line":59,"column":28}},"23":{"start":{"line":60,"column":11},"end":{"line":62,"column":5}},"24":{"start":{"line":61,"column":6},"end":{"line":61,"column":35}},"25":{"start":{"line":66,"column":4},"end":{"line":82,"column":5}},"26":{"start":{"line":67,"column":6},"end":{"line":67,"column":34}},"27":{"start":{"line":68,"column":6},"end":{"line":68,"column":18}},"28":{"start":{"line":70,"column":6},"end":{"line":81,"column":7}},"29":{"start":{"line":72,"column":10},"end":{"line":72,"column":26}},"30":{"start":{"line":73,"column":10},"end":{"line":73,"column":22}},"31":{"start":{"line":75,"column":10},"end":{"line":80,"column":11}},"32":{"start":{"line":76,"column":12},"end":{"line":76,"column":42}},"33":{"start":{"line":77,"column":12},"end":{"line":77,"column":24}},"34":{"start":{"line":79,"column":12},"end":{"line":79,"column":25}},"35":{"start":{"line":85,"column":4},"end":{"line":87,"column":5}},"36":{"start":{"line":86,"column":6},"end":{"line":86,"column":34}},"37":{"start":{"line":90,"column":4},"end":{"line":98,"column":5}},"38":{"start":{"line":91,"column":6},"end":{"line":94,"column":7}},"39":{"start":{"line":92,"column":8},"end":{"line":92,"column":43}},"40":{"start":{"line":93,"column":8},"end":{"line":93,"column":32}},"41":{"start":{"line":95,"column":6},"end":{"line":95,"column":18}},"42":{"start":{"line":97,"column":6},"end":{"line":97,"column":19}},"43":{"start":{"line":101,"column":4},"end":{"line":106,"column":5}},"44":{"start":{"line":102,"column":6},"end":{"line":102,"column":39}},"45":{"start":{"line":103,"column":6},"end":{"line":105,"column":9}},"46":{"start":{"line":104,"column":8},"end":{"line":104,"column":50}}},"branchMap":{"1":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":16},"end":{"line":32,"column":30}},{"start":{"line":32,"column":34},"end":{"line":32,"column":41}}]},"2":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]},"3":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":48,"column":4}},{"start":{"line":48,"column":4},"end":{"line":48,"column":4}}]},"4":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":8},"end":{"line":48,"column":13}},{"start":{"line":48,"column":17},"end":{"line":48,"column":29}}]},"5":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":6},"end":{"line":50,"column":6}},{"start":{"line":50,"column":6},"end":{"line":50,"column":6}}]},"6":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":11},"end":{"line":60,"column":11}},{"start":{"line":60,"column":11},"end":{"line":60,"column":11}}]},"7":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]},"8":{"line":70,"type":"switch","locations":[{"start":{"line":71,"column":8},"end":{"line":73,"column":22}},{"start":{"line":74,"column":8},"end":{"line":80,"column":11}}]},"9":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":10},"end":{"line":75,"column":10}},{"start":{"line":75,"column":10},"end":{"line":75,"column":10}}]},"10":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":85,"column":4}},{"start":{"line":85,"column":4},"end":{"line":85,"column":4}}]},"11":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":4},"end":{"line":90,"column":4}},{"start":{"line":90,"column":4},"end":{"line":90,"column":4}}]},"12":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":6},"end":{"line":91,"column":6}},{"start":{"line":91,"column":6},"end":{"line":91,"column":6}}]},"13":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":4},"end":{"line":101,"column":4}},{"start":{"line":101,"column":4},"end":{"line":101,"column":4}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../utils/utils');","var BaseXform = require('./base-xform');","","var ListXform = module.exports = function(options) {","  this.tag = options.tag;","  this.count = options.count;","  this.empty = options.empty;","  this.$count = options.$count || 'count';","  this.$ = options.$;","  this.childXform = options.childXform;","};","","utils.inherits(ListXform, BaseXform, {","  prepare: function(model, options) {","    var childXform = this.childXform;","    if (model) {","      model.forEach(function (childModel) {","        childXform.prepare(childModel, options);","      });","    }","  },","  ","  render: function(xmlStream, model) {","    if (model && model.length) {","      xmlStream.openNode(this.tag, this.$);","      if (this.count) {","        xmlStream.addAttribute(this.$count, model.length);","      }","","      var childXform = this.childXform;","      model.forEach(function (childModel) {","        childXform.render(xmlStream, childModel);","      });","","      xmlStream.closeNode();","    } else if (this.empty) {","      xmlStream.leafNode(this.tag);","    }","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case this.tag:","          this.model = [];","          return true;","        default:","          if (this.childXform.parseOpen(node)) {","            this.parser = this.childXform;","            return true;","          } else {","            return false;","          }","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model.push(this.parser.model);","        this.parser = undefined;","      }","      return true;","    } else {","      return false;","    }","  },","  reconcile: function(model, options) {","    if (model) {","      var childXform = this.childXform;","      model.forEach(function (childModel) {","        childXform.reconcile(childModel, options);","      });","    }","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":3,"30":3,"31":3,"32":3,"33":3,"34":3,"37":1,"39":0,"40":0,"41":0,"42":0,"48":0,"49":0,"50":0,"51":0,"54":0,"55":0,"56":0,"59":0,"60":0,"61":0,"66":0,"67":0,"68":0,"70":0,"72":0,"73":0,"75":0,"76":0,"77":0,"79":0,"85":0,"86":0,"90":0,"91":0,"92":0,"93":0,"95":0,"97":0,"101":0,"102":0,"103":0,"104":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/font-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/font-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":36,"loc":{"start":{"line":36,"column":33},"end":{"line":36,"column":51}}},"2":{"name":"(anonymous_2)","line":64,"loc":{"start":{"line":64,"column":9},"end":{"line":64,"column":12}}},"3":{"name":"(anonymous_3)","line":66,"loc":{"start":{"line":66,"column":10},"end":{"line":66,"column":37}}},"4":{"name":"(anonymous_4)","line":70,"loc":{"start":{"line":70,"column":21},"end":{"line":70,"column":41}}},"5":{"name":"(anonymous_5)","line":76,"loc":{"start":{"line":76,"column":13},"end":{"line":76,"column":28}}},"6":{"name":"(anonymous_6)","line":93,"loc":{"start":{"line":93,"column":14},"end":{"line":93,"column":29}}},"7":{"name":"(anonymous_7)","line":98,"loc":{"start":{"line":98,"column":14},"end":{"line":98,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":42}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":54}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":54}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":52}},"5":{"start":{"line":29,"column":0},"end":{"line":29,"column":50}},"6":{"start":{"line":31,"column":0},"end":{"line":31,"column":45}},"7":{"start":{"line":32,"column":0},"end":{"line":32,"column":45}},"8":{"start":{"line":33,"column":0},"end":{"line":33,"column":41}},"9":{"start":{"line":36,"column":0},"end":{"line":55,"column":2}},"10":{"start":{"line":37,"column":2},"end":{"line":37,"column":46}},"11":{"start":{"line":39,"column":2},"end":{"line":53,"column":4}},"12":{"start":{"line":54,"column":2},"end":{"line":54,"column":126}},"13":{"start":{"line":57,"column":0},"end":{"line":60,"column":2}},"14":{"start":{"line":62,"column":0},"end":{"line":115,"column":3}},"15":{"start":{"line":64,"column":14},"end":{"line":64,"column":42}},"16":{"start":{"line":67,"column":4},"end":{"line":67,"column":24}},"17":{"start":{"line":69,"column":4},"end":{"line":69,"column":45}},"18":{"start":{"line":70,"column":4},"end":{"line":72,"column":7}},"19":{"start":{"line":71,"column":6},"end":{"line":71,"column":57}},"20":{"start":{"line":73,"column":4},"end":{"line":73,"column":26}},"21":{"start":{"line":77,"column":4},"end":{"line":91,"column":5}},"22":{"start":{"line":78,"column":6},"end":{"line":78,"column":34}},"23":{"start":{"line":79,"column":6},"end":{"line":79,"column":18}},"24":{"start":{"line":80,"column":11},"end":{"line":91,"column":5}},"25":{"start":{"line":81,"column":6},"end":{"line":81,"column":46}},"26":{"start":{"line":82,"column":6},"end":{"line":82,"column":41}},"27":{"start":{"line":84,"column":6},"end":{"line":90,"column":7}},"28":{"start":{"line":86,"column":10},"end":{"line":86,"column":26}},"29":{"start":{"line":87,"column":10},"end":{"line":87,"column":22}},"30":{"start":{"line":89,"column":10},"end":{"line":89,"column":23}},"31":{"start":{"line":94,"column":4},"end":{"line":96,"column":5}},"32":{"start":{"line":95,"column":6},"end":{"line":95,"column":34}},"33":{"start":{"line":99,"column":4},"end":{"line":113,"column":5}},"34":{"start":{"line":100,"column":6},"end":{"line":100,"column":32}},"35":{"start":{"line":101,"column":6},"end":{"line":103,"column":7}},"36":{"start":{"line":102,"column":8},"end":{"line":102,"column":50}},"37":{"start":{"line":104,"column":6},"end":{"line":104,"column":31}},"38":{"start":{"line":105,"column":6},"end":{"line":105,"column":18}},"39":{"start":{"line":107,"column":6},"end":{"line":112,"column":7}},"40":{"start":{"line":109,"column":10},"end":{"line":109,"column":23}},"41":{"start":{"line":111,"column":10},"end":{"line":111,"column":22}}},"branchMap":{"1":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":17},"end":{"line":37,"column":24}},{"start":{"line":37,"column":28},"end":{"line":37,"column":45}}]},"2":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":77,"column":4}},{"start":{"line":77,"column":4},"end":{"line":77,"column":4}}]},"3":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":11},"end":{"line":80,"column":11}},{"start":{"line":80,"column":11},"end":{"line":80,"column":11}}]},"4":{"line":84,"type":"switch","locations":[{"start":{"line":85,"column":8},"end":{"line":87,"column":22}},{"start":{"line":88,"column":8},"end":{"line":89,"column":23}}]},"5":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":4},"end":{"line":94,"column":4}},{"start":{"line":94,"column":4},"end":{"line":94,"column":4}}]},"6":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":99,"column":4}},{"start":{"line":99,"column":4},"end":{"line":99,"column":4}}]},"7":{"line":99,"type":"binary-expr","locations":[{"start":{"line":99,"column":8},"end":{"line":99,"column":19}},{"start":{"line":99,"column":23},"end":{"line":99,"column":52}}]},"8":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":6},"end":{"line":101,"column":6}},{"start":{"line":101,"column":6},"end":{"line":101,"column":6}}]},"9":{"line":107,"type":"switch","locations":[{"start":{"line":108,"column":8},"end":{"line":109,"column":23}},{"start":{"line":110,"column":8},"end":{"line":111,"column":22}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var ColorXform = require('./color-xform');","var BooleanXform = require('../simple/boolean-xform');","var IntegerXform = require('../simple/integer-xform');","var StringXform = require('../simple/string-xform');","var UnderlineXform = require('./underline-xform');","","var _ = require('../../../utils/under-dash');","var utils  = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","// Font encapsulates translation from font model to xlsx","var FontXform = module.exports = function(options) {","  this.options = options || FontXform.OPTIONS;","","  this.map = {","    b: { prop: 'bold', xform: new BooleanXform({tag: 'b', attr: 'val'}) },","    i: { prop: 'italic', xform: new BooleanXform({tag: 'i', attr: 'val'}) },","    u: { prop: 'underline', xform: new UnderlineXform() },","    charset: { prop: 'charset', xform: new IntegerXform({tag: 'charset', attr: 'val'}) },","    color: { prop: 'color', xform: new ColorXform() },","    condense: { prop: 'condense', xform: new BooleanXform({tag: 'condense', attr: 'val'}) },","    extend: { prop: 'extend', xform: new BooleanXform({tag: 'extend', attr: 'val'}) },","    family: { prop: 'family', xform: new IntegerXform({tag: 'family', attr: 'val'}) },","    outline: { prop: 'outline', xform: new BooleanXform({tag: 'outline', attr: 'val'}) },","    scheme: { prop: 'scheme', xform: new StringXform({tag: 'scheme', attr: 'val'}) },","    shadow: { prop: 'shadow', xform: new BooleanXform({tag: 'shadow', attr: 'val'}) },","    strike: { prop: 'strike', xform: new BooleanXform({tag: 'strike', attr: 'val'}) },","    sz: { prop: 'size', xform: new IntegerXform({tag: 'sz', attr: 'val'}) }","  };","  this.map[this.options.fontNameTag] = { prop: 'name', xform: new StringXform({tag: this.options.fontNameTag, attr: 'val'}) };","};","","FontXform.OPTIONS = {","  tagName: 'font',","  fontNameTag: 'name'","};","","utils.inherits(FontXform, BaseXform, {","","  get tag() { return this.options.tagName; },","","  render: function(xmlStream, model) {","    var map =  this.map;","","    xmlStream.openNode(this.options.tagName);","    _.each(this.map, function(defn, tag) {","      map[tag].xform.render(xmlStream, model[defn.prop]);","    });","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else if(this.map[node.name]) {","      this.parser = this.map[node.name].xform;","      return this.parser.parseOpen(node);","    } else {","      switch (node.name) {","        case this.options.tagName:","          this.model = {};","          return true;","        default:","          return false;","      }","    }","  },","  parseText:  function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser && !this.parser.parseClose(name)) {","      var item = this.map[name];","      if (this.parser.model) {","        this.model[item.prop] = this.parser.model;","      }","      this.parser  = undefined;","      return true;","    } else {","      switch (name) {","        case this.options.tagName:","          return false;","        default:","          return true;","      }","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"28":1,"29":1,"31":1,"32":1,"33":1,"36":1,"37":0,"39":0,"54":0,"57":1,"62":1,"64":0,"67":0,"69":0,"70":0,"71":0,"73":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"84":0,"86":0,"87":0,"89":0,"94":0,"95":0,"99":0,"100":0,"101":0,"102":0,"104":0,"105":0,"107":0,"109":0,"111":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/color-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/color-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},"b":{"1":[1,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":49,"loc":{"start":{"line":49,"column":34},"end":{"line":49,"column":49}}},"2":{"name":"(anonymous_2)","line":56,"loc":{"start":{"line":56,"column":9},"end":{"line":56,"column":12}}},"3":{"name":"(anonymous_3)","line":58,"loc":{"start":{"line":58,"column":10},"end":{"line":58,"column":37}}},"4":{"name":"(anonymous_4)","line":78,"loc":{"start":{"line":78,"column":13},"end":{"line":78,"column":28}}},"5":{"name":"(anonymous_5)","line":97,"loc":{"start":{"line":97,"column":13},"end":{"line":97,"column":24}}},"6":{"name":"(anonymous_6)","line":99,"loc":{"start":{"line":99,"column":14},"end":{"line":99,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":49,"column":0},"end":{"line":52,"column":2}},"4":{"start":{"line":51,"column":2},"end":{"line":51,"column":30}},"5":{"start":{"line":54,"column":0},"end":{"line":102,"column":3}},"6":{"start":{"line":56,"column":14},"end":{"line":56,"column":31}},"7":{"start":{"line":59,"column":4},"end":{"line":75,"column":5}},"8":{"start":{"line":60,"column":6},"end":{"line":60,"column":36}},"9":{"start":{"line":61,"column":6},"end":{"line":72,"column":7}},"10":{"start":{"line":62,"column":8},"end":{"line":62,"column":50}},"11":{"start":{"line":63,"column":13},"end":{"line":72,"column":7}},"12":{"start":{"line":64,"column":8},"end":{"line":64,"column":53}},"13":{"start":{"line":65,"column":8},"end":{"line":67,"column":9}},"14":{"start":{"line":66,"column":10},"end":{"line":66,"column":53}},"15":{"start":{"line":68,"column":13},"end":{"line":72,"column":7}},"16":{"start":{"line":69,"column":8},"end":{"line":69,"column":56}},"17":{"start":{"line":71,"column":8},"end":{"line":71,"column":44}},"18":{"start":{"line":73,"column":6},"end":{"line":73,"column":28}},"19":{"start":{"line":74,"column":6},"end":{"line":74,"column":18}},"20":{"start":{"line":79,"column":4},"end":{"line":95,"column":5}},"21":{"start":{"line":80,"column":6},"end":{"line":91,"column":7}},"22":{"start":{"line":81,"column":8},"end":{"line":81,"column":49}},"23":{"start":{"line":82,"column":13},"end":{"line":91,"column":7}},"24":{"start":{"line":83,"column":8},"end":{"line":83,"column":62}},"25":{"start":{"line":84,"column":8},"end":{"line":86,"column":9}},"26":{"start":{"line":85,"column":10},"end":{"line":85,"column":61}},"27":{"start":{"line":87,"column":13},"end":{"line":91,"column":7}},"28":{"start":{"line":88,"column":8},"end":{"line":88,"column":66}},"29":{"start":{"line":90,"column":8},"end":{"line":90,"column":31}},"30":{"start":{"line":92,"column":6},"end":{"line":92,"column":18}},"31":{"start":{"line":94,"column":6},"end":{"line":94,"column":19}},"32":{"start":{"line":100,"column":4},"end":{"line":100,"column":17}}},"branchMap":{"1":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":14},"end":{"line":51,"column":18}},{"start":{"line":51,"column":22},"end":{"line":51,"column":29}}]},"2":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":4},"end":{"line":59,"column":4}},{"start":{"line":59,"column":4},"end":{"line":59,"column":4}}]},"3":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":6},"end":{"line":61,"column":6}},{"start":{"line":61,"column":6},"end":{"line":61,"column":6}}]},"4":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":13},"end":{"line":63,"column":13}},{"start":{"line":63,"column":13},"end":{"line":63,"column":13}}]},"5":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":65,"column":8}},{"start":{"line":65,"column":8},"end":{"line":65,"column":8}}]},"6":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":13},"end":{"line":68,"column":13}},{"start":{"line":68,"column":13},"end":{"line":68,"column":13}}]},"7":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"8":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":6},"end":{"line":80,"column":6}},{"start":{"line":80,"column":6},"end":{"line":80,"column":6}}]},"9":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":13},"end":{"line":82,"column":13}},{"start":{"line":82,"column":13},"end":{"line":82,"column":13}}]},"10":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":8},"end":{"line":84,"column":8}},{"start":{"line":84,"column":8},"end":{"line":84,"column":8}}]},"11":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":13},"end":{"line":87,"column":13}},{"start":{"line":87,"column":13},"end":{"line":87,"column":13}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","//<color auto=\"1\"/>","//<color rgb=\"FFFF0000\"/>","//<color theme=\"0\" tint=\"-0.499984740745262\"/>","//<color indexed=\"64\"/>","","// var modelSchema = {","//   // argb style","//   argb: 'AARRGGBB',","//","//   // theme style","//   theme: 0, // any valid theme integer","//   tint: 0.5, // optional. float value from -1 to 1","//","//   // indexed style","//   indexed: 64, // a valid color index colour","//","//   // auto","//   auto: true // optional - is the default state","// };","","// Color encapsulates translation from color model to/from xlsx","var ColorXform = module.exports = function(name) {","  // this.name controls the xm node name","  this.name = name || 'color';","};","","utils.inherits(ColorXform, BaseXform, {","","  get tag() { return this.name; },","","  render: function(xmlStream, model) {","    if (model) {","      xmlStream.openNode(this.name);","      if (model.argb) {","        xmlStream.addAttribute('rgb', model.argb);","      } else if (model.theme !== undefined) {","        xmlStream.addAttribute('theme', model.theme);","        if (model.tint !== undefined) {","          xmlStream.addAttribute('tint', model.tint);","        }","      } else if (model.indexed !== undefined) {","        xmlStream.addAttribute('indexed', model.indexed)","      } else {","        xmlStream.addAttribute('auto', '1');","      }","      xmlStream.closeNode();","      return true;","    }","  },","  ","  parseOpen: function(node) {","    if (node.name === this.name) {","      if (node.attributes.rgb) {","        this.model = {argb: node.attributes.rgb};","      } else if (node.attributes.theme) {","        this.model = {theme: parseInt(node.attributes.theme)};","        if (node.attributes.tint) {","          this.model.tint = parseFloat(node.attributes.tint);","        }","      } else if (node.attributes.indexed) {","        this.model = {indexed: parseInt(node.attributes.indexed)};","      } else {","        this.model = undefined;","      }","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"49":1,"51":1,"54":1,"56":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"68":0,"69":0,"71":0,"73":0,"74":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"87":0,"88":0,"90":0,"92":0,"94":0,"100":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/boolean-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/boolean-xform.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":36},"end":{"line":28,"column":54}}},"2":{"name":"(anonymous_2)","line":35,"loc":{"start":{"line":35,"column":10},"end":{"line":35,"column":37}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":13},"end":{"line":42,"column":28}}},"4":{"name":"(anonymous_4)","line":47,"loc":{"start":{"line":47,"column":13},"end":{"line":47,"column":24}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":14},"end":{"line":49,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":31,"column":2}},"4":{"start":{"line":29,"column":2},"end":{"line":29,"column":25}},"5":{"start":{"line":30,"column":2},"end":{"line":30,"column":27}},"6":{"start":{"line":33,"column":0},"end":{"line":52,"column":3}},"7":{"start":{"line":36,"column":4},"end":{"line":39,"column":5}},"8":{"start":{"line":37,"column":6},"end":{"line":37,"column":35}},"9":{"start":{"line":38,"column":6},"end":{"line":38,"column":28}},"10":{"start":{"line":43,"column":4},"end":{"line":45,"column":5}},"11":{"start":{"line":44,"column":6},"end":{"line":44,"column":24}},"12":{"start":{"line":50,"column":4},"end":{"line":50,"column":17}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":36,"column":4}},{"start":{"line":36,"column":4},"end":{"line":36,"column":4}}]},"2":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":43,"column":4}},{"start":{"line":43,"column":4},"end":{"line":43,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var BooleanXform = module.exports = function(options) {","  this.tag = options.tag;","  this.attr = options.attr;","};","","utils.inherits(BooleanXform, BaseXform, {","  ","  render: function(xmlStream, model) {","    if (model) {","      xmlStream.openNode(this.tag);","      xmlStream.closeNode();","    }","  },","","  parseOpen: function(node) {","    if (node.name === this.tag) {","      this.model = true;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":0,"30":0,"33":1,"36":0,"37":0,"38":0,"43":0,"44":0,"50":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/integer-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/integer-xform.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":36},"end":{"line":28,"column":54}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":10},"end":{"line":36,"column":37}}},"3":{"name":"(anonymous_3)","line":52,"loc":{"start":{"line":52,"column":13},"end":{"line":52,"column":28}}},"4":{"name":"(anonymous_4)","line":64,"loc":{"start":{"line":64,"column":13},"end":{"line":64,"column":28}}},"5":{"name":"(anonymous_5)","line":69,"loc":{"start":{"line":69,"column":14},"end":{"line":69,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":32,"column":2}},"4":{"start":{"line":29,"column":2},"end":{"line":29,"column":25}},"5":{"start":{"line":30,"column":2},"end":{"line":30,"column":27}},"6":{"start":{"line":31,"column":2},"end":{"line":31,"column":29}},"7":{"start":{"line":34,"column":0},"end":{"line":75,"column":3}},"8":{"start":{"line":38,"column":4},"end":{"line":49,"column":5}},"9":{"start":{"line":39,"column":6},"end":{"line":39,"column":35}},"10":{"start":{"line":40,"column":6},"end":{"line":42,"column":7}},"11":{"start":{"line":41,"column":8},"end":{"line":41,"column":44}},"12":{"start":{"line":43,"column":6},"end":{"line":47,"column":7}},"13":{"start":{"line":44,"column":8},"end":{"line":44,"column":49}},"14":{"start":{"line":46,"column":8},"end":{"line":46,"column":35}},"15":{"start":{"line":48,"column":6},"end":{"line":48,"column":28}},"16":{"start":{"line":53,"column":4},"end":{"line":62,"column":5}},"17":{"start":{"line":54,"column":6},"end":{"line":58,"column":7}},"18":{"start":{"line":55,"column":8},"end":{"line":55,"column":58}},"19":{"start":{"line":57,"column":8},"end":{"line":57,"column":23}},"20":{"start":{"line":59,"column":6},"end":{"line":59,"column":18}},"21":{"start":{"line":61,"column":6},"end":{"line":61,"column":19}},"22":{"start":{"line":65,"column":4},"end":{"line":67,"column":5}},"23":{"start":{"line":66,"column":6},"end":{"line":66,"column":27}},"24":{"start":{"line":70,"column":4},"end":{"line":72,"column":5}},"25":{"start":{"line":71,"column":6},"end":{"line":71,"column":53}},"26":{"start":{"line":73,"column":4},"end":{"line":73,"column":17}}},"branchMap":{"1":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":4}},{"start":{"line":38,"column":4},"end":{"line":38,"column":4}}]},"2":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":6},"end":{"line":40,"column":6}},{"start":{"line":40,"column":6},"end":{"line":40,"column":6}}]},"3":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":6},"end":{"line":43,"column":6}},{"start":{"line":43,"column":6},"end":{"line":43,"column":6}}]},"4":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":53,"column":4}},{"start":{"line":53,"column":4},"end":{"line":53,"column":4}}]},"5":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":6},"end":{"line":54,"column":6}},{"start":{"line":54,"column":6},"end":{"line":54,"column":6}}]},"6":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":4},"end":{"line":65,"column":4}},{"start":{"line":65,"column":4},"end":{"line":65,"column":4}}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":4}},{"start":{"line":70,"column":4},"end":{"line":70,"column":4}}]},"8":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":28},"end":{"line":71,"column":46}},{"start":{"line":71,"column":50},"end":{"line":71,"column":51}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var IntegerXform = module.exports = function(options) {","  this.tag = options.tag;","  this.attr = options.attr;","  this.attrs = options.attrs;","};","","utils.inherits(IntegerXform, BaseXform, {","  ","  render: function(xmlStream, model) {","    // int is different to float in that zero is not rendered","    if (model) {","      xmlStream.openNode(this.tag);","      if (this.attrs) {","        xmlStream.addAttributes(this.attrs);","      }","      if (this.attr) {","        xmlStream.addAttribute(this.attr, model);","      } else {","        xmlStream.writeText(model);","      }","      xmlStream.closeNode();","    }","  },","","  parseOpen: function(node) {","    if (node.name === this.tag) {","      if (this.attr) {","        this.model = parseInt(node.attributes[this.attr]);","      } else {","        this.text = [];","      }","      return true;","    } else {","      return false;","    }","  },","  parseText: function(text) {","    if (!this.attr) {","      this.text.push(text);","    }","  },","  parseClose: function() {","    if (!this.attr) {","      this.model = parseInt(this.text.join('') || 0);","    }","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":0,"30":0,"31":0,"34":1,"38":0,"39":0,"40":0,"41":0,"43":0,"44":0,"46":0,"48":0,"53":0,"54":0,"55":0,"57":0,"59":0,"61":0,"65":0,"66":0,"70":0,"71":0,"73":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/string-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/string-xform.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":35},"end":{"line":28,"column":53}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":10},"end":{"line":36,"column":37}}},"3":{"name":"(anonymous_3)","line":51,"loc":{"start":{"line":51,"column":13},"end":{"line":51,"column":28}}},"4":{"name":"(anonymous_4)","line":60,"loc":{"start":{"line":60,"column":13},"end":{"line":60,"column":28}}},"5":{"name":"(anonymous_5)","line":65,"loc":{"start":{"line":65,"column":14},"end":{"line":65,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":32,"column":2}},"4":{"start":{"line":29,"column":2},"end":{"line":29,"column":25}},"5":{"start":{"line":30,"column":2},"end":{"line":30,"column":27}},"6":{"start":{"line":31,"column":2},"end":{"line":31,"column":29}},"7":{"start":{"line":34,"column":0},"end":{"line":71,"column":3}},"8":{"start":{"line":37,"column":4},"end":{"line":48,"column":5}},"9":{"start":{"line":38,"column":6},"end":{"line":38,"column":35}},"10":{"start":{"line":39,"column":6},"end":{"line":41,"column":7}},"11":{"start":{"line":40,"column":8},"end":{"line":40,"column":44}},"12":{"start":{"line":42,"column":6},"end":{"line":46,"column":7}},"13":{"start":{"line":43,"column":8},"end":{"line":43,"column":49}},"14":{"start":{"line":45,"column":8},"end":{"line":45,"column":35}},"15":{"start":{"line":47,"column":6},"end":{"line":47,"column":28}},"16":{"start":{"line":52,"column":4},"end":{"line":58,"column":5}},"17":{"start":{"line":53,"column":6},"end":{"line":57,"column":7}},"18":{"start":{"line":54,"column":8},"end":{"line":54,"column":48}},"19":{"start":{"line":56,"column":8},"end":{"line":56,"column":23}},"20":{"start":{"line":61,"column":4},"end":{"line":63,"column":5}},"21":{"start":{"line":62,"column":6},"end":{"line":62,"column":27}},"22":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"23":{"start":{"line":67,"column":6},"end":{"line":67,"column":38}},"24":{"start":{"line":69,"column":4},"end":{"line":69,"column":17}}},"branchMap":{"1":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"2":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":6},"end":{"line":39,"column":6}},{"start":{"line":39,"column":6},"end":{"line":39,"column":6}}]},"3":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":6},"end":{"line":42,"column":6}},{"start":{"line":42,"column":6},"end":{"line":42,"column":6}}]},"4":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"5":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":6},"end":{"line":53,"column":6}},{"start":{"line":53,"column":6},"end":{"line":53,"column":6}}]},"6":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":4}},{"start":{"line":61,"column":4},"end":{"line":61,"column":4}}]},"7":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var StringXform = module.exports = function(options) {","  this.tag = options.tag;","  this.attr = options.attr;","  this.attrs = options.attrs;","};","","utils.inherits(StringXform, BaseXform, {","  ","  render: function(xmlStream, model) {","    if (model !== undefined) {","      xmlStream.openNode(this.tag);","      if (this.attrs) {","        xmlStream.addAttributes(this.attrs);","      }","      if (this.attr) {","        xmlStream.addAttribute(this.attr, model);","      } else {","        xmlStream.writeText(model);","      }","      xmlStream.closeNode();","    }","  },","","  parseOpen: function(node) {","    if (node.name === this.tag) {","      if (this.attr) {","        this.model = node.attributes[this.attr];","      } else {","        this.text = [];","      }","    }","  },","  parseText: function(text) {","    if (!this.attr) {","      this.text.push(text);","    }","  },","  parseClose: function() {","    if (!this.attr) {","      this.model = this.text.join('');","    }","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":0,"30":0,"31":0,"34":1,"37":0,"38":0,"39":0,"40":0,"42":0,"43":0,"45":0,"47":0,"52":0,"53":0,"54":0,"56":0,"61":0,"62":0,"66":0,"67":0,"69":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/underline-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/underline-xform.js","s":{"1":1,"2":1,"3":1,"4":0,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":38},"end":{"line":30,"column":54}}},"2":{"name":"(anonymous_2)","line":43,"loc":{"start":{"line":43,"column":9},"end":{"line":43,"column":12}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":10},"end":{"line":45,"column":37}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":13},"end":{"line":58,"column":28}}},"5":{"name":"(anonymous_5)","line":63,"loc":{"start":{"line":63,"column":13},"end":{"line":63,"column":24}}},"6":{"name":"(anonymous_6)","line":65,"loc":{"start":{"line":65,"column":14},"end":{"line":65,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":30,"column":0},"end":{"line":32,"column":2}},"4":{"start":{"line":31,"column":2},"end":{"line":31,"column":21}},"5":{"start":{"line":34,"column":0},"end":{"line":39,"column":2}},"6":{"start":{"line":41,"column":0},"end":{"line":68,"column":3}},"7":{"start":{"line":43,"column":14},"end":{"line":43,"column":25}},"8":{"start":{"line":46,"column":4},"end":{"line":46,"column":32}},"9":{"start":{"line":48,"column":4},"end":{"line":55,"column":5}},"10":{"start":{"line":49,"column":6},"end":{"line":49,"column":29}},"11":{"start":{"line":51,"column":6},"end":{"line":51,"column":50}},"12":{"start":{"line":52,"column":6},"end":{"line":54,"column":7}},"13":{"start":{"line":53,"column":8},"end":{"line":53,"column":38}},"14":{"start":{"line":59,"column":4},"end":{"line":61,"column":5}},"15":{"start":{"line":60,"column":6},"end":{"line":60,"column":47}},"16":{"start":{"line":66,"column":4},"end":{"line":66,"column":17}}},"branchMap":{"1":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":12},"end":{"line":46,"column":17}},{"start":{"line":46,"column":21},"end":{"line":46,"column":31}}]},"2":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":48,"column":4}},{"start":{"line":48,"column":4},"end":{"line":48,"column":4}}]},"3":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":6},"end":{"line":52,"column":6}},{"start":{"line":52,"column":6},"end":{"line":52,"column":6}}]},"4":{"line":59,"type":"if","locations":[{"start":{"line":59,"column":4},"end":{"line":59,"column":4}},{"start":{"line":59,"column":4},"end":{"line":59,"column":4}}]},"5":{"line":60,"type":"binary-expr","locations":[{"start":{"line":60,"column":19},"end":{"line":60,"column":38}},{"start":{"line":60,"column":42},"end":{"line":60,"column":46}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","// | underline | Font <u>underline</u> style | true, false, 'none', 'single', 'double', 'singleAccounting', 'doubleAccounting' |","","var UnderlineXform = module.exports = function(model) {","  this.model = model;","};","","UnderlineXform.Attributes = {","  single: {},","  double: { val: 'double' },","  singleAccounting: { val: 'singleAccounting' },","  doubleAccounting: { val: 'doubleAccounting' }","};","","utils.inherits(UnderlineXform, BaseXform, {","","  get tag() { return 'u'; },","","  render: function(xmlStream, model) {","    model = model || this.model;","","    if (model === true) {","      xmlStream.leafNode('u')","    } else {","      var attr = UnderlineXform.Attributes[model];","      if (attr) {","        xmlStream.leafNode('u', attr);","      }","    }","  },","","  parseOpen: function(node) {","    if (node.name === 'u') {","      this.model = node.attributes.val || true;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"30":1,"31":0,"34":1,"41":1,"43":0,"46":0,"48":0,"49":0,"51":0,"52":0,"53":0,"59":0,"60":0,"66":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/fill-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/fill-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":1,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":1,"116":0,"117":1,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":21,"150":21,"151":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":21,"29":0},"fnMap":{"1":{"name":"(anonymous_1)","line":86,"loc":{"start":{"line":86,"column":16},"end":{"line":86,"column":27}}},"2":{"name":"(anonymous_2)","line":94,"loc":{"start":{"line":94,"column":9},"end":{"line":94,"column":12}}},"3":{"name":"(anonymous_3)","line":96,"loc":{"start":{"line":96,"column":11},"end":{"line":96,"column":38}}},"4":{"name":"(anonymous_4)","line":102,"loc":{"start":{"line":102,"column":13},"end":{"line":102,"column":28}}},"5":{"name":"(anonymous_5)","line":122,"loc":{"start":{"line":122,"column":13},"end":{"line":122,"column":24}}},"6":{"name":"(anonymous_6)","line":124,"loc":{"start":{"line":124,"column":14},"end":{"line":124,"column":29}}},"7":{"name":"(anonymous_7)","line":136,"loc":{"start":{"line":136,"column":23},"end":{"line":136,"column":34}}},"8":{"name":"(anonymous_8)","line":144,"loc":{"start":{"line":144,"column":10},"end":{"line":144,"column":13}}},"9":{"name":"(anonymous_9)","line":145,"loc":{"start":{"line":145,"column":9},"end":{"line":145,"column":12}}},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":10},"end":{"line":147,"column":37}}},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":13},"end":{"line":158,"column":28}}},"12":{"name":"(anonymous_12)","line":180,"loc":{"start":{"line":180,"column":13},"end":{"line":180,"column":28}}},"13":{"name":"(anonymous_13)","line":185,"loc":{"start":{"line":185,"column":14},"end":{"line":185,"column":29}}},"14":{"name":"(anonymous_14)","line":200,"loc":{"start":{"line":200,"column":24},"end":{"line":200,"column":35}}},"15":{"name":"(anonymous_15)","line":218,"loc":{"start":{"line":218,"column":10},"end":{"line":218,"column":13}}},"16":{"name":"(anonymous_16)","line":219,"loc":{"start":{"line":219,"column":9},"end":{"line":219,"column":12}}},"17":{"name":"(anonymous_17)","line":221,"loc":{"start":{"line":221,"column":10},"end":{"line":221,"column":37}}},"18":{"name":"(anonymous_18)","line":251,"loc":{"start":{"line":251,"column":24},"end":{"line":251,"column":44}}},"19":{"name":"(anonymous_19)","line":258,"loc":{"start":{"line":258,"column":13},"end":{"line":258,"column":28}}},"20":{"name":"(anonymous_20)","line":295,"loc":{"start":{"line":295,"column":13},"end":{"line":295,"column":28}}},"21":{"name":"(anonymous_21)","line":300,"loc":{"start":{"line":300,"column":15},"end":{"line":300,"column":30}}},"22":{"name":"(anonymous_22)","line":315,"loc":{"start":{"line":315,"column":33},"end":{"line":315,"column":44}}},"23":{"name":"(anonymous_23)","line":336,"loc":{"start":{"line":336,"column":9},"end":{"line":336,"column":12}}},"24":{"name":"(anonymous_24)","line":338,"loc":{"start":{"line":338,"column":10},"end":{"line":338,"column":37}}},"25":{"name":"(anonymous_25)","line":356,"loc":{"start":{"line":356,"column":13},"end":{"line":356,"column":28}}},"26":{"name":"(anonymous_26)","line":376,"loc":{"start":{"line":376,"column":13},"end":{"line":376,"column":28}}},"27":{"name":"(anonymous_27)","line":381,"loc":{"start":{"line":381,"column":15},"end":{"line":381,"column":30}}},"28":{"name":"(anonymous_28)","line":416,"loc":{"start":{"line":416,"column":11},"end":{"line":416,"column":24}}},"29":{"name":"(anonymous_29)","line":417,"loc":{"start":{"line":417,"column":14},"end":{"line":417,"column":30}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":42}},"4":{"start":{"line":86,"column":0},"end":{"line":90,"column":2}},"5":{"start":{"line":87,"column":2},"end":{"line":89,"column":4}},"6":{"start":{"line":92,"column":0},"end":{"line":134,"column":3}},"7":{"start":{"line":94,"column":14},"end":{"line":94,"column":28}},"8":{"start":{"line":97,"column":4},"end":{"line":97,"column":31}},"9":{"start":{"line":98,"column":4},"end":{"line":98,"column":55}},"10":{"start":{"line":99,"column":4},"end":{"line":99,"column":50}},"11":{"start":{"line":100,"column":4},"end":{"line":100,"column":26}},"12":{"start":{"line":103,"column":4},"end":{"line":120,"column":5}},"13":{"start":{"line":104,"column":6},"end":{"line":104,"column":34}},"14":{"start":{"line":105,"column":6},"end":{"line":105,"column":18}},"15":{"start":{"line":107,"column":6},"end":{"line":119,"column":7}},"16":{"start":{"line":109,"column":10},"end":{"line":111,"column":12}},"17":{"start":{"line":112,"column":10},"end":{"line":112,"column":22}},"18":{"start":{"line":114,"column":10},"end":{"line":114,"column":39}},"19":{"start":{"line":115,"column":10},"end":{"line":115,"column":38}},"20":{"start":{"line":116,"column":10},"end":{"line":116,"column":22}},"21":{"start":{"line":118,"column":10},"end":{"line":118,"column":23}},"22":{"start":{"line":125,"column":4},"end":{"line":131,"column":5}},"23":{"start":{"line":126,"column":6},"end":{"line":129,"column":7}},"24":{"start":{"line":127,"column":8},"end":{"line":127,"column":45}},"25":{"start":{"line":128,"column":8},"end":{"line":128,"column":32}},"26":{"start":{"line":130,"column":6},"end":{"line":130,"column":18}},"27":{"start":{"line":132,"column":4},"end":{"line":132,"column":17}},"28":{"start":{"line":136,"column":0},"end":{"line":141,"column":2}},"29":{"start":{"line":137,"column":2},"end":{"line":140,"column":4}},"30":{"start":{"line":142,"column":0},"end":{"line":198,"column":3}},"31":{"start":{"line":144,"column":15},"end":{"line":144,"column":32}},"32":{"start":{"line":145,"column":14},"end":{"line":145,"column":35}},"33":{"start":{"line":148,"column":4},"end":{"line":148,"column":38}},"34":{"start":{"line":149,"column":4},"end":{"line":149,"column":57}},"35":{"start":{"line":150,"column":4},"end":{"line":152,"column":5}},"36":{"start":{"line":151,"column":6},"end":{"line":151,"column":56}},"37":{"start":{"line":153,"column":4},"end":{"line":155,"column":5}},"38":{"start":{"line":154,"column":6},"end":{"line":154,"column":56}},"39":{"start":{"line":156,"column":4},"end":{"line":156,"column":26}},"40":{"start":{"line":159,"column":4},"end":{"line":178,"column":5}},"41":{"start":{"line":160,"column":6},"end":{"line":160,"column":34}},"42":{"start":{"line":161,"column":6},"end":{"line":161,"column":18}},"43":{"start":{"line":163,"column":6},"end":{"line":177,"column":7}},"44":{"start":{"line":165,"column":10},"end":{"line":168,"column":14}},"45":{"start":{"line":169,"column":10},"end":{"line":169,"column":22}},"46":{"start":{"line":171,"column":10},"end":{"line":176,"column":11}},"47":{"start":{"line":172,"column":12},"end":{"line":172,"column":40}},"48":{"start":{"line":173,"column":12},"end":{"line":173,"column":24}},"49":{"start":{"line":175,"column":12},"end":{"line":175,"column":25}},"50":{"start":{"line":181,"column":4},"end":{"line":183,"column":5}},"51":{"start":{"line":182,"column":6},"end":{"line":182,"column":34}},"52":{"start":{"line":186,"column":4},"end":{"line":196,"column":5}},"53":{"start":{"line":187,"column":6},"end":{"line":192,"column":7}},"54":{"start":{"line":188,"column":8},"end":{"line":190,"column":9}},"55":{"start":{"line":189,"column":10},"end":{"line":189,"column":47}},"56":{"start":{"line":191,"column":8},"end":{"line":191,"column":32}},"57":{"start":{"line":193,"column":6},"end":{"line":193,"column":18}},"58":{"start":{"line":195,"column":6},"end":{"line":195,"column":19}},"59":{"start":{"line":200,"column":0},"end":{"line":216,"column":2}},"60":{"start":{"line":201,"column":2},"end":{"line":203,"column":4}},"61":{"start":{"line":217,"column":0},"end":{"line":311,"column":3}},"62":{"start":{"line":218,"column":15},"end":{"line":218,"column":33}},"63":{"start":{"line":219,"column":14},"end":{"line":219,"column":36}},"64":{"start":{"line":222,"column":4},"end":{"line":222,"column":39}},"65":{"start":{"line":223,"column":4},"end":{"line":248,"column":5}},"66":{"start":{"line":225,"column":8},"end":{"line":225,"column":55}},"67":{"start":{"line":226,"column":8},"end":{"line":226,"column":14}},"68":{"start":{"line":228,"column":8},"end":{"line":228,"column":47}},"69":{"start":{"line":229,"column":8},"end":{"line":234,"column":9}},"70":{"start":{"line":230,"column":10},"end":{"line":230,"column":60}},"71":{"start":{"line":231,"column":10},"end":{"line":233,"column":11}},"72":{"start":{"line":232,"column":12},"end":{"line":232,"column":63}},"73":{"start":{"line":235,"column":8},"end":{"line":237,"column":9}},"74":{"start":{"line":236,"column":10},"end":{"line":236,"column":62}},"75":{"start":{"line":238,"column":8},"end":{"line":243,"column":9}},"76":{"start":{"line":239,"column":10},"end":{"line":239,"column":58}},"77":{"start":{"line":240,"column":10},"end":{"line":242,"column":11}},"78":{"start":{"line":241,"column":12},"end":{"line":241,"column":63}},"79":{"start":{"line":244,"column":8},"end":{"line":246,"column":9}},"80":{"start":{"line":245,"column":10},"end":{"line":245,"column":64}},"81":{"start":{"line":247,"column":8},"end":{"line":247,"column":14}},"82":{"start":{"line":250,"column":4},"end":{"line":250,"column":34}},"83":{"start":{"line":251,"column":4},"end":{"line":253,"column":7}},"84":{"start":{"line":252,"column":6},"end":{"line":252,"column":45}},"85":{"start":{"line":255,"column":4},"end":{"line":255,"column":26}},"86":{"start":{"line":259,"column":4},"end":{"line":293,"column":5}},"87":{"start":{"line":260,"column":6},"end":{"line":260,"column":34}},"88":{"start":{"line":261,"column":6},"end":{"line":261,"column":18}},"89":{"start":{"line":263,"column":6},"end":{"line":292,"column":7}},"90":{"start":{"line":265,"column":10},"end":{"line":267,"column":12}},"91":{"start":{"line":268,"column":10},"end":{"line":283,"column":11}},"92":{"start":{"line":269,"column":12},"end":{"line":269,"column":37}},"93":{"start":{"line":270,"column":12},"end":{"line":270,"column":60}},"94":{"start":{"line":271,"column":17},"end":{"line":283,"column":11}},"95":{"start":{"line":272,"column":12},"end":{"line":272,"column":36}},"96":{"start":{"line":273,"column":12},"end":{"line":276,"column":14}},"97":{"start":{"line":277,"column":12},"end":{"line":279,"column":13}},"98":{"start":{"line":278,"column":14},"end":{"line":278,"column":97}},"99":{"start":{"line":280,"column":12},"end":{"line":282,"column":13}},"100":{"start":{"line":281,"column":14},"end":{"line":281,"column":100}},"101":{"start":{"line":284,"column":10},"end":{"line":284,"column":22}},"102":{"start":{"line":286,"column":10},"end":{"line":286,"column":38}},"103":{"start":{"line":287,"column":10},"end":{"line":287,"column":38}},"104":{"start":{"line":288,"column":10},"end":{"line":288,"column":22}},"105":{"start":{"line":289,"column":10},"end":{"line":289,"column":16}},"106":{"start":{"line":291,"column":10},"end":{"line":291,"column":23}},"107":{"start":{"line":296,"column":4},"end":{"line":298,"column":5}},"108":{"start":{"line":297,"column":6},"end":{"line":297,"column":34}},"109":{"start":{"line":301,"column":4},"end":{"line":309,"column":5}},"110":{"start":{"line":302,"column":6},"end":{"line":305,"column":7}},"111":{"start":{"line":303,"column":8},"end":{"line":303,"column":49}},"112":{"start":{"line":304,"column":8},"end":{"line":304,"column":32}},"113":{"start":{"line":306,"column":6},"end":{"line":306,"column":18}},"114":{"start":{"line":308,"column":6},"end":{"line":308,"column":19}},"115":{"start":{"line":315,"column":0},"end":{"line":329,"column":2}},"116":{"start":{"line":316,"column":2},"end":{"line":319,"column":4}},"117":{"start":{"line":331,"column":0},"end":{"line":420,"column":3}},"118":{"start":{"line":336,"column":14},"end":{"line":336,"column":28}},"119":{"start":{"line":339,"column":4},"end":{"line":339,"column":28}},"120":{"start":{"line":340,"column":4},"end":{"line":340,"column":31}},"121":{"start":{"line":341,"column":4},"end":{"line":351,"column":5}},"122":{"start":{"line":343,"column":8},"end":{"line":343,"column":54}},"123":{"start":{"line":344,"column":8},"end":{"line":344,"column":14}},"124":{"start":{"line":346,"column":8},"end":{"line":346,"column":55}},"125":{"start":{"line":347,"column":8},"end":{"line":347,"column":14}},"126":{"start":{"line":349,"column":8},"end":{"line":349,"column":29}},"127":{"start":{"line":350,"column":8},"end":{"line":350,"column":15}},"128":{"start":{"line":352,"column":4},"end":{"line":352,"column":26}},"129":{"start":{"line":353,"column":4},"end":{"line":353,"column":23}},"130":{"start":{"line":357,"column":4},"end":{"line":373,"column":5}},"131":{"start":{"line":358,"column":6},"end":{"line":358,"column":34}},"132":{"start":{"line":359,"column":6},"end":{"line":359,"column":18}},"133":{"start":{"line":361,"column":6},"end":{"line":372,"column":7}},"134":{"start":{"line":363,"column":10},"end":{"line":363,"column":26}},"135":{"start":{"line":364,"column":10},"end":{"line":364,"column":22}},"136":{"start":{"line":366,"column":10},"end":{"line":371,"column":11}},"137":{"start":{"line":367,"column":12},"end":{"line":367,"column":40}},"138":{"start":{"line":368,"column":12},"end":{"line":368,"column":24}},"139":{"start":{"line":370,"column":12},"end":{"line":370,"column":25}},"140":{"start":{"line":377,"column":4},"end":{"line":379,"column":5}},"141":{"start":{"line":378,"column":6},"end":{"line":378,"column":34}},"142":{"start":{"line":382,"column":4},"end":{"line":391,"column":5}},"143":{"start":{"line":383,"column":6},"end":{"line":387,"column":7}},"144":{"start":{"line":384,"column":8},"end":{"line":384,"column":39}},"145":{"start":{"line":385,"column":8},"end":{"line":385,"column":43}},"146":{"start":{"line":386,"column":8},"end":{"line":386,"column":32}},"147":{"start":{"line":388,"column":6},"end":{"line":388,"column":18}},"148":{"start":{"line":390,"column":6},"end":{"line":390,"column":19}},"149":{"start":{"line":416,"column":25},"end":{"line":416,"column":35}},"150":{"start":{"line":416,"column":36},"end":{"line":416,"column":45}},"151":{"start":{"line":418,"column":4},"end":{"line":418,"column":40}}},"branchMap":{"1":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]},"2":{"line":107,"type":"switch","locations":[{"start":{"line":108,"column":8},"end":{"line":112,"column":22}},{"start":{"line":113,"column":8},"end":{"line":116,"column":22}},{"start":{"line":117,"column":8},"end":{"line":118,"column":23}}]},"3":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":4},"end":{"line":125,"column":4}},{"start":{"line":125,"column":4},"end":{"line":125,"column":4}}]},"4":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":6},"end":{"line":126,"column":6}},{"start":{"line":126,"column":6},"end":{"line":126,"column":6}}]},"5":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":4},"end":{"line":150,"column":4}},{"start":{"line":150,"column":4},"end":{"line":150,"column":4}}]},"6":{"line":153,"type":"if","locations":[{"start":{"line":153,"column":4},"end":{"line":153,"column":4}},{"start":{"line":153,"column":4},"end":{"line":153,"column":4}}]},"7":{"line":159,"type":"if","locations":[{"start":{"line":159,"column":4},"end":{"line":159,"column":4}},{"start":{"line":159,"column":4},"end":{"line":159,"column":4}}]},"8":{"line":163,"type":"switch","locations":[{"start":{"line":164,"column":8},"end":{"line":169,"column":22}},{"start":{"line":170,"column":8},"end":{"line":176,"column":11}}]},"9":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":10},"end":{"line":171,"column":10}},{"start":{"line":171,"column":10},"end":{"line":171,"column":10}}]},"10":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":4},"end":{"line":181,"column":4}},{"start":{"line":181,"column":4},"end":{"line":181,"column":4}}]},"11":{"line":186,"type":"if","locations":[{"start":{"line":186,"column":4},"end":{"line":186,"column":4}},{"start":{"line":186,"column":4},"end":{"line":186,"column":4}}]},"12":{"line":187,"type":"if","locations":[{"start":{"line":187,"column":6},"end":{"line":187,"column":6}},{"start":{"line":187,"column":6},"end":{"line":187,"column":6}}]},"13":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":8},"end":{"line":188,"column":8}},{"start":{"line":188,"column":8},"end":{"line":188,"column":8}}]},"14":{"line":223,"type":"switch","locations":[{"start":{"line":224,"column":6},"end":{"line":226,"column":14}},{"start":{"line":227,"column":6},"end":{"line":247,"column":14}}]},"15":{"line":229,"type":"if","locations":[{"start":{"line":229,"column":8},"end":{"line":229,"column":8}},{"start":{"line":229,"column":8},"end":{"line":229,"column":8}}]},"16":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":10},"end":{"line":231,"column":10}},{"start":{"line":231,"column":10},"end":{"line":231,"column":10}}]},"17":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":8},"end":{"line":235,"column":8}},{"start":{"line":235,"column":8},"end":{"line":235,"column":8}}]},"18":{"line":238,"type":"if","locations":[{"start":{"line":238,"column":8},"end":{"line":238,"column":8}},{"start":{"line":238,"column":8},"end":{"line":238,"column":8}}]},"19":{"line":240,"type":"if","locations":[{"start":{"line":240,"column":10},"end":{"line":240,"column":10}},{"start":{"line":240,"column":10},"end":{"line":240,"column":10}}]},"20":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":8},"end":{"line":244,"column":8}},{"start":{"line":244,"column":8},"end":{"line":244,"column":8}}]},"21":{"line":259,"type":"if","locations":[{"start":{"line":259,"column":4},"end":{"line":259,"column":4}},{"start":{"line":259,"column":4},"end":{"line":259,"column":4}}]},"22":{"line":263,"type":"switch","locations":[{"start":{"line":264,"column":8},"end":{"line":284,"column":22}},{"start":{"line":285,"column":8},"end":{"line":289,"column":16}},{"start":{"line":290,"column":8},"end":{"line":291,"column":23}}]},"23":{"line":268,"type":"if","locations":[{"start":{"line":268,"column":10},"end":{"line":268,"column":10}},{"start":{"line":268,"column":10},"end":{"line":268,"column":10}}]},"24":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":17},"end":{"line":271,"column":17}},{"start":{"line":271,"column":17},"end":{"line":271,"column":17}}]},"25":{"line":274,"type":"cond-expr","locations":[{"start":{"line":274,"column":43},"end":{"line":274,"column":75}},{"start":{"line":274,"column":78},"end":{"line":274,"column":79}}]},"26":{"line":275,"type":"cond-expr","locations":[{"start":{"line":275,"column":41},"end":{"line":275,"column":72}},{"start":{"line":275,"column":75},"end":{"line":275,"column":76}}]},"27":{"line":277,"type":"if","locations":[{"start":{"line":277,"column":12},"end":{"line":277,"column":12}},{"start":{"line":277,"column":12},"end":{"line":277,"column":12}}]},"28":{"line":278,"type":"cond-expr","locations":[{"start":{"line":278,"column":59},"end":{"line":278,"column":92}},{"start":{"line":278,"column":95},"end":{"line":278,"column":96}}]},"29":{"line":280,"type":"if","locations":[{"start":{"line":280,"column":12},"end":{"line":280,"column":12}},{"start":{"line":280,"column":12},"end":{"line":280,"column":12}}]},"30":{"line":281,"type":"cond-expr","locations":[{"start":{"line":281,"column":61},"end":{"line":281,"column":95}},{"start":{"line":281,"column":98},"end":{"line":281,"column":99}}]},"31":{"line":296,"type":"if","locations":[{"start":{"line":296,"column":4},"end":{"line":296,"column":4}},{"start":{"line":296,"column":4},"end":{"line":296,"column":4}}]},"32":{"line":301,"type":"if","locations":[{"start":{"line":301,"column":4},"end":{"line":301,"column":4}},{"start":{"line":301,"column":4},"end":{"line":301,"column":4}}]},"33":{"line":302,"type":"if","locations":[{"start":{"line":302,"column":6},"end":{"line":302,"column":6}},{"start":{"line":302,"column":6},"end":{"line":302,"column":6}}]},"34":{"line":341,"type":"switch","locations":[{"start":{"line":342,"column":6},"end":{"line":344,"column":14}},{"start":{"line":345,"column":6},"end":{"line":347,"column":14}},{"start":{"line":348,"column":6},"end":{"line":350,"column":15}}]},"35":{"line":357,"type":"if","locations":[{"start":{"line":357,"column":4},"end":{"line":357,"column":4}},{"start":{"line":357,"column":4},"end":{"line":357,"column":4}}]},"36":{"line":361,"type":"switch","locations":[{"start":{"line":362,"column":8},"end":{"line":364,"column":22}},{"start":{"line":365,"column":8},"end":{"line":371,"column":11}}]},"37":{"line":366,"type":"if","locations":[{"start":{"line":366,"column":10},"end":{"line":366,"column":10}},{"start":{"line":366,"column":10},"end":{"line":366,"column":10}}]},"38":{"line":377,"type":"if","locations":[{"start":{"line":377,"column":4},"end":{"line":377,"column":4}},{"start":{"line":377,"column":4},"end":{"line":377,"column":4}}]},"39":{"line":382,"type":"if","locations":[{"start":{"line":382,"column":4},"end":{"line":382,"column":4}},{"start":{"line":382,"column":4},"end":{"line":382,"column":4}}]},"40":{"line":383,"type":"if","locations":[{"start":{"line":383,"column":6},"end":{"line":383,"column":6}},{"start":{"line":383,"column":6},"end":{"line":383,"column":6}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var ColorXform = require('./color-xform');","","// pattern fill: fgColor is pattern, gbColor is solid gb fill","//<fill>","//    <patternFill patternType=\"solid\">","//        <fgColor theme=\"0\" tint=\"-4.9989318521683403E-2\"/>","//        <bgColor indexed=\"64\"/>","//    </patternFill>","//</fill>","//","// angle gradient. degree=[0-180] 0=L->R, 1-359=rotate clockwise","// stop sequence specifies way points for the color to travel through","//<fill>","//    <gradientFill degree=\"30\">","//        <stop position=\"0\"><color theme=\"0\"/></stop>","//        <stop position=\"1\"><color theme=\"4\"/></stop>","//    </gradientFill>","//</fill>","//","// \"path\" gradient. Outwards from a point (or rectangle) where left=right=x, top=bottom=y","//<fill>","//    <gradientFill type=\"path\" left=\"0.3\" right=\"0.3\" top=\"0.7\" bottom=\"0.7\">","//        <stop position=\"0\"><color rgb=\"FFFF0000\"/></stop>","//        <stop position=\"0.5\"><color rgb=\"FF00FF00\"/></stop>","//        <stop position=\"1\"><color rgb=\"FF0000FF\"/></stop>","//    </gradientFill>","//</fill>","","// var modelSchema = {","//   // fill will be one of these types","//   type: ['pattern', 'gradient'],","//","//   // ============================================================","//   // pattern properties","//","//   // pattern style, required","//   pattern: ['solid', 'darkGray', 'mediumGray', 'lightGray', 'gray125', 'gray0625',","//     'darkHorizontal', 'darkVertical', 'darkDown', 'darkUp', 'darkGrid', 'darkTrellis',","//     'lightHorizontal', 'lightVertical', 'lightDown', 'lightUp', 'lightGrid', 'lightTrellis'],","//","//   // foreground colour, default is auto (i.e. black)","//   fgColor: new ColorXform('fgColor'),","//","//   // background (solid fill) colour, default is auto (i.e. white)","//   bgColor: new ColorXform('bgColor'),","//","//   // ============================================================","//   // gradient properties","//   gradient: ['angle', 'path'],","//   degree: [0,359], // for angle gradients 0=left to right, then clockwise from that","//   center: { left:[0,1], top:[0,1] }, // for path gradients optional right, bottom for a square","//   stops: [ //  start at position 0 and end at position 1","//     {position:0, color: {argb:''}},","//     {position:(0,1), color: {argb:''}}, // intermediate steps optional","//     {position:1, color: {argb:''}}","//   ]","// };","","var StopXform = function() {","  this.map = {","    color: new ColorXform()","  };","};","","utils.inherits(StopXform, BaseXform, {","","  get tag() { return 'stop'; },","","  render:  function(xmlStream, model) {","    xmlStream.openNode('stop');","    xmlStream.addAttribute('position', model.position);","    this.map.color.render(xmlStream, model.color);","    xmlStream.closeNode();","  },","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch (node.name) {","        case 'stop':","          this.model = {","            position: parseFloat(node.attributes.position)","          };","          return true;","        case 'color':","          this.parser = this.map.color;","          this.parser.parseOpen(node);","          return true;","        default:","          return false;","      }","    }","  },","  parseText: function() {","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model.color = this.parser.model;","        this.parser = undefined;","      }","      return true;","    }","    return false;","  }","});","","var PatternFillXform = function() {","  this.map = {","    fgColor: new ColorXform('fgColor'),","    bgColor: new ColorXform('bgColor')","  };","};","utils.inherits(PatternFillXform, BaseXform, {","","  get name() { return 'pattern'; },","  get tag() { return 'patternFill'; },","","  render: function(xmlStream, model) {","    xmlStream.openNode('patternFill');","    xmlStream.addAttribute('patternType', model.pattern);","    if (model.fgColor) {","      this.map.fgColor.render(xmlStream, model.fgColor);","    }","    if (model.bgColor) {","      this.map.bgColor.render(xmlStream, model.bgColor);","    }","    xmlStream.closeNode();","  },","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'patternFill':","          this.model = {","              type: 'pattern',","              pattern: node.attributes.patternType","            };","          return true;","        default:","          if ((this.parser = this.map[node.name])) {","            this.parser.parseOpen(node);","            return true;","          } else {","            return false;","          }","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        if (this.parser.model) {","          this.model[name] = this.parser.model;","        }","        this.parser = undefined;","      }","      return true;","    } else {","      return false;","    }","  }","});","","var GradientFillXform = function() {","  this.map = {","    stop: new StopXform()","  };","  // if (model) {","  //   this.gradient = model.gradient;","  //   if (model.center) {","  //     this.center = model.center;","  //   }","  //   if (model.degree !== undefined) {","  //     this.degree = model.degree;","  //   }","  //   this.stops = model.stops.map(function(stop) { return new StopXform(stop); });","  // } else {","  //   this.stops = [];","  // }","};","utils.inherits(GradientFillXform, BaseXform, {","  get name() { return 'gradient'; },","  get tag() { return 'gradientFill'; },","  ","  render: function(xmlStream, model) {","    xmlStream.openNode('gradientFill');","    switch(model.gradient) {","      case 'angle':","        xmlStream.addAttribute('degree', model.degree);","        break;","      case 'path':","        xmlStream.addAttribute('type', 'path');","        if (model.center.left) {","          xmlStream.addAttribute('left', model.center.left);","          if (model.center.right === undefined) {","            xmlStream.addAttribute('right', model.center.left);","          }","        }","        if (model.center.right) {","          xmlStream.addAttribute('right', model.center.right);","        }","        if (model.center.top) {","          xmlStream.addAttribute('top', model.center.top);","          if (model.center.bottom === undefined) {","            xmlStream.addAttribute('bottom', model.center.top);","          }","        }","        if (model.center.bottom) {","          xmlStream.addAttribute('bottom', model.center.bottom);","        }","        break;","    }","","    var stopXform = this.map.stop;","    model.stops.forEach(function(stopModel) {","      stopXform.render(xmlStream, stopModel);","    });","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch (node.name) {","        case 'gradientFill':","          var model = this.model = {","            stops: []","          };","          if (node.attributes.degree) {","            model.gradient = 'angle';","            model.degree = parseInt(node.attributes.degree);","          } else if (node.attributes.type == 'path') {","            model.gradient = 'path';","            model.center = {","              left: node.attributes.left ? parseFloat(node.attributes.left) : 0,","              top: node.attributes.top ? parseFloat(node.attributes.top) : 0","            };","            if (node.attributes.right != node.attributes.left) {","              model.center.right = node.attributes.right ? parseFloat(node.attributes.right) : 0;","            }","            if (node.attributes.bottom != node.attributes.top) {","              model.center.bottom = node.attributes.bottom ? parseFloat(node.attributes.bottom) : 0;","            }","          }","          return true;","        case 'stop':","          this.parser = this.map.stop;","          this.parser.parseOpen(node);","          return true;","          break;","        default:","          return false;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose:  function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model.stops.push(this.parser.model);","        this.parser = undefined;","      }","      return true;","    } else {","      return false;","    }","  }","});","","","// Fill encapsulates translation from fill model to/from xlsx","var FillXform = module.exports = function() {","  this.map = {","    patternFill:  new PatternFillXform(),","    gradientFill: new GradientFillXform()","  };","  // if (model) {","  //   if (model.pattern) {","  //     this._model = new PatternFillXform(model);","  //   } else if (model.gradient) {","  //     this._model = new GradientFill(model);","  //   } else {","  //     throw new Error('Did not recognise this fill model: ' + JSON.stringify(model));","  //   }","  // }","};","","utils.inherits(FillXform, BaseXform, {","  StopXform: StopXform,","  PatternFillXform: PatternFillXform,","  GradientFillXform: GradientFillXform","},{","  get tag() { return 'fill'; },","","  render: function(xmlStream, model) {","    xmlStream.addRollback();","    xmlStream.openNode('fill');","    switch(model.type) {","      case 'pattern':","        this.map.patternFill.render(xmlStream, model);","        break;","      case 'gradient':","        this.map.gradientFill.render(xmlStream, model);","        break;","      default:","        xmlStream.rollback();","        return;","    }","    xmlStream.closeNode();","    xmlStream.commit();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch (node.name) {","        case 'fill':","          this.model = {};","          return true;","        default:","          if ((this.parser = this.map[node.name])) {","            this.parser.parseOpen(node);","            return true;","          } else {","            return false;","          }","      }","    }","  },","","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose:  function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model = this.parser.model;","        this.model.type = this.parser.name;","        this.parser = undefined;","      }","      return true;","    } else {","      return false;","    }","  },","","  validPatternValues: [","    'none',","    'solid',","    'darkVertical',","    'darkGray',","    'mediumGray',","    'lightGray',","    'gray125',","    'gray0625',","    'darkHorizontal',","    'darkVertical',","    'darkDown',","    'darkUp',","    'darkGrid',","    'darkTrellis',","    'lightHorizontal',","    'lightVertical',","    'lightDown',","    'lightUp',","    'lightGrid',","    'lightTrellis',","    'lightGrid'","  ].reduce(function(p,v){p[v]=true; return p;}, {}),","  validStyle: function(value) {","    return this.validStyleValues[value];","  }","});",""],"l":{"25":1,"26":1,"28":1,"86":1,"87":0,"92":1,"94":0,"97":0,"98":0,"99":0,"100":0,"103":0,"104":0,"105":0,"107":0,"109":0,"112":0,"114":0,"115":0,"116":0,"118":0,"125":0,"126":0,"127":0,"128":0,"130":0,"132":0,"136":1,"137":0,"142":1,"144":0,"145":0,"148":0,"149":0,"150":0,"151":0,"153":0,"154":0,"156":0,"159":0,"160":0,"161":0,"163":0,"165":0,"169":0,"171":0,"172":0,"173":0,"175":0,"181":0,"182":0,"186":0,"187":0,"188":0,"189":0,"191":0,"193":0,"195":0,"200":1,"201":0,"217":1,"218":0,"219":0,"222":0,"223":0,"225":0,"226":0,"228":0,"229":0,"230":0,"231":0,"232":0,"235":0,"236":0,"238":0,"239":0,"240":0,"241":0,"244":0,"245":0,"247":0,"250":0,"251":0,"252":0,"255":0,"259":0,"260":0,"261":0,"263":0,"265":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"277":0,"278":0,"280":0,"281":0,"284":0,"286":0,"287":0,"288":0,"289":0,"291":0,"296":0,"297":0,"301":0,"302":0,"303":0,"304":0,"306":0,"308":0,"315":1,"316":0,"331":1,"336":0,"339":0,"340":0,"341":0,"343":0,"344":0,"346":0,"347":0,"349":0,"350":0,"352":0,"353":0,"357":0,"358":0,"359":0,"361":0,"363":0,"364":0,"366":0,"367":0,"368":0,"370":0,"377":0,"378":0,"382":0,"383":0,"384":0,"385":0,"386":0,"388":0,"390":0,"416":21,"418":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/border-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/border-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":12,"42":12,"43":0,"44":1,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":1,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0},"b":{"1":[0,0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":12,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"(anonymous_1)","line":37,"loc":{"start":{"line":37,"column":16},"end":{"line":37,"column":31}}},"2":{"name":"(anonymous_2)","line":46,"loc":{"start":{"line":46,"column":9},"end":{"line":46,"column":12}}},"3":{"name":"(anonymous_3)","line":48,"loc":{"start":{"line":48,"column":10},"end":{"line":48,"column":51}}},"4":{"name":"(anonymous_4)","line":60,"loc":{"start":{"line":60,"column":13},"end":{"line":60,"column":28}}},"5":{"name":"(anonymous_5)","line":85,"loc":{"start":{"line":85,"column":13},"end":{"line":85,"column":28}}},"6":{"name":"(anonymous_6)","line":90,"loc":{"start":{"line":90,"column":14},"end":{"line":90,"column":29}}},"7":{"name":"(anonymous_7)","line":121,"loc":{"start":{"line":121,"column":11},"end":{"line":121,"column":24}}},"8":{"name":"(anonymous_8)","line":122,"loc":{"start":{"line":122,"column":14},"end":{"line":122,"column":30}}},"9":{"name":"(anonymous_9)","line":128,"loc":{"start":{"line":128,"column":35},"end":{"line":128,"column":46}}},"10":{"name":"(anonymous_10)","line":139,"loc":{"start":{"line":139,"column":10},"end":{"line":139,"column":37}}},"11":{"name":"add","line":150,"loc":{"start":{"line":150,"column":4},"end":{"line":150,"column":39}}},"12":{"name":"(anonymous_12)","line":166,"loc":{"start":{"line":166,"column":13},"end":{"line":166,"column":28}}},"13":{"name":"(anonymous_13)","line":191,"loc":{"start":{"line":191,"column":13},"end":{"line":191,"column":28}}},"14":{"name":"(anonymous_14)","line":196,"loc":{"start":{"line":196,"column":14},"end":{"line":196,"column":29}}},"15":{"name":"(anonymous_15)","line":205,"loc":{"start":{"line":205,"column":18},"end":{"line":205,"column":56}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":42}},"4":{"start":{"line":37,"column":0},"end":{"line":42,"column":2}},"5":{"start":{"line":38,"column":2},"end":{"line":38,"column":19}},"6":{"start":{"line":39,"column":2},"end":{"line":41,"column":4}},"7":{"start":{"line":44,"column":0},"end":{"line":125,"column":3}},"8":{"start":{"line":46,"column":14},"end":{"line":46,"column":31}},"9":{"start":{"line":49,"column":4},"end":{"line":49,"column":74}},"10":{"start":{"line":50,"column":4},"end":{"line":50,"column":34}},"11":{"start":{"line":51,"column":4},"end":{"line":56,"column":5}},"12":{"start":{"line":52,"column":6},"end":{"line":52,"column":51}},"13":{"start":{"line":53,"column":6},"end":{"line":55,"column":7}},"14":{"start":{"line":54,"column":8},"end":{"line":54,"column":48}},"15":{"start":{"line":57,"column":4},"end":{"line":57,"column":26}},"16":{"start":{"line":61,"column":4},"end":{"line":83,"column":5}},"17":{"start":{"line":62,"column":6},"end":{"line":62,"column":34}},"18":{"start":{"line":63,"column":6},"end":{"line":63,"column":18}},"19":{"start":{"line":65,"column":6},"end":{"line":82,"column":7}},"20":{"start":{"line":67,"column":10},"end":{"line":67,"column":44}},"21":{"start":{"line":68,"column":10},"end":{"line":74,"column":11}},"22":{"start":{"line":69,"column":12},"end":{"line":71,"column":14}},"23":{"start":{"line":73,"column":12},"end":{"line":73,"column":35}},"24":{"start":{"line":75,"column":10},"end":{"line":75,"column":22}},"25":{"start":{"line":77,"column":10},"end":{"line":77,"column":40}},"26":{"start":{"line":78,"column":10},"end":{"line":78,"column":38}},"27":{"start":{"line":79,"column":10},"end":{"line":79,"column":22}},"28":{"start":{"line":81,"column":10},"end":{"line":81,"column":23}},"29":{"start":{"line":86,"column":4},"end":{"line":88,"column":5}},"30":{"start":{"line":87,"column":6},"end":{"line":87,"column":34}},"31":{"start":{"line":91,"column":4},"end":{"line":105,"column":5}},"32":{"start":{"line":92,"column":6},"end":{"line":94,"column":7}},"33":{"start":{"line":93,"column":8},"end":{"line":93,"column":32}},"34":{"start":{"line":95,"column":6},"end":{"line":95,"column":18}},"35":{"start":{"line":97,"column":6},"end":{"line":103,"column":7}},"36":{"start":{"line":98,"column":8},"end":{"line":102,"column":9}},"37":{"start":{"line":99,"column":10},"end":{"line":100,"column":26}},"38":{"start":{"line":100,"column":12},"end":{"line":100,"column":26}},"39":{"start":{"line":101,"column":10},"end":{"line":101,"column":50}},"40":{"start":{"line":104,"column":6},"end":{"line":104,"column":19}},"41":{"start":{"line":121,"column":25},"end":{"line":121,"column":35}},"42":{"start":{"line":121,"column":36},"end":{"line":121,"column":45}},"43":{"start":{"line":123,"column":4},"end":{"line":123,"column":40}},"44":{"start":{"line":128,"column":0},"end":{"line":136,"column":2}},"45":{"start":{"line":129,"column":2},"end":{"line":135,"column":4}},"46":{"start":{"line":138,"column":0},"end":{"line":222,"column":3}},"47":{"start":{"line":140,"column":4},"end":{"line":140,"column":28}},"48":{"start":{"line":141,"column":4},"end":{"line":141,"column":33}},"49":{"start":{"line":142,"column":4},"end":{"line":149,"column":5}},"50":{"start":{"line":143,"column":6},"end":{"line":145,"column":7}},"51":{"start":{"line":144,"column":8},"end":{"line":144,"column":50}},"52":{"start":{"line":146,"column":6},"end":{"line":148,"column":7}},"53":{"start":{"line":147,"column":8},"end":{"line":147,"column":52}},"54":{"start":{"line":150,"column":4},"end":{"line":156,"column":5}},"55":{"start":{"line":151,"column":6},"end":{"line":154,"column":7}},"56":{"start":{"line":153,"column":8},"end":{"line":153,"column":71}},"57":{"start":{"line":155,"column":6},"end":{"line":155,"column":52}},"58":{"start":{"line":157,"column":4},"end":{"line":157,"column":35}},"59":{"start":{"line":158,"column":4},"end":{"line":158,"column":37}},"60":{"start":{"line":159,"column":4},"end":{"line":159,"column":33}},"61":{"start":{"line":160,"column":4},"end":{"line":160,"column":39}},"62":{"start":{"line":161,"column":4},"end":{"line":161,"column":43}},"63":{"start":{"line":163,"column":4},"end":{"line":163,"column":26}},"64":{"start":{"line":167,"column":4},"end":{"line":189,"column":5}},"65":{"start":{"line":168,"column":6},"end":{"line":168,"column":34}},"66":{"start":{"line":170,"column":6},"end":{"line":188,"column":7}},"67":{"start":{"line":172,"column":10},"end":{"line":172,"column":70}},"68":{"start":{"line":173,"column":10},"end":{"line":173,"column":74}},"69":{"start":{"line":174,"column":10},"end":{"line":174,"column":32}},"70":{"start":{"line":175,"column":10},"end":{"line":175,"column":33}},"71":{"start":{"line":176,"column":10},"end":{"line":176,"column":31}},"72":{"start":{"line":177,"column":10},"end":{"line":177,"column":34}},"73":{"start":{"line":178,"column":10},"end":{"line":178,"column":36}},"74":{"start":{"line":179,"column":10},"end":{"line":179,"column":22}},"75":{"start":{"line":181,"column":10},"end":{"line":181,"column":44}},"76":{"start":{"line":182,"column":10},"end":{"line":187,"column":11}},"77":{"start":{"line":183,"column":12},"end":{"line":183,"column":40}},"78":{"start":{"line":184,"column":12},"end":{"line":184,"column":24}},"79":{"start":{"line":186,"column":12},"end":{"line":186,"column":25}},"80":{"start":{"line":192,"column":4},"end":{"line":194,"column":5}},"81":{"start":{"line":193,"column":6},"end":{"line":193,"column":34}},"82":{"start":{"line":197,"column":4},"end":{"line":220,"column":5}},"83":{"start":{"line":198,"column":6},"end":{"line":200,"column":7}},"84":{"start":{"line":199,"column":8},"end":{"line":199,"column":32}},"85":{"start":{"line":201,"column":6},"end":{"line":201,"column":18}},"86":{"start":{"line":203,"column":6},"end":{"line":218,"column":7}},"87":{"start":{"line":204,"column":8},"end":{"line":204,"column":36}},"88":{"start":{"line":205,"column":8},"end":{"line":212,"column":10}},"89":{"start":{"line":206,"column":10},"end":{"line":211,"column":11}},"90":{"start":{"line":207,"column":12},"end":{"line":209,"column":13}},"91":{"start":{"line":208,"column":14},"end":{"line":208,"column":51}},"92":{"start":{"line":210,"column":12},"end":{"line":210,"column":36}},"93":{"start":{"line":213,"column":8},"end":{"line":213,"column":41}},"94":{"start":{"line":214,"column":8},"end":{"line":214,"column":43}},"95":{"start":{"line":215,"column":8},"end":{"line":215,"column":39}},"96":{"start":{"line":216,"column":8},"end":{"line":216,"column":45}},"97":{"start":{"line":217,"column":8},"end":{"line":217,"column":97}},"98":{"start":{"line":219,"column":6},"end":{"line":219,"column":19}}},"branchMap":{"1":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":16},"end":{"line":49,"column":21}},{"start":{"line":49,"column":25},"end":{"line":49,"column":36}},{"start":{"line":49,"column":40},"end":{"line":49,"column":52}},{"start":{"line":49,"column":56},"end":{"line":49,"column":73}}]},"2":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":51,"column":4}},{"start":{"line":51,"column":4},"end":{"line":51,"column":4}}]},"3":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":8},"end":{"line":51,"column":13}},{"start":{"line":51,"column":17},"end":{"line":51,"column":28}}]},"4":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":6},"end":{"line":53,"column":6}},{"start":{"line":53,"column":6},"end":{"line":53,"column":6}}]},"5":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":4}},{"start":{"line":61,"column":4},"end":{"line":61,"column":4}}]},"6":{"line":65,"type":"switch","locations":[{"start":{"line":66,"column":8},"end":{"line":75,"column":22}},{"start":{"line":76,"column":8},"end":{"line":79,"column":22}},{"start":{"line":80,"column":8},"end":{"line":81,"column":23}}]},"7":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":10},"end":{"line":68,"column":10}},{"start":{"line":68,"column":10},"end":{"line":68,"column":10}}]},"8":{"line":86,"type":"if","locations":[{"start":{"line":86,"column":4},"end":{"line":86,"column":4}},{"start":{"line":86,"column":4},"end":{"line":86,"column":4}}]},"9":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":91,"column":4}},{"start":{"line":91,"column":4},"end":{"line":91,"column":4}}]},"10":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":6},"end":{"line":92,"column":6}},{"start":{"line":92,"column":6},"end":{"line":92,"column":6}}]},"11":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":6},"end":{"line":97,"column":6}},{"start":{"line":97,"column":6},"end":{"line":97,"column":6}}]},"12":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":8}},{"start":{"line":98,"column":8},"end":{"line":98,"column":8}}]},"13":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":10},"end":{"line":99,"column":10}},{"start":{"line":99,"column":10},"end":{"line":99,"column":10}}]},"14":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":4},"end":{"line":142,"column":4}},{"start":{"line":142,"column":4},"end":{"line":142,"column":4}}]},"15":{"line":142,"type":"binary-expr","locations":[{"start":{"line":142,"column":8},"end":{"line":142,"column":22}},{"start":{"line":142,"column":26},"end":{"line":142,"column":46}}]},"16":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":6},"end":{"line":143,"column":6}},{"start":{"line":143,"column":6},"end":{"line":143,"column":6}}]},"17":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":6},"end":{"line":146,"column":6}},{"start":{"line":146,"column":6},"end":{"line":146,"column":6}}]},"18":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":6},"end":{"line":151,"column":6}},{"start":{"line":151,"column":6},"end":{"line":151,"column":6}}]},"19":{"line":151,"type":"binary-expr","locations":[{"start":{"line":151,"column":10},"end":{"line":151,"column":19}},{"start":{"line":151,"column":23},"end":{"line":151,"column":39}},{"start":{"line":151,"column":43},"end":{"line":151,"column":54}}]},"20":{"line":167,"type":"if","locations":[{"start":{"line":167,"column":4},"end":{"line":167,"column":4}},{"start":{"line":167,"column":4},"end":{"line":167,"column":4}}]},"21":{"line":170,"type":"switch","locations":[{"start":{"line":171,"column":8},"end":{"line":179,"column":22}},{"start":{"line":180,"column":8},"end":{"line":187,"column":11}}]},"22":{"line":172,"type":"cond-expr","locations":[{"start":{"line":172,"column":57},"end":{"line":172,"column":61}},{"start":{"line":172,"column":64},"end":{"line":172,"column":69}}]},"23":{"line":173,"type":"cond-expr","locations":[{"start":{"line":173,"column":61},"end":{"line":173,"column":65}},{"start":{"line":173,"column":68},"end":{"line":173,"column":73}}]},"24":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":10},"end":{"line":182,"column":10}},{"start":{"line":182,"column":10},"end":{"line":182,"column":10}}]},"25":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":4},"end":{"line":192,"column":4}},{"start":{"line":192,"column":4},"end":{"line":192,"column":4}}]},"26":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":4},"end":{"line":197,"column":4}},{"start":{"line":197,"column":4},"end":{"line":197,"column":4}}]},"27":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":6},"end":{"line":198,"column":6}},{"start":{"line":198,"column":6},"end":{"line":198,"column":6}}]},"28":{"line":203,"type":"if","locations":[{"start":{"line":203,"column":6},"end":{"line":203,"column":6}},{"start":{"line":203,"column":6},"end":{"line":203,"column":6}}]},"29":{"line":206,"type":"if","locations":[{"start":{"line":206,"column":10},"end":{"line":206,"column":10}},{"start":{"line":206,"column":10},"end":{"line":206,"column":10}}]},"30":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":12},"end":{"line":207,"column":12}},{"start":{"line":207,"column":12},"end":{"line":207,"column":12}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var ColorXform = require('./color-xform');","","//var model = {","//    color: { argb: \"12345678\" }, // default colour for individual directions","//    top: { style: \"thick\" }, // gets default colour","//    left: { style: \"thin\", color:{auto:true} }, // overrides with auto colour","//    diagonal: { up: true, down: true, style: \"thin\" }","//}","","var EdgeXform = function(name) {","  this.name = name;","  this.map = {","    color: new ColorXform()","  };","};","","utils.inherits(EdgeXform, BaseXform, {","","  get tag() { return this.name; },","","  render: function(xmlStream, model, defaultColor) {","    var color = model && model.color || defaultColor || this.defaultColor;","    xmlStream.openNode(this.name);","    if (model && model.style) {","      xmlStream.addAttribute('style', model.style);","      if (color) {","        this.map.color.render(xmlStream, color);","      }","    }","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch (node.name) {","        case this.name:","          var style = node.attributes.style;","          if (style) {","            this.model = {","              style: style","            };","          } else {","            this.model = undefined;","          }","          return true;","        case 'color':","          this.parser  = this.map.color;","          this.parser.parseOpen(node);","          return true;","        default:","          return false;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      if (name === this.name) {","        if (this.map.color.model) {","          if(!this.model)","            this.model={};","          this.model.color = this.map.color.model;","        }","      }","      return false;","    }","  },","","  validStyleValues: [","    'thin',","    'dotted',","    'dashDot',","    'hair',","    'dashDotDot',","    'slantDashDot',","    'mediumDashed',","    'mediumDashDotDot',","    'mediumDashDot',","    'medium',","    'double',","    'thick'","  ].reduce(function(p,v){p[v]=true; return p;}, {}),","  validStyle: function(value) {","    return this.validStyleValues[value];","  }","});","","// Border encapsulates translation from border model to/from xlsx","var BorderXform = module.exports = function() {","  this.map = {","    top: new EdgeXform('top'),","    left: new EdgeXform('left'),","    bottom: new EdgeXform('bottom'),","    right: new EdgeXform('right'),","    diagonal: new EdgeXform('diagonal')","  };","};","","utils.inherits(BorderXform, BaseXform, {","  render: function(xmlStream, model) {","    var color = model.color;","    xmlStream.openNode('border');","    if (model.diagonal && model.diagonal.style) {","      if (model.diagonal.up) {","        xmlStream.addAttribute('diagonalUp', '1');","      }","      if (model.diagonal.down) {","        xmlStream.addAttribute('diagonalDown', '1');","      }","    }","    function add(edgeModel, edgeXform) {","      if (edgeModel && !edgeModel.color && model.color) {","        // don't mess with incoming models","        edgeModel = Object.assign({}, edgeModel, {color: model.color});","      }","      edgeXform.render(xmlStream, edgeModel, color);","    }","    add(model.left, this.map.left);","    add(model.right, this.map.right);","    add(model.top, this.map.top);","    add(model.bottom, this.map.bottom);","    add(model.diagonal, this.map.diagonal);","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","    } else {","      switch(node.name) {","        case 'border':","          this.diagonalUp = node.attributes.diagonalUp ? true : false;","          this.diagonalDown = node.attributes.diagonalDown ? true : false;","          this.map.left.reset();","          this.map.right.reset();","          this.map.top.reset();","          this.map.bottom.reset();","          this.map.diagonal.reset();","          return true;","        default:","          this.parser = this.map[node.name];","          if (this.parser) {","            this.parser.parseOpen(node);","            return true;","          } else {","            return false;","          }","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      if (name === 'border') {","        var model = this.model = {};","        var add = function(name, edgeModel, extensions) {","          if (edgeModel) {","            if (extensions) {","              Object.assign(edgeModel, extensions);","            }","            model[name] = edgeModel;","          }","        };","        add('left', this.map.left.model);","        add('right', this.map.right.model);","        add('top', this.map.top.model);","        add('bottom', this.map.bottom.model);","        add('diagonal', this.map.diagonal.model, {up: this.diagonalUp, down: this.diagonalDown});","      }","      return false;","    }","  }","});",""],"l":{"25":1,"26":1,"28":1,"37":1,"38":0,"39":0,"44":1,"46":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"57":0,"61":0,"62":0,"63":0,"65":0,"67":0,"68":0,"69":0,"73":0,"75":0,"77":0,"78":0,"79":0,"81":0,"86":0,"87":0,"91":0,"92":0,"93":0,"95":0,"97":0,"98":0,"99":0,"100":0,"101":0,"104":0,"121":12,"123":0,"128":1,"129":0,"138":1,"140":0,"141":0,"142":0,"143":0,"144":0,"146":0,"147":0,"150":1,"151":0,"153":0,"155":0,"157":0,"158":0,"159":0,"160":0,"161":0,"163":0,"167":0,"168":0,"170":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"181":0,"182":0,"183":0,"184":0,"186":0,"192":0,"193":0,"197":0,"198":0,"199":0,"201":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"210":0,"213":0,"214":0,"215":0,"216":0,"217":0,"219":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/numfmt-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/numfmt-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":56,"9":28,"10":1,"11":1,"12":1,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},"b":{"1":[28,28],"2":[0,0],"3":[0,0]},"f":{"1":1,"2":56,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"hashDefaultFormats","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":30}}},"2":{"name":"(anonymous_2)","line":34,"loc":{"start":{"line":34,"column":28},"end":{"line":34,"column":46}}},"3":{"name":"(anonymous_3)","line":46,"loc":{"start":{"line":46,"column":35},"end":{"line":46,"column":60}}},"4":{"name":"(anonymous_4)","line":54,"loc":{"start":{"line":54,"column":9},"end":{"line":54,"column":12}}},"5":{"name":"(anonymous_5)","line":56,"loc":{"start":{"line":56,"column":19},"end":{"line":56,"column":40}}},"6":{"name":"(anonymous_6)","line":59,"loc":{"start":{"line":59,"column":21},"end":{"line":59,"column":40}}},"7":{"name":"(anonymous_7)","line":63,"loc":{"start":{"line":63,"column":10},"end":{"line":63,"column":37}}},"8":{"name":"(anonymous_8)","line":67,"loc":{"start":{"line":67,"column":14},"end":{"line":67,"column":29}}},"9":{"name":"(anonymous_9)","line":79,"loc":{"start":{"line":79,"column":13},"end":{"line":79,"column":24}}},"10":{"name":"(anonymous_10)","line":81,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":45}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":44}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":59}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":41}},"5":{"start":{"line":32,"column":0},"end":{"line":41,"column":1}},"6":{"start":{"line":33,"column":2},"end":{"line":33,"column":16}},"7":{"start":{"line":34,"column":2},"end":{"line":39,"column":5}},"8":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"9":{"start":{"line":36,"column":6},"end":{"line":36,"column":33}},"10":{"start":{"line":40,"column":2},"end":{"line":40,"column":14}},"11":{"start":{"line":42,"column":0},"end":{"line":42,"column":42}},"12":{"start":{"line":46,"column":0},"end":{"line":49,"column":2}},"13":{"start":{"line":47,"column":2},"end":{"line":47,"column":15}},"14":{"start":{"line":48,"column":2},"end":{"line":48,"column":31}},"15":{"start":{"line":52,"column":0},"end":{"line":84,"column":3}},"16":{"start":{"line":54,"column":14},"end":{"line":54,"column":30}},"17":{"start":{"line":57,"column":4},"end":{"line":57,"column":38}},"18":{"start":{"line":60,"column":4},"end":{"line":60,"column":72}},"19":{"start":{"line":65,"column":4},"end":{"line":65,"column":85}},"20":{"start":{"line":68,"column":4},"end":{"line":77,"column":5}},"21":{"start":{"line":70,"column":8},"end":{"line":73,"column":10}},"22":{"start":{"line":74,"column":8},"end":{"line":74,"column":20}},"23":{"start":{"line":76,"column":8},"end":{"line":76,"column":21}},"24":{"start":{"line":82,"column":4},"end":{"line":82,"column":17}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]},"2":{"line":60,"type":"binary-expr","locations":[{"start":{"line":60,"column":11},"end":{"line":60,"column":38}},{"start":{"line":60,"column":42},"end":{"line":60,"column":71}}]},"3":{"line":68,"type":"switch","locations":[{"start":{"line":69,"column":6},"end":{"line":74,"column":20}},{"start":{"line":75,"column":6},"end":{"line":76,"column":21}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../../../utils/under-dash');","var utils = require('../../../utils/utils');","var defaultNumFormats = require('../../defaultnumformats');","","var BaseXform = require('../base-xform');","","","function hashDefaultFormats() {","  var hash = {};","  _.each(defaultNumFormats, function(dnf, id) {","    if (dnf.f) {","      hash[dnf.f] = parseInt(id);","    }","    // at some point, add the other cultures here...","  });","  return hash;","}","var defaultFmtHash = hashDefaultFormats();","","","// NumFmt encapsulates translation between number format and xlsx","var NumFmtXform = module.exports = function(id, formatCode) {","  this.id = id;","  this.formatCode = formatCode;","};","","","utils.inherits(NumFmtXform, BaseXform, {","","  get tag() { return 'numFmt'; },","","  getDefaultFmtId: function(formatCode) {","    return defaultFmtHash[formatCode];","  },","  getDefaultFmtCode: function(numFmtId) {","    return defaultNumFormats[numFmtId] && defaultNumFormats[numFmtId].f;","  }","},{","  render: function(xmlStream, model) {","    //var formatCode = model.formatCode.replace(/([\\s\\-\\(\\)])/g, '\\\\$1');","    xmlStream.leafNode('numFmt', {numFmtId: model.id, formatCode: model.formatCode});","  },","  parseOpen:  function(node) {","    switch(node.name) {","      case 'numFmt':","        this.model = {","          id: parseInt(node.attributes.numFmtId),","          formatCode: node.attributes.formatCode.replace(/[\\\\](.)/g, '$1')","        };","        return true;","      default:","        return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"32":1,"33":1,"34":1,"35":56,"36":28,"40":1,"42":1,"46":1,"47":0,"48":0,"52":1,"54":0,"57":0,"60":0,"65":0,"68":0,"70":0,"74":0,"76":0,"82":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/defaultnumformats.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/defaultnumformats.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":87,"column":2}}},"branchMap":{},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","\"use strict\";","","module.exports = {","  0:  { \"f\": 'General' },","  1:  { \"f\": '0' },","  2:  { \"f\": '0.00' },","  3:  { \"f\": '#,##0' },","  4:  { \"f\": '#,##0.00' },","  9:  { \"f\": '0%' },","  10: { \"f\": '0.00%' },","  11: { \"f\": '0.00E+00' },","  12: { \"f\": '# ?/?'},","  13: { \"f\": '# ??/??'},","  14: { \"f\": 'mm-dd-yy'},","  15: { \"f\": 'd-mmm-yy'},","  16: { \"f\": 'd-mmm'},","  17: { \"f\": 'mmm-yy'},","  18: { \"f\": 'h:mm AM/PM'},","  19: { \"f\": 'h:mm:ss AM/PM'},","  20: { \"f\": 'h:mm'},","  21: { \"f\": 'h:mm:ss'},","  22: { \"f\": 'm/d/yy \"h\":mm'},","","  27: { \"zh-tw\": '[$-404]e/m/d', \"zh-cn\": 'yyyy\"\"m\"\"', \"ja-jp\": '[$-411]ge.m.d', \"ko-kr\": 'yyyy\"\" mm\"\" dd\"\"' },","  28: { \"zh-tw\": '[$-404]e\"\"m\"\"d\"\"', \"zh-cn\": 'm\"\"d\"\"', \"ja-jp\": '[$-411]ggge\"\"m\"\"d\"\"', \"ko-kr\": 'mm-dd' },","  29: { \"zh-tw\": '[$-404]e\"\"m\"\"d\"\"', \"zh-cn\": 'm\"\"d\"\"', \"ja-jp\": '[$-411]ggge\"\"m\"\"d\"\"', \"ko-kr\": 'mm-dd' },","  30: { \"zh-tw\": 'm/d/yy ', \"zh-cn\": 'm-d-yy', \"ja-jp\": 'm/d/yy', \"ko-kr\": 'mm-dd-yy' },","  31: { \"zh-tw\": 'yyyy\"\"m\"\"d\"\"', \"zh-cn\": 'yyyy\"\"m\"\"d\"\"', \"ja-jp\": 'yyyy\"\"m\"\"d\"\"', \"ko-kr\": 'yyyy\"\" mm\"\" dd\"\"' },","  32: { \"zh-tw\": 'hh\"\"mm\"\"', \"zh-cn\": 'h\"\"mm\"\"', \"ja-jp\": 'h\"\"mm\"\"', \"ko-kr\": 'h\"\" mm\"\"' },","  33: { \"zh-tw\": 'hh\"\"mm\"\"ss\"\"', \"zh-cn\": 'h\"\"mm\"\"ss\"\"', \"ja-jp\": 'h\"\"mm\"\"ss\"\"', \"ko-kr\": 'h\"\" mm\"\" ss\"\"' },","  34: { \"zh-tw\": '/ hh\"\"mm\"\"', \"zh-cn\": '/ h\"\"mm\"\"', \"ja-jp\": 'yyyy\"\"m\"\"', \"ko-kr\": 'yyyy-mm-dd'},","  35: { \"zh-tw\": '/ hh\"\"mm\"\"ss\"\"', \"zh-cn\": '/ h\"\"mm\"\"ss\"\"', \"ja-jp\": 'm\"\"d\"\"', \"ko-kr\": 'yyyy-mm-dd' },","  36: { \"zh-tw\": '[$-404]e/m/d', \"zh-cn\": 'yyyy\"\"m\"\"', \"ja-jp\": '[$-411]ge.m.d', \"ko-kr\": 'yyyy\"\" mm\"\" dd\"\"' },","","  37: { \"f\": '#,##0 ;(#,##0)'},","  38: { \"f\": '#,##0 ;[Red](#,##0)'},","  39: { \"f\": '#,##0.00 ;(#,##0.00)'},","  40: { \"f\": '#,##0.00 ;[Red](#,##0.00)'},","  45: { \"f\": 'mm:ss'},","  46: { \"f\": '[h]:mm:ss'},","  47: { \"f\": 'mmss.0'},","  48: { \"f\": '##0.0E+0'},","  49: { \"f\": '@' },","","  50: { \"zh-tw\": '[$-404]e/m/d', \"zh-cn\": 'yyyy\"\"m\"\"', \"ja-jp\": '[$-411]ge.m.d', \"ko-kr\": 'yyyy\"\" mm\"\" dd\"\"' },","  51: { \"zh-tw\": '[$-404]e\"\"m\"\"d\"\"', \"zh-cn\": 'm\"\"d\"\"', \"ja-jp\": '[$-411]ggge\"\"m\"\"d\"\"', \"ko-kr\": 'mm-dd' },","  52: { \"zh-tw\": '/ hh\"\"mm\"\"', \"zh-cn\": 'yyyy\"\"m\"\"', \"ja-jp\": 'yyyy\"\"m\"\"', \"ko-kr\": 'yyyy-mm-dd' },","  53: { \"zh-tw\": '/ hh\"\"mm\"\"ss\"\"', \"zh-cn\": 'm\"\"d\"\"', \"ja-jp\": 'm\"\"d\"\"', \"ko-kr\": 'yyyy-mm-dd' },","  54: { \"zh-tw\": '[$-404]e\"\"m\"\"d\"\"', \"zh-cn\": 'm\"\"d\"\"', \"ja-jp\": '[$-411]ggge\"\"m\"\"d\"\"', \"ko-kr\": 'mm-dd' },","  55: { \"zh-tw\": '/ hh\"\"mm\"\"', \"zh-cn\": '/ h\"\"mm\"\"', \"ja-jp\": 'yyyy\"\"m\"\"', \"ko-kr\": 'yyyy-mm-dd' },","  56: { \"zh-tw\": '/ hh\"\"mm\"\"ss\"\"', \"zh-cn\": '/ h\"\"mm\"\"ss\"\"', \"ja-jp\": 'm\"\"d\"\"', \"ko-kr\": 'yyyy-mm-dd' },","  57: { \"zh-tw\": '[$-404]e/m/d', \"zh-cn\": 'yyyy\"\"m\"\"', \"ja-jp\": '[$-411]ge.m.d', \"ko-kr\": 'yyyy\"\" mm\"\" dd\"\"' },","  58: { \"zh-tw\": '[$-404]e\"\"m\"\"d\"\"', \"zh-cn\": 'm\"\"d\"\"', \"ja-jp\": '[$-411]ggge\"\"m\"\"d\"\"', \"ko-kr\": 'mm-dd' },","","  59: { \"th-th\": 't0' },","  60: { \"th-th\": 't0.00' },","  61: { \"th-th\": 't#,##0' },","  62: { \"th-th\": 't#,##0.00' },","  67: { \"th-th\": 't0%' },","  68: { \"th-th\": 't0.00%' },","  69: { \"th-th\": 't# ?/?' },","  70: { \"th-th\": 't# ??/??'},","","  81: { \"th-th\": 'd/m/bb' }","};"],"l":{"25":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/style-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/style-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":35,"loc":{"start":{"line":35,"column":34},"end":{"line":35,"column":52}}},"2":{"name":"(anonymous_2)","line":44,"loc":{"start":{"line":44,"column":9},"end":{"line":44,"column":12}}},"3":{"name":"(anonymous_3)","line":46,"loc":{"start":{"line":46,"column":10},"end":{"line":46,"column":37}}},"4":{"name":"(anonymous_4)","line":78,"loc":{"start":{"line":78,"column":13},"end":{"line":78,"column":28}}},"5":{"name":"(anonymous_5)","line":107,"loc":{"start":{"line":107,"column":13},"end":{"line":107,"column":28}}},"6":{"name":"(anonymous_6)","line":112,"loc":{"start":{"line":112,"column":14},"end":{"line":112,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":50}},"4":{"start":{"line":35,"column":0},"end":{"line":40,"column":2}},"5":{"start":{"line":36,"column":2},"end":{"line":36,"column":42}},"6":{"start":{"line":37,"column":2},"end":{"line":39,"column":4}},"7":{"start":{"line":42,"column":0},"end":{"line":123,"column":3}},"8":{"start":{"line":44,"column":14},"end":{"line":44,"column":26}},"9":{"start":{"line":47,"column":4},"end":{"line":52,"column":7}},"10":{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},"11":{"start":{"line":54,"column":6},"end":{"line":54,"column":54}},"12":{"start":{"line":57,"column":4},"end":{"line":59,"column":5}},"13":{"start":{"line":58,"column":6},"end":{"line":58,"column":55}},"14":{"start":{"line":60,"column":4},"end":{"line":62,"column":5}},"15":{"start":{"line":61,"column":6},"end":{"line":61,"column":47}},"16":{"start":{"line":63,"column":4},"end":{"line":65,"column":5}},"17":{"start":{"line":64,"column":6},"end":{"line":64,"column":47}},"18":{"start":{"line":66,"column":4},"end":{"line":68,"column":5}},"19":{"start":{"line":67,"column":6},"end":{"line":67,"column":49}},"20":{"start":{"line":70,"column":4},"end":{"line":73,"column":5}},"21":{"start":{"line":71,"column":6},"end":{"line":71,"column":52}},"22":{"start":{"line":72,"column":6},"end":{"line":72,"column":60}},"23":{"start":{"line":75,"column":4},"end":{"line":75,"column":26}},"24":{"start":{"line":81,"column":4},"end":{"line":105,"column":5}},"25":{"start":{"line":82,"column":6},"end":{"line":82,"column":34}},"26":{"start":{"line":83,"column":6},"end":{"line":83,"column":18}},"27":{"start":{"line":86,"column":6},"end":{"line":104,"column":7}},"28":{"start":{"line":88,"column":10},"end":{"line":93,"column":12}},"29":{"start":{"line":94,"column":10},"end":{"line":96,"column":11}},"30":{"start":{"line":95,"column":12},"end":{"line":95,"column":61}},"31":{"start":{"line":97,"column":10},"end":{"line":97,"column":22}},"32":{"start":{"line":99,"column":10},"end":{"line":99,"column":43}},"33":{"start":{"line":100,"column":10},"end":{"line":100,"column":38}},"34":{"start":{"line":101,"column":10},"end":{"line":101,"column":22}},"35":{"start":{"line":103,"column":10},"end":{"line":103,"column":23}},"36":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"37":{"start":{"line":109,"column":6},"end":{"line":109,"column":34}},"38":{"start":{"line":113,"column":4},"end":{"line":121,"column":5}},"39":{"start":{"line":114,"column":6},"end":{"line":117,"column":7}},"40":{"start":{"line":115,"column":8},"end":{"line":115,"column":49}},"41":{"start":{"line":116,"column":8},"end":{"line":116,"column":32}},"42":{"start":{"line":118,"column":6},"end":{"line":118,"column":18}},"43":{"start":{"line":120,"column":6},"end":{"line":120,"column":27}}},"branchMap":{"1":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":17},"end":{"line":36,"column":24}},{"start":{"line":36,"column":28},"end":{"line":36,"column":40}}]},"2":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":16},"end":{"line":48,"column":30}},{"start":{"line":48,"column":34},"end":{"line":48,"column":35}}]},"3":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":14},"end":{"line":49,"column":26}},{"start":{"line":49,"column":30},"end":{"line":49,"column":31}}]},"4":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":14},"end":{"line":50,"column":26}},{"start":{"line":50,"column":30},"end":{"line":50,"column":31}}]},"5":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":16},"end":{"line":51,"column":30}},{"start":{"line":51,"column":34},"end":{"line":51,"column":35}}]},"6":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":53,"column":4}},{"start":{"line":53,"column":4},"end":{"line":53,"column":4}}]},"7":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":37},"end":{"line":54,"column":47}},{"start":{"line":54,"column":51},"end":{"line":54,"column":52}}]},"8":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":4},"end":{"line":57,"column":4}},{"start":{"line":57,"column":4},"end":{"line":57,"column":4}}]},"9":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":4},"end":{"line":60,"column":4}},{"start":{"line":60,"column":4},"end":{"line":60,"column":4}}]},"10":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"11":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]},"12":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":4}},{"start":{"line":70,"column":4},"end":{"line":70,"column":4}}]},"13":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":4},"end":{"line":81,"column":4}},{"start":{"line":81,"column":4},"end":{"line":81,"column":4}}]},"14":{"line":86,"type":"switch","locations":[{"start":{"line":87,"column":8},"end":{"line":97,"column":22}},{"start":{"line":98,"column":8},"end":{"line":101,"column":22}},{"start":{"line":102,"column":8},"end":{"line":103,"column":23}}]},"15":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":10},"end":{"line":94,"column":10}},{"start":{"line":94,"column":10},"end":{"line":94,"column":10}}]},"16":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":108,"column":4}},{"start":{"line":108,"column":4},"end":{"line":108,"column":4}}]},"17":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":4},"end":{"line":113,"column":4}},{"start":{"line":113,"column":4},"end":{"line":113,"column":4}}]},"18":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":6},"end":{"line":114,"column":6}},{"start":{"line":114,"column":6},"end":{"line":114,"column":6}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var AlignmentXform = require('./alignment-xform');","","// <xf numFmtId=\"[numFmtId]\" fontId=\"[fontId]\" fillId=\"[fillId]\" borderId=\"[xf.borderId]\" xfId=\"[xfId]\">","//   Optional <alignment>","// </xf>","","// Style assists translation from style model to/from xlsx","var StyleXform = module.exports = function(options) {","  this.xfId = !!(options && options.xfId);","  this.map = {","    alignment: new AlignmentXform()","  };","};","","utils.inherits(StyleXform, BaseXform, {","","  get tag() { return 'xf'; },","","  render: function(xmlStream, model) {","    xmlStream.openNode('xf', {","      numFmtId: model.numFmtId || 0,","      fontId: model.fontId || 0,","      fillId: model.fillId || 0,","      borderId: model.borderId || 0","    });","    if (this.xfId) {","      xmlStream.addAttribute('xfId', model.xfId || 0);","    }","","    if (model.numFmtId) {","      xmlStream.addAttribute('applyNumberFormat', '1');","    }","    if (model.fontId) {","      xmlStream.addAttribute('applyFont', '1');","    }","    if (model.fillId) {","      xmlStream.addAttribute('applyFill', '1');","    }","    if (model.borderId) {","      xmlStream.addAttribute('applyBorder', '1');","    }","","    if (model.alignment) {","      xmlStream.addAttribute('applyAlignment', '1');","      this.map.alignment.render(xmlStream, model.alignment);","    }","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    // console.log('style-xform',JSON.stringify(node));","","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      // used during sax parsing of xml to build font object","      switch (node.name) {","        case 'xf':","          this.model = {","            numFmtId: parseInt(node.attributes.numFmtId),","            fontId: parseInt(node.attributes.fontId),","            fillId: parseInt(node.attributes.fillId),","            borderId: parseInt(node.attributes.borderId)","          };","          if (this.xfId) {","            this.model.xfId = parseInt(node.attributes.xfId);","          }","          return true;","        case 'alignment':","          this.parser = this.map.alignment;","          this.parser.parseOpen(node);","          return true;","        default:","          return false;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model.alignment = this.parser.model;","        this.parser = undefined;","      }","      return true;","    } else {","      return name !== 'xf';","    }","  }","});",""],"l":{"25":1,"26":1,"28":1,"35":1,"36":0,"37":0,"42":1,"44":0,"47":0,"53":0,"54":0,"57":0,"58":0,"60":0,"61":0,"63":0,"64":0,"66":0,"67":0,"70":0,"71":0,"72":0,"75":0,"81":0,"82":0,"83":0,"86":0,"88":0,"94":0,"95":0,"97":0,"99":0,"100":0,"101":0,"103":0,"108":0,"109":0,"113":0,"114":0,"115":0,"116":0,"118":0,"120":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/alignment-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/style/alignment-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":7,"6":7,"7":0,"8":5,"9":5,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":4,"22":4,"23":0,"24":1,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":1,"44":0,"45":0,"46":0,"47":0,"48":1,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":1,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"f":{"1":7,"2":0,"3":5,"4":0,"5":0,"6":0,"7":0,"8":0,"9":4,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},"fnMap":{"1":{"name":"(anonymous_1)","line":39,"loc":{"start":{"line":39,"column":11},"end":{"line":39,"column":24}}},"2":{"name":"(anonymous_2)","line":40,"loc":{"start":{"line":40,"column":14},"end":{"line":40,"column":30}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":11},"end":{"line":50,"column":24}}},"4":{"name":"(anonymous_4)","line":51,"loc":{"start":{"line":51,"column":12},"end":{"line":51,"column":28}}},"5":{"name":"(anonymous_5)","line":55,"loc":{"start":{"line":55,"column":12},"end":{"line":55,"column":28}}},"6":{"name":"(anonymous_6)","line":58,"loc":{"start":{"line":58,"column":15},"end":{"line":58,"column":31}}},"7":{"name":"(anonymous_7)","line":61,"loc":{"start":{"line":61,"column":16},"end":{"line":61,"column":32}}},"8":{"name":"(anonymous_8)","line":70,"loc":{"start":{"line":70,"column":10},"end":{"line":70,"column":26}}},"9":{"name":"(anonymous_9)","line":79,"loc":{"start":{"line":79,"column":11},"end":{"line":79,"column":25}}},"10":{"name":"(anonymous_10)","line":81,"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":32}}},"11":{"name":"(anonymous_11)","line":87,"loc":{"start":{"line":87,"column":10},"end":{"line":87,"column":33}}},"12":{"name":"(anonymous_12)","line":102,"loc":{"start":{"line":102,"column":11},"end":{"line":102,"column":34}}},"13":{"name":"(anonymous_13)","line":117,"loc":{"start":{"line":117,"column":38},"end":{"line":117,"column":49}}},"14":{"name":"(anonymous_14)","line":122,"loc":{"start":{"line":122,"column":9},"end":{"line":122,"column":12}}},"15":{"name":"(anonymous_15)","line":124,"loc":{"start":{"line":124,"column":10},"end":{"line":124,"column":37}}},"16":{"name":"add","line":130,"loc":{"start":{"line":130,"column":4},"end":{"line":130,"column":30}}},"17":{"name":"(anonymous_17)","line":153,"loc":{"start":{"line":153,"column":13},"end":{"line":153,"column":28}}},"18":{"name":"add","line":157,"loc":{"start":{"line":157,"column":4},"end":{"line":157,"column":38}}},"19":{"name":"(anonymous_19)","line":174,"loc":{"start":{"line":174,"column":13},"end":{"line":174,"column":24}}},"20":{"name":"(anonymous_20)","line":176,"loc":{"start":{"line":176,"column":14},"end":{"line":176,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":42}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":44}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":41}},"4":{"start":{"line":30,"column":0},"end":{"line":84,"column":2}},"5":{"start":{"line":39,"column":25},"end":{"line":39,"column":35}},"6":{"start":{"line":39,"column":36},"end":{"line":39,"column":45}},"7":{"start":{"line":41,"column":4},"end":{"line":41,"column":60}},"8":{"start":{"line":50,"column":25},"end":{"line":50,"column":35}},"9":{"start":{"line":50,"column":36},"end":{"line":50,"column":45}},"10":{"start":{"line":52,"column":4},"end":{"line":52,"column":44}},"11":{"start":{"line":52,"column":28},"end":{"line":52,"column":44}},"12":{"start":{"line":53,"column":4},"end":{"line":53,"column":58}},"13":{"start":{"line":56,"column":4},"end":{"line":56,"column":36}},"14":{"start":{"line":59,"column":4},"end":{"line":59,"column":36}},"15":{"start":{"line":62,"column":4},"end":{"line":68,"column":5}},"16":{"start":{"line":64,"column":8},"end":{"line":64,"column":21}},"17":{"start":{"line":66,"column":8},"end":{"line":66,"column":38}},"18":{"start":{"line":67,"column":8},"end":{"line":67,"column":67}},"19":{"start":{"line":71,"column":4},"end":{"line":71,"column":34}},"20":{"start":{"line":72,"column":4},"end":{"line":72,"column":30}},"21":{"start":{"line":79,"column":26},"end":{"line":79,"column":37}},"22":{"start":{"line":79,"column":38},"end":{"line":79,"column":47}},"23":{"start":{"line":82,"column":4},"end":{"line":82,"column":42}},"24":{"start":{"line":86,"column":0},"end":{"line":114,"column":2}},"25":{"start":{"line":88,"column":4},"end":{"line":88,"column":52}},"26":{"start":{"line":89,"column":4},"end":{"line":100,"column":5}},"27":{"start":{"line":90,"column":6},"end":{"line":99,"column":7}},"28":{"start":{"line":91,"column":8},"end":{"line":91,"column":19}},"29":{"start":{"line":93,"column":8},"end":{"line":93,"column":42}},"30":{"start":{"line":94,"column":8},"end":{"line":98,"column":9}},"31":{"start":{"line":95,"column":10},"end":{"line":95,"column":20}},"32":{"start":{"line":96,"column":15},"end":{"line":98,"column":9}},"33":{"start":{"line":97,"column":10},"end":{"line":97,"column":25}},"34":{"start":{"line":103,"column":4},"end":{"line":103,"column":42}},"35":{"start":{"line":104,"column":4},"end":{"line":112,"column":5}},"36":{"start":{"line":105,"column":6},"end":{"line":111,"column":7}},"37":{"start":{"line":106,"column":8},"end":{"line":106,"column":26}},"38":{"start":{"line":107,"column":13},"end":{"line":111,"column":7}},"39":{"start":{"line":108,"column":8},"end":{"line":108,"column":18}},"40":{"start":{"line":109,"column":13},"end":{"line":111,"column":7}},"41":{"start":{"line":110,"column":8},"end":{"line":110,"column":23}},"42":{"start":{"line":117,"column":0},"end":{"line":118,"column":2}},"43":{"start":{"line":120,"column":0},"end":{"line":179,"column":3}},"44":{"start":{"line":122,"column":14},"end":{"line":122,"column":33}},"45":{"start":{"line":126,"column":4},"end":{"line":126,"column":28}},"46":{"start":{"line":127,"column":4},"end":{"line":127,"column":36}},"47":{"start":{"line":129,"column":4},"end":{"line":129,"column":24}},"48":{"start":{"line":130,"column":4},"end":{"line":135,"column":5}},"49":{"start":{"line":131,"column":6},"end":{"line":134,"column":7}},"50":{"start":{"line":132,"column":8},"end":{"line":132,"column":44}},"51":{"start":{"line":133,"column":8},"end":{"line":133,"column":23}},"52":{"start":{"line":136,"column":4},"end":{"line":136,"column":58}},"53":{"start":{"line":137,"column":4},"end":{"line":137,"column":52}},"54":{"start":{"line":138,"column":4},"end":{"line":138,"column":66}},"55":{"start":{"line":139,"column":4},"end":{"line":139,"column":75}},"56":{"start":{"line":140,"column":4},"end":{"line":140,"column":46}},"57":{"start":{"line":141,"column":4},"end":{"line":141,"column":69}},"58":{"start":{"line":142,"column":4},"end":{"line":142,"column":64}},"59":{"start":{"line":144,"column":4},"end":{"line":144,"column":26}},"60":{"start":{"line":146,"column":4},"end":{"line":150,"column":5}},"61":{"start":{"line":147,"column":6},"end":{"line":147,"column":25}},"62":{"start":{"line":149,"column":6},"end":{"line":149,"column":27}},"63":{"start":{"line":154,"column":4},"end":{"line":154,"column":19}},"64":{"start":{"line":156,"column":4},"end":{"line":156,"column":22}},"65":{"start":{"line":157,"column":4},"end":{"line":162,"column":5}},"66":{"start":{"line":158,"column":6},"end":{"line":161,"column":7}},"67":{"start":{"line":159,"column":8},"end":{"line":159,"column":28}},"68":{"start":{"line":160,"column":8},"end":{"line":160,"column":21}},"69":{"start":{"line":163,"column":4},"end":{"line":163,"column":78}},"70":{"start":{"line":164,"column":4},"end":{"line":164,"column":123}},"71":{"start":{"line":165,"column":4},"end":{"line":165,"column":87}},"72":{"start":{"line":166,"column":4},"end":{"line":166,"column":96}},"73":{"start":{"line":167,"column":4},"end":{"line":167,"column":76}},"74":{"start":{"line":168,"column":4},"end":{"line":168,"column":111}},"75":{"start":{"line":169,"column":4},"end":{"line":169,"column":84}},"76":{"start":{"line":171,"column":4},"end":{"line":171,"column":38}},"77":{"start":{"line":177,"column":4},"end":{"line":177,"column":17}}},"branchMap":{"1":{"line":41,"type":"cond-expr","locations":[{"start":{"line":41,"column":42},"end":{"line":41,"column":47}},{"start":{"line":41,"column":50},"end":{"line":41,"column":59}}]},"2":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"3":{"line":53,"type":"cond-expr","locations":[{"start":{"line":53,"column":40},"end":{"line":53,"column":45}},{"start":{"line":53,"column":48},"end":{"line":53,"column":57}}]},"4":{"line":56,"type":"cond-expr","locations":[{"start":{"line":56,"column":19},"end":{"line":56,"column":23}},{"start":{"line":56,"column":26},"end":{"line":56,"column":35}}]},"5":{"line":59,"type":"cond-expr","locations":[{"start":{"line":59,"column":19},"end":{"line":59,"column":23}},{"start":{"line":59,"column":26},"end":{"line":59,"column":35}}]},"6":{"line":62,"type":"switch","locations":[{"start":{"line":63,"column":6},"end":{"line":64,"column":21}},{"start":{"line":65,"column":6},"end":{"line":67,"column":67}}]},"7":{"line":67,"type":"cond-expr","locations":[{"start":{"line":67,"column":49},"end":{"line":67,"column":54}},{"start":{"line":67,"column":57},"end":{"line":67,"column":66}}]},"8":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":16},"end":{"line":67,"column":28}},{"start":{"line":67,"column":34},"end":{"line":67,"column":45}}]},"9":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":4},"end":{"line":89,"column":4}},{"start":{"line":89,"column":4},"end":{"line":89,"column":4}}]},"10":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":6},"end":{"line":90,"column":6}},{"start":{"line":90,"column":6},"end":{"line":90,"column":6}}]},"11":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":8},"end":{"line":94,"column":8}},{"start":{"line":94,"column":8},"end":{"line":94,"column":8}}]},"12":{"line":94,"type":"binary-expr","locations":[{"start":{"line":94,"column":13},"end":{"line":94,"column":20}},{"start":{"line":94,"column":26},"end":{"line":94,"column":34}}]},"13":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":15},"end":{"line":96,"column":15}},{"start":{"line":96,"column":15},"end":{"line":96,"column":15}}]},"14":{"line":96,"type":"binary-expr","locations":[{"start":{"line":96,"column":20},"end":{"line":96,"column":26}},{"start":{"line":96,"column":32},"end":{"line":96,"column":41}}]},"15":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":4},"end":{"line":104,"column":4}},{"start":{"line":104,"column":4},"end":{"line":104,"column":4}}]},"16":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":6},"end":{"line":105,"column":6}},{"start":{"line":105,"column":6},"end":{"line":105,"column":6}}]},"17":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":13},"end":{"line":107,"column":13}},{"start":{"line":107,"column":13},"end":{"line":107,"column":13}}]},"18":{"line":107,"type":"binary-expr","locations":[{"start":{"line":107,"column":17},"end":{"line":107,"column":24}},{"start":{"line":107,"column":30},"end":{"line":107,"column":38}}]},"19":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":13},"end":{"line":109,"column":13}},{"start":{"line":109,"column":13},"end":{"line":109,"column":13}}]},"20":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":18},"end":{"line":109,"column":25}},{"start":{"line":109,"column":31},"end":{"line":109,"column":40}}]},"21":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":6},"end":{"line":131,"column":6}},{"start":{"line":131,"column":6},"end":{"line":131,"column":6}}]},"22":{"line":138,"type":"cond-expr","locations":[{"start":{"line":138,"column":53},"end":{"line":138,"column":56}},{"start":{"line":138,"column":59},"end":{"line":138,"column":64}}]},"23":{"line":139,"type":"cond-expr","locations":[{"start":{"line":139,"column":62},"end":{"line":139,"column":65}},{"start":{"line":139,"column":68},"end":{"line":139,"column":73}}]},"24":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":4},"end":{"line":146,"column":4}},{"start":{"line":146,"column":4},"end":{"line":146,"column":4}}]},"25":{"line":158,"type":"if","locations":[{"start":{"line":158,"column":6},"end":{"line":158,"column":6}},{"start":{"line":158,"column":6},"end":{"line":158,"column":6}}]},"26":{"line":164,"type":"cond-expr","locations":[{"start":{"line":164,"column":86},"end":{"line":164,"column":94}},{"start":{"line":164,"column":97},"end":{"line":164,"column":121}}]},"27":{"line":165,"type":"cond-expr","locations":[{"start":{"line":165,"column":73},"end":{"line":165,"column":77}},{"start":{"line":165,"column":80},"end":{"line":165,"column":85}}]},"28":{"line":166,"type":"cond-expr","locations":[{"start":{"line":166,"column":82},"end":{"line":166,"column":86}},{"start":{"line":166,"column":89},"end":{"line":166,"column":94}}]},"29":{"line":171,"type":"cond-expr","locations":[{"start":{"line":171,"column":25},"end":{"line":171,"column":30}},{"start":{"line":171,"column":33},"end":{"line":171,"column":37}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","\"use strict\";","","var Enums = require(\"../../../doc/enums\");","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var valid = {","  horizontalValues: [","    \"left\",","    \"center\",","    \"right\",","    \"fill\",","    \"centerContinuous\",","    \"distributed\",","    \"justify\"","  ].reduce(function(p,v){p[v]=true; return p;}, {}),","  horizontal: function(value) {","    return this.horizontalValues[value] ? value : undefined;","  },","","  verticalValues: [","    \"top\",","    \"middle\",","    \"bottom\",","    \"distributed\",","    \"justify\"","  ].reduce(function(p,v){p[v]=true; return p;}, {}),","  vertical: function(value) {","    if (value === \"middle\") return \"center\";","    return this.verticalValues[value] ? value : undefined;","  },","  wrapText: function(value) {","    return value ? true : undefined;","  },","  shrinkToFit: function(value) {","    return value ? true : undefined;","  },","  textRotation: function(value) {","    switch(value) {","      case \"vertical\":","        return value;","      default:","        value = utils.validInt(value);","        return (value >= -90) && (value <= 90) ? value : undefined;","    }","  },","  indent: function(value) {","    value = utils.validInt(value);","    return Math.max(0, value);","  },","  readingOrderValues: [","    {k:\"r2l\",v:1},","    {k:\"l2r\",v:2},","    {k:Enums.ReadingOrder.RightToLeft,v:1},","    {k:Enums.ReadingOrder.LeftToRight,v:2}","  ].reduce(function(p,v) {p[v.k]=v.v; return p;}, {}),","","  readingOrder: function(value) {","    return this.readingOrderValues[value];","  }","};","","var textRotationXform = {","  toXml:  function(textRotation) {","    textRotation = valid.textRotation(textRotation);","    if (textRotation) {","      if (textRotation == \"vertical\") {","        return 255;","      } else {","        var tr = Math.round(textRotation);","        if ((tr >= 0) && (tr <= 90)) {","          return tr;","        } else if ((tr < 0) && (tr >= -90)) {","          return 90 - tr;","        }","      }","    }","  },","  toModel: function(textRotation) {","    var tr = utils.validInt(textRotation);","    if (tr !== undefined) {","      if (tr == 255) {","        return \"vertical\";","      } else if((tr >= 0) && (tr <= 90)) {","        return tr;","      } else if ((tr > 90) && (tr <= 180)) {","        return 90 - tr;","      }","    }","  }","};","","// Alignment encapsulates translation from style.alignment model to/from xlsx","var AlignmentXform = module.exports = function() {","};","","utils.inherits(AlignmentXform, BaseXform, {","","  get tag() { return 'alignment'; },","","  render: function(xmlStream, model) {","","    xmlStream.addRollback();","    xmlStream.openNode('alignment');","","    var isValid = false;","    function add(name, value) {","      if (value) {","        xmlStream.addAttribute(name, value);","        isValid = true;","      }","    }","    add('horizontal', valid.horizontal(model.horizontal));","    add('vertical', valid.vertical(model.vertical));","    add('wrapText', valid.wrapText(model.wrapText) ? '1' : false);","    add('shrinkToFit', valid.shrinkToFit(model.shrinkToFit) ? '1' : false);","    add('indent', valid.indent(model.indent));","    add('textRotation', textRotationXform.toXml(model.textRotation));","    add('readingOrder', valid.readingOrder(model.readingOrder));","","    xmlStream.closeNode();","","    if (isValid) {","      xmlStream.commit();","    } else {","      xmlStream.rollback();","    }","  },","  ","  parseOpen: function(node) {","    var model = {};","    ","    var valid = false;","    function add(truthy, name, value) {","      if (truthy) {","        model[name] = value;","        valid = true;","      }","    }","    add(node.attributes.horizontal, 'horizontal', node.attributes.horizontal);","    add(node.attributes.vertical, 'vertical', node.attributes.vertical === 'center' ? 'middle' : node.attributes.vertical);","    add(node.attributes.wrapText, 'wrapText', node.attributes.wrapText ? true : false);","    add(node.attributes.shrinkToFit, 'shrinkToFit', node.attributes.shrinkToFit ? true : false);","    add(node.attributes.indent, 'indent', parseInt(node.attributes.indent));","    add(node.attributes.textRotation, 'textRotation', textRotationXform.toModel(node.attributes.textRotation));","    add(node.attributes.readingOrder, 'readingOrder', node.attributes.readingOrder);","    ","    this.model = valid ? model : null;","  },","  ","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"27":1,"28":1,"30":1,"39":7,"41":0,"50":5,"52":0,"53":0,"56":0,"59":0,"62":0,"64":0,"66":0,"67":0,"71":0,"72":0,"79":4,"82":0,"86":1,"88":0,"89":0,"90":0,"91":0,"93":0,"94":0,"95":0,"96":0,"97":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"117":1,"120":1,"122":0,"126":0,"127":0,"129":0,"130":1,"131":0,"132":0,"133":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"144":0,"146":0,"147":0,"149":0,"154":0,"156":0,"157":1,"158":0,"159":0,"160":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"171":0,"177":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/core-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/core-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":1,"9":0,"10":1,"11":1,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":33},"end":{"line":31,"column":44}}},"2":{"name":"(anonymous_2)","line":50,"loc":{"start":{"line":50,"column":23},"end":{"line":50,"column":36}}},"3":{"name":"(anonymous_3)","line":64,"loc":{"start":{"line":64,"column":10},"end":{"line":64,"column":37}}},"4":{"name":"(anonymous_4)","line":87,"loc":{"start":{"line":87,"column":13},"end":{"line":87,"column":28}}},"5":{"name":"(anonymous_5)","line":105,"loc":{"start":{"line":105,"column":13},"end":{"line":105,"column":28}}},"6":{"name":"(anonymous_6)","line":110,"loc":{"start":{"line":110,"column":14},"end":{"line":110,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":53}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":48}},"5":{"start":{"line":29,"column":0},"end":{"line":29,"column":52}},"6":{"start":{"line":31,"column":0},"end":{"line":48,"column":2}},"7":{"start":{"line":32,"column":2},"end":{"line":47,"column":3}},"8":{"start":{"line":50,"column":0},"end":{"line":52,"column":2}},"9":{"start":{"line":51,"column":2},"end":{"line":51,"column":48}},"10":{"start":{"line":53,"column":0},"end":{"line":53,"column":53}},"11":{"start":{"line":55,"column":0},"end":{"line":61,"column":2}},"12":{"start":{"line":63,"column":0},"end":{"line":141,"column":3}},"13":{"start":{"line":65,"column":4},"end":{"line":65,"column":50}},"14":{"start":{"line":67,"column":4},"end":{"line":67,"column":80}},"15":{"start":{"line":69,"column":4},"end":{"line":69,"column":60}},"16":{"start":{"line":70,"column":4},"end":{"line":70,"column":56}},"17":{"start":{"line":71,"column":4},"end":{"line":71,"column":60}},"18":{"start":{"line":72,"column":4},"end":{"line":72,"column":68}},"19":{"start":{"line":73,"column":4},"end":{"line":73,"column":66}},"20":{"start":{"line":74,"column":4},"end":{"line":74,"column":62}},"21":{"start":{"line":75,"column":4},"end":{"line":75,"column":62}},"22":{"start":{"line":76,"column":4},"end":{"line":76,"column":62}},"23":{"start":{"line":77,"column":4},"end":{"line":77,"column":74}},"24":{"start":{"line":78,"column":4},"end":{"line":78,"column":68}},"25":{"start":{"line":79,"column":4},"end":{"line":79,"column":62}},"26":{"start":{"line":80,"column":4},"end":{"line":80,"column":72}},"27":{"start":{"line":81,"column":4},"end":{"line":81,"column":65}},"28":{"start":{"line":82,"column":4},"end":{"line":82,"column":67}},"29":{"start":{"line":84,"column":4},"end":{"line":84,"column":26}},"30":{"start":{"line":88,"column":4},"end":{"line":103,"column":5}},"31":{"start":{"line":89,"column":6},"end":{"line":89,"column":34}},"32":{"start":{"line":90,"column":6},"end":{"line":90,"column":18}},"33":{"start":{"line":92,"column":6},"end":{"line":102,"column":7}},"34":{"start":{"line":94,"column":10},"end":{"line":94,"column":22}},"35":{"start":{"line":96,"column":10},"end":{"line":96,"column":44}},"36":{"start":{"line":97,"column":10},"end":{"line":100,"column":11}},"37":{"start":{"line":98,"column":12},"end":{"line":98,"column":40}},"38":{"start":{"line":99,"column":12},"end":{"line":99,"column":24}},"39":{"start":{"line":101,"column":10},"end":{"line":101,"column":87}},"40":{"start":{"line":106,"column":4},"end":{"line":108,"column":5}},"41":{"start":{"line":107,"column":6},"end":{"line":107,"column":34}},"42":{"start":{"line":111,"column":4},"end":{"line":139,"column":5}},"43":{"start":{"line":112,"column":6},"end":{"line":114,"column":7}},"44":{"start":{"line":113,"column":8},"end":{"line":113,"column":32}},"45":{"start":{"line":115,"column":6},"end":{"line":115,"column":18}},"46":{"start":{"line":117,"column":6},"end":{"line":138,"column":7}},"47":{"start":{"line":119,"column":10},"end":{"line":134,"column":12}},"48":{"start":{"line":135,"column":10},"end":{"line":135,"column":23}},"49":{"start":{"line":137,"column":10},"end":{"line":137,"column":72}}},"branchMap":{"1":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"2":{"line":92,"type":"switch","locations":[{"start":{"line":93,"column":8},"end":{"line":94,"column":22}},{"start":{"line":95,"column":8},"end":{"line":101,"column":87}}]},"3":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":10},"end":{"line":97,"column":10}},{"start":{"line":97,"column":10},"end":{"line":97,"column":10}}]},"4":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":4},"end":{"line":106,"column":4}},{"start":{"line":106,"column":4},"end":{"line":106,"column":4}}]},"5":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":4},"end":{"line":111,"column":4}},{"start":{"line":111,"column":4},"end":{"line":111,"column":4}}]},"6":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":6},"end":{"line":112,"column":6}},{"start":{"line":112,"column":6},"end":{"line":112,"column":6}}]},"7":{"line":117,"type":"switch","locations":[{"start":{"line":118,"column":8},"end":{"line":135,"column":23}},{"start":{"line":136,"column":8},"end":{"line":137,"column":72}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var XmlStream = require('../../../utils/xml-stream');","var BaseXform = require('../base-xform');","var DateXform = require('../simple/date-xform');","var StringXform = require('../simple/string-xform');","","var CoreXform = module.exports = function() {","  this.map = {","    'dc:creator': new StringXform({tag: 'dc:creator'}),","    'dc:title': new StringXform({tag: 'dc:title'}),","    'dc:subject': new StringXform({tag: 'dc:subject'}),","    'dc:description': new StringXform({tag: 'dc:description'}),","    'dc:identifier': new StringXform({tag: 'dc:identifier'}),","    'dc:language': new StringXform({tag: 'dc:language'}),","    'cp:keywords': new StringXform({tag: 'cp:keywords'}),","    'cp:category': new StringXform({tag: 'cp:category'}),","    'cp:lastModifiedBy': new StringXform({tag: 'cp:lastModifiedBy'}),","    'cp:lastPrinted': new DateXform({tag: 'cp:lastPrinted', format: CoreXform.DateFormat}),","    'cp:revision': new DateXform({tag: 'cp:revision'}),","    'cp:contentStatus': new StringXform({tag: 'cp:contentStatus'}),","    'dcterms:created': new DateXform({tag: 'dcterms:created', attrs: CoreXform.DateAttrs, format: CoreXform.DateFormat}),","    'dcterms:modified': new DateXform({tag: 'dcterms:modified', attrs: CoreXform.DateAttrs, format: CoreXform.DateFormat})","  }","};","","CoreXform.DateFormat = function(dt) {","  return dt.toISOString().replace(/\\.\\d{3}/,'');","};","CoreXform.DateAttrs = {'xsi:type': 'dcterms:W3CDTF'};","","CoreXform.CORE_PROPERTY_ATTRIBUTES = {","  'xmlns:cp': 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',","  'xmlns:dc': 'http://purl.org/dc/elements/1.1/',","  'xmlns:dcterms': 'http://purl.org/dc/terms/',","  'xmlns:dcmitype': 'http://purl.org/dc/dcmitype/',","  'xmlns:xsi': 'http://www.w3.org/2001/XMLSchema-instance'","};","","utils.inherits(CoreXform, BaseXform, {","  render: function(xmlStream, model) {","    xmlStream.openXml(XmlStream.StdDocAttributes);","","    xmlStream.openNode('cp:coreProperties', CoreXform.CORE_PROPERTY_ATTRIBUTES);","","    this.map['dc:creator'].render(xmlStream, model.creator);","    this.map['dc:title'].render(xmlStream, model.title);","    this.map['dc:subject'].render(xmlStream, model.subject);","    this.map['dc:description'].render(xmlStream, model.description);","    this.map['dc:identifier'].render(xmlStream, model.identifier);","    this.map['dc:language'].render(xmlStream, model.language);","    this.map['cp:keywords'].render(xmlStream, model.keywords);","    this.map['cp:category'].render(xmlStream, model.category);","    this.map['cp:lastModifiedBy'].render(xmlStream, model.lastModifiedBy);","    this.map['cp:lastPrinted'].render(xmlStream, model.lastPrinted);","    this.map['cp:revision'].render(xmlStream, model.revision);","    this.map['cp:contentStatus'].render(xmlStream, model.contentStatus);","    this.map['dcterms:created'].render(xmlStream, model.created);","    this.map['dcterms:modified'].render(xmlStream, model.modified);","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'cp:coreProperties':","          return true;","        default:","          this.parser = this.map[node.name];","          if (this.parser) {","            this.parser.parseOpen(node);","            return true;","          }","          throw new Error('Unexpected xml node in parseOpen: ' + JSON.stringify(node));","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case 'cp:coreProperties':","          this.model = {","            creator: this.map['dc:creator'].model,","            title: this.map['dc:title'].model,","            subject: this.map['dc:subject'].model,","            description: this.map['dc:description'].model,","            identifier: this.map['dc:identifier'].model,","            language: this.map['dc:language'].model,","            keywords: this.map['cp:keywords'].model,","            category: this.map['cp:category'].model,","            lastModifiedBy: this.map['cp:lastModifiedBy'].model,","            lastPrinted: this.map['cp:lastPrinted'].model,","            revision: this.map['cp:revision'].model,","            contentStatus: this.map['cp:contentStatus'].model,","            created: this.map['dcterms:created'].model,","            modified: this.map['dcterms:modified'].model","          };","          return false;","        default:","          throw new Error('Unexpected xml node in parseClose: ' + name);","      }","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"28":1,"29":1,"31":1,"32":0,"50":1,"51":0,"53":1,"55":1,"63":1,"65":0,"67":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"84":0,"88":0,"89":0,"90":0,"92":0,"94":0,"96":0,"97":0,"98":0,"99":0,"101":0,"106":0,"107":0,"111":0,"112":0,"113":0,"115":0,"117":0,"119":0,"135":0,"137":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/date-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/simple/date-xform.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":33},"end":{"line":28,"column":51}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":35},"end":{"line":32,"column":48}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":33},"end":{"line":33,"column":47}}},"4":{"name":"(anonymous_4)","line":38,"loc":{"start":{"line":38,"column":10},"end":{"line":38,"column":37}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":13},"end":{"line":53,"column":28}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":13},"end":{"line":62,"column":28}}},"7":{"name":"(anonymous_7)","line":67,"loc":{"start":{"line":67,"column":14},"end":{"line":67,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":34,"column":2}},"4":{"start":{"line":29,"column":2},"end":{"line":29,"column":25}},"5":{"start":{"line":30,"column":2},"end":{"line":30,"column":27}},"6":{"start":{"line":31,"column":2},"end":{"line":31,"column":29}},"7":{"start":{"line":32,"column":2},"end":{"line":32,"column":77}},"8":{"start":{"line":32,"column":50},"end":{"line":32,"column":74}},"9":{"start":{"line":33,"column":2},"end":{"line":33,"column":72}},"10":{"start":{"line":33,"column":49},"end":{"line":33,"column":70}},"11":{"start":{"line":36,"column":0},"end":{"line":73,"column":3}},"12":{"start":{"line":39,"column":4},"end":{"line":50,"column":5}},"13":{"start":{"line":40,"column":6},"end":{"line":40,"column":35}},"14":{"start":{"line":41,"column":6},"end":{"line":43,"column":7}},"15":{"start":{"line":42,"column":8},"end":{"line":42,"column":44}},"16":{"start":{"line":44,"column":6},"end":{"line":48,"column":7}},"17":{"start":{"line":45,"column":8},"end":{"line":45,"column":63}},"18":{"start":{"line":47,"column":8},"end":{"line":47,"column":49}},"19":{"start":{"line":49,"column":6},"end":{"line":49,"column":28}},"20":{"start":{"line":54,"column":4},"end":{"line":60,"column":5}},"21":{"start":{"line":55,"column":6},"end":{"line":59,"column":7}},"22":{"start":{"line":56,"column":8},"end":{"line":56,"column":61}},"23":{"start":{"line":58,"column":8},"end":{"line":58,"column":23}},"24":{"start":{"line":63,"column":4},"end":{"line":65,"column":5}},"25":{"start":{"line":64,"column":6},"end":{"line":64,"column":27}},"26":{"start":{"line":68,"column":4},"end":{"line":70,"column":5}},"27":{"start":{"line":69,"column":6},"end":{"line":69,"column":51}},"28":{"start":{"line":71,"column":4},"end":{"line":71,"column":17}}},"branchMap":{"1":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":17},"end":{"line":32,"column":31}},{"start":{"line":32,"column":35},"end":{"line":32,"column":76}}]},"2":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":16},"end":{"line":33,"column":29}},{"start":{"line":33,"column":33},"end":{"line":33,"column":72}}]},"3":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"4":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":6},"end":{"line":41,"column":6}},{"start":{"line":41,"column":6},"end":{"line":41,"column":6}}]},"5":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":6}},{"start":{"line":44,"column":6},"end":{"line":44,"column":6}}]},"6":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":4},"end":{"line":54,"column":4}},{"start":{"line":54,"column":4},"end":{"line":54,"column":4}}]},"7":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":6},"end":{"line":55,"column":6}},{"start":{"line":55,"column":6},"end":{"line":55,"column":6}}]},"8":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"9":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var DateXform = module.exports = function(options) {","  this.tag = options.tag;","  this.attr = options.attr;","  this.attrs = options.attrs;","  this._format = options.format || function(dt) { return dt.toISOString(); };","  this._parse = options.parse || function(str) { return new Date(str); }","};","","utils.inherits(DateXform, BaseXform, {","  ","  render: function(xmlStream, model) {","    if (model) {","      xmlStream.openNode(this.tag);","      if (this.attrs) {","        xmlStream.addAttributes(this.attrs);","      }","      if (this.attr) {","        xmlStream.addAttribute(this.attr, this._format(model));","      } else {","        xmlStream.writeText(this._format(model));","      }","      xmlStream.closeNode();","    }","  },","","  parseOpen: function(node) {","    if (node.name === this.tag) {","      if (this.attr) {","        this.model = this._parse(node.attributes[this.attr]);","      } else {","        this.text = [];","      }","    }","  },","  parseText: function(text) {","    if (!this.attr) {","      this.text.push(text);","    }","  },","  parseClose: function() {","    if (!this.attr) {","      this.model = this._parse(this.text.join(''));","    }","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"36":1,"39":0,"40":0,"41":0,"42":0,"44":0,"45":0,"47":0,"49":0,"54":0,"55":0,"56":0,"58":0,"63":0,"64":0,"68":0,"69":0,"71":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/shared-strings-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/shared-strings-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":42},"end":{"line":30,"column":58}}},"2":{"name":"(anonymous_2)","line":40,"loc":{"start":{"line":40,"column":23},"end":{"line":40,"column":26}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":12},"end":{"line":42,"column":15}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":17},"end":{"line":45,"column":20}}},"5":{"name":"(anonymous_5)","line":48,"loc":{"start":{"line":48,"column":11},"end":{"line":48,"column":14}}},"6":{"name":"(anonymous_6)","line":52,"loc":{"start":{"line":52,"column":13},"end":{"line":52,"column":29}}},"7":{"name":"(anonymous_7)","line":56,"loc":{"start":{"line":56,"column":7},"end":{"line":56,"column":23}}},"8":{"name":"(anonymous_8)","line":61,"loc":{"start":{"line":61,"column":11},"end":{"line":61,"column":27}}},"9":{"name":"(anonymous_9)","line":70,"loc":{"start":{"line":70,"column":15},"end":{"line":70,"column":31}}},"10":{"name":"(anonymous_10)","line":88,"loc":{"start":{"line":88,"column":10},"end":{"line":88,"column":37}}},"11":{"name":"(anonymous_11)","line":99,"loc":{"start":{"line":99,"column":25},"end":{"line":99,"column":48}}},"12":{"name":"(anonymous_12)","line":105,"loc":{"start":{"line":105,"column":13},"end":{"line":105,"column":28}}},"13":{"name":"(anonymous_13)","line":122,"loc":{"start":{"line":122,"column":13},"end":{"line":122,"column":28}}},"14":{"name":"(anonymous_14)","line":127,"loc":{"start":{"line":127,"column":14},"end":{"line":127,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":53}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":57}},"5":{"start":{"line":30,"column":0},"end":{"line":37,"column":2}},"6":{"start":{"line":31,"column":2},"end":{"line":34,"column":4}},"7":{"start":{"line":35,"column":2},"end":{"line":35,"column":17}},"8":{"start":{"line":36,"column":2},"end":{"line":36,"column":17}},"9":{"start":{"line":39,"column":0},"end":{"line":144,"column":3}},"10":{"start":{"line":40,"column":28},"end":{"line":40,"column":114}},"11":{"start":{"line":43,"column":4},"end":{"line":43,"column":29}},"12":{"start":{"line":46,"column":4},"end":{"line":46,"column":36}},"13":{"start":{"line":49,"column":4},"end":{"line":49,"column":28}},"14":{"start":{"line":53,"column":4},"end":{"line":53,"column":36}},"15":{"start":{"line":57,"column":4},"end":{"line":59,"column":26}},"16":{"start":{"line":62,"column":4},"end":{"line":62,"column":33}},"17":{"start":{"line":63,"column":4},"end":{"line":66,"column":5}},"18":{"start":{"line":64,"column":6},"end":{"line":64,"column":58}},"19":{"start":{"line":65,"column":6},"end":{"line":65,"column":36}},"20":{"start":{"line":67,"column":4},"end":{"line":67,"column":23}},"21":{"start":{"line":68,"column":4},"end":{"line":68,"column":17}},"22":{"start":{"line":72,"column":4},"end":{"line":72,"column":50}},"23":{"start":{"line":73,"column":4},"end":{"line":73,"column":31}},"24":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"25":{"start":{"line":75,"column":6},"end":{"line":75,"column":56}},"26":{"start":{"line":76,"column":6},"end":{"line":76,"column":36}},"27":{"start":{"line":78,"column":4},"end":{"line":78,"column":23}},"28":{"start":{"line":79,"column":4},"end":{"line":79,"column":17}},"29":{"start":{"line":89,"column":4},"end":{"line":89,"column":34}},"30":{"start":{"line":90,"column":4},"end":{"line":90,"column":50}},"31":{"start":{"line":92,"column":4},"end":{"line":96,"column":7}},"32":{"start":{"line":98,"column":4},"end":{"line":98,"column":37}},"33":{"start":{"line":99,"column":4},"end":{"line":101,"column":7}},"34":{"start":{"line":100,"column":6},"end":{"line":100,"column":41}},"35":{"start":{"line":102,"column":4},"end":{"line":102,"column":26}},"36":{"start":{"line":106,"column":4},"end":{"line":120,"column":5}},"37":{"start":{"line":107,"column":6},"end":{"line":107,"column":34}},"38":{"start":{"line":108,"column":6},"end":{"line":108,"column":18}},"39":{"start":{"line":110,"column":6},"end":{"line":119,"column":7}},"40":{"start":{"line":112,"column":10},"end":{"line":112,"column":22}},"41":{"start":{"line":114,"column":10},"end":{"line":114,"column":47}},"42":{"start":{"line":115,"column":10},"end":{"line":115,"column":38}},"43":{"start":{"line":116,"column":10},"end":{"line":116,"column":22}},"44":{"start":{"line":118,"column":10},"end":{"line":118,"column":87}},"45":{"start":{"line":123,"column":4},"end":{"line":125,"column":5}},"46":{"start":{"line":124,"column":6},"end":{"line":124,"column":34}},"47":{"start":{"line":128,"column":4},"end":{"line":142,"column":5}},"48":{"start":{"line":129,"column":6},"end":{"line":133,"column":7}},"49":{"start":{"line":130,"column":8},"end":{"line":130,"column":50}},"50":{"start":{"line":131,"column":8},"end":{"line":131,"column":27}},"51":{"start":{"line":132,"column":8},"end":{"line":132,"column":32}},"52":{"start":{"line":134,"column":6},"end":{"line":134,"column":18}},"53":{"start":{"line":136,"column":6},"end":{"line":141,"column":7}},"54":{"start":{"line":138,"column":10},"end":{"line":138,"column":23}},"55":{"start":{"line":140,"column":10},"end":{"line":140,"column":72}}},"branchMap":{"1":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":15},"end":{"line":31,"column":20}},{"start":{"line":31,"column":24},"end":{"line":34,"column":3}}]},"2":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":35},"end":{"line":40,"column":58}},{"start":{"line":40,"column":63},"end":{"line":40,"column":112}}]},"3":{"line":57,"type":"cond-expr","locations":[{"start":{"line":58,"column":6},"end":{"line":58,"column":29}},{"start":{"line":59,"column":6},"end":{"line":59,"column":25}}]},"4":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"5":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":74,"column":4}},{"start":{"line":74,"column":4},"end":{"line":74,"column":4}}]},"6":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":12},"end":{"line":89,"column":17}},{"start":{"line":89,"column":21},"end":{"line":89,"column":33}}]},"7":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":4},"end":{"line":106,"column":4}},{"start":{"line":106,"column":4},"end":{"line":106,"column":4}}]},"8":{"line":110,"type":"switch","locations":[{"start":{"line":111,"column":8},"end":{"line":112,"column":22}},{"start":{"line":113,"column":8},"end":{"line":116,"column":22}},{"start":{"line":117,"column":8},"end":{"line":118,"column":87}}]},"9":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":4}},{"start":{"line":123,"column":4},"end":{"line":123,"column":4}}]},"10":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":4},"end":{"line":128,"column":4}},{"start":{"line":128,"column":4},"end":{"line":128,"column":4}}]},"11":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":6},"end":{"line":129,"column":6}},{"start":{"line":129,"column":6},"end":{"line":129,"column":6}}]},"12":{"line":136,"type":"switch","locations":[{"start":{"line":137,"column":8},"end":{"line":138,"column":23}},{"start":{"line":139,"column":8},"end":{"line":140,"column":72}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var XmlStream = require('../../../utils/xml-stream');","var BaseXform = require('../base-xform');","var SharedStringXform = require('./shared-string-xform');","","var SharedStringsXform = module.exports = function(model) {","  this.model = model || {","    values: [],","    count: 0","  };","  this.hash = {};","  this.rich = {};","};","","utils.inherits(SharedStringsXform, BaseXform, {","  get sharedStringXform() { return this._sharedStringXform || (this._sharedStringXform = new SharedStringXform()); },","","  get values() {","    return this.model.values;","  },","  get uniqueCount() {","    return this.model.values.length;","  },","  get count() {","    return this.model.count;","  },","","  getString: function(index) {","    return this.model.values[index];","  },","","  add: function(value) {","    return value.richText ?","      this.addRichText(value) :","      this.addText(value);","  },","  addText: function(value) {","    var index = this.hash[value];","    if (index === undefined) {","      index = this.hash[value] = this.model.values.length;","      this.model.values.push(value);","    }","    this.model.count++;","    return index;","  },","  addRichText: function(value) {","    // TODO: add WeakMap here","    var xml = this.sharedStringXform.toXml(value);","    var index = this.rich[xml];","    if (index === undefined) {","      index = this.rich[xml] = this.model.values.length;","      this.model.values.push(value);","    }","    this.model.count++;","    return index;","  },","","  // <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>","  // <sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"<%=totalRefs%>\" uniqueCount=\"<%=count%>\">","  //   <si><t><%=text%></t></si>","  //   <si><r><rPr></rPr><t></t></r></si>","  // </sst>","","  render: function(xmlStream, model) {","    model = model || this._values;","    xmlStream.openXml(XmlStream.StdDocAttributes);","","    xmlStream.openNode('sst', {","      xmlns: 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',","      count: model.count,","      uniqueCount: model.values.length","    });","","    var sx =  this.sharedStringXform;","    model.values.forEach(function(sharedString) {","      sx.render(xmlStream, sharedString);","    });","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'sst':","          return true;","        case 'si':","          this.parser = this.sharedStringXform;","          this.parser.parseOpen(node);","          return true;","        default:","          throw new Error('Unexpected xml node in parseOpen: ' + JSON.stringify(node));","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model.values.push(this.parser.model);","        this.model.count++;","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case 'sst':","          return false;","        default:","          throw new Error('Unexpected xml node in parseClose: ' + name);","      }","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"28":1,"30":1,"31":0,"35":0,"36":0,"39":1,"40":0,"43":0,"46":0,"49":0,"53":0,"57":0,"62":0,"63":0,"64":0,"65":0,"67":0,"68":0,"72":0,"73":0,"74":0,"75":0,"76":0,"78":0,"79":0,"89":0,"90":0,"92":0,"98":0,"99":0,"100":0,"102":0,"106":0,"107":0,"108":0,"110":0,"112":0,"114":0,"115":0,"116":0,"118":0,"123":0,"124":0,"128":0,"129":0,"130":0,"131":0,"132":0,"134":0,"136":0,"138":0,"140":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/shared-string-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/shared-string-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":39,"loc":{"start":{"line":39,"column":41},"end":{"line":39,"column":57}}},"2":{"name":"(anonymous_2)","line":52,"loc":{"start":{"line":52,"column":9},"end":{"line":52,"column":12}}},"3":{"name":"(anonymous_3)","line":54,"loc":{"start":{"line":54,"column":10},"end":{"line":54,"column":37}}},"4":{"name":"(anonymous_4)","line":58,"loc":{"start":{"line":58,"column":29},"end":{"line":58,"column":44}}},"5":{"name":"(anonymous_5)","line":67,"loc":{"start":{"line":67,"column":13},"end":{"line":67,"column":28}}},"6":{"name":"(anonymous_6)","line":84,"loc":{"start":{"line":84,"column":13},"end":{"line":84,"column":28}}},"7":{"name":"(anonymous_7)","line":89,"loc":{"start":{"line":89,"column":14},"end":{"line":89,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":40}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":49}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":57}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":44}},"5":{"start":{"line":30,"column":0},"end":{"line":30,"column":41}},"6":{"start":{"line":39,"column":0},"end":{"line":47,"column":2}},"7":{"start":{"line":40,"column":2},"end":{"line":40,"column":21}},"8":{"start":{"line":42,"column":2},"end":{"line":46,"column":4}},"9":{"start":{"line":50,"column":0},"end":{"line":114,"column":3}},"10":{"start":{"line":52,"column":14},"end":{"line":52,"column":26}},"11":{"start":{"line":55,"column":4},"end":{"line":55,"column":33}},"12":{"start":{"line":56,"column":4},"end":{"line":63,"column":5}},"13":{"start":{"line":57,"column":6},"end":{"line":57,"column":25}},"14":{"start":{"line":58,"column":6},"end":{"line":60,"column":9}},"15":{"start":{"line":59,"column":8},"end":{"line":59,"column":34}},"16":{"start":{"line":61,"column":11},"end":{"line":63,"column":5}},"17":{"start":{"line":62,"column":6},"end":{"line":62,"column":42}},"18":{"start":{"line":64,"column":4},"end":{"line":64,"column":26}},"19":{"start":{"line":68,"column":4},"end":{"line":68,"column":25}},"20":{"start":{"line":69,"column":4},"end":{"line":82,"column":5}},"21":{"start":{"line":70,"column":6},"end":{"line":70,"column":34}},"22":{"start":{"line":71,"column":6},"end":{"line":71,"column":18}},"23":{"start":{"line":72,"column":11},"end":{"line":82,"column":5}},"24":{"start":{"line":73,"column":6},"end":{"line":73,"column":22}},"25":{"start":{"line":74,"column":6},"end":{"line":74,"column":18}},"26":{"start":{"line":76,"column":6},"end":{"line":76,"column":35}},"27":{"start":{"line":77,"column":6},"end":{"line":80,"column":7}},"28":{"start":{"line":78,"column":8},"end":{"line":78,"column":36}},"29":{"start":{"line":79,"column":8},"end":{"line":79,"column":20}},"30":{"start":{"line":81,"column":6},"end":{"line":81,"column":19}},"31":{"start":{"line":85,"column":4},"end":{"line":87,"column":5}},"32":{"start":{"line":86,"column":6},"end":{"line":86,"column":34}},"33":{"start":{"line":90,"column":4},"end":{"line":112,"column":5}},"34":{"start":{"line":91,"column":6},"end":{"line":103,"column":7}},"35":{"start":{"line":92,"column":8},"end":{"line":101,"column":9}},"36":{"start":{"line":94,"column":12},"end":{"line":94,"column":41}},"37":{"start":{"line":95,"column":12},"end":{"line":95,"column":55}},"38":{"start":{"line":95,"column":23},"end":{"line":95,"column":53}},"39":{"start":{"line":96,"column":12},"end":{"line":96,"column":39}},"40":{"start":{"line":97,"column":12},"end":{"line":97,"column":18}},"41":{"start":{"line":99,"column":12},"end":{"line":99,"column":43}},"42":{"start":{"line":100,"column":12},"end":{"line":100,"column":18}},"43":{"start":{"line":102,"column":8},"end":{"line":102,"column":32}},"44":{"start":{"line":104,"column":6},"end":{"line":104,"column":18}},"45":{"start":{"line":106,"column":6},"end":{"line":111,"column":7}},"46":{"start":{"line":108,"column":10},"end":{"line":108,"column":23}},"47":{"start":{"line":110,"column":10},"end":{"line":110,"column":22}}},"branchMap":{"1":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"2":{"line":56,"type":"binary-expr","locations":[{"start":{"line":56,"column":8},"end":{"line":56,"column":13}},{"start":{"line":56,"column":17},"end":{"line":56,"column":49}},{"start":{"line":56,"column":53},"end":{"line":56,"column":67}}]},"3":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":11},"end":{"line":61,"column":11}},{"start":{"line":61,"column":11},"end":{"line":61,"column":11}}]},"4":{"line":61,"type":"binary-expr","locations":[{"start":{"line":61,"column":15},"end":{"line":61,"column":34}},{"start":{"line":61,"column":38},"end":{"line":61,"column":52}}]},"5":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":69,"column":4}},{"start":{"line":69,"column":4},"end":{"line":69,"column":4}}]},"6":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":11},"end":{"line":72,"column":11}},{"start":{"line":72,"column":11},"end":{"line":72,"column":11}}]},"7":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":6},"end":{"line":77,"column":6}},{"start":{"line":77,"column":6},"end":{"line":77,"column":6}}]},"8":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":85,"column":4}},{"start":{"line":85,"column":4},"end":{"line":85,"column":4}}]},"9":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":4},"end":{"line":90,"column":4}},{"start":{"line":90,"column":4},"end":{"line":90,"column":4}}]},"10":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":6},"end":{"line":91,"column":6}},{"start":{"line":91,"column":6},"end":{"line":91,"column":6}}]},"11":{"line":92,"type":"switch","locations":[{"start":{"line":93,"column":10},"end":{"line":97,"column":18}},{"start":{"line":98,"column":10},"end":{"line":100,"column":18}}]},"12":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":12},"end":{"line":95,"column":12}},{"start":{"line":95,"column":12},"end":{"line":95,"column":12}}]},"13":{"line":106,"type":"switch","locations":[{"start":{"line":107,"column":8},"end":{"line":108,"column":23}},{"start":{"line":109,"column":8},"end":{"line":110,"column":22}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var TextXform = require('./text-xform');","var RichTextXform = require('./rich-text-xform');","var PhoneticTextXform = require('./phonetic-text-xform');","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","// <si>","//   <r></r><r></r>...","// </si>","// <si>","//   <t></t>","// </si>","","var SharedStringXform = module.exports = function(model) {","  this.model = model;","","  this.map = {","    r: new RichTextXform(),","    t: new TextXform(),","    rPh: new PhoneticTextXform()","  };","};","","","utils.inherits(SharedStringXform, BaseXform, {","","  get tag() { return 'si'; },","","  render: function(xmlStream, model) {","    xmlStream.openNode(this.tag);","    if (model && model.hasOwnProperty('richText') && model.richText) {","      var r = this.map.r;","      model.richText.forEach(function(text) {","        r.render(xmlStream, text);","      });","    } else if (model !== undefined && model !== null) {","      this.map.t.render(xmlStream, model);","    }","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    var name = node.name;","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else if (name === this.tag) {","      this.model = {};","      return true;","    } else {","      this.parser = this.map[name];","      if (this.parser) {","        this.parser.parseOpen(node);","        return true;","      }","      return false;","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        switch(name) {","          case 'r':","            var rt = this.model.richText;","            if (!rt) { rt = this.model.richText = []; }","            rt.push(this.parser.model);","            break;","          case 't':","            this.model = this.parser.model;","            break;","        }","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case this.tag:","          return false;","        default:","          return true;","      }","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"30":1,"39":1,"40":0,"42":0,"50":1,"52":0,"55":0,"56":0,"57":0,"58":0,"59":0,"61":0,"62":0,"64":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"76":0,"77":0,"78":0,"79":0,"81":0,"85":0,"86":0,"90":0,"91":0,"92":0,"94":0,"95":0,"96":0,"97":0,"99":0,"100":0,"102":0,"104":0,"106":0,"108":0,"110":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/text-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/text-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":33},"end":{"line":30,"column":44}}},"2":{"name":"(anonymous_2)","line":35,"loc":{"start":{"line":35,"column":9},"end":{"line":35,"column":12}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":10},"end":{"line":37,"column":37}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":11},"end":{"line":46,"column":14}}},"5":{"name":"(anonymous_5)","line":50,"loc":{"start":{"line":50,"column":13},"end":{"line":50,"column":28}}},"6":{"name":"(anonymous_6)","line":59,"loc":{"start":{"line":59,"column":13},"end":{"line":59,"column":28}}},"7":{"name":"(anonymous_7)","line":62,"loc":{"start":{"line":62,"column":14},"end":{"line":62,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":30,"column":0},"end":{"line":31,"column":2}},"4":{"start":{"line":33,"column":0},"end":{"line":65,"column":3}},"5":{"start":{"line":35,"column":14},"end":{"line":35,"column":25}},"6":{"start":{"line":38,"column":4},"end":{"line":38,"column":28}},"7":{"start":{"line":39,"column":4},"end":{"line":41,"column":5}},"8":{"start":{"line":40,"column":6},"end":{"line":40,"column":54}},"9":{"start":{"line":42,"column":4},"end":{"line":42,"column":31}},"10":{"start":{"line":43,"column":4},"end":{"line":43,"column":26}},"11":{"start":{"line":47,"column":4},"end":{"line":47,"column":31}},"12":{"start":{"line":51,"column":4},"end":{"line":57,"column":5}},"13":{"start":{"line":53,"column":8},"end":{"line":53,"column":24}},"14":{"start":{"line":54,"column":8},"end":{"line":54,"column":20}},"15":{"start":{"line":56,"column":8},"end":{"line":56,"column":21}},"16":{"start":{"line":60,"column":4},"end":{"line":60,"column":26}},"17":{"start":{"line":63,"column":4},"end":{"line":63,"column":17}}},"branchMap":{"1":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"2":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":9},"end":{"line":39,"column":25}},{"start":{"line":39,"column":31},"end":{"line":39,"column":60}}]},"3":{"line":51,"type":"switch","locations":[{"start":{"line":52,"column":6},"end":{"line":54,"column":20}},{"start":{"line":55,"column":6},"end":{"line":56,"column":21}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","//   <t xml:space=\"preserve\"> is </t>","","var TextXform = module.exports = function() {","};","","utils.inherits(TextXform, BaseXform, {","","  get tag() { return 't'; },","","  render: function(xmlStream, model) {","    xmlStream.openNode('t');","    if ((model[0] === ' ') || (model[model.length-1] === ' ')) {","      xmlStream.addAttribute('xml:space', 'preserve');","    }","    xmlStream.writeText(model);","    xmlStream.closeNode();","  },","  ","  get model() {","    return this._text.join('');","  },","","  parseOpen: function(node) {","    switch(node.name) {","      case 't':","        this._text = [];","        return true;","      default:","        return false;","    }","  },","  parseText: function(text) {","    this._text.push(text);","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"30":1,"33":1,"35":0,"38":0,"39":0,"40":0,"42":0,"43":0,"47":0,"51":0,"53":0,"54":0,"56":0,"60":0,"63":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/rich-text-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/rich-text-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0,0],"7":[0,0],"8":[0,0,0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":42,"loc":{"start":{"line":42,"column":37},"end":{"line":42,"column":53}}},"2":{"name":"(anonymous_2)","line":53,"loc":{"start":{"line":53,"column":9},"end":{"line":53,"column":12}}},"3":{"name":"(anonymous_3)","line":55,"loc":{"start":{"line":55,"column":15},"end":{"line":55,"column":18}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":15},"end":{"line":56,"column":18}}},"5":{"name":"(anonymous_5)","line":58,"loc":{"start":{"line":58,"column":10},"end":{"line":58,"column":37}}},"6":{"name":"(anonymous_6)","line":69,"loc":{"start":{"line":69,"column":13},"end":{"line":69,"column":28}}},"7":{"name":"(anonymous_7)","line":91,"loc":{"start":{"line":91,"column":13},"end":{"line":91,"column":28}}},"8":{"name":"(anonymous_8)","line":96,"loc":{"start":{"line":96,"column":14},"end":{"line":96,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":40}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":47}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":44}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":41}},"5":{"start":{"line":42,"column":0},"end":{"line":44,"column":2}},"6":{"start":{"line":43,"column":2},"end":{"line":43,"column":21}},"7":{"start":{"line":46,"column":0},"end":{"line":49,"column":2}},"8":{"start":{"line":51,"column":0},"end":{"line":115,"column":3}},"9":{"start":{"line":53,"column":14},"end":{"line":53,"column":25}},"10":{"start":{"line":55,"column":20},"end":{"line":55,"column":82}},"11":{"start":{"line":56,"column":20},"end":{"line":56,"column":108}},"12":{"start":{"line":59,"column":4},"end":{"line":59,"column":32}},"13":{"start":{"line":61,"column":4},"end":{"line":61,"column":28}},"14":{"start":{"line":62,"column":4},"end":{"line":64,"column":5}},"15":{"start":{"line":63,"column":6},"end":{"line":63,"column":51}},"16":{"start":{"line":65,"column":4},"end":{"line":65,"column":49}},"17":{"start":{"line":66,"column":4},"end":{"line":66,"column":26}},"18":{"start":{"line":70,"column":4},"end":{"line":89,"column":5}},"19":{"start":{"line":71,"column":6},"end":{"line":71,"column":34}},"20":{"start":{"line":72,"column":6},"end":{"line":72,"column":18}},"21":{"start":{"line":74,"column":6},"end":{"line":88,"column":7}},"22":{"start":{"line":76,"column":10},"end":{"line":76,"column":26}},"23":{"start":{"line":77,"column":10},"end":{"line":77,"column":22}},"24":{"start":{"line":79,"column":10},"end":{"line":79,"column":39}},"25":{"start":{"line":80,"column":10},"end":{"line":80,"column":38}},"26":{"start":{"line":81,"column":10},"end":{"line":81,"column":22}},"27":{"start":{"line":83,"column":10},"end":{"line":83,"column":39}},"28":{"start":{"line":84,"column":10},"end":{"line":84,"column":38}},"29":{"start":{"line":85,"column":10},"end":{"line":85,"column":22}},"30":{"start":{"line":87,"column":10},"end":{"line":87,"column":23}},"31":{"start":{"line":92,"column":4},"end":{"line":94,"column":5}},"32":{"start":{"line":93,"column":6},"end":{"line":93,"column":34}},"33":{"start":{"line":97,"column":4},"end":{"line":113,"column":5}},"34":{"start":{"line":99,"column":8},"end":{"line":99,"column":21}},"35":{"start":{"line":101,"column":8},"end":{"line":101,"column":44}},"36":{"start":{"line":102,"column":8},"end":{"line":102,"column":32}},"37":{"start":{"line":103,"column":8},"end":{"line":103,"column":20}},"38":{"start":{"line":105,"column":8},"end":{"line":105,"column":44}},"39":{"start":{"line":106,"column":8},"end":{"line":106,"column":32}},"40":{"start":{"line":107,"column":8},"end":{"line":107,"column":20}},"41":{"start":{"line":109,"column":8},"end":{"line":111,"column":9}},"42":{"start":{"line":110,"column":10},"end":{"line":110,"column":39}},"43":{"start":{"line":112,"column":8},"end":{"line":112,"column":20}}},"branchMap":{"1":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":27},"end":{"line":55,"column":42}},{"start":{"line":55,"column":47},"end":{"line":55,"column":80}}]},"2":{"line":56,"type":"binary-expr","locations":[{"start":{"line":56,"column":27},"end":{"line":56,"column":42}},{"start":{"line":56,"column":47},"end":{"line":56,"column":106}}]},"3":{"line":59,"type":"binary-expr","locations":[{"start":{"line":59,"column":12},"end":{"line":59,"column":17}},{"start":{"line":59,"column":21},"end":{"line":59,"column":31}}]},"4":{"line":62,"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":62,"column":4}},{"start":{"line":62,"column":4},"end":{"line":62,"column":4}}]},"5":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":4}},{"start":{"line":70,"column":4},"end":{"line":70,"column":4}}]},"6":{"line":74,"type":"switch","locations":[{"start":{"line":75,"column":8},"end":{"line":77,"column":22}},{"start":{"line":78,"column":8},"end":{"line":81,"column":22}},{"start":{"line":82,"column":8},"end":{"line":85,"column":22}},{"start":{"line":86,"column":8},"end":{"line":87,"column":23}}]},"7":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":4},"end":{"line":92,"column":4}},{"start":{"line":92,"column":4},"end":{"line":92,"column":4}}]},"8":{"line":97,"type":"switch","locations":[{"start":{"line":98,"column":6},"end":{"line":99,"column":21}},{"start":{"line":100,"column":6},"end":{"line":103,"column":20}},{"start":{"line":104,"column":6},"end":{"line":107,"column":20}},{"start":{"line":108,"column":6},"end":{"line":112,"column":20}}]},"9":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":8},"end":{"line":109,"column":8}},{"start":{"line":109,"column":8},"end":{"line":109,"column":8}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var TextXform = require('./text-xform');","var FontXform = require('../style/font-xform');","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","// <r>","//   <rPr>","//     <sz val=\"11\"/>","//     <color theme=\"1\" tint=\"5\"/>","//     <rFont val=\"Calibri\"/>","//     <family val=\"2\"/>","//     <scheme val=\"minor\"/>","//   </rPr>","//   <t xml:space=\"preserve\"> is </t>","// </r>","","var RichTextXform = module.exports = function(model) {","  this.model = model;","};","","RichTextXform.FONT_OPTIONS = {","  tagName: 'rPr',","  fontNameTag:  'rFont'","};","","utils.inherits(RichTextXform, BaseXform, {","","  get tag() { return 'r'; },","","  get textXform() { return this._textXform || (this._textXform = new TextXform()); },","  get fontXform() { return this._fontXform || (this._fontXform = new FontXform(RichTextXform.FONT_OPTIONS)); },","","  render: function(xmlStream, model) {","    model = model || this.model;","","    xmlStream.openNode('r');","    if (model.font) {","      this.fontXform.render(xmlStream, model.font);","    }","    this.textXform.render(xmlStream, model.text);","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'r':","          this.model = {};","          return true;","        case 't':","          this.parser = this.textXform;","          this.parser.parseOpen(node);","          return true;","        case 'rPr':","          this.parser = this.fontXform;","          this.parser.parseOpen(node);","          return true;","        default:","          return false;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    switch(name) {","      case 'r':","        return false;","      case 't':","        this.model.text = this.parser.model;","        this.parser = undefined;","        return true;","      case 'rPr':","        this.model.font = this.parser.model;","        this.parser = undefined;","        return true;","      default:","        if (this.parser) {","          this.parser.parseClose(name);","        }","        return true;","    }","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":1,"42":1,"43":0,"46":1,"51":1,"53":0,"55":0,"56":0,"59":0,"61":0,"62":0,"63":0,"65":0,"66":0,"70":0,"71":0,"72":0,"74":0,"76":0,"77":0,"79":0,"80":0,"81":0,"83":0,"84":0,"85":0,"87":0,"92":0,"93":0,"97":0,"99":0,"101":0,"102":0,"103":0,"105":0,"106":0,"107":0,"109":0,"110":0,"112":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/phonetic-text-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/strings/phonetic-text-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":35,"loc":{"start":{"line":35,"column":41},"end":{"line":35,"column":52}}},"2":{"name":"(anonymous_2)","line":45,"loc":{"start":{"line":45,"column":9},"end":{"line":45,"column":12}}},"3":{"name":"(anonymous_3)","line":47,"loc":{"start":{"line":47,"column":10},"end":{"line":47,"column":37}}},"4":{"name":"(anonymous_4)","line":54,"loc":{"start":{"line":54,"column":29},"end":{"line":54,"column":44}}},"5":{"name":"(anonymous_5)","line":63,"loc":{"start":{"line":63,"column":13},"end":{"line":63,"column":28}}},"6":{"name":"(anonymous_6)","line":83,"loc":{"start":{"line":83,"column":13},"end":{"line":83,"column":28}}},"7":{"name":"(anonymous_7)","line":88,"loc":{"start":{"line":88,"column":14},"end":{"line":88,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":40}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":49}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":44}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":41}},"5":{"start":{"line":35,"column":0},"end":{"line":40,"column":2}},"6":{"start":{"line":36,"column":2},"end":{"line":39,"column":4}},"7":{"start":{"line":43,"column":0},"end":{"line":113,"column":3}},"8":{"start":{"line":45,"column":14},"end":{"line":45,"column":27}},"9":{"start":{"line":48,"column":4},"end":{"line":51,"column":7}},"10":{"start":{"line":52,"column":4},"end":{"line":59,"column":5}},"11":{"start":{"line":53,"column":6},"end":{"line":53,"column":25}},"12":{"start":{"line":54,"column":6},"end":{"line":56,"column":9}},"13":{"start":{"line":55,"column":8},"end":{"line":55,"column":34}},"14":{"start":{"line":57,"column":11},"end":{"line":59,"column":5}},"15":{"start":{"line":58,"column":6},"end":{"line":58,"column":47}},"16":{"start":{"line":60,"column":4},"end":{"line":60,"column":26}},"17":{"start":{"line":64,"column":4},"end":{"line":64,"column":25}},"18":{"start":{"line":65,"column":4},"end":{"line":81,"column":5}},"19":{"start":{"line":66,"column":6},"end":{"line":66,"column":34}},"20":{"start":{"line":67,"column":6},"end":{"line":67,"column":18}},"21":{"start":{"line":68,"column":11},"end":{"line":81,"column":5}},"22":{"start":{"line":69,"column":6},"end":{"line":72,"column":8}},"23":{"start":{"line":74,"column":6},"end":{"line":74,"column":35}},"24":{"start":{"line":75,"column":6},"end":{"line":80,"column":7}},"25":{"start":{"line":76,"column":8},"end":{"line":76,"column":36}},"26":{"start":{"line":77,"column":8},"end":{"line":77,"column":20}},"27":{"start":{"line":79,"column":8},"end":{"line":79,"column":21}},"28":{"start":{"line":84,"column":4},"end":{"line":86,"column":5}},"29":{"start":{"line":85,"column":6},"end":{"line":85,"column":34}},"30":{"start":{"line":89,"column":4},"end":{"line":111,"column":5}},"31":{"start":{"line":90,"column":6},"end":{"line":102,"column":7}},"32":{"start":{"line":91,"column":8},"end":{"line":100,"column":9}},"33":{"start":{"line":93,"column":12},"end":{"line":93,"column":41}},"34":{"start":{"line":94,"column":12},"end":{"line":94,"column":55}},"35":{"start":{"line":94,"column":23},"end":{"line":94,"column":53}},"36":{"start":{"line":95,"column":12},"end":{"line":95,"column":39}},"37":{"start":{"line":96,"column":12},"end":{"line":96,"column":18}},"38":{"start":{"line":98,"column":12},"end":{"line":98,"column":48}},"39":{"start":{"line":99,"column":12},"end":{"line":99,"column":18}},"40":{"start":{"line":101,"column":8},"end":{"line":101,"column":32}},"41":{"start":{"line":103,"column":6},"end":{"line":103,"column":18}},"42":{"start":{"line":105,"column":6},"end":{"line":110,"column":7}},"43":{"start":{"line":107,"column":10},"end":{"line":107,"column":23}},"44":{"start":{"line":109,"column":10},"end":{"line":109,"column":22}}},"branchMap":{"1":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":11},"end":{"line":49,"column":19}},{"start":{"line":49,"column":23},"end":{"line":49,"column":24}}]},"2":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":10},"end":{"line":50,"column":18}},{"start":{"line":50,"column":22},"end":{"line":50,"column":23}}]},"3":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"4":{"line":52,"type":"binary-expr","locations":[{"start":{"line":52,"column":8},"end":{"line":52,"column":13}},{"start":{"line":52,"column":17},"end":{"line":52,"column":49}},{"start":{"line":52,"column":53},"end":{"line":52,"column":67}}]},"5":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":11},"end":{"line":57,"column":11}},{"start":{"line":57,"column":11},"end":{"line":57,"column":11}}]},"6":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":4},"end":{"line":65,"column":4}},{"start":{"line":65,"column":4},"end":{"line":65,"column":4}}]},"7":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":11},"end":{"line":68,"column":11}},{"start":{"line":68,"column":11},"end":{"line":68,"column":11}}]},"8":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":6},"end":{"line":75,"column":6}},{"start":{"line":75,"column":6},"end":{"line":75,"column":6}}]},"9":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":4},"end":{"line":84,"column":4}},{"start":{"line":84,"column":4},"end":{"line":84,"column":4}}]},"10":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":4},"end":{"line":89,"column":4}},{"start":{"line":89,"column":4},"end":{"line":89,"column":4}}]},"11":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":6},"end":{"line":90,"column":6}},{"start":{"line":90,"column":6},"end":{"line":90,"column":6}}]},"12":{"line":91,"type":"switch","locations":[{"start":{"line":92,"column":10},"end":{"line":96,"column":18}},{"start":{"line":97,"column":10},"end":{"line":99,"column":18}}]},"13":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":94,"column":12}},{"start":{"line":94,"column":12},"end":{"line":94,"column":12}}]},"14":{"line":105,"type":"switch","locations":[{"start":{"line":106,"column":8},"end":{"line":107,"column":23}},{"start":{"line":108,"column":8},"end":{"line":109,"column":22}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var TextXform = require('./text-xform');","var RichTextXform = require('./rich-text-xform');","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","// <rPh sb=\"0\" eb=\"1\">","//   <t>(its pronounciation in KATAKANA)</t>","// </rPh>","","var PhoneticTextXform = module.exports = function() {","  this.map = {","    r: new RichTextXform(),","    t: new TextXform()","  };","};","","","utils.inherits(PhoneticTextXform, BaseXform, {","","  get tag() { return 'rPh'; },","","  render: function(xmlStream, model) {","    xmlStream.openNode(this.tag, {","      sb:  model.sb || 0,","      eb: model.eb || 0","    });","    if (model && model.hasOwnProperty('richText') && model.richText) {","      var r = this.map.r;","      model.richText.forEach(function(text) {","        r.render(xmlStream, text);","      });","    } else if (model) {","      this.map.t.render(xmlStream, model.text);","    }","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    var name = node.name;","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else if (name === this.tag) {","      this.model = {","        sb: parseInt(node.attributes.sb),","        eb: parseInt(node.attributes.eb)","      };","    } else {","      this.parser = this.map[name];","      if (this.parser) {","        this.parser.parseOpen(node);","        return true;","      } else {","        return false;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        switch(name) {","          case 'r':","            var rt = this.model.richText;","            if (!rt) { rt = this.model.richText = []; }","            rt.push(this.parser.model);","            break;","          case 't':","            this.model.text = this.parser.model;","            break;","        }","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case this.tag:","          return false;","        default:","          return true;","      }","    }","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":1,"35":1,"36":0,"43":1,"45":0,"48":0,"52":0,"53":0,"54":0,"55":0,"57":0,"58":0,"60":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"74":0,"75":0,"76":0,"77":0,"79":0,"84":0,"85":0,"89":0,"90":0,"91":0,"93":0,"94":0,"95":0,"96":0,"98":0,"99":0,"101":0,"103":0,"105":0,"107":0,"109":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/relationships-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/relationships-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":43,"loc":{"start":{"line":43,"column":42},"end":{"line":43,"column":53}}},"2":{"name":"(anonymous_2)","line":52,"loc":{"start":{"line":52,"column":10},"end":{"line":52,"column":37}}},"3":{"name":"(anonymous_3)","line":58,"loc":{"start":{"line":58,"column":18},"end":{"line":58,"column":41}}},"4":{"name":"(anonymous_4)","line":65,"loc":{"start":{"line":65,"column":13},"end":{"line":65,"column":28}}},"5":{"name":"(anonymous_5)","line":84,"loc":{"start":{"line":84,"column":13},"end":{"line":84,"column":28}}},"6":{"name":"(anonymous_6)","line":89,"loc":{"start":{"line":89,"column":14},"end":{"line":89,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":53}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":56}},"5":{"start":{"line":43,"column":0},"end":{"line":47,"column":2}},"6":{"start":{"line":44,"column":2},"end":{"line":46,"column":3}},"7":{"start":{"line":49,"column":0},"end":{"line":105,"column":3}},"8":{"start":{"line":53,"column":4},"end":{"line":53,"column":34}},"9":{"start":{"line":54,"column":4},"end":{"line":54,"column":50}},"10":{"start":{"line":55,"column":4},"end":{"line":55,"column":85}},"11":{"start":{"line":57,"column":4},"end":{"line":57,"column":20}},"12":{"start":{"line":58,"column":4},"end":{"line":60,"column":7}},"13":{"start":{"line":59,"column":6},"end":{"line":59,"column":60}},"14":{"start":{"line":62,"column":4},"end":{"line":62,"column":26}},"15":{"start":{"line":66,"column":4},"end":{"line":82,"column":5}},"16":{"start":{"line":67,"column":6},"end":{"line":67,"column":34}},"17":{"start":{"line":68,"column":6},"end":{"line":68,"column":18}},"18":{"start":{"line":70,"column":6},"end":{"line":81,"column":7}},"19":{"start":{"line":72,"column":10},"end":{"line":72,"column":26}},"20":{"start":{"line":73,"column":10},"end":{"line":73,"column":22}},"21":{"start":{"line":75,"column":10},"end":{"line":75,"column":44}},"22":{"start":{"line":76,"column":10},"end":{"line":79,"column":11}},"23":{"start":{"line":77,"column":12},"end":{"line":77,"column":40}},"24":{"start":{"line":78,"column":12},"end":{"line":78,"column":24}},"25":{"start":{"line":80,"column":10},"end":{"line":80,"column":87}},"26":{"start":{"line":85,"column":4},"end":{"line":87,"column":5}},"27":{"start":{"line":86,"column":6},"end":{"line":86,"column":34}},"28":{"start":{"line":90,"column":4},"end":{"line":103,"column":5}},"29":{"start":{"line":91,"column":6},"end":{"line":94,"column":7}},"30":{"start":{"line":92,"column":8},"end":{"line":92,"column":43}},"31":{"start":{"line":93,"column":8},"end":{"line":93,"column":32}},"32":{"start":{"line":95,"column":6},"end":{"line":95,"column":18}},"33":{"start":{"line":97,"column":6},"end":{"line":102,"column":7}},"34":{"start":{"line":99,"column":10},"end":{"line":99,"column":23}},"35":{"start":{"line":101,"column":10},"end":{"line":101,"column":72}}},"branchMap":{"1":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":12},"end":{"line":53,"column":17}},{"start":{"line":53,"column":21},"end":{"line":53,"column":33}}]},"2":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]},"3":{"line":70,"type":"switch","locations":[{"start":{"line":71,"column":8},"end":{"line":73,"column":22}},{"start":{"line":74,"column":8},"end":{"line":80,"column":87}}]},"4":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":10},"end":{"line":76,"column":10}},{"start":{"line":76,"column":10},"end":{"line":76,"column":10}}]},"5":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":85,"column":4}},{"start":{"line":85,"column":4},"end":{"line":85,"column":4}}]},"6":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":4},"end":{"line":90,"column":4}},{"start":{"line":90,"column":4},"end":{"line":90,"column":4}}]},"7":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":6},"end":{"line":91,"column":6}},{"start":{"line":91,"column":6},"end":{"line":91,"column":6}}]},"8":{"line":97,"type":"switch","locations":[{"start":{"line":98,"column":8},"end":{"line":99,"column":23}},{"start":{"line":100,"column":8},"end":{"line":101,"column":72}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var XmlStream = require('../../../utils/xml-stream');","var BaseXform = require('../base-xform');","","var RelationshipXform = require('./relationship-xform');","","// <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>","// <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">","//   <%relationships.forEach(function(r) {%>","//     <Relationship","//       Id=\"<%=r.rId%>\"","//       Type=\"<%=r.type%>\"","//       Target=\"<%=r.target%>\" <% if (r.targetMode) {%>","//       TargetMode=\"<%=r.targetMode%>\"<%}%>","//     />","//     <%});%>","// </Relationships>","  ","var RelationshipsXform = module.exports = function() {","  this.map = {","    Relationship: new RelationshipXform()","  }","};","","utils.inherits(RelationshipsXform, BaseXform, {","  RELATIONSHIPS_ATTRIBUTES: {xmlns:  'http://schemas.openxmlformats.org/package/2006/relationships'}","},{","  render: function(xmlStream, model) {","    model = model || this._values;","    xmlStream.openXml(XmlStream.StdDocAttributes);","    xmlStream.openNode('Relationships', RelationshipsXform.RELATIONSHIPS_ATTRIBUTES);","","    var self = this;","    model.forEach(function(relationship) {","      self.map.Relationship.render(xmlStream, relationship);","    });","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'Relationships':","          this.model = [];","          return true;","        default:","          this.parser = this.map[node.name];","          if (this.parser) {","            this.parser.parseOpen(node);","            return true;","          }","          throw new Error('Unexpected xml node in parseOpen: ' + JSON.stringify(node));","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model.push(this.parser.model);","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case 'Relationships':","          return false;","        default:","          throw new Error('Unexpected xml node in parseClose: ' + name);","      }","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"43":1,"44":0,"49":1,"53":0,"54":0,"55":0,"57":0,"58":0,"59":0,"62":0,"66":0,"67":0,"68":0,"70":0,"72":0,"73":0,"75":0,"76":0,"77":0,"78":0,"80":0,"85":0,"86":0,"90":0,"91":0,"92":0,"93":0,"95":0,"97":0,"99":0,"101":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/relationship-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/relationship-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":41},"end":{"line":28,"column":52}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":10},"end":{"line":32,"column":37}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":13},"end":{"line":41,"column":28}}},"4":{"name":"(anonymous_4)","line":57,"loc":{"start":{"line":57,"column":13},"end":{"line":57,"column":24}}},"5":{"name":"(anonymous_5)","line":59,"loc":{"start":{"line":59,"column":14},"end":{"line":59,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":62,"column":3}},"5":{"start":{"line":33,"column":4},"end":{"line":38,"column":7}},"6":{"start":{"line":42,"column":4},"end":{"line":55,"column":5}},"7":{"start":{"line":44,"column":8},"end":{"line":48,"column":10}},"8":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"9":{"start":{"line":50,"column":10},"end":{"line":50,"column":61}},"10":{"start":{"line":52,"column":8},"end":{"line":52,"column":20}},"11":{"start":{"line":54,"column":8},"end":{"line":54,"column":21}},"12":{"start":{"line":60,"column":4},"end":{"line":60,"column":17}}},"branchMap":{"1":{"line":42,"type":"switch","locations":[{"start":{"line":43,"column":6},"end":{"line":52,"column":20}},{"start":{"line":53,"column":6},"end":{"line":54,"column":21}}]},"2":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":49,"column":8}},{"start":{"line":49,"column":8},"end":{"line":49,"column":8}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var RelationshipXform = module.exports = function() {","};","","utils.inherits(RelationshipXform, BaseXform, {","  render: function(xmlStream, model) {","    xmlStream.leafNode('Relationship', {","      Id: model.rId,","      Type: model.type,","      Target: model.target,","      TargetMode: model.targetMode","    });","  },","  ","  parseOpen: function(node) {","    switch(node.name) {","      case 'Relationship':","        this.model = {","          rId: node.attributes.Id,","          type: node.attributes.Type,","          target: node.attributes.Target","        };","        if (node.attributes.TargetMode) {","          this.model.targetMode = node.attributes.TargetMode;","        }","        return true;","      default:","        return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"33":0,"42":0,"44":0,"49":0,"50":0,"52":0,"54":0,"60":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/content-types-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/content-types-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":32,"loc":{"start":{"line":32,"column":41},"end":{"line":32,"column":52}}},"2":{"name":"(anonymous_2)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":37}}},"3":{"name":"(anonymous_3)","line":52,"loc":{"start":{"line":52,"column":29},"end":{"line":52,"column":49}}},"4":{"name":"(anonymous_4)","line":66,"loc":{"start":{"line":66,"column":13},"end":{"line":66,"column":24}}},"5":{"name":"(anonymous_5)","line":69,"loc":{"start":{"line":69,"column":13},"end":{"line":69,"column":24}}},"6":{"name":"(anonymous_6)","line":71,"loc":{"start":{"line":71,"column":14},"end":{"line":71,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":53}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":41}},"4":{"start":{"line":32,"column":0},"end":{"line":33,"column":2}},"5":{"start":{"line":36,"column":0},"end":{"line":74,"column":3}},"6":{"start":{"line":43,"column":4},"end":{"line":43,"column":50}},"7":{"start":{"line":45,"column":4},"end":{"line":45,"column":71}},"8":{"start":{"line":47,"column":4},"end":{"line":47,"column":127}},"9":{"start":{"line":48,"column":4},"end":{"line":48,"column":85}},"10":{"start":{"line":50,"column":4},"end":{"line":50,"column":157}},"11":{"start":{"line":52,"column":4},"end":{"line":55,"column":7}},"12":{"start":{"line":53,"column":6},"end":{"line":53,"column":64}},"13":{"start":{"line":54,"column":6},"end":{"line":54,"column":144}},"14":{"start":{"line":57,"column":4},"end":{"line":57,"column":142}},"15":{"start":{"line":58,"column":4},"end":{"line":58,"column":151}},"16":{"start":{"line":59,"column":4},"end":{"line":59,"column":165}},"17":{"start":{"line":60,"column":4},"end":{"line":60,"column":143}},"18":{"start":{"line":61,"column":4},"end":{"line":61,"column":153}},"19":{"start":{"line":63,"column":4},"end":{"line":63,"column":26}},"20":{"start":{"line":67,"column":4},"end":{"line":67,"column":17}},"21":{"start":{"line":72,"column":4},"end":{"line":72,"column":17}}},"branchMap":{},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var XmlStream = require('../../../utils/xml-stream');","","var BaseXform = require('../base-xform');","","// used for rendering the [Content_Types].xml file","// not used for parsing","var ContentTypesXform = module.exports = function() {","};","","","utils.inherits(ContentTypesXform, BaseXform, {","  PROPERTY_ATTRIBUTES: {","    xmlns: 'http://schemas.openxmlformats.org/package/2006/content-types'","  }","},{","","  render: function(xmlStream, model) {","    xmlStream.openXml(XmlStream.StdDocAttributes);","","    xmlStream.openNode('Types', ContentTypesXform.PROPERTY_ATTRIBUTES);","","    xmlStream.leafNode('Default', {Extension:'rels', ContentType: 'application/vnd.openxmlformats-package.relationships+xml'});","    xmlStream.leafNode('Default', {Extension:'xml', ContentType: 'application/xml'});","","    xmlStream.leafNode('Override', {PartName:'/xl/workbook.xml', ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml'});","","    model.worksheets.forEach(function(worksheet) {","      var name = '/xl/worksheets/sheet' + worksheet.id + '.xml';","      xmlStream.leafNode('Override', {PartName:name, ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml'});","    });","","    xmlStream.leafNode('Override', {PartName:'/xl/theme/theme1.xml', ContentType: 'application/vnd.openxmlformats-officedocument.theme+xml'});","    xmlStream.leafNode('Override', {PartName:'/xl/styles.xml', ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml'});","    xmlStream.leafNode('Override', {PartName:'/xl/sharedStrings.xml', ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml'});","    xmlStream.leafNode('Override', {PartName:'/docProps/core.xml', ContentType: 'application/vnd.openxmlformats-package.core-properties+xml'});","    xmlStream.leafNode('Override', {PartName:'/docProps/app.xml', ContentType: 'application/vnd.openxmlformats-officedocument.extended-properties+xml'});","","    xmlStream.closeNode();","  },","","  parseOpen: function() {","    return false;","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"32":1,"36":1,"43":0,"45":0,"47":0,"48":0,"50":0,"52":0,"53":0,"54":0,"57":0,"58":0,"59":0,"60":0,"61":0,"63":0,"67":0,"72":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/app-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/app-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":0,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":39,"loc":{"start":{"line":39,"column":32},"end":{"line":39,"column":43}}},"2":{"name":"(anonymous_2)","line":48,"loc":{"start":{"line":48,"column":22},"end":{"line":48,"column":35}}},"3":{"name":"(anonymous_3)","line":59,"loc":{"start":{"line":59,"column":10},"end":{"line":59,"column":37}}},"4":{"name":"(anonymous_4)","line":81,"loc":{"start":{"line":81,"column":13},"end":{"line":81,"column":28}}},"5":{"name":"(anonymous_5)","line":101,"loc":{"start":{"line":101,"column":13},"end":{"line":101,"column":28}}},"6":{"name":"(anonymous_6)","line":106,"loc":{"start":{"line":106,"column":14},"end":{"line":106,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":53}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":52}},"5":{"start":{"line":30,"column":0},"end":{"line":30,"column":64}},"6":{"start":{"line":31,"column":0},"end":{"line":31,"column":66}},"7":{"start":{"line":33,"column":0},"end":{"line":37,"column":2}},"8":{"start":{"line":39,"column":0},"end":{"line":46,"column":2}},"9":{"start":{"line":40,"column":2},"end":{"line":45,"column":3}},"10":{"start":{"line":48,"column":0},"end":{"line":50,"column":2}},"11":{"start":{"line":49,"column":2},"end":{"line":49,"column":48}},"12":{"start":{"line":51,"column":0},"end":{"line":51,"column":52}},"13":{"start":{"line":53,"column":0},"end":{"line":56,"column":2}},"14":{"start":{"line":58,"column":0},"end":{"line":126,"column":3}},"15":{"start":{"line":60,"column":4},"end":{"line":60,"column":50}},"16":{"start":{"line":62,"column":4},"end":{"line":62,"column":67}},"17":{"start":{"line":64,"column":4},"end":{"line":64,"column":69}},"18":{"start":{"line":65,"column":4},"end":{"line":65,"column":55}},"19":{"start":{"line":66,"column":4},"end":{"line":66,"column":57}},"20":{"start":{"line":68,"column":4},"end":{"line":68,"column":65}},"21":{"start":{"line":69,"column":4},"end":{"line":69,"column":65}},"22":{"start":{"line":70,"column":4},"end":{"line":70,"column":63}},"23":{"start":{"line":71,"column":4},"end":{"line":71,"column":57}},"24":{"start":{"line":73,"column":4},"end":{"line":73,"column":61}},"25":{"start":{"line":74,"column":4},"end":{"line":74,"column":57}},"26":{"start":{"line":75,"column":4},"end":{"line":75,"column":65}},"27":{"start":{"line":76,"column":4},"end":{"line":76,"column":60}},"28":{"start":{"line":78,"column":4},"end":{"line":78,"column":26}},"29":{"start":{"line":82,"column":4},"end":{"line":99,"column":5}},"30":{"start":{"line":83,"column":6},"end":{"line":83,"column":34}},"31":{"start":{"line":84,"column":6},"end":{"line":84,"column":18}},"32":{"start":{"line":86,"column":6},"end":{"line":98,"column":7}},"33":{"start":{"line":88,"column":10},"end":{"line":88,"column":22}},"34":{"start":{"line":90,"column":10},"end":{"line":90,"column":44}},"35":{"start":{"line":91,"column":10},"end":{"line":94,"column":11}},"36":{"start":{"line":92,"column":12},"end":{"line":92,"column":40}},"37":{"start":{"line":93,"column":12},"end":{"line":93,"column":24}},"38":{"start":{"line":97,"column":10},"end":{"line":97,"column":23}},"39":{"start":{"line":102,"column":4},"end":{"line":104,"column":5}},"40":{"start":{"line":103,"column":6},"end":{"line":103,"column":34}},"41":{"start":{"line":107,"column":4},"end":{"line":124,"column":5}},"42":{"start":{"line":108,"column":6},"end":{"line":110,"column":7}},"43":{"start":{"line":109,"column":8},"end":{"line":109,"column":32}},"44":{"start":{"line":111,"column":6},"end":{"line":111,"column":18}},"45":{"start":{"line":113,"column":6},"end":{"line":123,"column":7}},"46":{"start":{"line":115,"column":10},"end":{"line":119,"column":12}},"47":{"start":{"line":120,"column":10},"end":{"line":120,"column":23}},"48":{"start":{"line":122,"column":10},"end":{"line":122,"column":22}}},"branchMap":{"1":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":42},"end":{"line":70,"column":55}},{"start":{"line":70,"column":59},"end":{"line":70,"column":61}}]},"2":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":82,"column":4}},{"start":{"line":82,"column":4},"end":{"line":82,"column":4}}]},"3":{"line":86,"type":"switch","locations":[{"start":{"line":87,"column":8},"end":{"line":88,"column":22}},{"start":{"line":89,"column":8},"end":{"line":97,"column":23}}]},"4":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":10},"end":{"line":91,"column":10}},{"start":{"line":91,"column":10},"end":{"line":91,"column":10}}]},"5":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":4},"end":{"line":102,"column":4}},{"start":{"line":102,"column":4},"end":{"line":102,"column":4}}]},"6":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":4},"end":{"line":107,"column":4}},{"start":{"line":107,"column":4},"end":{"line":107,"column":4}}]},"7":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":6},"end":{"line":108,"column":6}},{"start":{"line":108,"column":6},"end":{"line":108,"column":6}}]},"8":{"line":113,"type":"switch","locations":[{"start":{"line":114,"column":8},"end":{"line":120,"column":23}},{"start":{"line":121,"column":8},"end":{"line":122,"column":22}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var XmlStream = require('../../../utils/xml-stream');","var BaseXform = require('../base-xform');","var StringXform = require('../simple/string-xform');","","var AppHeadingPairsXform = require('./app-heading-pairs-xform');","var AppTitleOfPartsXform = require('./app-titles-of-parts-xform');","","var props = {","  company: 'Company',","  manager: 'Manager',","  worksheets: [{name: 'sheet1'}]","};","","var AppXform = module.exports = function() {","  this.map = {","    'Company': new StringXform({tag: 'Company'}),","    'Manager': new StringXform({tag: 'Manager'}),","    'HeadingPairs': new AppHeadingPairsXform(),","    'TitleOfParts': new AppTitleOfPartsXform()","  }","};","","AppXform.DateFormat = function(dt) {","  return dt.toISOString().replace(/\\.\\d{3}/,'');","};","AppXform.DateAttrs = {'xsi:type': 'dcterms:W3CDTF'};","","AppXform.PROPERTY_ATTRIBUTES = {","  'xmlns': 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties',","  'xmlns:vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes'","};","","utils.inherits(AppXform, BaseXform, {","  render: function(xmlStream, model) {","    xmlStream.openXml(XmlStream.StdDocAttributes);","","    xmlStream.openNode('Properties', AppXform.PROPERTY_ATTRIBUTES);","    ","    xmlStream.leafNode('Application',  undefined, 'Microsoft Excel');","    xmlStream.leafNode('DocSecurity',  undefined, '0');","    xmlStream.leafNode('ScaleCrop',  undefined, 'false');","","    this.map['HeadingPairs'].render(xmlStream, model.worksheets);","    this.map['TitleOfParts'].render(xmlStream, model.worksheets);","    this.map['Company'].render(xmlStream, model.company || '');","    this.map['Manager'].render(xmlStream, model.manager);","","    xmlStream.leafNode('LinksUpToDate',  undefined, 'false');","    xmlStream.leafNode('SharedDoc',  undefined, 'false');","    xmlStream.leafNode('HyperlinksChanged',  undefined, 'false');","    xmlStream.leafNode('AppVersion',  undefined, '16.0300');","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'Properties':","          return true;","        default:","          this.parser = this.map[node.name];","          if (this.parser) {","            this.parser.parseOpen(node);","            return true;","          }","          ","          // there's a lot we don't bother to parse","          return false;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case 'Properties':","          this.model = {","            worksheets: this.map['TitleOfParts'].model,","            company: this.map['Company'].model,","            manager: this.map['Manager'].model","          };","          return false;","        default:","          return true;","      }","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"28":1,"30":1,"31":1,"33":1,"39":1,"40":0,"48":1,"49":0,"51":1,"53":1,"58":1,"60":0,"62":0,"64":0,"65":0,"66":0,"68":0,"69":0,"70":0,"71":0,"73":0,"74":0,"75":0,"76":0,"78":0,"82":0,"83":0,"84":0,"86":0,"88":0,"90":0,"91":0,"92":0,"93":0,"97":0,"102":0,"103":0,"107":0,"108":0,"109":0,"111":0,"113":0,"115":0,"120":0,"122":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/app-heading-pairs-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/app-heading-pairs-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":44},"end":{"line":28,"column":55}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":10},"end":{"line":32,"column":37}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":13},"end":{"line":49,"column":28}}},"4":{"name":"(anonymous_4)","line":53,"loc":{"start":{"line":53,"column":13},"end":{"line":53,"column":24}}},"5":{"name":"(anonymous_5)","line":55,"loc":{"start":{"line":55,"column":14},"end":{"line":55,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":58,"column":3}},"5":{"start":{"line":34,"column":4},"end":{"line":34,"column":39}},"6":{"start":{"line":35,"column":4},"end":{"line":35,"column":68}},"7":{"start":{"line":37,"column":4},"end":{"line":37,"column":37}},"8":{"start":{"line":38,"column":4},"end":{"line":38,"column":60}},"9":{"start":{"line":39,"column":4},"end":{"line":39,"column":26}},"10":{"start":{"line":41,"column":4},"end":{"line":41,"column":37}},"11":{"start":{"line":42,"column":4},"end":{"line":42,"column":57}},"12":{"start":{"line":43,"column":4},"end":{"line":43,"column":26}},"13":{"start":{"line":45,"column":4},"end":{"line":45,"column":26}},"14":{"start":{"line":46,"column":4},"end":{"line":46,"column":26}},"15":{"start":{"line":51,"column":4},"end":{"line":51,"column":40}},"16":{"start":{"line":56,"column":4},"end":{"line":56,"column":35}}},"branchMap":{},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var AppHeadingPairsXform = module.exports = function() {","};","","utils.inherits(AppHeadingPairsXform, BaseXform, {","  render: function(xmlStream, model) {","","    xmlStream.openNode('HeadingPairs');","    xmlStream.openNode('vt:vector', {size: 2, baseType: 'variant'});","","    xmlStream.openNode('vt:variant');","    xmlStream.leafNode('vt:lpstr', undefined, 'Worksheets');","    xmlStream.closeNode();","    ","    xmlStream.openNode('vt:variant');","    xmlStream.leafNode('vt:i4', undefined, model.length);","    xmlStream.closeNode();","    ","    xmlStream.closeNode();","    xmlStream.closeNode();","  },","  ","  parseOpen: function(node) {","    // no parsing","    return node.name === 'HeadingPairs';","  },","  parseText: function() {","  },","  parseClose: function(name) {","    return name !== 'HeadingPairs';","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"34":0,"35":0,"37":0,"38":0,"39":0,"41":0,"42":0,"43":0,"45":0,"46":0,"51":0,"56":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/app-titles-of-parts-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/core/app-titles-of-parts-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":45},"end":{"line":28,"column":56}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":10},"end":{"line":32,"column":37}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":18},"end":{"line":37,"column":34}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":13},"end":{"line":45,"column":28}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":13},"end":{"line":49,"column":24}}},"6":{"name":"(anonymous_6)","line":51,"loc":{"start":{"line":51,"column":14},"end":{"line":51,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":54,"column":3}},"5":{"start":{"line":34,"column":4},"end":{"line":34,"column":40}},"6":{"start":{"line":35,"column":4},"end":{"line":35,"column":77}},"7":{"start":{"line":37,"column":4},"end":{"line":39,"column":7}},"8":{"start":{"line":38,"column":6},"end":{"line":38,"column":60}},"9":{"start":{"line":41,"column":4},"end":{"line":41,"column":26}},"10":{"start":{"line":42,"column":4},"end":{"line":42,"column":26}},"11":{"start":{"line":47,"column":4},"end":{"line":47,"column":41}},"12":{"start":{"line":52,"column":4},"end":{"line":52,"column":36}}},"branchMap":{},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var AppTitlesOfPartsXform = module.exports = function() {","};","","utils.inherits(AppTitlesOfPartsXform, BaseXform, {","  render: function(xmlStream, model) {","","    xmlStream.openNode('TitlesOfParts');","    xmlStream.openNode('vt:vector', {size: model.length, baseType: 'lpstr'});","","    model.forEach(function(sheet) {","      xmlStream.leafNode('vt:lpstr', undefined, sheet.name);","    });","    ","    xmlStream.closeNode();","    xmlStream.closeNode();","  },","  ","  parseOpen: function(node) {","    // no parsing","    return node.name === 'TitlesOfParts';","  },","  parseText: function() {","  },","  parseClose: function(name) {","    return name !== 'TitlesOfParts';","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"34":0,"35":0,"37":0,"38":0,"41":0,"42":0,"47":0,"52":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/workbook-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/workbook-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":39,"loc":{"start":{"line":39,"column":37},"end":{"line":39,"column":48}}},"2":{"name":"(anonymous_2)","line":64,"loc":{"start":{"line":64,"column":11},"end":{"line":64,"column":27}}},"3":{"name":"(anonymous_3)","line":70,"loc":{"start":{"line":70,"column":25},"end":{"line":70,"column":41}}},"4":{"name":"(anonymous_4)","line":86,"loc":{"start":{"line":86,"column":10},"end":{"line":86,"column":37}}},"5":{"name":"(anonymous_5)","line":100,"loc":{"start":{"line":100,"column":13},"end":{"line":100,"column":28}}},"6":{"name":"(anonymous_6)","line":117,"loc":{"start":{"line":117,"column":13},"end":{"line":117,"column":28}}},"7":{"name":"(anonymous_7)","line":122,"loc":{"start":{"line":122,"column":14},"end":{"line":122,"column":29}}},"8":{"name":"(anonymous_8)","line":148,"loc":{"start":{"line":148,"column":13},"end":{"line":148,"column":29}}},"9":{"name":"(anonymous_9)","line":149,"loc":{"start":{"line":149,"column":41},"end":{"line":149,"column":60}}},"10":{"name":"(anonymous_10)","line":159,"loc":{"start":{"line":159,"column":25},"end":{"line":159,"column":41}}},"11":{"name":"(anonymous_11)","line":172,"loc":{"start":{"line":172,"column":31},"end":{"line":172,"column":53}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":45}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":44}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":51}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":53}},"5":{"start":{"line":31,"column":0},"end":{"line":31,"column":41}},"6":{"start":{"line":32,"column":0},"end":{"line":32,"column":45}},"7":{"start":{"line":33,"column":0},"end":{"line":33,"column":41}},"8":{"start":{"line":34,"column":0},"end":{"line":34,"column":55}},"9":{"start":{"line":35,"column":0},"end":{"line":35,"column":42}},"10":{"start":{"line":36,"column":0},"end":{"line":36,"column":57}},"11":{"start":{"line":37,"column":0},"end":{"line":37,"column":69}},"12":{"start":{"line":39,"column":0},"end":{"line":48,"column":2}},"13":{"start":{"line":40,"column":2},"end":{"line":47,"column":4}},"14":{"start":{"line":50,"column":0},"end":{"line":186,"column":3}},"15":{"start":{"line":65,"column":4},"end":{"line":65,"column":36}},"16":{"start":{"line":68,"column":4},"end":{"line":68,"column":24}},"17":{"start":{"line":69,"column":4},"end":{"line":69,"column":18}},"18":{"start":{"line":70,"column":4},"end":{"line":80,"column":7}},"19":{"start":{"line":71,"column":6},"end":{"line":78,"column":7}},"20":{"start":{"line":72,"column":8},"end":{"line":76,"column":10}},"21":{"start":{"line":77,"column":8},"end":{"line":77,"column":37}},"22":{"start":{"line":79,"column":6},"end":{"line":79,"column":14}},"23":{"start":{"line":81,"column":4},"end":{"line":83,"column":5}},"24":{"start":{"line":82,"column":6},"end":{"line":82,"column":65}},"25":{"start":{"line":87,"column":4},"end":{"line":87,"column":50}},"26":{"start":{"line":88,"column":4},"end":{"line":88,"column":70}},"27":{"start":{"line":90,"column":4},"end":{"line":90,"column":43}},"28":{"start":{"line":91,"column":4},"end":{"line":91,"column":60}},"29":{"start":{"line":92,"column":4},"end":{"line":92,"column":54}},"30":{"start":{"line":93,"column":4},"end":{"line":93,"column":52}},"31":{"start":{"line":94,"column":4},"end":{"line":94,"column":64}},"32":{"start":{"line":95,"column":4},"end":{"line":95,"column":38}},"33":{"start":{"line":97,"column":4},"end":{"line":97,"column":26}},"34":{"start":{"line":101,"column":4},"end":{"line":115,"column":5}},"35":{"start":{"line":102,"column":6},"end":{"line":102,"column":34}},"36":{"start":{"line":103,"column":6},"end":{"line":103,"column":18}},"37":{"start":{"line":105,"column":6},"end":{"line":114,"column":7}},"38":{"start":{"line":107,"column":10},"end":{"line":107,"column":22}},"39":{"start":{"line":109,"column":10},"end":{"line":109,"column":44}},"40":{"start":{"line":110,"column":10},"end":{"line":112,"column":11}},"41":{"start":{"line":111,"column":12},"end":{"line":111,"column":40}},"42":{"start":{"line":113,"column":10},"end":{"line":113,"column":22}},"43":{"start":{"line":118,"column":4},"end":{"line":120,"column":5}},"44":{"start":{"line":119,"column":6},"end":{"line":119,"column":34}},"45":{"start":{"line":123,"column":4},"end":{"line":145,"column":5}},"46":{"start":{"line":124,"column":6},"end":{"line":126,"column":7}},"47":{"start":{"line":125,"column":8},"end":{"line":125,"column":32}},"48":{"start":{"line":127,"column":6},"end":{"line":127,"column":18}},"49":{"start":{"line":129,"column":6},"end":{"line":144,"column":7}},"50":{"start":{"line":131,"column":10},"end":{"line":135,"column":12}},"51":{"start":{"line":136,"column":10},"end":{"line":138,"column":11}},"52":{"start":{"line":137,"column":12},"end":{"line":137,"column":66}},"53":{"start":{"line":140,"column":10},"end":{"line":140,"column":23}},"54":{"start":{"line":143,"column":10},"end":{"line":143,"column":22}},"55":{"start":{"line":149,"column":4},"end":{"line":152,"column":11}},"56":{"start":{"line":150,"column":6},"end":{"line":150,"column":25}},"57":{"start":{"line":151,"column":6},"end":{"line":151,"column":17}},"58":{"start":{"line":155,"column":4},"end":{"line":155,"column":24}},"59":{"start":{"line":156,"column":4},"end":{"line":156,"column":18}},"60":{"start":{"line":157,"column":4},"end":{"line":157,"column":18}},"61":{"start":{"line":159,"column":4},"end":{"line":168,"column":7}},"62":{"start":{"line":160,"column":6},"end":{"line":160,"column":32}},"63":{"start":{"line":161,"column":6},"end":{"line":163,"column":7}},"64":{"start":{"line":162,"column":8},"end":{"line":162,"column":15}},"65":{"start":{"line":164,"column":6},"end":{"line":164,"column":58}},"66":{"start":{"line":165,"column":6},"end":{"line":165,"column":34}},"67":{"start":{"line":166,"column":6},"end":{"line":166,"column":30}},"68":{"start":{"line":167,"column":6},"end":{"line":167,"column":38}},"69":{"start":{"line":171,"column":4},"end":{"line":171,"column":26}},"70":{"start":{"line":172,"column":4},"end":{"line":183,"column":7}},"71":{"start":{"line":173,"column":6},"end":{"line":182,"column":7}},"72":{"start":{"line":174,"column":8},"end":{"line":174,"column":57}},"73":{"start":{"line":175,"column":8},"end":{"line":179,"column":9}},"74":{"start":{"line":176,"column":10},"end":{"line":176,"column":65}},"75":{"start":{"line":176,"column":38},"end":{"line":176,"column":63}},"76":{"start":{"line":177,"column":10},"end":{"line":177,"column":65}},"77":{"start":{"line":178,"column":10},"end":{"line":178,"column":59}},"78":{"start":{"line":181,"column":8},"end":{"line":181,"column":39}},"79":{"start":{"line":184,"column":4},"end":{"line":184,"column":38}}},"branchMap":{"1":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":6},"end":{"line":71,"column":6}},{"start":{"line":71,"column":6},"end":{"line":71,"column":6}}]},"2":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":10},"end":{"line":71,"column":25}},{"start":{"line":71,"column":29},"end":{"line":71,"column":54}}]},"3":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":4},"end":{"line":81,"column":4}},{"start":{"line":81,"column":4},"end":{"line":81,"column":4}}]},"4":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":4},"end":{"line":101,"column":4}},{"start":{"line":101,"column":4},"end":{"line":101,"column":4}}]},"5":{"line":105,"type":"switch","locations":[{"start":{"line":106,"column":8},"end":{"line":107,"column":22}},{"start":{"line":108,"column":8},"end":{"line":113,"column":22}}]},"6":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":10},"end":{"line":110,"column":10}},{"start":{"line":110,"column":10},"end":{"line":110,"column":10}}]},"7":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]},"8":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":4}},{"start":{"line":123,"column":4},"end":{"line":123,"column":4}}]},"9":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":6},"end":{"line":124,"column":6}},{"start":{"line":124,"column":6},"end":{"line":124,"column":6}}]},"10":{"line":129,"type":"switch","locations":[{"start":{"line":130,"column":8},"end":{"line":140,"column":23}},{"start":{"line":141,"column":8},"end":{"line":143,"column":22}}]},"11":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":10},"end":{"line":136,"column":10}},{"start":{"line":136,"column":10},"end":{"line":136,"column":10}}]},"12":{"line":161,"type":"if","locations":[{"start":{"line":161,"column":6},"end":{"line":161,"column":6}},{"start":{"line":161,"column":6},"end":{"line":161,"column":6}}]},"13":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":6},"end":{"line":173,"column":6}},{"start":{"line":173,"column":6},"end":{"line":173,"column":6}}]},"14":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":8},"end":{"line":175,"column":8}},{"start":{"line":175,"column":8},"end":{"line":175,"column":8}}]},"15":{"line":176,"type":"if","locations":[{"start":{"line":176,"column":10},"end":{"line":176,"column":10}},{"start":{"line":176,"column":10},"end":{"line":176,"column":10}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../../../utils/under-dash');","","var utils = require('../../../utils/utils');","var colCache = require('../../../utils/col-cache');","var XmlStream = require('../../../utils/xml-stream');","","var BaseXform = require('../base-xform');","var StaticXform = require('../static-xform');","var ListXform = require('../list-xform');","var DefinedNameXform = require('./defined-name-xform');","var SheetXform = require('./sheet-xform');","var WorkbookViewXform = require('./workbook-view-xform');","var WorkbookPropertiesXform = require('./workbook-properties-xform');","","var WorkbookXform = module.exports = function() {","  this.map = {","    fileVersion: WorkbookXform.STATIC_XFORMS.fileVersion,","    workbookPr: new WorkbookPropertiesXform(),","    bookViews: new ListXform({tag: 'bookViews', count: false, childXform: new WorkbookViewXform()}),","    sheets: new ListXform({tag: 'sheets', count: false, childXform: new SheetXform()}),","    definedNames: new ListXform({tag: 'definedNames', count: false, childXform: new DefinedNameXform()}),","    calcPr: WorkbookXform.STATIC_XFORMS.calcPr","  };","};","","utils.inherits(WorkbookXform, BaseXform, {","  WORKBOOK_ATTRIBUTES: {","    'xmlns': 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',","    'xmlns:r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',","    'xmlns:mc': 'http://schemas.openxmlformats.org/markup-compatibility/2006',","    'mc:Ignorable': 'x15',","    'xmlns:x15': 'http://schemas.microsoft.com/office/spreadsheetml/2010/11/main'","  },","  STATIC_XFORMS: {","    fileVersion: new StaticXform({tag: 'fileVersion', $: {appName: 'xl', lastEdited: 5, lowestEdited: 5, rupBuild: 9303}}),","    calcPr: new StaticXform({tag: 'calcPr', $: {calcId: 171027}})","  }","},{","","  prepare: function(model) {","    model.sheets = model.worksheets;","","    // collate all the print areas from all of the sheets and add them to the defined names","    var printAreas = [];","    var index = 0; // sheets is sparse array - calc index manually","    model.sheets.forEach(function(sheet) {","      if (sheet.pageSetup && sheet.pageSetup.printArea) {","        var definedName = {","          name: '_xlnm.Print_Area',","          ranges: ['\\'' + sheet.name + '\\'!' + sheet.pageSetup.printArea],","          localSheetId: index","        };","        printAreas.push(definedName);","      }","      index++;","    });","    if (printAreas.length) {","      model.definedNames = model.definedNames.concat(printAreas);","    }","  },","","  render: function(xmlStream, model) {","    xmlStream.openXml(XmlStream.StdDocAttributes);","    xmlStream.openNode('workbook', WorkbookXform.WORKBOOK_ATTRIBUTES);","","    this.map.fileVersion.render(xmlStream);","    this.map.workbookPr.render(xmlStream, model.properties);","    this.map.bookViews.render(xmlStream, model.views);","    this.map.sheets.render(xmlStream, model.sheets);","    this.map.definedNames.render(xmlStream, model.definedNames);","    this.map.calcPr.render(xmlStream);","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else {","      switch(node.name) {","        case 'workbook':","          return true;","        default:","          this.parser = this.map[node.name];","          if (this.parser) {","            this.parser.parseOpen(node);","          }","          return true;","      }","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case 'workbook':","          this.model = {","            sheets: this.map.sheets.model,","            properties: this.map.workbookPr.model,","            views: this.map.bookViews.model","          };","          if (this.map.definedNames.model) {","            this.model.definedNames = this.map.definedNames.model;","          }","","          return false;","        default:","          // not quite sure how we get here!","          return true;","      }","    }","  },","","  reconcile: function(model) {","    var rels = model.workbookRels.reduce(function(map, rel) {","      map[rel.rId] = rel;","      return map;","    }, {});","","    // reconcile sheet ids, rIds and names","    var worksheets = [];","    var worksheet;","    var index = 0;","","    model.sheets.forEach(function(sheet) {","      var rel = rels[sheet.rId];","      if (!rel) {","        return;","      }","      worksheet = model.worksheetHash['xl/' + rel.target];","      worksheet.name = sheet.name;","      worksheet.id = sheet.id;","      worksheets[index++] = worksheet;","    });","","    // reconcile print areas","    var definedNames = [];","    _.each(model.definedNames, function(definedName) {","      if (definedName.name === '_xlnm.Print_Area') {","        worksheet = worksheets[definedName.localSheetId];","        if (worksheet) {","          if (!worksheet.pageSetup) { worksheet.pageSetup = {}; }","          var range  =  colCache.decodeEx(definedName.ranges[0]);","          worksheet.pageSetup.printArea = range.dimensions;","        }","      } else {","        definedNames.push(definedName);","      }","    });","    model.definedNames = definedNames;","  }","});",""],"l":{"25":1,"27":1,"28":1,"29":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"39":1,"40":0,"50":1,"65":0,"68":0,"69":0,"70":0,"71":0,"72":0,"77":0,"79":0,"81":0,"82":0,"87":0,"88":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"97":0,"101":0,"102":0,"103":0,"105":0,"107":0,"109":0,"110":0,"111":0,"113":0,"118":0,"119":0,"123":0,"124":0,"125":0,"127":0,"129":0,"131":0,"136":0,"137":0,"140":0,"143":0,"149":0,"150":0,"151":0,"155":0,"156":0,"157":0,"159":0,"160":0,"161":0,"162":0,"164":0,"165":0,"166":0,"167":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"181":0,"184":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/defined-name-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/defined-name-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":41},"end":{"line":28,"column":52}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":10},"end":{"line":32,"column":37}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":13},"end":{"line":44,"column":28}}},"4":{"name":"(anonymous_4)","line":55,"loc":{"start":{"line":55,"column":13},"end":{"line":55,"column":28}}},"5":{"name":"(anonymous_5)","line":58,"loc":{"start":{"line":58,"column":14},"end":{"line":58,"column":25}}},"6":{"name":"extractRanges","line":70,"loc":{"start":{"line":70,"column":0},"end":{"line":70,"column":35}}},"7":{"name":"(anonymous_7)","line":74,"loc":{"start":{"line":74,"column":31},"end":{"line":74,"column":47}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":68,"column":3}},"5":{"start":{"line":37,"column":4},"end":{"line":40,"column":7}},"6":{"start":{"line":41,"column":4},"end":{"line":41,"column":48}},"7":{"start":{"line":42,"column":4},"end":{"line":42,"column":26}},"8":{"start":{"line":45,"column":4},"end":{"line":53,"column":5}},"9":{"start":{"line":47,"column":8},"end":{"line":47,"column":48}},"10":{"start":{"line":48,"column":8},"end":{"line":48,"column":64}},"11":{"start":{"line":49,"column":8},"end":{"line":49,"column":30}},"12":{"start":{"line":50,"column":8},"end":{"line":50,"column":20}},"13":{"start":{"line":52,"column":8},"end":{"line":52,"column":21}},"14":{"start":{"line":56,"column":4},"end":{"line":56,"column":32}},"15":{"start":{"line":59,"column":4},"end":{"line":62,"column":6}},"16":{"start":{"line":63,"column":4},"end":{"line":65,"column":5}},"17":{"start":{"line":64,"column":6},"end":{"line":64,"column":67}},"18":{"start":{"line":66,"column":4},"end":{"line":66,"column":17}},"19":{"start":{"line":70,"column":0},"end":{"line":102,"column":1}},"20":{"start":{"line":71,"column":1},"end":{"line":71,"column":17}},"21":{"start":{"line":72,"column":1},"end":{"line":72,"column":26}},"22":{"start":{"line":73,"column":1},"end":{"line":73,"column":15}},"23":{"start":{"line":74,"column":1},"end":{"line":100,"column":6}},"24":{"start":{"line":75,"column":5},"end":{"line":77,"column":8}},"25":{"start":{"line":76,"column":9},"end":{"line":76,"column":16}},"26":{"start":{"line":78,"column":5},"end":{"line":78,"column":50}},"27":{"start":{"line":80,"column":9},"end":{"line":87,"column":8}},"28":{"start":{"line":81,"column":9},"end":{"line":85,"column":12}},"29":{"start":{"line":82,"column":13},"end":{"line":82,"column":32}},"30":{"start":{"line":84,"column":13},"end":{"line":84,"column":31}},"31":{"start":{"line":86,"column":9},"end":{"line":86,"column":16}},"32":{"start":{"line":88,"column":5},"end":{"line":88,"column":39}},"33":{"start":{"line":90,"column":9},"end":{"line":99,"column":8}},"34":{"start":{"line":91,"column":9},"end":{"line":91,"column":27}},"35":{"start":{"line":92,"column":14},"end":{"line":99,"column":8}},"36":{"start":{"line":93,"column":9},"end":{"line":93,"column":30}},"37":{"start":{"line":94,"column":9},"end":{"line":94,"column":34}},"38":{"start":{"line":95,"column":9},"end":{"line":95,"column":19}},"39":{"start":{"line":97,"column":9},"end":{"line":97,"column":29}},"40":{"start":{"line":98,"column":9},"end":{"line":98,"column":28}},"41":{"start":{"line":101,"column":1},"end":{"line":101,"column":15}}},"branchMap":{"1":{"line":45,"type":"switch","locations":[{"start":{"line":46,"column":6},"end":{"line":50,"column":20}},{"start":{"line":51,"column":6},"end":{"line":52,"column":21}}]},"2":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"3":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":5},"end":{"line":75,"column":5}},{"start":{"line":75,"column":5},"end":{"line":75,"column":5}}]},"4":{"line":78,"type":"binary-expr","locations":[{"start":{"line":78,"column":19},"end":{"line":78,"column":35}},{"start":{"line":78,"column":39},"end":{"line":78,"column":41}}]},"5":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":9},"end":{"line":80,"column":9}},{"start":{"line":80,"column":9},"end":{"line":80,"column":9}}]},"6":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":9},"end":{"line":81,"column":9}},{"start":{"line":81,"column":9},"end":{"line":81,"column":9}}]},"7":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":9},"end":{"line":90,"column":9}},{"start":{"line":90,"column":9},"end":{"line":90,"column":9}}]},"8":{"line":90,"type":"binary-expr","locations":[{"start":{"line":90,"column":13},"end":{"line":90,"column":26}},{"start":{"line":90,"column":30},"end":{"line":90,"column":40}}]},"9":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":14},"end":{"line":92,"column":14}},{"start":{"line":92,"column":14},"end":{"line":92,"column":14}}]},"10":{"line":92,"type":"binary-expr","locations":[{"start":{"line":92,"column":18},"end":{"line":92,"column":30}},{"start":{"line":92,"column":34},"end":{"line":92,"column":45}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var DefinedNamesXform = module.exports = function() {","};","","utils.inherits(DefinedNamesXform, BaseXform, {","  render: function(xmlStream, model) {","    // <definedNames>","    //   <definedName name=\"name\">name.ranges.join(',')</definedName>","    //   <definedName name=\"_xlnm.Print_Area\" localSheetId=\"0\">name.ranges.join(',')</definedName>","    // </definedNames>","    xmlStream.openNode('definedName', {","      name: model.name,","      localSheetId: model.localSheetId","    });","    xmlStream.writeText(model.ranges.join(','));","    xmlStream.closeNode();","  },","  parseOpen: function(node) {","    switch(node.name) {","      case 'definedName':","        this._parsedName = node.attributes.name;","        this._parsedLocalSheetId = node.attributes.localSheetId;","        this._parsedText = [];","        return true;","      default:","        return false;","    }","  },","  parseText: function(text) {","    this._parsedText.push(text);","  },","  parseClose: function() {","    this.model = {","      name: this._parsedName,","      ranges: extractRanges(this._parsedText.join(''))","    };","    if (this._parsedLocalSheetId !== undefined) {","      this.model.localSheetId = parseInt(this._parsedLocalSheetId);","    }","    return false;","  }","});","","function extractRanges(parsedText) {"," var ranges = [];"," var quotesOpened = false;"," var last = '';"," parsedText.split(',').forEach(function (item) {","     if(!item){","         return;","       }","     var quotes = (item.match(/'/g) || []).length;","","         if (!quotes) {","         if (quotesOpened) {","             last += item + ',';","           } else {","             ranges.push(item);","           }","         return;","       }","     var quotesEven = quotes % 2 === 0;","","         if (!quotesOpened && quotesEven) {","         ranges.push(item);","       } else if (quotesOpened && !quotesEven) {","         quotesOpened = false;","         ranges.push(last + item);","         last = '';","       } else {","         quotesOpened = true;","         last += item + ',';","       }","   });"," return ranges;","}"],"l":{"25":1,"26":1,"28":1,"31":1,"37":0,"41":0,"42":0,"45":0,"47":0,"48":0,"49":0,"50":0,"52":0,"56":0,"59":0,"63":0,"64":0,"66":0,"70":1,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"78":0,"80":0,"81":0,"82":0,"84":0,"86":0,"88":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"97":0,"98":0,"101":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/sheet-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/sheet-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":38},"end":{"line":28,"column":49}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":10},"end":{"line":33,"column":37}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":13},"end":{"line":41,"column":28}}},"4":{"name":"(anonymous_4)","line":53,"loc":{"start":{"line":53,"column":13},"end":{"line":53,"column":24}}},"5":{"name":"(anonymous_5)","line":55,"loc":{"start":{"line":55,"column":14},"end":{"line":55,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":58,"column":3}},"5":{"start":{"line":34,"column":4},"end":{"line":38,"column":7}},"6":{"start":{"line":42,"column":4},"end":{"line":51,"column":5}},"7":{"start":{"line":43,"column":6},"end":{"line":47,"column":8}},"8":{"start":{"line":48,"column":6},"end":{"line":48,"column":18}},"9":{"start":{"line":50,"column":6},"end":{"line":50,"column":19}},"10":{"start":{"line":56,"column":4},"end":{"line":56,"column":17}}},"branchMap":{"1":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var WorksheetXform = module.exports = function() {","};","","utils.inherits(WorksheetXform, BaseXform, {","  ","  render: function(xmlStream, model) {","    xmlStream.leafNode('sheet', {","      sheetId: model.id,","      name: model.name,","      'r:id': model.rId","    });","  },","  ","  parseOpen: function(node) {","    if (node.name === 'sheet') {","      this.model = {","        name: utils.xmlDecode(node.attributes.name),","        id: parseInt(node.attributes.sheetId),","        rId: node.attributes['r:id']","      };","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"34":0,"42":0,"43":0,"48":0,"50":0,"56":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/workbook-view-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/workbook-view-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":41},"end":{"line":28,"column":52}}},"2":{"name":"(anonymous_2)","line":34,"loc":{"start":{"line":34,"column":10},"end":{"line":34,"column":37}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":13},"end":{"line":49,"column":28}}},"4":{"name":"(anonymous_4)","line":52,"loc":{"start":{"line":52,"column":17},"end":{"line":52,"column":45}}},"5":{"name":"(anonymous_5)","line":58,"loc":{"start":{"line":58,"column":17},"end":{"line":58,"column":45}}},"6":{"name":"(anonymous_6)","line":76,"loc":{"start":{"line":76,"column":13},"end":{"line":76,"column":24}}},"7":{"name":"(anonymous_7)","line":78,"loc":{"start":{"line":78,"column":14},"end":{"line":78,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":81,"column":3}},"5":{"start":{"line":35,"column":4},"end":{"line":42,"column":6}},"6":{"start":{"line":43,"column":4},"end":{"line":45,"column":5}},"7":{"start":{"line":44,"column":6},"end":{"line":44,"column":47}},"8":{"start":{"line":46,"column":4},"end":{"line":46,"column":51}},"9":{"start":{"line":50,"column":4},"end":{"line":74,"column":5}},"10":{"start":{"line":51,"column":6},"end":{"line":51,"column":34}},"11":{"start":{"line":52,"column":6},"end":{"line":57,"column":8}},"12":{"start":{"line":53,"column":8},"end":{"line":53,"column":67}},"13":{"start":{"line":54,"column":8},"end":{"line":56,"column":9}},"14":{"start":{"line":55,"column":10},"end":{"line":55,"column":26}},"15":{"start":{"line":58,"column":6},"end":{"line":63,"column":8}},"16":{"start":{"line":59,"column":8},"end":{"line":59,"column":77}},"17":{"start":{"line":60,"column":8},"end":{"line":62,"column":9}},"18":{"start":{"line":61,"column":10},"end":{"line":61,"column":26}},"19":{"start":{"line":64,"column":6},"end":{"line":64,"column":44}},"20":{"start":{"line":65,"column":6},"end":{"line":65,"column":45}},"21":{"start":{"line":66,"column":6},"end":{"line":66,"column":56}},"22":{"start":{"line":67,"column":6},"end":{"line":67,"column":58}},"23":{"start":{"line":68,"column":6},"end":{"line":68,"column":64}},"24":{"start":{"line":69,"column":6},"end":{"line":69,"column":62}},"25":{"start":{"line":70,"column":6},"end":{"line":70,"column":64}},"26":{"start":{"line":71,"column":6},"end":{"line":71,"column":18}},"27":{"start":{"line":73,"column":6},"end":{"line":73,"column":19}},"28":{"start":{"line":79,"column":4},"end":{"line":79,"column":17}}},"branchMap":{"1":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":15},"end":{"line":36,"column":22}},{"start":{"line":36,"column":26},"end":{"line":36,"column":27}}]},"2":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":15},"end":{"line":37,"column":22}},{"start":{"line":37,"column":26},"end":{"line":37,"column":27}}]},"3":{"line":38,"type":"binary-expr","locations":[{"start":{"line":38,"column":19},"end":{"line":38,"column":30}},{"start":{"line":38,"column":34},"end":{"line":38,"column":39}}]},"4":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":20},"end":{"line":39,"column":32}},{"start":{"line":39,"column":36},"end":{"line":39,"column":41}}]},"5":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":43,"column":4}},{"start":{"line":43,"column":4},"end":{"line":43,"column":4}}]},"6":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":8},"end":{"line":43,"column":24}},{"start":{"line":43,"column":28},"end":{"line":43,"column":58}}]},"7":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":50,"column":4}},{"start":{"line":50,"column":4},"end":{"line":50,"column":4}}]},"8":{"line":53,"type":"cond-expr","locations":[{"start":{"line":53,"column":40},"end":{"line":53,"column":59}},{"start":{"line":53,"column":62},"end":{"line":53,"column":66}}]},"9":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":54,"column":8}},{"start":{"line":54,"column":8},"end":{"line":54,"column":8}}]},"10":{"line":59,"type":"cond-expr","locations":[{"start":{"line":59,"column":40},"end":{"line":59,"column":69}},{"start":{"line":59,"column":72},"end":{"line":59,"column":76}}]},"11":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":8},"end":{"line":60,"column":8}},{"start":{"line":60,"column":8},"end":{"line":60,"column":8}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var WorkbookViewXform = module.exports = function() {","};","","utils.inherits(WorkbookViewXform, BaseXform, {","  // \t\t<workbookView visibility=\"hidden\" xWindow=\"0\" yWindow=\"0\" windowWidth=\"23040\" windowHeight=\"8808\"/>","","  render: function(xmlStream, model) {","    var attributes = {","      xWindow: model.x || 0,","      yWindow: model.y || 0,","      windowWidth: model.width || 12000,","      windowHeight: model.height || 24000,","      firstSheet: model.firstSheet,","      activeTab: model.activeTab","    };","    if (model.visibility && model.visibility !== 'visible') {","      attributes.visibility = model.visibility;","    }","    xmlStream.leafNode('workbookView', attributes);","  },","  ","  parseOpen: function(node) {","    if (node.name === 'workbookView') {","      var model = this.model = {};","      var addS = function(name, value, dflt) {","        var s = (value !== undefined) ? model[name] = value : dflt;","        if (s !== undefined) {","          model[name] = s;","        }","      };","      var addN = function(name, value, dflt) {","        var n = (value !== undefined) ? model[name] = parseInt(value) : dflt;","        if (n !== undefined) {","          model[name] = n;","        }","      };","      addN('x', node.attributes.xWindow, 0);","      addN('y', node.attributes.yWindow,  0);","      addN('width', node.attributes.windowWidth, 25000);","      addN('height', node.attributes.windowHeight, 10000);","      addS('visibility', node.attributes.visibility, 'visible');","      addN('activeTab', node.attributes.activeTab, undefined);","      addN('firstSheet', node.attributes.firstSheet, undefined);","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"35":0,"43":0,"44":0,"46":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"58":0,"59":0,"60":0,"61":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"73":0,"79":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/workbook-properties-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/book/workbook-properties-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":48},"end":{"line":28,"column":59}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":10},"end":{"line":33,"column":37}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":13},"end":{"line":41,"column":28}}},"4":{"name":"(anonymous_4)","line":51,"loc":{"start":{"line":51,"column":13},"end":{"line":51,"column":24}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":14},"end":{"line":53,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":56,"column":3}},"5":{"start":{"line":34,"column":4},"end":{"line":38,"column":7}},"6":{"start":{"line":42,"column":4},"end":{"line":49,"column":5}},"7":{"start":{"line":43,"column":6},"end":{"line":45,"column":8}},"8":{"start":{"line":46,"column":6},"end":{"line":46,"column":18}},"9":{"start":{"line":48,"column":6},"end":{"line":48,"column":19}},"10":{"start":{"line":54,"column":4},"end":{"line":54,"column":17}}},"branchMap":{"1":{"line":35,"type":"cond-expr","locations":[{"start":{"line":35,"column":33},"end":{"line":35,"column":34}},{"start":{"line":35,"column":37},"end":{"line":35,"column":46}}]},"2":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var WorksheetPropertiesXform = module.exports = function() {","};","","utils.inherits(WorksheetPropertiesXform, BaseXform, {","","  render: function(xmlStream, model) {","    xmlStream.leafNode('workbookPr', {","      date1904: model.date1904 ? 1 : undefined,","      defaultThemeVersion: 164011,","      filterPrivacy: 1","    });","  },","","  parseOpen: function(node) {","    if (node.name === 'workbookPr') {","      this.model = {","        date1904: node.attributes.date1904 === '1'","      };","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"34":0,"42":0,"43":0,"46":0,"48":0,"54":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/worksheet-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/worksheet-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0,0,0],"16":[0,0,0],"17":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"(anonymous_1)","line":49,"loc":{"start":{"line":49,"column":38},"end":{"line":49,"column":49}}},"2":{"name":"(anonymous_2)","line":76,"loc":{"start":{"line":76,"column":11},"end":{"line":76,"column":36}}},"3":{"name":"(anonymous_3)","line":87,"loc":{"start":{"line":87,"column":10},"end":{"line":87,"column":37}}},"4":{"name":"(anonymous_4)","line":127,"loc":{"start":{"line":127,"column":13},"end":{"line":127,"column":28}}},"5":{"name":"(anonymous_5)","line":132,"loc":{"start":{"line":132,"column":23},"end":{"line":132,"column":39}}},"6":{"name":"(anonymous_6)","line":144,"loc":{"start":{"line":144,"column":13},"end":{"line":144,"column":28}}},"7":{"name":"(anonymous_7)","line":149,"loc":{"start":{"line":149,"column":14},"end":{"line":149,"column":29}}},"8":{"name":"(anonymous_8)","line":190,"loc":{"start":{"line":190,"column":13},"end":{"line":190,"column":38}}},"9":{"name":"(anonymous_9)","line":196,"loc":{"start":{"line":196,"column":49},"end":{"line":196,"column":64}}},"10":{"name":"(anonymous_10)","line":199,"loc":{"start":{"line":199,"column":23},"end":{"line":199,"column":38}}},"11":{"name":"(anonymous_11)","line":200,"loc":{"start":{"line":200,"column":48},"end":{"line":200,"column":64}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":45}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":44}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":53}},"5":{"start":{"line":31,"column":0},"end":{"line":31,"column":33}},"6":{"start":{"line":32,"column":0},"end":{"line":32,"column":46}},"7":{"start":{"line":34,"column":0},"end":{"line":34,"column":41}},"8":{"start":{"line":35,"column":0},"end":{"line":35,"column":41}},"9":{"start":{"line":36,"column":0},"end":{"line":36,"column":38}},"10":{"start":{"line":37,"column":0},"end":{"line":37,"column":38}},"11":{"start":{"line":38,"column":0},"end":{"line":38,"column":50}},"12":{"start":{"line":39,"column":0},"end":{"line":39,"column":50}},"13":{"start":{"line":40,"column":0},"end":{"line":40,"column":51}},"14":{"start":{"line":41,"column":0},"end":{"line":41,"column":63}},"15":{"start":{"line":42,"column":0},"end":{"line":42,"column":63}},"16":{"start":{"line":43,"column":0},"end":{"line":43,"column":76}},"17":{"start":{"line":44,"column":0},"end":{"line":44,"column":51}},"18":{"start":{"line":45,"column":0},"end":{"line":45,"column":55}},"19":{"start":{"line":46,"column":0},"end":{"line":46,"column":51}},"20":{"start":{"line":47,"column":0},"end":{"line":47,"column":57}},"21":{"start":{"line":49,"column":0},"end":{"line":64,"column":2}},"22":{"start":{"line":50,"column":2},"end":{"line":63,"column":4}},"23":{"start":{"line":66,"column":0},"end":{"line":211,"column":3}},"24":{"start":{"line":77,"column":4},"end":{"line":77,"column":34}},"25":{"start":{"line":78,"column":4},"end":{"line":78,"column":47}},"26":{"start":{"line":80,"column":4},"end":{"line":80,"column":47}},"27":{"start":{"line":81,"column":4},"end":{"line":81,"column":52}},"28":{"start":{"line":83,"column":4},"end":{"line":83,"column":49}},"29":{"start":{"line":88,"column":4},"end":{"line":88,"column":50}},"30":{"start":{"line":89,"column":4},"end":{"line":89,"column":73}},"31":{"start":{"line":91,"column":4},"end":{"line":96,"column":18}},"32":{"start":{"line":97,"column":4},"end":{"line":102,"column":6}},"33":{"start":{"line":103,"column":4},"end":{"line":103,"column":70}},"34":{"start":{"line":104,"column":4},"end":{"line":109,"column":6}},"35":{"start":{"line":111,"column":4},"end":{"line":111,"column":61}},"36":{"start":{"line":112,"column":4},"end":{"line":112,"column":59}},"37":{"start":{"line":113,"column":4},"end":{"line":113,"column":55}},"38":{"start":{"line":114,"column":4},"end":{"line":114,"column":73}},"39":{"start":{"line":115,"column":4},"end":{"line":115,"column":48}},"40":{"start":{"line":116,"column":4},"end":{"line":116,"column":53}},"41":{"start":{"line":117,"column":4},"end":{"line":117,"column":60}},"42":{"start":{"line":118,"column":4},"end":{"line":118,"column":70}},"43":{"start":{"line":119,"column":4},"end":{"line":119,"column":60}},"44":{"start":{"line":120,"column":4},"end":{"line":120,"column":61}},"45":{"start":{"line":121,"column":4},"end":{"line":121,"column":63}},"46":{"start":{"line":122,"column":4},"end":{"line":122,"column":58}},"47":{"start":{"line":124,"column":4},"end":{"line":124,"column":26}},"48":{"start":{"line":128,"column":4},"end":{"line":142,"column":5}},"49":{"start":{"line":129,"column":6},"end":{"line":129,"column":34}},"50":{"start":{"line":130,"column":6},"end":{"line":130,"column":18}},"51":{"start":{"line":131,"column":11},"end":{"line":142,"column":5}},"52":{"start":{"line":132,"column":6},"end":{"line":134,"column":9}},"53":{"start":{"line":133,"column":8},"end":{"line":133,"column":22}},"54":{"start":{"line":135,"column":6},"end":{"line":135,"column":18}},"55":{"start":{"line":137,"column":6},"end":{"line":137,"column":40}},"56":{"start":{"line":138,"column":6},"end":{"line":140,"column":7}},"57":{"start":{"line":139,"column":8},"end":{"line":139,"column":36}},"58":{"start":{"line":141,"column":6},"end":{"line":141,"column":18}},"59":{"start":{"line":145,"column":4},"end":{"line":147,"column":5}},"60":{"start":{"line":146,"column":6},"end":{"line":146,"column":34}},"61":{"start":{"line":150,"column":4},"end":{"line":187,"column":5}},"62":{"start":{"line":151,"column":6},"end":{"line":153,"column":7}},"63":{"start":{"line":152,"column":8},"end":{"line":152,"column":32}},"64":{"start":{"line":154,"column":6},"end":{"line":154,"column":18}},"65":{"start":{"line":156,"column":6},"end":{"line":186,"column":7}},"66":{"start":{"line":158,"column":10},"end":{"line":158,"column":56}},"67":{"start":{"line":159,"column":10},"end":{"line":161,"column":11}},"68":{"start":{"line":160,"column":12},"end":{"line":160,"column":66}},"69":{"start":{"line":162,"column":10},"end":{"line":165,"column":12}},"70":{"start":{"line":166,"column":10},"end":{"line":170,"column":12}},"71":{"start":{"line":171,"column":10},"end":{"line":181,"column":12}},"72":{"start":{"line":182,"column":10},"end":{"line":182,"column":23}},"73":{"start":{"line":185,"column":10},"end":{"line":185,"column":22}},"74":{"start":{"line":193,"column":4},"end":{"line":193,"column":84}},"75":{"start":{"line":196,"column":4},"end":{"line":198,"column":13}},"76":{"start":{"line":197,"column":6},"end":{"line":197,"column":17}},"77":{"start":{"line":199,"column":4},"end":{"line":203,"column":7}},"78":{"start":{"line":200,"column":6},"end":{"line":202,"column":15}},"79":{"start":{"line":201,"column":8},"end":{"line":201,"column":20}},"80":{"start":{"line":205,"column":4},"end":{"line":205,"column":49}},"81":{"start":{"line":206,"column":4},"end":{"line":206,"column":54}},"82":{"start":{"line":208,"column":4},"end":{"line":208,"column":36}},"83":{"start":{"line":209,"column":4},"end":{"line":209,"column":33}}},"branchMap":{"1":{"line":91,"type":"cond-expr","locations":[{"start":{"line":91,"column":56},"end":{"line":96,"column":5}},{"start":{"line":96,"column":8},"end":{"line":96,"column":17}}]},"2":{"line":98,"type":"binary-expr","locations":[{"start":{"line":98,"column":16},"end":{"line":98,"column":32}},{"start":{"line":98,"column":36},"end":{"line":98,"column":61}}]},"3":{"line":99,"type":"cond-expr","locations":[{"start":{"line":99,"column":64},"end":{"line":101,"column":7}},{"start":{"line":101,"column":10},"end":{"line":101,"column":19}}]},"4":{"line":99,"type":"binary-expr","locations":[{"start":{"line":99,"column":17},"end":{"line":99,"column":32}},{"start":{"line":99,"column":36},"end":{"line":99,"column":61}}]},"5":{"line":103,"type":"binary-expr","locations":[{"start":{"line":103,"column":27},"end":{"line":103,"column":42}},{"start":{"line":103,"column":46},"end":{"line":103,"column":69}}]},"6":{"line":128,"type":"if","locations":[{"start":{"line":128,"column":4},"end":{"line":128,"column":4}},{"start":{"line":128,"column":4},"end":{"line":128,"column":4}}]},"7":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":11},"end":{"line":131,"column":11}},{"start":{"line":131,"column":11},"end":{"line":131,"column":11}}]},"8":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":6},"end":{"line":138,"column":6}},{"start":{"line":138,"column":6},"end":{"line":138,"column":6}}]},"9":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"10":{"line":150,"type":"if","locations":[{"start":{"line":150,"column":4},"end":{"line":150,"column":4}},{"start":{"line":150,"column":4},"end":{"line":150,"column":4}}]},"11":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":6},"end":{"line":151,"column":6}},{"start":{"line":151,"column":6},"end":{"line":151,"column":6}}]},"12":{"line":156,"type":"switch","locations":[{"start":{"line":157,"column":8},"end":{"line":182,"column":23}},{"start":{"line":183,"column":8},"end":{"line":185,"column":22}}]},"13":{"line":159,"type":"if","locations":[{"start":{"line":159,"column":10},"end":{"line":159,"column":10}},{"start":{"line":159,"column":10},"end":{"line":159,"column":10}}]},"14":{"line":159,"type":"binary-expr","locations":[{"start":{"line":159,"column":14},"end":{"line":159,"column":36}},{"start":{"line":159,"column":40},"end":{"line":159,"column":71}}]},"15":{"line":163,"type":"binary-expr","locations":[{"start":{"line":163,"column":24},"end":{"line":163,"column":46}},{"start":{"line":163,"column":50},"end":{"line":163,"column":82}},{"start":{"line":163,"column":86},"end":{"line":163,"column":128}},{"start":{"line":163,"column":133},"end":{"line":163,"column":138}}]},"16":{"line":196,"type":"binary-expr","locations":[{"start":{"line":196,"column":17},"end":{"line":196,"column":27}},{"start":{"line":196,"column":31},"end":{"line":198,"column":6}},{"start":{"line":198,"column":10},"end":{"line":198,"column":12}}]},"17":{"line":200,"type":"binary-expr","locations":[{"start":{"line":200,"column":18},"end":{"line":200,"column":27}},{"start":{"line":200,"column":31},"end":{"line":202,"column":8}},{"start":{"line":202,"column":12},"end":{"line":202,"column":14}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var events = require('events');","var _ = require('../../../utils/under-dash');","","var utils = require('../../../utils/utils');","var XmlStream = require('../../../utils/xml-stream');","","var Merges = require('./merges');","var HyperlinkMap = require('./hyperlink-map');","","var BaseXform = require('../base-xform');","var ListXform = require('../list-xform');","var RowXform = require('./row-xform');","var ColXform = require('./col-xform');","var DimensionXform = require('./dimension-xform');","var HyperlinkXform = require('./hyperlink-xform');","var MergeCellXform = require('./merge-cell-xform');","var DataValidationsXform = require('./data-validations-xform');","var SheetPropertiesXform = require('./sheet-properties-xform');","var SheetFormatPropertiesXform = require('./sheet-format-properties-xform');","var SheetViewXform = require('./sheet-view-xform');","var PageMarginsXform = require('./page-margins-xform');","var PageSetupXform = require('./page-setup-xform');","var PrintOptionsXform = require('./print-options-xform');","","var WorkSheetXform = module.exports = function() {","  this.map = {","    sheetPr: new SheetPropertiesXform(),","    dimension: new DimensionXform(),","    sheetViews: new ListXform({tag: 'sheetViews', count: false, childXform: new SheetViewXform()}),","    sheetFormatPr: new SheetFormatPropertiesXform(),","    cols: new ListXform({tag: 'cols', count: false, childXform: new ColXform()}),","    sheetData: new ListXform({tag: 'sheetData', count: false, empty: true, childXform: new RowXform()}),","    mergeCells: new ListXform({tag: 'mergeCells', count: true, childXform: new MergeCellXform()}),","    hyperlinks: new ListXform({tag: 'hyperlinks', count: false, childXform: new HyperlinkXform()}),","    pageMargins: new PageMarginsXform(),","    dataValidations: new DataValidationsXform(),","    pageSetup: new PageSetupXform(),","    printOptions: new PrintOptionsXform()","  };","};","","utils.inherits(WorkSheetXform, BaseXform, {","  WORKSHEET_ATTRIBUTES: {","    'xmlns': 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',","    'xmlns:r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',","    'xmlns:mc': 'http://schemas.openxmlformats.org/markup-compatibility/2006',","    'mc:Ignorable': 'x14ac',","    'xmlns:x14ac': 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac'","  }","},{","","  prepare: function(model, options) {","    options.merges = new Merges();","    model.hyperlinks = options.hyperlinks = [];","","    this.map.cols.prepare(model.cols, options);","    this.map.sheetData.prepare(model.rows, options);","","    model.mergeCells = options.merges.mergeCells;","    ","  },","","  render: function(xmlStream, model) {","    xmlStream.openXml(XmlStream.StdDocAttributes);","    xmlStream.openNode('worksheet', WorkSheetXform.WORKSHEET_ATTRIBUTES);","","    var sheetFormatPropertiesModel = model.properties ? {","      defaultRowHeight: model.properties.defaultRowHeight,","      dyDescent: model.properties.dyDescent,","      outlineLevelCol: model.properties.outlineLevelCol,","      outlineLevelRow: model.properties.outlineLevelRow","    } : undefined;","    var sheetPropertiesModel = {","      tabColor: model.properties && model.properties.tabColor,","      pageSetup: model.pageSetup && model.pageSetup.fitToPage ? {","        fitToPage: model.pageSetup.fitToPage","      } : undefined","    };","    var pageMarginsModel = model.pageSetup && model.pageSetup.margins;","    var printOptionsModel = {","      showRowColHeaders: model.showRowColHeaders,","      showGridLines: model.showGridLines,","      horizontalCentered: model.horizontalCentered,","      verticalCentered: model.verticalCentered","    };","","    this.map.sheetPr.render(xmlStream, sheetPropertiesModel);","    this.map.dimension.render(xmlStream, model.dimensions);","    this.map.sheetViews.render(xmlStream, model.views);","    this.map.sheetFormatPr.render(xmlStream, sheetFormatPropertiesModel);","    this.map.cols.render(xmlStream, model.cols);","    this.map.sheetData.render(xmlStream, model.rows);","    this.map.mergeCells.render(xmlStream, model.mergeCells);","    this.map.dataValidations.render(xmlStream, model.dataValidations);","    this.map.hyperlinks.render(xmlStream, model.hyperlinks);//For some reason hyperlinks have to be after the data validations","    this.map.pageMargins.render(xmlStream, pageMarginsModel);","    this.map.printOptions.render(xmlStream, printOptionsModel);","    this.map.pageSetup.render(xmlStream, model.pageSetup);","","    xmlStream.closeNode();","  },","","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else if (node.name === 'worksheet') {","      _.each(this.map, function(xform) {","        xform.reset();","      });","      return true;","    } else {","      this.parser = this.map[node.name];","      if (this.parser) {","        this.parser.parseOpen(node);","      }","      return true;","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      switch(name) {","        case 'worksheet':","          var properties = this.map.sheetFormatPr.model;","          if (this.map.sheetPr.model && this.map.sheetPr.model.tabColor) {","            properties.tabColor = this.map.sheetPr.model.tabColor;","          }","          var sheetProperties = {","            fitToPage: (this.map.sheetPr.model && this.map.sheetPr.model.pageSetup && this.map.sheetPr.model.pageSetup.fitToPage) || false,","            margins: this.map.pageMargins.model","          };","          var pageSetup = Object.assign(","            sheetProperties,","            this.map.pageSetup.model,","            this.map.printOptions.model","          );","          this.model = {","            dimensions: this.map.dimension.model,","            cols: this.map.cols.model,","            rows: this.map.sheetData.model,","            mergeCells: this.map.mergeCells.model,","            hyperlinks: this.map.hyperlinks.model,","            dataValidations: this.map.dataValidations.model,","            properties: properties,","            views: this.map.sheetViews.model,","            pageSetup: pageSetup","          };","          return false;","        default:","          // not quite sure how we get here!","          return true;","      }","    }","  },","","  reconcile: function(model, options) {","    // options.merges = new Merges();","    // options.merges.reconcile(model.mergeCells, model.rows);","    options.hyperlinkMap  = new HyperlinkMap(model.relationships, model.hyperlinks);","","    // compact the rows and cells","    model.rows = model.rows && model.rows.filter(function (row) {","      return row;","    }) || [];","    model.rows.forEach(function (row) {","      row.cells = row.cells && row.cells.filter(function (cell) {","        return cell;","      }) || [];","    });","    ","    this.map.cols.reconcile(model.cols, options);","    this.map.sheetData.reconcile(model.rows, options);","","    model.relationships = undefined;","    model.hyperlinks = undefined;","  }","});","",""],"l":{"25":1,"26":1,"28":1,"29":1,"31":1,"32":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"49":1,"50":0,"66":1,"77":0,"78":0,"80":0,"81":0,"83":0,"88":0,"89":0,"91":0,"97":0,"103":0,"104":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"124":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"135":0,"137":0,"138":0,"139":0,"141":0,"145":0,"146":0,"150":0,"151":0,"152":0,"154":0,"156":0,"158":0,"159":0,"160":0,"162":0,"166":0,"171":0,"182":0,"185":0,"193":0,"196":0,"197":0,"199":0,"200":0,"201":0,"205":0,"206":0,"208":0,"209":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/merges.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/merges.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":30},"end":{"line":30,"column":41}}},"2":{"name":"(anonymous_2)","line":36,"loc":{"start":{"line":36,"column":8},"end":{"line":36,"column":24}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":16},"end":{"line":45,"column":19}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":30},"end":{"line":46,"column":46}}},"5":{"name":"(anonymous_5)","line":50,"loc":{"start":{"line":50,"column":13},"end":{"line":50,"column":40}}},"6":{"name":"(anonymous_6)","line":52,"loc":{"start":{"line":52,"column":23},"end":{"line":52,"column":40}}},"7":{"name":"(anonymous_7)","line":71,"loc":{"start":{"line":71,"column":21},"end":{"line":71,"column":39}}}},"statementMap":{"1":{"start":{"line":24,"column":0},"end":{"line":24,"column":45}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":42}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":51}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":42}},"5":{"start":{"line":30,"column":0},"end":{"line":33,"column":2}},"6":{"start":{"line":32,"column":2},"end":{"line":32,"column":19}},"7":{"start":{"line":35,"column":0},"end":{"line":78,"column":2}},"8":{"start":{"line":38,"column":4},"end":{"line":43,"column":5}},"9":{"start":{"line":39,"column":6},"end":{"line":39,"column":63}},"10":{"start":{"line":41,"column":6},"end":{"line":41,"column":53}},"11":{"start":{"line":42,"column":6},"end":{"line":42,"column":51}},"12":{"start":{"line":46,"column":4},"end":{"line":48,"column":7}},"13":{"start":{"line":47,"column":6},"end":{"line":47,"column":25}},"14":{"start":{"line":52,"column":4},"end":{"line":69,"column":7}},"15":{"start":{"line":53,"column":6},"end":{"line":53,"column":46}},"16":{"start":{"line":54,"column":6},"end":{"line":68,"column":7}},"17":{"start":{"line":55,"column":8},"end":{"line":55,"column":28}},"18":{"start":{"line":56,"column":8},"end":{"line":67,"column":9}},"19":{"start":{"line":57,"column":10},"end":{"line":57,"column":36}},"20":{"start":{"line":58,"column":10},"end":{"line":66,"column":11}},"21":{"start":{"line":60,"column":12},"end":{"line":63,"column":14}},"22":{"start":{"line":64,"column":17},"end":{"line":66,"column":11}},"23":{"start":{"line":65,"column":12},"end":{"line":65,"column":40}},"24":{"start":{"line":73,"column":4},"end":{"line":73,"column":35}},"25":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"26":{"start":{"line":75,"column":6},"end":{"line":75,"column":22}}},"branchMap":{"1":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":4}},{"start":{"line":38,"column":4},"end":{"line":38,"column":4}}]},"2":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":10},"end":{"line":58,"column":10}},{"start":{"line":58,"column":10},"end":{"line":58,"column":10}}]},"3":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":17},"end":{"line":64,"column":17}},{"start":{"line":64,"column":17},"end":{"line":64,"column":17}}]},"4":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":74,"column":4}},{"start":{"line":74,"column":4},"end":{"line":74,"column":4}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","var _ = require('../../../utils/under-dash');","","var Range = require('../../../doc/range');","var colCache = require('../../../utils/col-cache');","var Enums = require('../../../doc/enums');","","var Merges = module.exports = function() {","  // optional mergeCells is array of ranges (like the xml)","  this.merges = {};","};","","Merges.prototype = {","  add:  function(merge) {","    // merge is {address, master}","    if (this.merges[merge.master]) {","      this.merges[merge.master].expandToAddress(merge.address);","    } else {","      var range = merge.master + ':' + merge.address;","      this.merges[merge.master] = new Range(range);","    }","  },","  get mergeCells() {","    return _.map(this.merges, function(merge) {","      return merge.range;","    });","  },","  reconcile: function(mergeCells, rows) {","    // reconcile merge list with merge cells","    _.each(mergeCells, function (merge) {","      var dimensions = colCache.decode(merge);","      for (var i = dimensions.top; i <= dimensions.bottom; i++) {","        var row = rows[i-1];","        for (var j = dimensions.left; j <= dimensions.right; j++) {","          var cell = row.cells[j-1];","          if (!cell) {","            // nulls are not included in document - so if master cell has no value - add a null one here","            row.cells[j] = {","              type: Enums.ValueType.Null,","              address: colCache.encodeAddress(i, j)","            };","          } else if (cell.type === Enums.ValueType.Merge) {","            cell.master = dimensions.tl;","          }","        }","      }","    });","  },","  getMasterAddress:  function(address) {","    // if address has been merged, return its master's address. Assumes reconcile has been called","    var range = this.hash[address];","    if (range) {","      return range.tl;","    }","  }","};"],"l":{"24":1,"26":1,"27":1,"28":1,"30":1,"32":0,"35":1,"38":0,"39":0,"41":0,"42":0,"46":0,"47":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"60":0,"64":0,"65":0,"73":0,"74":0,"75":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/hyperlink-map.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/hyperlink-map.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"(anonymous_1)","line":25,"loc":{"start":{"line":25,"column":19},"end":{"line":25,"column":55}}},"2":{"name":"(anonymous_2)","line":29,"loc":{"start":{"line":29,"column":26},"end":{"line":29,"column":50}}},"3":{"name":"(anonymous_3)","line":33,"loc":{"start":{"line":33,"column":23},"end":{"line":33,"column":44}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":16},"end":{"line":40,"column":34}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":37,"column":2}},"2":{"start":{"line":26,"column":2},"end":{"line":26,"column":16}},"3":{"start":{"line":27,"column":2},"end":{"line":27,"column":26}},"4":{"start":{"line":28,"column":2},"end":{"line":36,"column":3}},"5":{"start":{"line":29,"column":4},"end":{"line":31,"column":7}},"6":{"start":{"line":30,"column":6},"end":{"line":30,"column":51}},"7":{"start":{"line":33,"column":4},"end":{"line":35,"column":7}},"8":{"start":{"line":34,"column":6},"end":{"line":34,"column":51}},"9":{"start":{"line":39,"column":0},"end":{"line":43,"column":2}},"10":{"start":{"line":41,"column":4},"end":{"line":41,"column":29}},"11":{"start":{"line":45,"column":0},"end":{"line":45,"column":30}}},"branchMap":{"1":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":2},"end":{"line":28,"column":2}},{"start":{"line":28,"column":2},"end":{"line":28,"column":2}}]},"2":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":6},"end":{"line":28,"column":19}},{"start":{"line":28,"column":23},"end":{"line":28,"column":33}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var HyperlinkMap = function(relationships, hyperlinks) {","  var rels = {};","  var map = this.map = {};","  if (relationships && hyperlinks) {","    relationships.forEach(function (relationship) {","      rels[relationship.rId] = relationship.target;","    });","","    hyperlinks.forEach(function (hyperlink) {","      map[hyperlink.address] = rels[hyperlink.rId];","    });","  }","};","","HyperlinkMap.prototype = {","  getHyperlink: function(address) {","    return this.map[address];","  }","};","","module.exports = HyperlinkMap;",""],"l":{"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"33":0,"34":0,"39":1,"41":0,"45":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/row-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/row-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":32},"end":{"line":30,"column":43}}},"2":{"name":"(anonymous_2)","line":48,"loc":{"start":{"line":48,"column":9},"end":{"line":48,"column":12}}},"3":{"name":"(anonymous_3)","line":50,"loc":{"start":{"line":50,"column":11},"end":{"line":50,"column":36}}},"4":{"name":"(anonymous_4)","line":56,"loc":{"start":{"line":56,"column":24},"end":{"line":56,"column":44}}},"5":{"name":"(anonymous_5)","line":61,"loc":{"start":{"line":61,"column":10},"end":{"line":61,"column":46}}},"6":{"name":"(anonymous_6)","line":87,"loc":{"start":{"line":87,"column":24},"end":{"line":87,"column":44}}},"7":{"name":"(anonymous_7)","line":94,"loc":{"start":{"line":94,"column":13},"end":{"line":94,"column":28}}},"8":{"name":"(anonymous_8)","line":99,"loc":{"start":{"line":99,"column":79},"end":{"line":99,"column":94}}},"9":{"name":"(anonymous_9)","line":132,"loc":{"start":{"line":132,"column":13},"end":{"line":132,"column":28}}},"10":{"name":"(anonymous_10)","line":137,"loc":{"start":{"line":137,"column":14},"end":{"line":137,"column":29}}},"11":{"name":"(anonymous_11)","line":149,"loc":{"start":{"line":149,"column":13},"end":{"line":149,"column":38}}},"12":{"name":"(anonymous_12)","line":156,"loc":{"start":{"line":156,"column":24},"end":{"line":156,"column":44}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":40}},"4":{"start":{"line":30,"column":0},"end":{"line":34,"column":2}},"5":{"start":{"line":31,"column":2},"end":{"line":33,"column":4}},"6":{"start":{"line":46,"column":0},"end":{"line":160,"column":3}},"7":{"start":{"line":48,"column":14},"end":{"line":48,"column":27}},"8":{"start":{"line":51,"column":4},"end":{"line":51,"column":60}},"9":{"start":{"line":52,"column":4},"end":{"line":54,"column":5}},"10":{"start":{"line":53,"column":6},"end":{"line":53,"column":30}},"11":{"start":{"line":55,"column":4},"end":{"line":55,"column":31}},"12":{"start":{"line":56,"column":4},"end":{"line":58,"column":7}},"13":{"start":{"line":57,"column":6},"end":{"line":57,"column":44}},"14":{"start":{"line":62,"column":4},"end":{"line":62,"column":30}},"15":{"start":{"line":63,"column":4},"end":{"line":63,"column":47}},"16":{"start":{"line":64,"column":4},"end":{"line":67,"column":5}},"17":{"start":{"line":65,"column":6},"end":{"line":65,"column":50}},"18":{"start":{"line":66,"column":6},"end":{"line":66,"column":50}},"19":{"start":{"line":68,"column":4},"end":{"line":70,"column":5}},"20":{"start":{"line":69,"column":6},"end":{"line":69,"column":45}},"21":{"start":{"line":71,"column":4},"end":{"line":73,"column":5}},"22":{"start":{"line":72,"column":6},"end":{"line":72,"column":67}},"23":{"start":{"line":74,"column":4},"end":{"line":77,"column":5}},"24":{"start":{"line":75,"column":6},"end":{"line":75,"column":50}},"25":{"start":{"line":76,"column":6},"end":{"line":76,"column":50}},"26":{"start":{"line":78,"column":4},"end":{"line":78,"column":54}},"27":{"start":{"line":79,"column":4},"end":{"line":81,"column":5}},"28":{"start":{"line":80,"column":6},"end":{"line":80,"column":66}},"29":{"start":{"line":82,"column":4},"end":{"line":84,"column":5}},"30":{"start":{"line":83,"column":6},"end":{"line":83,"column":48}},"31":{"start":{"line":86,"column":4},"end":{"line":86,"column":31}},"32":{"start":{"line":87,"column":4},"end":{"line":89,"column":7}},"33":{"start":{"line":88,"column":6},"end":{"line":88,"column":54}},"34":{"start":{"line":91,"column":4},"end":{"line":91,"column":26}},"35":{"start":{"line":95,"column":4},"end":{"line":130,"column":5}},"36":{"start":{"line":96,"column":6},"end":{"line":96,"column":34}},"37":{"start":{"line":97,"column":6},"end":{"line":97,"column":18}},"38":{"start":{"line":98,"column":11},"end":{"line":130,"column":5}},"39":{"start":{"line":99,"column":6},"end":{"line":99,"column":147}},"40":{"start":{"line":99,"column":96},"end":{"line":99,"column":118}},"41":{"start":{"line":100,"column":6},"end":{"line":105,"column":8}},"42":{"start":{"line":106,"column":6},"end":{"line":108,"column":7}},"43":{"start":{"line":107,"column":8},"end":{"line":107,"column":52}},"44":{"start":{"line":109,"column":6},"end":{"line":111,"column":7}},"45":{"start":{"line":110,"column":8},"end":{"line":110,"column":28}},"46":{"start":{"line":112,"column":6},"end":{"line":114,"column":7}},"47":{"start":{"line":113,"column":8},"end":{"line":113,"column":29}},"48":{"start":{"line":115,"column":6},"end":{"line":117,"column":7}},"49":{"start":{"line":116,"column":8},"end":{"line":116,"column":54}},"50":{"start":{"line":118,"column":6},"end":{"line":120,"column":7}},"51":{"start":{"line":119,"column":8},"end":{"line":119,"column":68}},"52":{"start":{"line":121,"column":6},"end":{"line":123,"column":7}},"53":{"start":{"line":122,"column":8},"end":{"line":122,"column":31}},"54":{"start":{"line":124,"column":6},"end":{"line":124,"column":18}},"55":{"start":{"line":125,"column":11},"end":{"line":130,"column":5}},"56":{"start":{"line":126,"column":6},"end":{"line":126,"column":34}},"57":{"start":{"line":127,"column":6},"end":{"line":127,"column":18}},"58":{"start":{"line":129,"column":6},"end":{"line":129,"column":19}},"59":{"start":{"line":133,"column":4},"end":{"line":135,"column":5}},"60":{"start":{"line":134,"column":6},"end":{"line":134,"column":34}},"61":{"start":{"line":138,"column":4},"end":{"line":146,"column":5}},"62":{"start":{"line":139,"column":6},"end":{"line":142,"column":7}},"63":{"start":{"line":140,"column":8},"end":{"line":140,"column":49}},"64":{"start":{"line":141,"column":8},"end":{"line":141,"column":32}},"65":{"start":{"line":143,"column":6},"end":{"line":143,"column":18}},"66":{"start":{"line":145,"column":6},"end":{"line":145,"column":19}},"67":{"start":{"line":150,"column":4},"end":{"line":150,"column":83}},"68":{"start":{"line":151,"column":4},"end":{"line":153,"column":5}},"69":{"start":{"line":152,"column":6},"end":{"line":152,"column":32}},"70":{"start":{"line":155,"column":4},"end":{"line":155,"column":31}},"71":{"start":{"line":156,"column":4},"end":{"line":158,"column":7}},"72":{"start":{"line":157,"column":6},"end":{"line":157,"column":46}}},"branchMap":{"1":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"2":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":64,"column":4}},{"start":{"line":64,"column":4},"end":{"line":64,"column":4}}]},"3":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]},"4":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":4},"end":{"line":71,"column":4}},{"start":{"line":71,"column":4},"end":{"line":71,"column":4}}]},"5":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":8},"end":{"line":71,"column":21}},{"start":{"line":71,"column":25},"end":{"line":71,"column":38}},{"start":{"line":71,"column":42},"end":{"line":71,"column":64}}]},"6":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":74,"column":4}},{"start":{"line":74,"column":4},"end":{"line":74,"column":4}}]},"7":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"8":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":82,"column":4}},{"start":{"line":82,"column":4},"end":{"line":82,"column":4}}]},"9":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":4},"end":{"line":95,"column":4}},{"start":{"line":95,"column":4},"end":{"line":95,"column":4}}]},"10":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":11},"end":{"line":98,"column":11}},{"start":{"line":98,"column":11},"end":{"line":98,"column":11}}]},"11":{"line":99,"type":"cond-expr","locations":[{"start":{"line":99,"column":42},"end":{"line":99,"column":121}},{"start":{"line":99,"column":124},"end":{"line":99,"column":146}}]},"12":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":6},"end":{"line":106,"column":6}},{"start":{"line":106,"column":6},"end":{"line":106,"column":6}}]},"13":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":6},"end":{"line":109,"column":6}},{"start":{"line":109,"column":6},"end":{"line":109,"column":6}}]},"14":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":6},"end":{"line":112,"column":6}},{"start":{"line":112,"column":6},"end":{"line":112,"column":6}}]},"15":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":6},"end":{"line":115,"column":6}},{"start":{"line":115,"column":6},"end":{"line":115,"column":6}}]},"16":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":6},"end":{"line":118,"column":6}},{"start":{"line":118,"column":6},"end":{"line":118,"column":6}}]},"17":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":6},"end":{"line":121,"column":6}},{"start":{"line":121,"column":6},"end":{"line":121,"column":6}}]},"18":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":11},"end":{"line":125,"column":11}},{"start":{"line":125,"column":11},"end":{"line":125,"column":11}}]},"19":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":4},"end":{"line":133,"column":4}},{"start":{"line":133,"column":4},"end":{"line":133,"column":4}}]},"20":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":4},"end":{"line":138,"column":4}},{"start":{"line":138,"column":4},"end":{"line":138,"column":4}}]},"21":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":6},"end":{"line":139,"column":6}},{"start":{"line":139,"column":6},"end":{"line":139,"column":6}}]},"22":{"line":150,"type":"cond-expr","locations":[{"start":{"line":150,"column":34},"end":{"line":150,"column":77}},{"start":{"line":150,"column":80},"end":{"line":150,"column":82}}]},"23":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":4},"end":{"line":151,"column":4}},{"start":{"line":151,"column":4},"end":{"line":151,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var CellXform = require('./cell-xform');","","var RowXform = module.exports = function() {","  this.map = {","    c: new CellXform()","  };","};","","// <row r=\"<%=row.number%>\"","//     <% if(row.height) {%> ht=\"<%=row.height%>\" customHeight=\"1\"<% } %>","//     <% if(row.hidden) {%> hidden=\"1\"<% } %>","//     <% if(row.min > 0 && row.max > 0 && row.min <= row.max) {%> spans=\"<%=row.min%>:<%=row.max%>\"<% } %>","//     <% if (row.styleId) { %> s=\"<%=row.styleId%>\" customFormat=\"1\" <% } %>","//     x14ac:dyDescent=\"0.25\">","//   <% row.cells.forEach(function(cell){ %>","//     <%=cell.xml%><% }); %>","// </row>","","utils.inherits(RowXform, BaseXform, {","","  get tag() { return 'row'; },","","  prepare: function(model, options) {","    var styleId = options.styles.addStyleModel(model.style);","    if (styleId) {","      model.styleId = styleId;","    }","    var cellXform = this.map.c;","    model.cells.forEach(function(cellModel) {","      cellXform.prepare(cellModel, options);","    });","  },","  ","  render: function(xmlStream, model, options) {","    xmlStream.openNode('row');","    xmlStream.addAttribute('r',  model.number);","    if (model.height) {","      xmlStream.addAttribute('ht',  model.height);","      xmlStream.addAttribute('customHeight', '1');","    }","    if (model.hidden) {","      xmlStream.addAttribute('hidden',  '1');","    }","    if (model.min > 0 && model.max > 0 && model.min <= model.max) {","      xmlStream.addAttribute('spans', model.min + ':' + model.max);","    }","    if (model.styleId) {","      xmlStream.addAttribute('s',  model.styleId);","      xmlStream.addAttribute('customFormat', '1');","    }","    xmlStream.addAttribute('x14ac:dyDescent', '0.25');","    if (model.outlineLevel) {","      xmlStream.addAttribute('outlineLevel',  model.outlineLevel);","    }","    if (model.collapsed) {","      xmlStream.addAttribute('collapsed',  '1');","    }","","    var cellXform = this.map.c;","    model.cells.forEach(function(cellModel) {","      cellXform.render(xmlStream, cellModel, options);","    });","","    xmlStream.closeNode();","  },","  ","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else if (node.name === 'row') {","      var spans = node.attributes.spans ? node.attributes.spans.split(':').map(function(span) { return parseInt(span); }) : [undefined, undefined];","      var model = this.model = {","        number: parseInt(node.attributes.r),","        min: spans[0],","        max: spans[1],","        cells: []","      };","      if (node.attributes.s) {","        model.styleId = parseInt(node.attributes.s);","      }","      if (node.attributes.hidden) {","        model.hidden = true;","      }","      if (node.attributes.bestFit) {","        model.bestFit = true;","      }","      if (node.attributes.ht) {","        model.height = parseFloat(node.attributes.ht);","      }","      if (node.attributes.outlineLevel) {","        model.outlineLevel = parseInt(node.attributes.outlineLevel);","      }","      if (node.attributes.collapsed) {","        model.collapsed = true;","      }","      return true;","    } else if ((this.parser = this.map[node.name])) {","      this.parser.parseOpen(node);","      return true;","    } else {","      return false;","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.model.cells.push(this.parser.model);","        this.parser = undefined;","      }","      return true;","    } else {","      return false;","    }","  },","  ","  reconcile: function(model, options) {","    model.style = model.styleId ? options.styles.getStyleModel(model.styleId) : {};","    if (model.styleId != undefined) {","      model.styleId = undefined;","    }","","    var cellXform = this.map.c;","    model.cells.forEach(function(cellModel) {","      cellXform.reconcile(cellModel, options);","    });","  }","});",""],"l":{"25":1,"26":1,"28":1,"30":1,"31":1,"46":1,"48":0,"51":0,"52":0,"53":0,"55":0,"56":0,"57":0,"62":0,"63":0,"64":0,"65":0,"66":0,"68":0,"69":0,"71":0,"72":0,"74":0,"75":0,"76":0,"78":0,"79":0,"80":0,"82":0,"83":0,"86":0,"87":0,"88":0,"91":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"106":0,"107":0,"109":0,"110":0,"112":0,"113":0,"115":0,"116":0,"118":0,"119":0,"121":0,"122":0,"124":0,"125":0,"126":0,"127":0,"129":0,"133":0,"134":0,"138":0,"139":0,"140":0,"141":0,"143":0,"145":0,"150":0,"151":0,"152":0,"155":0,"156":0,"157":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/cell-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/cell-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":1,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0,0,0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0,0,0,0,0,0,0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0,0,0,0,0,0],"27":[0,0],"28":[0,0,0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0,0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0,0,0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0,0],"52":[0,0]},"f":{"1":0,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"fnMap":{"1":{"name":"getValueType","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":25}}},"2":{"name":"getEffectiveCellType","line":54,"loc":{"start":{"line":54,"column":0},"end":{"line":54,"column":36}}},"3":{"name":"(anonymous_3)","line":64,"loc":{"start":{"line":64,"column":33},"end":{"line":64,"column":44}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":9},"end":{"line":69,"column":12}}},"5":{"name":"(anonymous_5)","line":71,"loc":{"start":{"line":71,"column":11},"end":{"line":71,"column":36}}},"6":{"name":"(anonymous_6)","line":108,"loc":{"start":{"line":108,"column":10},"end":{"line":108,"column":37}}},"7":{"name":"(anonymous_7)","line":199,"loc":{"start":{"line":199,"column":13},"end":{"line":199,"column":28}}},"8":{"name":"(anonymous_8)","line":224,"loc":{"start":{"line":224,"column":13},"end":{"line":224,"column":28}}},"9":{"name":"(anonymous_9)","line":234,"loc":{"start":{"line":234,"column":14},"end":{"line":234,"column":29}}},"10":{"name":"(anonymous_10)","line":291,"loc":{"start":{"line":291,"column":13},"end":{"line":291,"column":38}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":42}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":40}},"5":{"start":{"line":32,"column":0},"end":{"line":52,"column":1}},"6":{"start":{"line":33,"column":2},"end":{"line":51,"column":3}},"7":{"start":{"line":34,"column":4},"end":{"line":34,"column":32}},"8":{"start":{"line":35,"column":9},"end":{"line":51,"column":3}},"9":{"start":{"line":36,"column":4},"end":{"line":36,"column":34}},"10":{"start":{"line":37,"column":9},"end":{"line":51,"column":3}},"11":{"start":{"line":38,"column":4},"end":{"line":38,"column":34}},"12":{"start":{"line":39,"column":9},"end":{"line":51,"column":3}},"13":{"start":{"line":40,"column":4},"end":{"line":40,"column":35}},"14":{"start":{"line":41,"column":9},"end":{"line":51,"column":3}},"15":{"start":{"line":42,"column":4},"end":{"line":42,"column":32}},"16":{"start":{"line":43,"column":9},"end":{"line":51,"column":3}},"17":{"start":{"line":44,"column":4},"end":{"line":44,"column":37}},"18":{"start":{"line":45,"column":9},"end":{"line":51,"column":3}},"19":{"start":{"line":46,"column":4},"end":{"line":46,"column":35}},"20":{"start":{"line":47,"column":9},"end":{"line":51,"column":3}},"21":{"start":{"line":48,"column":4},"end":{"line":48,"column":33}},"22":{"start":{"line":50,"column":4},"end":{"line":50,"column":60}},"23":{"start":{"line":54,"column":0},"end":{"line":61,"column":1}},"24":{"start":{"line":55,"column":2},"end":{"line":60,"column":3}},"25":{"start":{"line":57,"column":6},"end":{"line":57,"column":39}},"26":{"start":{"line":59,"column":6},"end":{"line":59,"column":23}},"27":{"start":{"line":64,"column":0},"end":{"line":65,"column":2}},"28":{"start":{"line":67,"column":0},"end":{"line":331,"column":3}},"29":{"start":{"line":69,"column":14},"end":{"line":69,"column":25}},"30":{"start":{"line":72,"column":4},"end":{"line":72,"column":95}},"31":{"start":{"line":73,"column":4},"end":{"line":75,"column":5}},"32":{"start":{"line":74,"column":6},"end":{"line":74,"column":30}},"33":{"start":{"line":77,"column":4},"end":{"line":105,"column":5}},"34":{"start":{"line":79,"column":8},"end":{"line":81,"column":9}},"35":{"start":{"line":80,"column":10},"end":{"line":80,"column":62}},"36":{"start":{"line":82,"column":8},"end":{"line":82,"column":14}},"37":{"start":{"line":85,"column":8},"end":{"line":87,"column":9}},"38":{"start":{"line":86,"column":10},"end":{"line":86,"column":32}},"39":{"start":{"line":88,"column":8},"end":{"line":88,"column":14}},"40":{"start":{"line":90,"column":8},"end":{"line":92,"column":9}},"41":{"start":{"line":91,"column":10},"end":{"line":91,"column":61}},"42":{"start":{"line":93,"column":8},"end":{"line":93,"column":56}},"43":{"start":{"line":94,"column":8},"end":{"line":100,"column":11}},"44":{"start":{"line":101,"column":8},"end":{"line":101,"column":14}},"45":{"start":{"line":103,"column":8},"end":{"line":103,"column":34}},"46":{"start":{"line":104,"column":8},"end":{"line":104,"column":14}},"47":{"start":{"line":109,"column":4},"end":{"line":112,"column":5}},"48":{"start":{"line":111,"column":6},"end":{"line":111,"column":13}},"49":{"start":{"line":114,"column":4},"end":{"line":114,"column":28}},"50":{"start":{"line":115,"column":4},"end":{"line":115,"column":47}},"51":{"start":{"line":117,"column":4},"end":{"line":119,"column":5}},"52":{"start":{"line":118,"column":6},"end":{"line":118,"column":49}},"53":{"start":{"line":121,"column":4},"end":{"line":194,"column":5}},"54":{"start":{"line":123,"column":8},"end":{"line":123,"column":14}},"55":{"start":{"line":125,"column":8},"end":{"line":125,"column":51}},"56":{"start":{"line":126,"column":8},"end":{"line":126,"column":14}},"57":{"start":{"line":128,"column":8},"end":{"line":128,"column":41}},"58":{"start":{"line":129,"column":8},"end":{"line":129,"column":63}},"59":{"start":{"line":130,"column":8},"end":{"line":130,"column":14}},"60":{"start":{"line":132,"column":8},"end":{"line":132,"column":41}},"61":{"start":{"line":133,"column":8},"end":{"line":133,"column":57}},"62":{"start":{"line":134,"column":8},"end":{"line":134,"column":14}},"63":{"start":{"line":136,"column":8},"end":{"line":142,"column":9}},"64":{"start":{"line":137,"column":10},"end":{"line":137,"column":43}},"65":{"start":{"line":138,"column":10},"end":{"line":138,"column":52}},"66":{"start":{"line":140,"column":10},"end":{"line":140,"column":45}},"67":{"start":{"line":141,"column":10},"end":{"line":141,"column":53}},"68":{"start":{"line":143,"column":8},"end":{"line":143,"column":14}},"69":{"start":{"line":145,"column":8},"end":{"line":145,"column":86}},"70":{"start":{"line":146,"column":8},"end":{"line":146,"column":14}},"71":{"start":{"line":148,"column":8},"end":{"line":154,"column":9}},"72":{"start":{"line":149,"column":10},"end":{"line":149,"column":43}},"73":{"start":{"line":150,"column":10},"end":{"line":150,"column":52}},"74":{"start":{"line":152,"column":10},"end":{"line":152,"column":45}},"75":{"start":{"line":153,"column":10},"end":{"line":153,"column":52}},"76":{"start":{"line":155,"column":8},"end":{"line":155,"column":14}},"77":{"start":{"line":157,"column":8},"end":{"line":189,"column":9}},"78":{"start":{"line":159,"column":12},"end":{"line":159,"column":57}},"79":{"start":{"line":160,"column":12},"end":{"line":160,"column":18}},"80":{"start":{"line":163,"column":12},"end":{"line":163,"column":47}},"81":{"start":{"line":164,"column":12},"end":{"line":164,"column":57}},"82":{"start":{"line":165,"column":12},"end":{"line":165,"column":56}},"83":{"start":{"line":166,"column":12},"end":{"line":166,"column":18}},"84":{"start":{"line":168,"column":12},"end":{"line":168,"column":57}},"85":{"start":{"line":169,"column":12},"end":{"line":169,"column":56}},"86":{"start":{"line":170,"column":12},"end":{"line":170,"column":18}},"87":{"start":{"line":172,"column":12},"end":{"line":172,"column":45}},"88":{"start":{"line":173,"column":12},"end":{"line":173,"column":57}},"89":{"start":{"line":174,"column":12},"end":{"line":174,"column":65}},"90":{"start":{"line":175,"column":12},"end":{"line":175,"column":18}},"91":{"start":{"line":177,"column":12},"end":{"line":177,"column":45}},"92":{"start":{"line":178,"column":12},"end":{"line":178,"column":57}},"93":{"start":{"line":179,"column":12},"end":{"line":179,"column":62}},"94":{"start":{"line":180,"column":12},"end":{"line":180,"column":18}},"95":{"start":{"line":182,"column":12},"end":{"line":182,"column":57}},"96":{"start":{"line":183,"column":12},"end":{"line":183,"column":91}},"97":{"start":{"line":184,"column":12},"end":{"line":184,"column":18}},"98":{"start":{"line":188,"column":12},"end":{"line":188,"column":68}},"99":{"start":{"line":190,"column":8},"end":{"line":190,"column":14}},"100":{"start":{"line":193,"column":8},"end":{"line":193,"column":14}},"101":{"start":{"line":196,"column":4},"end":{"line":196,"column":26}},"102":{"start":{"line":200,"column":4},"end":{"line":222,"column":5}},"103":{"start":{"line":203,"column":8},"end":{"line":205,"column":10}},"104":{"start":{"line":206,"column":8},"end":{"line":206,"column":35}},"105":{"start":{"line":207,"column":8},"end":{"line":209,"column":9}},"106":{"start":{"line":208,"column":10},"end":{"line":208,"column":54}},"107":{"start":{"line":210,"column":8},"end":{"line":210,"column":20}},"108":{"start":{"line":213,"column":8},"end":{"line":213,"column":31}},"109":{"start":{"line":214,"column":8},"end":{"line":214,"column":20}},"110":{"start":{"line":217,"column":8},"end":{"line":217,"column":31}},"111":{"start":{"line":218,"column":8},"end":{"line":218,"column":20}},"112":{"start":{"line":221,"column":8},"end":{"line":221,"column":21}},"113":{"start":{"line":225,"column":4},"end":{"line":232,"column":5}},"114":{"start":{"line":227,"column":8},"end":{"line":227,"column":83}},"115":{"start":{"line":228,"column":8},"end":{"line":228,"column":14}},"116":{"start":{"line":230,"column":8},"end":{"line":230,"column":78}},"117":{"start":{"line":231,"column":8},"end":{"line":231,"column":14}},"118":{"start":{"line":235,"column":4},"end":{"line":288,"column":5}},"119":{"start":{"line":237,"column":8},"end":{"line":237,"column":31}},"120":{"start":{"line":239,"column":8},"end":{"line":280,"column":9}},"121":{"start":{"line":240,"column":10},"end":{"line":240,"column":47}},"122":{"start":{"line":241,"column":10},"end":{"line":252,"column":11}},"123":{"start":{"line":242,"column":12},"end":{"line":250,"column":13}},"124":{"start":{"line":243,"column":14},"end":{"line":243,"column":58}},"125":{"start":{"line":244,"column":19},"end":{"line":250,"column":13}},"126":{"start":{"line":245,"column":14},"end":{"line":245,"column":56}},"127":{"start":{"line":246,"column":19},"end":{"line":250,"column":13}},"128":{"start":{"line":247,"column":14},"end":{"line":247,"column":52}},"129":{"start":{"line":249,"column":14},"end":{"line":249,"column":53}},"130":{"start":{"line":251,"column":12},"end":{"line":251,"column":36}},"131":{"start":{"line":253,"column":15},"end":{"line":280,"column":9}},"132":{"start":{"line":254,"column":10},"end":{"line":275,"column":11}},"133":{"start":{"line":256,"column":14},"end":{"line":256,"column":50}},"134":{"start":{"line":257,"column":14},"end":{"line":257,"column":50}},"135":{"start":{"line":258,"column":14},"end":{"line":258,"column":20}},"136":{"start":{"line":260,"column":14},"end":{"line":260,"column":50}},"137":{"start":{"line":261,"column":14},"end":{"line":261,"column":57}},"138":{"start":{"line":262,"column":14},"end":{"line":262,"column":20}},"139":{"start":{"line":264,"column":14},"end":{"line":264,"column":51}},"140":{"start":{"line":265,"column":14},"end":{"line":265,"column":56}},"141":{"start":{"line":266,"column":14},"end":{"line":266,"column":20}},"142":{"start":{"line":268,"column":14},"end":{"line":268,"column":49}},"143":{"start":{"line":269,"column":14},"end":{"line":269,"column":51}},"144":{"start":{"line":270,"column":14},"end":{"line":270,"column":20}},"145":{"start":{"line":272,"column":14},"end":{"line":272,"column":50}},"146":{"start":{"line":273,"column":14},"end":{"line":273,"column":52}},"147":{"start":{"line":274,"column":14},"end":{"line":274,"column":20}},"148":{"start":{"line":276,"column":15},"end":{"line":280,"column":9}},"149":{"start":{"line":277,"column":10},"end":{"line":277,"column":44}},"150":{"start":{"line":279,"column":10},"end":{"line":279,"column":45}},"151":{"start":{"line":281,"column":8},"end":{"line":281,"column":21}},"152":{"start":{"line":284,"column":8},"end":{"line":284,"column":37}},"153":{"start":{"line":285,"column":8},"end":{"line":285,"column":20}},"154":{"start":{"line":287,"column":8},"end":{"line":287,"column":21}},"155":{"start":{"line":292,"column":4},"end":{"line":292,"column":77}},"156":{"start":{"line":293,"column":4},"end":{"line":295,"column":5}},"157":{"start":{"line":294,"column":6},"end":{"line":294,"column":26}},"158":{"start":{"line":296,"column":4},"end":{"line":298,"column":5}},"159":{"start":{"line":297,"column":6},"end":{"line":297,"column":32}},"160":{"start":{"line":300,"column":4},"end":{"line":320,"column":5}},"161":{"start":{"line":302,"column":8},"end":{"line":304,"column":9}},"162":{"start":{"line":303,"column":10},"end":{"line":303,"column":69}},"163":{"start":{"line":305,"column":8},"end":{"line":307,"column":9}},"164":{"start":{"line":306,"column":10},"end":{"line":306,"column":48}},"165":{"start":{"line":308,"column":8},"end":{"line":308,"column":14}},"166":{"start":{"line":310,"column":8},"end":{"line":313,"column":9}},"167":{"start":{"line":311,"column":10},"end":{"line":311,"column":44}},"168":{"start":{"line":312,"column":10},"end":{"line":312,"column":73}},"169":{"start":{"line":314,"column":8},"end":{"line":314,"column":14}},"170":{"start":{"line":316,"column":8},"end":{"line":318,"column":9}},"171":{"start":{"line":317,"column":10},"end":{"line":317,"column":75}},"172":{"start":{"line":319,"column":8},"end":{"line":319,"column":14}},"173":{"start":{"line":323,"column":4},"end":{"line":323,"column":69}},"174":{"start":{"line":324,"column":4},"end":{"line":329,"column":5}},"175":{"start":{"line":325,"column":6},"end":{"line":325,"column":45}},"176":{"start":{"line":326,"column":6},"end":{"line":326,"column":31}},"177":{"start":{"line":327,"column":6},"end":{"line":327,"column":30}},"178":{"start":{"line":328,"column":6},"end":{"line":328,"column":34}}},"branchMap":{"1":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":2},"end":{"line":33,"column":2}},{"start":{"line":33,"column":2},"end":{"line":33,"column":2}}]},"2":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":7},"end":{"line":33,"column":17}},{"start":{"line":33,"column":23},"end":{"line":33,"column":38}}]},"3":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":9},"end":{"line":35,"column":9}},{"start":{"line":35,"column":9},"end":{"line":35,"column":9}}]},"4":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":14},"end":{"line":35,"column":33}},{"start":{"line":35,"column":39},"end":{"line":35,"column":60}}]},"5":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":9},"end":{"line":37,"column":9}},{"start":{"line":37,"column":9},"end":{"line":37,"column":9}}]},"6":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":9},"end":{"line":39,"column":9}},{"start":{"line":39,"column":9},"end":{"line":39,"column":9}}]},"7":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":9},"end":{"line":41,"column":9}},{"start":{"line":41,"column":9},"end":{"line":41,"column":9}}]},"8":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":9},"end":{"line":43,"column":9}},{"start":{"line":43,"column":9},"end":{"line":43,"column":9}}]},"9":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":13},"end":{"line":43,"column":19}},{"start":{"line":43,"column":23},"end":{"line":43,"column":34}}]},"10":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":9},"end":{"line":45,"column":9}},{"start":{"line":45,"column":9},"end":{"line":45,"column":9}}]},"11":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":9},"end":{"line":47,"column":9}},{"start":{"line":47,"column":9},"end":{"line":47,"column":9}}]},"12":{"line":55,"type":"switch","locations":[{"start":{"line":56,"column":4},"end":{"line":57,"column":39}},{"start":{"line":58,"column":4},"end":{"line":59,"column":23}}]},"13":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":47},"end":{"line":72,"column":58}},{"start":{"line":72,"column":62},"end":{"line":72,"column":64}}]},"14":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]},"15":{"line":77,"type":"switch","locations":[{"start":{"line":78,"column":6},"end":{"line":82,"column":14}},{"start":{"line":83,"column":6},"end":{"line":83,"column":32}},{"start":{"line":84,"column":6},"end":{"line":88,"column":14}},{"start":{"line":89,"column":6},"end":{"line":101,"column":14}},{"start":{"line":102,"column":6},"end":{"line":104,"column":14}}]},"16":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":8},"end":{"line":79,"column":8}},{"start":{"line":79,"column":8},"end":{"line":79,"column":8}}]},"17":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":8},"end":{"line":85,"column":8}},{"start":{"line":85,"column":8},"end":{"line":85,"column":8}}]},"18":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":8},"end":{"line":90,"column":8}},{"start":{"line":90,"column":8},"end":{"line":90,"column":8}}]},"19":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":4},"end":{"line":109,"column":4}},{"start":{"line":109,"column":4},"end":{"line":109,"column":4}}]},"20":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":9},"end":{"line":109,"column":44}},{"start":{"line":109,"column":49},"end":{"line":109,"column":63}}]},"21":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":117,"column":4}},{"start":{"line":117,"column":4},"end":{"line":117,"column":4}}]},"22":{"line":121,"type":"switch","locations":[{"start":{"line":122,"column":6},"end":{"line":123,"column":14}},{"start":{"line":124,"column":6},"end":{"line":126,"column":14}},{"start":{"line":127,"column":6},"end":{"line":130,"column":14}},{"start":{"line":131,"column":6},"end":{"line":134,"column":14}},{"start":{"line":135,"column":6},"end":{"line":143,"column":14}},{"start":{"line":144,"column":6},"end":{"line":146,"column":14}},{"start":{"line":147,"column":6},"end":{"line":155,"column":14}},{"start":{"line":156,"column":6},"end":{"line":190,"column":14}},{"start":{"line":191,"column":6},"end":{"line":193,"column":14}}]},"23":{"line":129,"type":"cond-expr","locations":[{"start":{"line":129,"column":52},"end":{"line":129,"column":55}},{"start":{"line":129,"column":58},"end":{"line":129,"column":61}}]},"24":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":8},"end":{"line":136,"column":8}},{"start":{"line":136,"column":8},"end":{"line":136,"column":8}}]},"25":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":8},"end":{"line":148,"column":8}},{"start":{"line":148,"column":8},"end":{"line":148,"column":8}}]},"26":{"line":157,"type":"switch","locations":[{"start":{"line":158,"column":10},"end":{"line":160,"column":18}},{"start":{"line":161,"column":10},"end":{"line":166,"column":18}},{"start":{"line":167,"column":10},"end":{"line":170,"column":18}},{"start":{"line":171,"column":10},"end":{"line":175,"column":18}},{"start":{"line":176,"column":10},"end":{"line":180,"column":18}},{"start":{"line":181,"column":10},"end":{"line":184,"column":18}},{"start":{"line":187,"column":10},"end":{"line":188,"column":68}}]},"27":{"line":174,"type":"cond-expr","locations":[{"start":{"line":174,"column":57},"end":{"line":174,"column":58}},{"start":{"line":174,"column":62},"end":{"line":174,"column":63}}]},"28":{"line":200,"type":"switch","locations":[{"start":{"line":201,"column":6},"end":{"line":210,"column":20}},{"start":{"line":212,"column":6},"end":{"line":214,"column":20}},{"start":{"line":216,"column":6},"end":{"line":218,"column":20}},{"start":{"line":220,"column":6},"end":{"line":221,"column":21}}]},"29":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":8},"end":{"line":207,"column":8}},{"start":{"line":207,"column":8},"end":{"line":207,"column":8}}]},"30":{"line":225,"type":"switch","locations":[{"start":{"line":226,"column":6},"end":{"line":228,"column":14}},{"start":{"line":229,"column":6},"end":{"line":231,"column":14}}]},"31":{"line":227,"type":"cond-expr","locations":[{"start":{"line":227,"column":50},"end":{"line":227,"column":75}},{"start":{"line":227,"column":78},"end":{"line":227,"column":82}}]},"32":{"line":230,"type":"cond-expr","locations":[{"start":{"line":230,"column":46},"end":{"line":230,"column":69}},{"start":{"line":230,"column":73},"end":{"line":230,"column":77}}]},"33":{"line":235,"type":"switch","locations":[{"start":{"line":236,"column":6},"end":{"line":281,"column":21}},{"start":{"line":282,"column":6},"end":{"line":282,"column":15}},{"start":{"line":283,"column":6},"end":{"line":285,"column":20}},{"start":{"line":286,"column":6},"end":{"line":287,"column":21}}]},"34":{"line":239,"type":"if","locations":[{"start":{"line":239,"column":8},"end":{"line":239,"column":8}},{"start":{"line":239,"column":8},"end":{"line":239,"column":8}}]},"35":{"line":241,"type":"if","locations":[{"start":{"line":241,"column":10},"end":{"line":241,"column":10}},{"start":{"line":241,"column":10},"end":{"line":241,"column":10}}]},"36":{"line":242,"type":"if","locations":[{"start":{"line":242,"column":12},"end":{"line":242,"column":12}},{"start":{"line":242,"column":12},"end":{"line":242,"column":12}}]},"37":{"line":244,"type":"if","locations":[{"start":{"line":244,"column":19},"end":{"line":244,"column":19}},{"start":{"line":244,"column":19},"end":{"line":244,"column":19}}]},"38":{"line":246,"type":"if","locations":[{"start":{"line":246,"column":19},"end":{"line":246,"column":19}},{"start":{"line":246,"column":19},"end":{"line":246,"column":19}}]},"39":{"line":253,"type":"if","locations":[{"start":{"line":253,"column":15},"end":{"line":253,"column":15}},{"start":{"line":253,"column":15},"end":{"line":253,"column":15}}]},"40":{"line":254,"type":"switch","locations":[{"start":{"line":255,"column":12},"end":{"line":258,"column":20}},{"start":{"line":259,"column":12},"end":{"line":262,"column":20}},{"start":{"line":263,"column":12},"end":{"line":266,"column":20}},{"start":{"line":267,"column":12},"end":{"line":270,"column":20}},{"start":{"line":271,"column":12},"end":{"line":274,"column":20}}]},"41":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":15},"end":{"line":276,"column":15}},{"start":{"line":276,"column":15},"end":{"line":276,"column":15}}]},"42":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":16},"end":{"line":292,"column":29}},{"start":{"line":292,"column":33},"end":{"line":292,"column":76}}]},"43":{"line":293,"type":"if","locations":[{"start":{"line":293,"column":4},"end":{"line":293,"column":4}},{"start":{"line":293,"column":4},"end":{"line":293,"column":4}}]},"44":{"line":296,"type":"if","locations":[{"start":{"line":296,"column":4},"end":{"line":296,"column":4}},{"start":{"line":296,"column":4},"end":{"line":296,"column":4}}]},"45":{"line":300,"type":"switch","locations":[{"start":{"line":301,"column":6},"end":{"line":308,"column":14}},{"start":{"line":309,"column":6},"end":{"line":314,"column":14}},{"start":{"line":315,"column":6},"end":{"line":319,"column":14}}]},"46":{"line":302,"type":"if","locations":[{"start":{"line":302,"column":8},"end":{"line":302,"column":8}},{"start":{"line":302,"column":8},"end":{"line":302,"column":8}}]},"47":{"line":305,"type":"if","locations":[{"start":{"line":305,"column":8},"end":{"line":305,"column":8}},{"start":{"line":305,"column":8},"end":{"line":305,"column":8}}]},"48":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8}},{"start":{"line":310,"column":8},"end":{"line":310,"column":8}}]},"49":{"line":310,"type":"binary-expr","locations":[{"start":{"line":310,"column":12},"end":{"line":310,"column":17}},{"start":{"line":310,"column":21},"end":{"line":310,"column":50}}]},"50":{"line":316,"type":"if","locations":[{"start":{"line":316,"column":8},"end":{"line":316,"column":8}},{"start":{"line":316,"column":8},"end":{"line":316,"column":8}}]},"51":{"line":316,"type":"binary-expr","locations":[{"start":{"line":316,"column":13},"end":{"line":316,"column":39}},{"start":{"line":316,"column":44},"end":{"line":316,"column":49}},{"start":{"line":316,"column":53},"end":{"line":316,"column":82}}]},"52":{"line":324,"type":"if","locations":[{"start":{"line":324,"column":4},"end":{"line":324,"column":4}},{"start":{"line":324,"column":4},"end":{"line":324,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var Enums = require('../../../doc/enums');","var RelType = require('../../rel-type');","","","function getValueType(v) {","  if ((v === null) || (v === undefined)) {","    return Enums.ValueType.Null;","  } else if ((v instanceof String) || (typeof v === 'string')) {","    return Enums.ValueType.String;","  } else if (typeof v === 'number') {","    return Enums.ValueType.Number;","  } else if (typeof v === 'boolean') {","    return Enums.ValueType.Boolean;","  } else if (v instanceof Date) {","    return Enums.ValueType.Date;","  } else if (v.text && v.hyperlink) {","    return Enums.ValueType.Hyperlink;","  } else if (v.formula) {","    return Enums.ValueType.Formula;","  } else if (v.error) {","    return Enums.ValueType.Error;","  } else {","    throw new Error('I could not understand type of value');","  }","}","","function getEffectiveCellType(cell) {","  switch (cell.type) {","    case Enums.ValueType.Formula:","      return getValueType(cell.result);","    default:","      return cell.type;","  }","}","","","var CellXform = module.exports = function() {","};","","utils.inherits(CellXform, BaseXform, {","","  get tag() { return 'c'; },","","  prepare: function(model, options) {","    var styleId = options.styles.addStyleModel(model.style || {}, getEffectiveCellType(model));","    if (styleId) {","      model.styleId = styleId;","    }","","    switch(model.type) {","      case Enums.ValueType.String:","        if (options.sharedStrings) {","          model.ssId = options.sharedStrings.add(model.value);","        }","        break;","      case Enums.ValueType.Date:","      case Enums.ValueType.Formula:","        if (options.date1904) {","          model.date1904 = true;","        }","        break;","      case Enums.ValueType.Hyperlink:","        if (options.sharedStrings) {","          model.ssId = options.sharedStrings.add(model.text);","        }","        var hyperlinkId = options.hyperlinks.length + 1;","        options.hyperlinks.push({","          address: model.address,","          rId: 'rId' + hyperlinkId,","          type: RelType.Hyperlink,","          target: model.hyperlink,","          targetMode: 'External'","        });","        break;","      case Enums.ValueType.Merge:","        options.merges.add(model);","        break;","    }","  },","","  render: function(xmlStream, model) {","    if ((model.type === Enums.ValueType.Null) && !model.styleId) {","      // if null and no style, exit","      return;","    }","","    xmlStream.openNode('c');","    xmlStream.addAttribute('r', model.address);","","    if (model.styleId) {","      xmlStream.addAttribute('s', model.styleId);","    }","","    switch (model.type) {","      case Enums.ValueType.Null:","        break;","      case Enums.ValueType.Number:","        xmlStream.leafNode('v', null, model.value);","        break;","      case Enums.ValueType.Boolean:","        xmlStream.addAttribute('t', 'b');","        xmlStream.leafNode('v', null, model.value ? '1' : '0');","        break;","      case Enums.ValueType.Error:","        xmlStream.addAttribute('t', 'e');","        xmlStream.leafNode('v', null, model.value.error);","        break;","      case Enums.ValueType.String:","        if (model.ssId !== undefined) {","          xmlStream.addAttribute('t', 's');","          xmlStream.leafNode('v', null, model.ssId);","        } else {","          xmlStream.addAttribute('t', 'str');","          xmlStream.leafNode('v', null, model.value);","        }","        break;","      case Enums.ValueType.Date:","        xmlStream.leafNode('v', null, utils.dateToExcel(model.value, model.date1904));","        break;","      case Enums.ValueType.Hyperlink:","        if (model.ssId !== undefined) {","          xmlStream.addAttribute('t', 's');","          xmlStream.leafNode('v', null, model.ssId);","        } else {","          xmlStream.addAttribute('t', 'str');","          xmlStream.leafNode('v', null, model.text);","        }","        break;","      case Enums.ValueType.Formula:","        switch (getValueType(model.result)) {","          case Enums.ValueType.Null: // ?","            xmlStream.leafNode('f', null, model.formula);","            break;","          case Enums.ValueType.String:","            // oddly, formula results don't ever use shared strings","            xmlStream.addAttribute('t', 'str');","            xmlStream.leafNode('f', null, model.formula);","            xmlStream.leafNode('v', null, model.result);","            break;","          case Enums.ValueType.Number:","            xmlStream.leafNode('f', null, model.formula);","            xmlStream.leafNode('v', null, model.result);","            break;","          case Enums.ValueType.Boolean:","            xmlStream.addAttribute('t', 'b');","            xmlStream.leafNode('f', null, model.formula);","            xmlStream.leafNode('v', null, model.result ? 1 :  0);","            break;","          case Enums.ValueType.Error:","            xmlStream.addAttribute('t', 'e');","            xmlStream.leafNode('f', null, model.formula);","            xmlStream.leafNode('v', null, model.result.error);","            break;","          case Enums.ValueType.Date:","            xmlStream.leafNode('f', null, model.formula);","            xmlStream.leafNode('v', null, utils.dateToExcel(model.result, model.date1904));","            break;","          // case Enums.ValueType.Hyperlink: // ??","          // case Enums.ValueType.Formula:","          default:","            throw new Error('I could not understand type of value');","        }","        break;","      case Enums.ValueType.Merge:","        // nothing to add","        break;","    }","","    xmlStream.closeNode(); //</c>","  },","  ","  parseOpen: function(node) {","    switch(node.name) {","      case 'c':","        //var address = colCache.decodeAddress(node.attributes.r);","        var model = this.model = {","          address: node.attributes.r","        };","        this.t = node.attributes.t;","        if (node.attributes.s) {","          model.styleId = parseInt(node.attributes.s);","        }","        return true;","","      case 'f':","        this.currentNode = 'f';","        return true;","","      case 'v':","        this.currentNode = 'v';","        return true;","","      default:","        return false;","    }","  },","  parseText: function(text) {","    switch(this.currentNode) {","      case 'f':","        this.model.formula = this.model.formula ? this.model.formula + text : text;","        break;","      case 'v':","        this.model.value = this.model.value ? this.model.value + text :  text;","        break;","    }","  },","  parseClose: function(name) {","    switch(name) {","      case 'c':","        var model = this.model;","        // first guess on cell type","        if (model.formula) {","          model.type = Enums.ValueType.Formula;","          if (model.value) {","            if (this.t === 'str') {","              model.result = utils.xmlDecode(model.value);","            } else if (this.t === 'b') {","              model.result = parseInt(model.value) != 0;","            } else if (this.t === 'e') {","              model.result = { error: model.value };","            } else {","              model.result = parseFloat(model.value);","            }","            model.value = undefined;","          }","        } else if (model.value !== undefined) {","          switch (this.t) {","            case 's':","              model.type = Enums.ValueType.String;","              model.value = parseInt(model.value);","              break;","            case 'str':","              model.type = Enums.ValueType.String;","              model.value = utils.xmlDecode(model.value);","              break;","            case 'b':","              model.type = Enums.ValueType.Boolean;","              model.value = parseInt(model.value) !== 0;","              break;","            case 'e':","              model.type = Enums.ValueType.Error;","              model.value = { error: model.value };","              break;","            default:","              model.type = Enums.ValueType.Number;","              model.value = parseFloat(model.value);","              break;","          }","        } else if (model.styleId) {","          model.type = Enums.ValueType.Null;","        } else {","          model.type = Enums.ValueType.Merge;","        }","        return false;","      case 'f':","      case 'v':","        this.currentNode = undefined;","        return true;","      default:","        return false;","    }","  },","","  reconcile: function(model, options) {","    var style = model.styleId && options.styles.getStyleModel(model.styleId);","    if (style) {","      model.style = style;","    }","    if (model.styleId !== undefined) {","      model.styleId = undefined;","    }","","    switch (model.type) {","      case Enums.ValueType.String:","        if (typeof model.value === 'number') {","          model.value = options.sharedStrings.getString(model.value);","        }","        if (model.value.richText) {","          model.type = Enums.ValueType.RichText;","        }","        break;","      case Enums.ValueType.Number:","        if (style && utils.isDateFmt(style.numFmt)) {","          model.type = Enums.ValueType.Date;","          model.value = utils.excelToDate(model.value, options.date1904);","        }","        break;","      case Enums.ValueType.Formula:","        if ((model.result !== undefined) && style && utils.isDateFmt(style.numFmt)) {","          model.result = utils.excelToDate(model.result, options.date1904);","        }","        break;","    }","    ","    // look for hyperlink","    var hyperlink = options.hyperlinkMap.getHyperlink(model.address);","    if (hyperlink) {","      model.type = Enums.ValueType.Hyperlink;","      model.text = model.value;","      model.value = undefined;","      model.hyperlink = hyperlink;","    }","  }","});",""],"l":{"25":1,"26":1,"28":1,"29":1,"32":1,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"50":0,"54":1,"55":0,"57":0,"59":0,"64":1,"67":1,"69":0,"72":0,"73":0,"74":0,"77":0,"79":0,"80":0,"82":0,"85":0,"86":0,"88":0,"90":0,"91":0,"93":0,"94":0,"101":0,"103":0,"104":0,"109":0,"111":0,"114":0,"115":0,"117":0,"118":0,"121":0,"123":0,"125":0,"126":0,"128":0,"129":0,"130":0,"132":0,"133":0,"134":0,"136":0,"137":0,"138":0,"140":0,"141":0,"143":0,"145":0,"146":0,"148":0,"149":0,"150":0,"152":0,"153":0,"155":0,"157":0,"159":0,"160":0,"163":0,"164":0,"165":0,"166":0,"168":0,"169":0,"170":0,"172":0,"173":0,"174":0,"175":0,"177":0,"178":0,"179":0,"180":0,"182":0,"183":0,"184":0,"188":0,"190":0,"193":0,"196":0,"200":0,"203":0,"206":0,"207":0,"208":0,"210":0,"213":0,"214":0,"217":0,"218":0,"221":0,"225":0,"227":0,"228":0,"230":0,"231":0,"235":0,"237":0,"239":0,"240":0,"241":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"249":0,"251":0,"253":0,"254":0,"256":0,"257":0,"258":0,"260":0,"261":0,"262":0,"264":0,"265":0,"266":0,"268":0,"269":0,"270":0,"272":0,"273":0,"274":0,"276":0,"277":0,"279":0,"281":0,"284":0,"285":0,"287":0,"292":0,"293":0,"294":0,"296":0,"297":0,"300":0,"302":0,"303":0,"305":0,"306":0,"308":0,"310":0,"311":0,"312":0,"314":0,"316":0,"317":0,"319":0,"323":0,"324":0,"325":0,"326":0,"327":0,"328":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/rel-type.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/rel-type.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":33,"column":2}}},"branchMap":{},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," * "," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," * "," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," * "," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," * "," */","\"use strict\";","","module.exports = {","    OfficeDocument: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",","    Worksheet: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",","    CalcChain: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain\",","    SharedStrings: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",","    Styles: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",","    Theme: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",","    Hyperlink: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\"","};",""],"l":{"25":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/col-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/col-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":32},"end":{"line":28,"column":43}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":12}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":11},"end":{"line":35,"column":36}}},"4":{"name":"(anonymous_4)","line":42,"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":37}}},"5":{"name":"(anonymous_5)","line":68,"loc":{"start":{"line":68,"column":13},"end":{"line":68,"column":28}}},"6":{"name":"(anonymous_6)","line":95,"loc":{"start":{"line":95,"column":13},"end":{"line":95,"column":24}}},"7":{"name":"(anonymous_7)","line":97,"loc":{"start":{"line":97,"column":14},"end":{"line":97,"column":25}}},"8":{"name":"(anonymous_8)","line":101,"loc":{"start":{"line":101,"column":13},"end":{"line":101,"column":38}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":107,"column":3}},"5":{"start":{"line":33,"column":14},"end":{"line":33,"column":27}},"6":{"start":{"line":36,"column":4},"end":{"line":36,"column":66}},"7":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"8":{"start":{"line":38,"column":6},"end":{"line":38,"column":30}},"9":{"start":{"line":43,"column":4},"end":{"line":43,"column":30}},"10":{"start":{"line":44,"column":4},"end":{"line":44,"column":46}},"11":{"start":{"line":45,"column":4},"end":{"line":45,"column":46}},"12":{"start":{"line":46,"column":4},"end":{"line":48,"column":5}},"13":{"start":{"line":47,"column":6},"end":{"line":47,"column":51}},"14":{"start":{"line":49,"column":4},"end":{"line":51,"column":5}},"15":{"start":{"line":50,"column":6},"end":{"line":50,"column":54}},"16":{"start":{"line":52,"column":4},"end":{"line":54,"column":5}},"17":{"start":{"line":53,"column":6},"end":{"line":53,"column":45}},"18":{"start":{"line":55,"column":4},"end":{"line":57,"column":5}},"19":{"start":{"line":56,"column":6},"end":{"line":56,"column":46}},"20":{"start":{"line":58,"column":4},"end":{"line":60,"column":5}},"21":{"start":{"line":59,"column":6},"end":{"line":59,"column":66}},"22":{"start":{"line":61,"column":4},"end":{"line":63,"column":5}},"23":{"start":{"line":62,"column":6},"end":{"line":62,"column":48}},"24":{"start":{"line":64,"column":4},"end":{"line":64,"column":48}},"25":{"start":{"line":65,"column":4},"end":{"line":65,"column":26}},"26":{"start":{"line":69,"column":4},"end":{"line":93,"column":5}},"27":{"start":{"line":70,"column":6},"end":{"line":74,"column":8}},"28":{"start":{"line":75,"column":6},"end":{"line":77,"column":7}},"29":{"start":{"line":76,"column":8},"end":{"line":76,"column":56}},"30":{"start":{"line":78,"column":6},"end":{"line":80,"column":7}},"31":{"start":{"line":79,"column":8},"end":{"line":79,"column":28}},"32":{"start":{"line":81,"column":6},"end":{"line":83,"column":7}},"33":{"start":{"line":82,"column":8},"end":{"line":82,"column":29}},"34":{"start":{"line":84,"column":6},"end":{"line":86,"column":7}},"35":{"start":{"line":85,"column":8},"end":{"line":85,"column":68}},"36":{"start":{"line":87,"column":6},"end":{"line":89,"column":7}},"37":{"start":{"line":88,"column":8},"end":{"line":88,"column":31}},"38":{"start":{"line":90,"column":6},"end":{"line":90,"column":18}},"39":{"start":{"line":92,"column":6},"end":{"line":92,"column":19}},"40":{"start":{"line":98,"column":4},"end":{"line":98,"column":17}},"41":{"start":{"line":103,"column":4},"end":{"line":105,"column":5}},"42":{"start":{"line":104,"column":6},"end":{"line":104,"column":64}}},"branchMap":{"1":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":47},"end":{"line":36,"column":58}},{"start":{"line":36,"column":62},"end":{"line":36,"column":64}}]},"2":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"3":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":4},"end":{"line":46,"column":4}},{"start":{"line":46,"column":4},"end":{"line":46,"column":4}}]},"4":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":4},"end":{"line":49,"column":4}},{"start":{"line":49,"column":4},"end":{"line":49,"column":4}}]},"5":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"6":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":55,"column":4}},{"start":{"line":55,"column":4},"end":{"line":55,"column":4}}]},"7":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":58,"column":4}},{"start":{"line":58,"column":4},"end":{"line":58,"column":4}}]},"8":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":4}},{"start":{"line":61,"column":4},"end":{"line":61,"column":4}}]},"9":{"line":69,"type":"if","locations":[{"start":{"line":69,"column":4},"end":{"line":69,"column":4}},{"start":{"line":69,"column":4},"end":{"line":69,"column":4}}]},"10":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":22},"end":{"line":71,"column":41}},{"start":{"line":71,"column":45},"end":{"line":71,"column":48}}]},"11":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":22},"end":{"line":72,"column":41}},{"start":{"line":72,"column":45},"end":{"line":72,"column":48}}]},"12":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":26},"end":{"line":73,"column":47}},{"start":{"line":73,"column":51},"end":{"line":73,"column":54}}]},"13":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":6},"end":{"line":75,"column":6}},{"start":{"line":75,"column":6},"end":{"line":75,"column":6}}]},"14":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":6},"end":{"line":78,"column":6}},{"start":{"line":78,"column":6},"end":{"line":78,"column":6}}]},"15":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":6},"end":{"line":81,"column":6}},{"start":{"line":81,"column":6},"end":{"line":81,"column":6}}]},"16":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":6},"end":{"line":84,"column":6}},{"start":{"line":84,"column":6},"end":{"line":84,"column":6}}]},"17":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":6},"end":{"line":87,"column":6}},{"start":{"line":87,"column":6},"end":{"line":87,"column":6}}]},"18":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var ColXform = module.exports = function() {","};","","utils.inherits(ColXform, BaseXform, {","","  get tag() { return 'col'; },","","  prepare: function(model, options) {","    var styleId = options.styles.addStyleModel(model.style || {});","    if (styleId) {","      model.styleId = styleId;","    }","  },","  ","  render: function(xmlStream, model) {","    xmlStream.openNode('col');","    xmlStream.addAttribute('min',  model.min);","    xmlStream.addAttribute('max',  model.max);","    if (model.width) {","      xmlStream.addAttribute('width', model.width);","    }","    if (model.styleId) {","      xmlStream.addAttribute('style',  model.styleId);","    }","    if (model.hidden) {","      xmlStream.addAttribute('hidden',  '1');","    }","    if (model.bestFit) {","      xmlStream.addAttribute('bestFit',  '1');","    }","    if (model.outlineLevel) {","      xmlStream.addAttribute('outlineLevel',  model.outlineLevel);","    }","    if (model.collapsed) {","      xmlStream.addAttribute('collapsed',  '1');","    }","    xmlStream.addAttribute('customWidth',  '1');","    xmlStream.closeNode();","  },","  ","  parseOpen: function(node) {","    if (node.name === 'col') {","      var model = this.model = {","        min: parseInt(node.attributes.min || '0'),","        max: parseInt(node.attributes.max || '0'),","        width: parseFloat(node.attributes.width || '0')","      };","      if (node.attributes.style) {","        model.styleId = parseInt(node.attributes.style);","      }","      if (node.attributes.hidden) {","        model.hidden = true;","      }","      if (node.attributes.bestFit) {","        model.bestFit = true;","      }","      if (node.attributes.outlineLevel) {","        model.outlineLevel = parseInt(node.attributes.outlineLevel);","      }","      if (node.attributes.collapsed) {","        model.collapsed = true;","      }","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  },","  ","  reconcile: function(model, options) {","    // reconcile column styles","    if (model.styleId) {","      model.style = options.styles.getStyleModel(model.styleId);","    }","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"33":0,"36":0,"37":0,"38":0,"43":0,"44":0,"45":0,"46":0,"47":0,"49":0,"50":0,"52":0,"53":0,"55":0,"56":0,"58":0,"59":0,"61":0,"62":0,"64":0,"65":0,"69":0,"70":0,"75":0,"76":0,"78":0,"79":0,"81":0,"82":0,"84":0,"85":0,"87":0,"88":0,"90":0,"92":0,"98":0,"103":0,"104":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/dimension-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/dimension-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":38},"end":{"line":28,"column":49}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":12}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":10},"end":{"line":35,"column":37}}},"4":{"name":"(anonymous_4)","line":41,"loc":{"start":{"line":41,"column":13},"end":{"line":41,"column":28}}},"5":{"name":"(anonymous_5)","line":49,"loc":{"start":{"line":49,"column":13},"end":{"line":49,"column":24}}},"6":{"name":"(anonymous_6)","line":51,"loc":{"start":{"line":51,"column":14},"end":{"line":51,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":54,"column":3}},"5":{"start":{"line":33,"column":14},"end":{"line":33,"column":33}},"6":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"7":{"start":{"line":37,"column":6},"end":{"line":37,"column":52}},"8":{"start":{"line":42,"column":4},"end":{"line":47,"column":5}},"9":{"start":{"line":43,"column":6},"end":{"line":43,"column":39}},"10":{"start":{"line":44,"column":6},"end":{"line":44,"column":18}},"11":{"start":{"line":46,"column":6},"end":{"line":46,"column":19}},"12":{"start":{"line":52,"column":4},"end":{"line":52,"column":17}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":36,"column":4}},{"start":{"line":36,"column":4},"end":{"line":36,"column":4}}]},"2":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var DimensionXform = module.exports = function() {","};","","utils.inherits(DimensionXform, BaseXform, {","","  get tag() { return 'dimension'; },","","  render: function(xmlStream, model) {","    if (model) {","      xmlStream.leafNode('dimension', {ref: model});","    }","  },","  ","  parseOpen: function(node) {","    if (node.name === 'dimension') {","      this.model = node.attributes.ref;","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"33":0,"36":0,"37":0,"42":0,"43":0,"44":0,"46":0,"52":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/hyperlink-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/hyperlink-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"1":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":38},"end":{"line":28,"column":49}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":12}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":10},"end":{"line":35,"column":37}}},"4":{"name":"(anonymous_4)","line":42,"loc":{"start":{"line":42,"column":13},"end":{"line":42,"column":28}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":13},"end":{"line":53,"column":24}}},"6":{"name":"(anonymous_6)","line":55,"loc":{"start":{"line":55,"column":14},"end":{"line":55,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":58,"column":3}},"5":{"start":{"line":33,"column":14},"end":{"line":33,"column":33}},"6":{"start":{"line":36,"column":4},"end":{"line":39,"column":7}},"7":{"start":{"line":43,"column":4},"end":{"line":51,"column":5}},"8":{"start":{"line":44,"column":6},"end":{"line":47,"column":8}},"9":{"start":{"line":48,"column":6},"end":{"line":48,"column":18}},"10":{"start":{"line":50,"column":6},"end":{"line":50,"column":19}},"11":{"start":{"line":56,"column":4},"end":{"line":56,"column":17}}},"branchMap":{"1":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":4},"end":{"line":43,"column":4}},{"start":{"line":43,"column":4},"end":{"line":43,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var HyperlinkXform = module.exports = function() {","};","","utils.inherits(HyperlinkXform, BaseXform, {","","  get tag() { return 'hyperlink'; },","","  render: function(xmlStream, model) {","    xmlStream.leafNode('hyperlink', {","      ref: model.address,","      'r:id': model.rId","    });","  },","  ","  parseOpen: function(node) {","    if (node.name === 'hyperlink') {","      this.model = {","        address: node.attributes.ref,","        rId:  node.attributes['r:id']","      };","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"33":0,"36":0,"43":0,"44":0,"48":0,"50":0,"56":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/merge-cell-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/merge-cell-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":38},"end":{"line":28,"column":49}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":12}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":10},"end":{"line":35,"column":37}}},"4":{"name":"(anonymous_4)","line":39,"loc":{"start":{"line":39,"column":13},"end":{"line":39,"column":28}}},"5":{"name":"(anonymous_5)","line":47,"loc":{"start":{"line":47,"column":13},"end":{"line":47,"column":24}}},"6":{"name":"(anonymous_6)","line":49,"loc":{"start":{"line":49,"column":14},"end":{"line":49,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":52,"column":3}},"5":{"start":{"line":33,"column":14},"end":{"line":33,"column":33}},"6":{"start":{"line":36,"column":4},"end":{"line":36,"column":50}},"7":{"start":{"line":40,"column":4},"end":{"line":45,"column":5}},"8":{"start":{"line":41,"column":6},"end":{"line":41,"column":39}},"9":{"start":{"line":42,"column":6},"end":{"line":42,"column":18}},"10":{"start":{"line":44,"column":6},"end":{"line":44,"column":19}},"11":{"start":{"line":50,"column":4},"end":{"line":50,"column":17}}},"branchMap":{"1":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var MergeCellXform = module.exports = function() {","};","","utils.inherits(MergeCellXform, BaseXform, {","","  get tag() { return 'mergeCell'; },","","  render: function(xmlStream, model) {","    xmlStream.leafNode('mergeCell', {ref: model});","  },","  ","  parseOpen: function(node) {","    if (node.name === 'mergeCell') {","      this.model = node.attributes.ref;","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"33":0,"36":0,"40":0,"41":0,"42":0,"44":0,"50":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/data-validations-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/data-validations-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0,0,0],"25":[0,0,0,0,0],"26":[0,0],"27":[0,0],"28":[0,0,0,0,0]},"f":{"1":0,"2":0,"3":0,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"fnMap":{"1":{"name":"assign","line":45,"loc":{"start":{"line":45,"column":0},"end":{"line":45,"column":61}}},"2":{"name":"parseBool","line":53,"loc":{"start":{"line":53,"column":0},"end":{"line":53,"column":26}}},"3":{"name":"assignBool","line":62,"loc":{"start":{"line":62,"column":0},"end":{"line":62,"column":65}}},"4":{"name":"(anonymous_4)","line":71,"loc":{"start":{"line":71,"column":44},"end":{"line":71,"column":55}}},"5":{"name":"(anonymous_5)","line":76,"loc":{"start":{"line":76,"column":9},"end":{"line":76,"column":12}}},"6":{"name":"(anonymous_6)","line":78,"loc":{"start":{"line":78,"column":10},"end":{"line":78,"column":37}}},"7":{"name":"(anonymous_7)","line":83,"loc":{"start":{"line":83,"column":20},"end":{"line":83,"column":46}}},"8":{"name":"(anonymous_8)","line":117,"loc":{"start":{"line":117,"column":39},"end":{"line":117,"column":65}}},"9":{"name":"(anonymous_9)","line":131,"loc":{"start":{"line":131,"column":13},"end":{"line":131,"column":28}}},"10":{"name":"(anonymous_10)","line":176,"loc":{"start":{"line":176,"column":13},"end":{"line":176,"column":28}}},"11":{"name":"(anonymous_11)","line":179,"loc":{"start":{"line":179,"column":14},"end":{"line":179,"column":29}}}},"statementMap":{"1":{"start":{"line":24,"column":0},"end":{"line":24,"column":45}},"2":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"3":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"4":{"start":{"line":45,"column":0},"end":{"line":52,"column":1}},"5":{"start":{"line":46,"column":2},"end":{"line":46,"column":31}},"6":{"start":{"line":47,"column":2},"end":{"line":51,"column":3}},"7":{"start":{"line":48,"column":4},"end":{"line":48,"column":30}},"8":{"start":{"line":49,"column":9},"end":{"line":51,"column":3}},"9":{"start":{"line":50,"column":4},"end":{"line":50,"column":37}},"10":{"start":{"line":53,"column":0},"end":{"line":61,"column":1}},"11":{"start":{"line":54,"column":2},"end":{"line":60,"column":3}},"12":{"start":{"line":57,"column":6},"end":{"line":57,"column":18}},"13":{"start":{"line":59,"column":6},"end":{"line":59,"column":19}},"14":{"start":{"line":62,"column":0},"end":{"line":69,"column":1}},"15":{"start":{"line":63,"column":2},"end":{"line":63,"column":31}},"16":{"start":{"line":64,"column":2},"end":{"line":68,"column":3}},"17":{"start":{"line":65,"column":4},"end":{"line":65,"column":41}},"18":{"start":{"line":66,"column":9},"end":{"line":68,"column":3}},"19":{"start":{"line":67,"column":4},"end":{"line":67,"column":37}},"20":{"start":{"line":71,"column":0},"end":{"line":72,"column":2}},"21":{"start":{"line":74,"column":0},"end":{"line":213,"column":3}},"22":{"start":{"line":76,"column":14},"end":{"line":76,"column":39}},"23":{"start":{"line":79,"column":4},"end":{"line":79,"column":51}},"24":{"start":{"line":80,"column":4},"end":{"line":129,"column":5}},"25":{"start":{"line":81,"column":6},"end":{"line":81,"column":60}},"26":{"start":{"line":83,"column":6},"end":{"line":127,"column":9}},"27":{"start":{"line":84,"column":8},"end":{"line":84,"column":45}},"28":{"start":{"line":85,"column":8},"end":{"line":94,"column":9}},"29":{"start":{"line":86,"column":10},"end":{"line":86,"column":53}},"30":{"start":{"line":88,"column":10},"end":{"line":90,"column":11}},"31":{"start":{"line":89,"column":12},"end":{"line":89,"column":63}},"32":{"start":{"line":91,"column":10},"end":{"line":93,"column":11}},"33":{"start":{"line":92,"column":12},"end":{"line":92,"column":54}},"34":{"start":{"line":95,"column":8},"end":{"line":97,"column":9}},"35":{"start":{"line":96,"column":10},"end":{"line":96,"column":58}},"36":{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},"37":{"start":{"line":99,"column":10},"end":{"line":99,"column":67}},"38":{"start":{"line":101,"column":8},"end":{"line":103,"column":9}},"39":{"start":{"line":102,"column":10},"end":{"line":102,"column":57}},"40":{"start":{"line":104,"column":8},"end":{"line":106,"column":9}},"41":{"start":{"line":105,"column":10},"end":{"line":105,"column":58}},"42":{"start":{"line":107,"column":8},"end":{"line":109,"column":9}},"43":{"start":{"line":108,"column":10},"end":{"line":108,"column":65}},"44":{"start":{"line":110,"column":8},"end":{"line":112,"column":9}},"45":{"start":{"line":111,"column":10},"end":{"line":111,"column":65}},"46":{"start":{"line":113,"column":8},"end":{"line":115,"column":9}},"47":{"start":{"line":114,"column":10},"end":{"line":114,"column":55}},"48":{"start":{"line":116,"column":8},"end":{"line":116,"column":49}},"49":{"start":{"line":117,"column":8},"end":{"line":125,"column":11}},"50":{"start":{"line":118,"column":10},"end":{"line":118,"column":54}},"51":{"start":{"line":119,"column":10},"end":{"line":123,"column":11}},"52":{"start":{"line":120,"column":12},"end":{"line":120,"column":60}},"53":{"start":{"line":122,"column":12},"end":{"line":122,"column":41}},"54":{"start":{"line":124,"column":10},"end":{"line":124,"column":32}},"55":{"start":{"line":126,"column":8},"end":{"line":126,"column":30}},"56":{"start":{"line":128,"column":6},"end":{"line":128,"column":28}},"57":{"start":{"line":132,"column":4},"end":{"line":174,"column":5}},"58":{"start":{"line":134,"column":8},"end":{"line":134,"column":24}},"59":{"start":{"line":135,"column":8},"end":{"line":135,"column":20}},"60":{"start":{"line":138,"column":8},"end":{"line":138,"column":46}},"61":{"start":{"line":139,"column":8},"end":{"line":144,"column":12}},"62":{"start":{"line":146,"column":8},"end":{"line":148,"column":9}},"63":{"start":{"line":147,"column":10},"end":{"line":147,"column":65}},"64":{"start":{"line":149,"column":8},"end":{"line":149,"column":69}},"65":{"start":{"line":150,"column":8},"end":{"line":150,"column":69}},"66":{"start":{"line":152,"column":8},"end":{"line":160,"column":9}},"67":{"start":{"line":156,"column":12},"end":{"line":156,"column":18}},"68":{"start":{"line":158,"column":12},"end":{"line":158,"column":72}},"69":{"start":{"line":159,"column":12},"end":{"line":159,"column":18}},"70":{"start":{"line":161,"column":8},"end":{"line":161,"column":60}},"71":{"start":{"line":162,"column":8},"end":{"line":162,"column":55}},"72":{"start":{"line":163,"column":8},"end":{"line":163,"column":59}},"73":{"start":{"line":164,"column":8},"end":{"line":164,"column":59}},"74":{"start":{"line":165,"column":8},"end":{"line":165,"column":54}},"75":{"start":{"line":166,"column":8},"end":{"line":166,"column":20}},"76":{"start":{"line":169,"column":8},"end":{"line":169,"column":27}},"77":{"start":{"line":170,"column":8},"end":{"line":170,"column":20}},"78":{"start":{"line":173,"column":8},"end":{"line":173,"column":21}},"79":{"start":{"line":177,"column":4},"end":{"line":177,"column":29}},"80":{"start":{"line":180,"column":4},"end":{"line":211,"column":5}},"81":{"start":{"line":182,"column":8},"end":{"line":182,"column":21}},"82":{"start":{"line":184,"column":8},"end":{"line":187,"column":9}},"83":{"start":{"line":185,"column":10},"end":{"line":185,"column":44}},"84":{"start":{"line":186,"column":10},"end":{"line":186,"column":44}},"85":{"start":{"line":188,"column":8},"end":{"line":188,"column":54}},"86":{"start":{"line":189,"column":8},"end":{"line":189,"column":20}},"87":{"start":{"line":192,"column":8},"end":{"line":192,"column":45}},"88":{"start":{"line":193,"column":8},"end":{"line":206,"column":9}},"89":{"start":{"line":196,"column":12},"end":{"line":196,"column":40}},"90":{"start":{"line":197,"column":12},"end":{"line":197,"column":18}},"91":{"start":{"line":199,"column":12},"end":{"line":199,"column":42}},"92":{"start":{"line":200,"column":12},"end":{"line":200,"column":18}},"93":{"start":{"line":202,"column":12},"end":{"line":202,"column":61}},"94":{"start":{"line":203,"column":12},"end":{"line":203,"column":18}},"95":{"start":{"line":205,"column":12},"end":{"line":205,"column":18}},"96":{"start":{"line":207,"column":8},"end":{"line":207,"column":49}},"97":{"start":{"line":208,"column":8},"end":{"line":208,"column":20}},"98":{"start":{"line":210,"column":8},"end":{"line":210,"column":20}}},"branchMap":{"1":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":2},"end":{"line":47,"column":2}},{"start":{"line":47,"column":2},"end":{"line":47,"column":2}}]},"2":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":9},"end":{"line":49,"column":9}},{"start":{"line":49,"column":9},"end":{"line":49,"column":9}}]},"3":{"line":54,"type":"switch","locations":[{"start":{"line":55,"column":4},"end":{"line":55,"column":13}},{"start":{"line":56,"column":4},"end":{"line":57,"column":18}},{"start":{"line":58,"column":4},"end":{"line":59,"column":19}}]},"4":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":2},"end":{"line":64,"column":2}},{"start":{"line":64,"column":2},"end":{"line":64,"column":2}}]},"5":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":9},"end":{"line":66,"column":9}},{"start":{"line":66,"column":9},"end":{"line":66,"column":9}}]},"6":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":16},"end":{"line":79,"column":21}},{"start":{"line":79,"column":25},"end":{"line":79,"column":50}}]},"7":{"line":80,"type":"if","locations":[{"start":{"line":80,"column":4},"end":{"line":80,"column":4}},{"start":{"line":80,"column":4},"end":{"line":80,"column":4}}]},"8":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":8},"end":{"line":85,"column":8}},{"start":{"line":85,"column":8},"end":{"line":85,"column":8}}]},"9":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":10},"end":{"line":88,"column":10}},{"start":{"line":88,"column":10},"end":{"line":88,"column":10}}]},"10":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":14},"end":{"line":88,"column":28}},{"start":{"line":88,"column":33},"end":{"line":88,"column":54}},{"start":{"line":88,"column":60},"end":{"line":88,"column":88}}]},"11":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":10},"end":{"line":91,"column":10}},{"start":{"line":91,"column":10},"end":{"line":91,"column":10}}]},"12":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":8},"end":{"line":95,"column":8}},{"start":{"line":95,"column":8},"end":{"line":95,"column":8}}]},"13":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":8},"end":{"line":98,"column":8}},{"start":{"line":98,"column":8},"end":{"line":98,"column":8}}]},"14":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":8},"end":{"line":101,"column":8}},{"start":{"line":101,"column":8},"end":{"line":101,"column":8}}]},"15":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":8},"end":{"line":104,"column":8}},{"start":{"line":104,"column":8},"end":{"line":104,"column":8}}]},"16":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":8},"end":{"line":107,"column":8}},{"start":{"line":107,"column":8},"end":{"line":107,"column":8}}]},"17":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":8}},{"start":{"line":110,"column":8},"end":{"line":110,"column":8}}]},"18":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":8},"end":{"line":113,"column":8}},{"start":{"line":113,"column":8},"end":{"line":113,"column":8}}]},"19":{"line":117,"type":"binary-expr","locations":[{"start":{"line":117,"column":9},"end":{"line":117,"column":23}},{"start":{"line":117,"column":27},"end":{"line":117,"column":29}}]},"20":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":10},"end":{"line":119,"column":10}},{"start":{"line":119,"column":10},"end":{"line":119,"column":10}}]},"21":{"line":132,"type":"switch","locations":[{"start":{"line":133,"column":6},"end":{"line":135,"column":20}},{"start":{"line":137,"column":6},"end":{"line":166,"column":20}},{"start":{"line":167,"column":6},"end":{"line":167,"column":22}},{"start":{"line":168,"column":6},"end":{"line":170,"column":20}},{"start":{"line":172,"column":6},"end":{"line":173,"column":21}}]},"22":{"line":139,"type":"cond-expr","locations":[{"start":{"line":139,"column":69},"end":{"line":142,"column":11}},{"start":{"line":142,"column":14},"end":{"line":144,"column":11}}]},"23":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":8},"end":{"line":146,"column":8}},{"start":{"line":146,"column":8},"end":{"line":146,"column":8}}]},"24":{"line":152,"type":"switch","locations":[{"start":{"line":153,"column":10},"end":{"line":153,"column":21}},{"start":{"line":154,"column":10},"end":{"line":154,"column":22}},{"start":{"line":155,"column":10},"end":{"line":156,"column":18}},{"start":{"line":157,"column":10},"end":{"line":159,"column":18}}]},"25":{"line":180,"type":"switch","locations":[{"start":{"line":181,"column":6},"end":{"line":182,"column":21}},{"start":{"line":183,"column":6},"end":{"line":189,"column":20}},{"start":{"line":190,"column":6},"end":{"line":190,"column":22}},{"start":{"line":191,"column":6},"end":{"line":208,"column":20}},{"start":{"line":209,"column":6},"end":{"line":210,"column":20}}]},"26":{"line":184,"type":"if","locations":[{"start":{"line":184,"column":8},"end":{"line":184,"column":8}},{"start":{"line":184,"column":8},"end":{"line":184,"column":8}}]},"27":{"line":184,"type":"binary-expr","locations":[{"start":{"line":184,"column":12},"end":{"line":184,"column":39}},{"start":{"line":184,"column":43},"end":{"line":184,"column":77}}]},"28":{"line":193,"type":"switch","locations":[{"start":{"line":194,"column":10},"end":{"line":194,"column":23}},{"start":{"line":195,"column":10},"end":{"line":197,"column":18}},{"start":{"line":198,"column":10},"end":{"line":200,"column":18}},{"start":{"line":201,"column":10},"end":{"line":203,"column":18}},{"start":{"line":204,"column":10},"end":{"line":205,"column":18}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","var _ = require('../../../utils/under-dash');","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","// for dev reference","// var DataValidationTemplate = { // a _ denotes defaults","//   address: 'A1',","//   type: ['list', 'whole', 'decimal', 'date', 'textLength'],","//   operator: ['between', 'notBetween', 'equal', 'notEqual', 'greaterThan', 'lessThan', 'greaterThanOrEqual', 'lessThanOrEqual'],","//   allowBlank: [true, false],","//   showInputMessage: [true, false],","//   showErrorMessage: [true, false],","//   formulae: [['DefinedName', '<value>', '\"list,of,values\"', '$A$1', '$A$1:$B$2','ACTUAL(\"Formula\")']],","//   promptTitle: ['Title'],","//   prompt: ['words'],","//   errorStyle: ['error', 'warning', 'information'],","//   errorTitle: ['Title'],","//   error: ['words']","// };","","","function assign(definedName, attributes, name, defaultValue) {","  var value = attributes[name];","  if (value !== undefined) {","    definedName[name] = value;","  } else if (defaultValue !== undefined) {","    definedName[name] = defaultValue;","  }","}","function parseBool(value) {","  switch(value) {","    case '1':","    case 'true':","      return true;","    default:","      return false;","  }","}","function assignBool(definedName, attributes, name, defaultValue) {","  var value = attributes[name];","  if (value !== undefined) {","    definedName[name] = parseBool(value);","  } else if (defaultValue !== undefined) {","    definedName[name] = defaultValue;","  }","}","","var DataValidationsXform = module.exports = function() {","};","","utils.inherits(DataValidationsXform, BaseXform, {","","  get tag() { return 'dataValidations'; },","","  render: function(xmlStream, model) {","    var count = model && Object.keys(model).length;","    if (count) {","      xmlStream.openNode('dataValidations', {count: count});","","      _.each(model, function (value, address) {","        xmlStream.openNode('dataValidation');","        if (value.type !== 'any') {","          xmlStream.addAttribute('type', value.type);","","          if (value.operator && (value.type !== 'list') && (value.operator !== 'between')) {","            xmlStream.addAttribute('operator', value.operator);","          }","          if (value.allowBlank) {","            xmlStream.addAttribute('allowBlank', '1');","          }","        }","        if (value.showInputMessage) {","          xmlStream.addAttribute('showInputMessage', '1');","        }","        if (value.promptTitle) {","          xmlStream.addAttribute('promptTitle', value.promptTitle);","        }","        if (value.prompt) {","          xmlStream.addAttribute('prompt', value.prompt);","        }","        if (value.showErrorMessage) {","          xmlStream.addAttribute('showErrorMessage', '1');","        }","        if (value.errorStyle) {","          xmlStream.addAttribute('errorStyle', value.errorStyle);","        }","        if (value.errorTitle) {","          xmlStream.addAttribute('errorTitle', value.errorTitle);","        }","        if (value.error) {","          xmlStream.addAttribute('error', value.error);","        }","        xmlStream.addAttribute('sqref', address);","        (value.formulae || []).forEach(function (formula, index) {","          xmlStream.openNode('formula' + (index + 1));","          if (value.type === 'date') {","            xmlStream.writeText(utils.dateToExcel(formula));","          } else {","            xmlStream.writeText(formula);","          }","          xmlStream.closeNode();","        });","        xmlStream.closeNode();","      });","      xmlStream.closeNode();","    }","  },","  parseOpen: function(node) {","    switch(node.name) {","      case 'dataValidations':","        this.model = {};","        return true;","","      case 'dataValidation':","        this._address = node.attributes.sqref;","        var definedName = this._definedName = node.attributes.type ? {","            type: node.attributes.type,","            formulae: []","          } : {","            type: 'any'","          };","","        if (node.attributes.type) {","          assignBool(definedName, node.attributes, 'allowBlank');","        }","        assignBool(definedName, node.attributes, 'showInputMessage');","        assignBool(definedName, node.attributes, 'showErrorMessage');","","        switch (definedName.type) {","          case 'any':","          case 'list':","          case 'custom':","            break;","          default:","            assign(definedName, node.attributes, 'operator', 'between');","            break;","        }","        assign(definedName, node.attributes, 'promptTitle');","        assign(definedName, node.attributes, 'prompt');","        assign(definedName, node.attributes, 'errorStyle');","        assign(definedName, node.attributes, 'errorTitle');","        assign(definedName, node.attributes, 'error');","        return true;","      case 'formula1':","      case 'formula2':","        this._formula = [];","        return true;","      ","      default:","        return false;","    }","  },","  parseText: function(text) {","    this._formula.push(text);","  },","  parseClose: function(name) {","    switch(name) {","      case 'dataValidations':","        return false;","      case 'dataValidation':","        if (!this._definedName.formulae || !this._definedName.formulae.length) {","          delete this._definedName.formulae;","          delete this._definedName.operator;","        }","        this.model[this._address] = this._definedName;","        return true;","      case 'formula1':","      case 'formula2':","        var formula = this._formula.join('');","        switch (this._definedName.type) {","          case 'whole':","          case 'textLength':","            formula = parseInt(formula);","            break;","          case 'decimal':","            formula = parseFloat(formula);","            break;","          case 'date':","            formula = utils.excelToDate(parseFloat(formula));","            break;","          default:","            break;","        }","        this._definedName.formulae.push(formula);","        return true;","      default:","        return true;","    }","  }","});",""],"l":{"24":1,"25":1,"26":1,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"53":1,"54":0,"57":0,"59":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"71":1,"74":1,"76":0,"79":0,"80":0,"81":0,"83":0,"84":0,"85":0,"86":0,"88":0,"89":0,"91":0,"92":0,"95":0,"96":0,"98":0,"99":0,"101":0,"102":0,"104":0,"105":0,"107":0,"108":0,"110":0,"111":0,"113":0,"114":0,"116":0,"117":0,"118":0,"119":0,"120":0,"122":0,"124":0,"126":0,"128":0,"132":0,"134":0,"135":0,"138":0,"139":0,"146":0,"147":0,"149":0,"150":0,"152":0,"156":0,"158":0,"159":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"169":0,"170":0,"173":0,"177":0,"180":0,"182":0,"184":0,"185":0,"186":0,"188":0,"189":0,"192":0,"193":0,"196":0,"197":0,"199":0,"200":0,"202":0,"203":0,"205":0,"207":0,"208":0,"210":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/sheet-properties-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/sheet-properties-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":30,"loc":{"start":{"line":30,"column":44},"end":{"line":30,"column":55}}},"2":{"name":"(anonymous_2)","line":39,"loc":{"start":{"line":39,"column":9},"end":{"line":39,"column":12}}},"3":{"name":"(anonymous_3)","line":41,"loc":{"start":{"line":41,"column":10},"end":{"line":41,"column":37}}},"4":{"name":"(anonymous_4)","line":59,"loc":{"start":{"line":59,"column":13},"end":{"line":59,"column":28}}},"5":{"name":"(anonymous_5)","line":75,"loc":{"start":{"line":75,"column":13},"end":{"line":75,"column":28}}},"6":{"name":"(anonymous_6)","line":81,"loc":{"start":{"line":81,"column":14},"end":{"line":81,"column":29}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":49}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":72}},"5":{"start":{"line":30,"column":0},"end":{"line":35,"column":2}},"6":{"start":{"line":31,"column":2},"end":{"line":34,"column":3}},"7":{"start":{"line":37,"column":0},"end":{"line":102,"column":3}},"8":{"start":{"line":39,"column":14},"end":{"line":39,"column":31}},"9":{"start":{"line":42,"column":4},"end":{"line":56,"column":5}},"10":{"start":{"line":43,"column":6},"end":{"line":43,"column":30}},"11":{"start":{"line":44,"column":6},"end":{"line":44,"column":36}},"12":{"start":{"line":46,"column":6},"end":{"line":46,"column":24}},"13":{"start":{"line":47,"column":6},"end":{"line":47,"column":75}},"14":{"start":{"line":48,"column":6},"end":{"line":48,"column":79}},"15":{"start":{"line":50,"column":6},"end":{"line":55,"column":7}},"16":{"start":{"line":51,"column":8},"end":{"line":51,"column":30}},"17":{"start":{"line":52,"column":8},"end":{"line":52,"column":27}},"18":{"start":{"line":54,"column":8},"end":{"line":54,"column":29}},"19":{"start":{"line":60,"column":4},"end":{"line":73,"column":5}},"20":{"start":{"line":61,"column":6},"end":{"line":61,"column":34}},"21":{"start":{"line":62,"column":6},"end":{"line":62,"column":18}},"22":{"start":{"line":63,"column":11},"end":{"line":73,"column":5}},"23":{"start":{"line":64,"column":6},"end":{"line":64,"column":32}},"24":{"start":{"line":65,"column":6},"end":{"line":65,"column":35}},"25":{"start":{"line":66,"column":6},"end":{"line":66,"column":18}},"26":{"start":{"line":67,"column":11},"end":{"line":73,"column":5}},"27":{"start":{"line":68,"column":6},"end":{"line":68,"column":40}},"28":{"start":{"line":69,"column":6},"end":{"line":69,"column":34}},"29":{"start":{"line":70,"column":6},"end":{"line":70,"column":18}},"30":{"start":{"line":72,"column":6},"end":{"line":72,"column":19}},"31":{"start":{"line":76,"column":4},"end":{"line":79,"column":5}},"32":{"start":{"line":77,"column":6},"end":{"line":77,"column":34}},"33":{"start":{"line":78,"column":6},"end":{"line":78,"column":18}},"34":{"start":{"line":82,"column":4},"end":{"line":100,"column":5}},"35":{"start":{"line":83,"column":6},"end":{"line":85,"column":7}},"36":{"start":{"line":84,"column":8},"end":{"line":84,"column":32}},"37":{"start":{"line":86,"column":6},"end":{"line":86,"column":18}},"38":{"start":{"line":88,"column":6},"end":{"line":98,"column":7}},"39":{"start":{"line":89,"column":8},"end":{"line":89,"column":24}},"40":{"start":{"line":90,"column":8},"end":{"line":92,"column":9}},"41":{"start":{"line":91,"column":10},"end":{"line":91,"column":56}},"42":{"start":{"line":93,"column":8},"end":{"line":95,"column":9}},"43":{"start":{"line":94,"column":10},"end":{"line":94,"column":60}},"44":{"start":{"line":97,"column":8},"end":{"line":97,"column":26}},"45":{"start":{"line":99,"column":6},"end":{"line":99,"column":19}}},"branchMap":{"1":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]},"2":{"line":47,"type":"binary-expr","locations":[{"start":{"line":47,"column":14},"end":{"line":47,"column":65}},{"start":{"line":47,"column":69},"end":{"line":47,"column":74}}]},"3":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":14},"end":{"line":48,"column":69}},{"start":{"line":48,"column":73},"end":{"line":48,"column":78}}]},"4":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":6},"end":{"line":50,"column":6}},{"start":{"line":50,"column":6},"end":{"line":50,"column":6}}]},"5":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":4},"end":{"line":60,"column":4}},{"start":{"line":60,"column":4},"end":{"line":60,"column":4}}]},"6":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":11},"end":{"line":63,"column":11}},{"start":{"line":63,"column":11},"end":{"line":63,"column":11}}]},"7":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":11},"end":{"line":67,"column":11}},{"start":{"line":67,"column":11},"end":{"line":67,"column":11}}]},"8":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":4},"end":{"line":76,"column":4}},{"start":{"line":76,"column":4},"end":{"line":76,"column":4}}]},"9":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":82,"column":4}},{"start":{"line":82,"column":4},"end":{"line":82,"column":4}}]},"10":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":6},"end":{"line":83,"column":6}},{"start":{"line":83,"column":6},"end":{"line":83,"column":6}}]},"11":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":6},"end":{"line":88,"column":6}},{"start":{"line":88,"column":6},"end":{"line":88,"column":6}}]},"12":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":10},"end":{"line":88,"column":33}},{"start":{"line":88,"column":37},"end":{"line":88,"column":63}}]},"13":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":8},"end":{"line":90,"column":8}},{"start":{"line":90,"column":8},"end":{"line":90,"column":8}}]},"14":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":8},"end":{"line":93,"column":8}},{"start":{"line":93,"column":8},"end":{"line":93,"column":8}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","var ColorXform = require('../style/color-xform');","var PageSetupPropertiesXform = require('./page-setup-properties-xform');","","var SheetPropertiesXform = module.exports = function() {","  this.map = {","    tabColor: new ColorXform('tabColor'),","    pageSetUpPr: new PageSetupPropertiesXform()","  }","};","","utils.inherits(SheetPropertiesXform, BaseXform, {","","  get tag() { return 'sheetPr'; },","","  render: function(xmlStream, model) {","    if (model) {","      xmlStream.addRollback();","      xmlStream.openNode('sheetPr');","","      var inner = false;","      inner = this.map.tabColor.render(xmlStream, model.tabColor) || inner;","      inner = this.map.pageSetUpPr.render(xmlStream, model.pageSetup) || inner;","","      if (inner) {","        xmlStream.closeNode();","        xmlStream.commit();","      } else {","        xmlStream.rollback();","      }","    }","  },","  ","  parseOpen: function(node) {","    if (this.parser) {","      this.parser.parseOpen(node);","      return true;","    } else if (node.name === this.tag) {","      this.map.tabColor.reset();","      this.map.pageSetUpPr.reset();","      return true;","    } else if (this.map[node.name]) {","      this.parser = this.map[node.name];","      this.parser.parseOpen(node);","      return true;","    } else {","      return false;","    }","  },","  parseText: function(text) {","    if (this.parser) {","      this.parser.parseText(text);","      return true;","    }","  },","  parseClose: function(name) {","    if (this.parser) {","      if (!this.parser.parseClose(name)) {","        this.parser = undefined;","      }","      return true;","    } else {","      if (this.map.tabColor.model || this.map.pageSetUpPr.model) {","        this.model = {};","        if (this.map.tabColor.model) {","          this.model.tabColor = this.map.tabColor.model;","        }","        if (this.map.pageSetUpPr.model) {","          this.model.pageSetup = this.map.pageSetUpPr.model;","        }","      } else {","        this.model = null;","      }","      return false;","    }","  }","});",""],"l":{"25":1,"26":1,"27":1,"28":1,"30":1,"31":1,"37":1,"39":0,"42":0,"43":0,"44":0,"46":0,"47":0,"48":0,"50":0,"51":0,"52":0,"54":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"72":0,"76":0,"77":0,"78":0,"82":0,"83":0,"84":0,"86":0,"88":0,"89":0,"90":0,"91":0,"93":0,"94":0,"97":0,"99":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/page-setup-properties-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/page-setup-properties-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":48},"end":{"line":28,"column":59}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":12}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":10},"end":{"line":35,"column":37}}},"4":{"name":"(anonymous_4)","line":44,"loc":{"start":{"line":44,"column":13},"end":{"line":44,"column":28}}},"5":{"name":"(anonymous_5)","line":54,"loc":{"start":{"line":54,"column":13},"end":{"line":54,"column":24}}},"6":{"name":"(anonymous_6)","line":56,"loc":{"start":{"line":56,"column":14},"end":{"line":56,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":59,"column":3}},"5":{"start":{"line":33,"column":14},"end":{"line":33,"column":35}},"6":{"start":{"line":36,"column":4},"end":{"line":41,"column":5}},"7":{"start":{"line":37,"column":6},"end":{"line":39,"column":9}},"8":{"start":{"line":40,"column":6},"end":{"line":40,"column":18}},"9":{"start":{"line":45,"column":4},"end":{"line":52,"column":5}},"10":{"start":{"line":46,"column":6},"end":{"line":48,"column":8}},"11":{"start":{"line":49,"column":6},"end":{"line":49,"column":18}},"12":{"start":{"line":51,"column":6},"end":{"line":51,"column":19}},"13":{"start":{"line":57,"column":4},"end":{"line":57,"column":17}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":36,"column":4}},{"start":{"line":36,"column":4},"end":{"line":36,"column":4}}]},"2":{"line":36,"type":"binary-expr","locations":[{"start":{"line":36,"column":8},"end":{"line":36,"column":13}},{"start":{"line":36,"column":17},"end":{"line":36,"column":32}}]},"3":{"line":38,"type":"cond-expr","locations":[{"start":{"line":38,"column":37},"end":{"line":38,"column":40}},{"start":{"line":38,"column":43},"end":{"line":38,"column":52}}]},"4":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":4},"end":{"line":45,"column":4}},{"start":{"line":45,"column":4},"end":{"line":45,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var PageSetupPropertiesXform = module.exports = function() {","};","","utils.inherits(PageSetupPropertiesXform, BaseXform, {","","  get tag() { return 'pageSetUpPr'; },","","  render: function(xmlStream, model) {","    if (model && model.fitToPage) {","      xmlStream.leafNode(this.tag, {","        fitToPage: model.fitToPage ? '1' : undefined","      });","      return true;","    }","  },","  ","  parseOpen: function(node) {","    if (node.name === this.tag) {","      this.model = {","        fitToPage: node.attributes.fitToPage === '1'","      };","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"28":1,"31":1,"33":0,"36":0,"37":0,"40":0,"45":0,"46":0,"49":0,"51":0,"57":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/sheet-format-properties-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/sheet-format-properties-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":29,"loc":{"start":{"line":29,"column":50},"end":{"line":29,"column":61}}},"2":{"name":"(anonymous_2)","line":34,"loc":{"start":{"line":34,"column":9},"end":{"line":34,"column":12}}},"3":{"name":"(anonymous_3)","line":36,"loc":{"start":{"line":36,"column":10},"end":{"line":36,"column":37}}},"4":{"name":"(anonymous_4)","line":44,"loc":{"start":{"line":44,"column":29},"end":{"line":44,"column":45}}},"5":{"name":"(anonymous_5)","line":50,"loc":{"start":{"line":50,"column":13},"end":{"line":50,"column":28}}},"6":{"name":"(anonymous_6)","line":63,"loc":{"start":{"line":63,"column":13},"end":{"line":63,"column":24}}},"7":{"name":"(anonymous_7)","line":65,"loc":{"start":{"line":65,"column":14},"end":{"line":65,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":45}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":44}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":29,"column":0},"end":{"line":30,"column":2}},"5":{"start":{"line":32,"column":0},"end":{"line":68,"column":3}},"6":{"start":{"line":34,"column":14},"end":{"line":34,"column":37}},"7":{"start":{"line":37,"column":4},"end":{"line":47,"column":5}},"8":{"start":{"line":38,"column":6},"end":{"line":43,"column":8}},"9":{"start":{"line":44,"column":6},"end":{"line":46,"column":7}},"10":{"start":{"line":44,"column":47},"end":{"line":44,"column":74}},"11":{"start":{"line":45,"column":8},"end":{"line":45,"column":56}},"12":{"start":{"line":51,"column":4},"end":{"line":61,"column":5}},"13":{"start":{"line":52,"column":6},"end":{"line":57,"column":8}},"14":{"start":{"line":58,"column":6},"end":{"line":58,"column":18}},"15":{"start":{"line":60,"column":6},"end":{"line":60,"column":19}},"16":{"start":{"line":66,"column":4},"end":{"line":66,"column":17}}},"branchMap":{"1":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"2":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":6}},{"start":{"line":44,"column":6},"end":{"line":44,"column":6}}]},"3":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":51,"column":4}},{"start":{"line":51,"column":4},"end":{"line":51,"column":4}}]},"4":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":38},"end":{"line":53,"column":70}},{"start":{"line":53,"column":74},"end":{"line":53,"column":75}}]},"5":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":30},"end":{"line":54,"column":64}},{"start":{"line":54,"column":68},"end":{"line":54,"column":69}}]},"6":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":34},"end":{"line":55,"column":65}},{"start":{"line":55,"column":69},"end":{"line":55,"column":70}}]},"7":{"line":56,"type":"binary-expr","locations":[{"start":{"line":56,"column":34},"end":{"line":56,"column":65}},{"start":{"line":56,"column":69},"end":{"line":56,"column":70}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../../../utils/under-dash');","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var SheetFormatPropertiesXform = module.exports = function() {","};","","utils.inherits(SheetFormatPropertiesXform, BaseXform, {","","  get tag() { return 'sheetFormatPr'; },","","  render: function(xmlStream, model) {","    if (model) {","      var attributes = {","        defaultRowHeight: model.defaultRowHeight,","        outlineLevelRow: model.outlineLevelRow,","        outlineLevelCol: model.outlineLevelCol,","        'x14ac:dyDescent': model.dyDescent","      };","      if (_.some(attributes, function(value) { return value !== undefined; })) {","        xmlStream.leafNode('sheetFormatPr', attributes);","      }","    }","  },","  ","  parseOpen: function(node) {","    if (node.name === 'sheetFormatPr') {","      this.model = {","        defaultRowHeight:  parseFloat(node.attributes.defaultRowHeight || 0),","        dyDescent: parseFloat(node.attributes['x14ac:dyDescent'] || 0),","        outlineLevelRow: parseInt(node.attributes.outlineLevelRow || 0),","        outlineLevelCol: parseInt(node.attributes.outlineLevelCol || 0)","      };","      return true;","    } else {","      return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"32":1,"34":0,"37":0,"38":0,"44":0,"45":0,"51":0,"52":0,"58":0,"60":0,"66":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/sheet-view-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/sheet-view-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0},"b":{"1":[0,0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0,0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":35,"loc":{"start":{"line":35,"column":38},"end":{"line":35,"column":49}}},"2":{"name":"(anonymous_2)","line":40,"loc":{"start":{"line":40,"column":9},"end":{"line":40,"column":12}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":11},"end":{"line":42,"column":27}}},"4":{"name":"(anonymous_4)","line":53,"loc":{"start":{"line":53,"column":10},"end":{"line":53,"column":37}}},"5":{"name":"(anonymous_5)","line":57,"loc":{"start":{"line":57,"column":14},"end":{"line":57,"column":46}}},"6":{"name":"(anonymous_6)","line":126,"loc":{"start":{"line":126,"column":13},"end":{"line":126,"column":28}}},"7":{"name":"(anonymous_7)","line":162,"loc":{"start":{"line":162,"column":13},"end":{"line":162,"column":24}}},"8":{"name":"(anonymous_8)","line":164,"loc":{"start":{"line":164,"column":14},"end":{"line":164,"column":29}}},"9":{"name":"(anonymous_9)","line":215,"loc":{"start":{"line":215,"column":13},"end":{"line":215,"column":38}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":51}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":29,"column":0},"end":{"line":33,"column":2}},"5":{"start":{"line":35,"column":0},"end":{"line":36,"column":2}},"6":{"start":{"line":38,"column":0},"end":{"line":217,"column":3}},"7":{"start":{"line":40,"column":14},"end":{"line":40,"column":33}},"8":{"start":{"line":43,"column":4},"end":{"line":50,"column":5}},"9":{"start":{"line":46,"column":8},"end":{"line":46,"column":14}},"10":{"start":{"line":48,"column":8},"end":{"line":48,"column":31}},"11":{"start":{"line":49,"column":8},"end":{"line":49,"column":14}},"12":{"start":{"line":54,"column":4},"end":{"line":56,"column":7}},"13":{"start":{"line":57,"column":4},"end":{"line":61,"column":6}},"14":{"start":{"line":58,"column":6},"end":{"line":60,"column":7}},"15":{"start":{"line":59,"column":8},"end":{"line":59,"column":44}},"16":{"start":{"line":62,"column":4},"end":{"line":62,"column":47}},"17":{"start":{"line":63,"column":4},"end":{"line":63,"column":53}},"18":{"start":{"line":64,"column":4},"end":{"line":64,"column":69}},"19":{"start":{"line":65,"column":4},"end":{"line":65,"column":61}},"20":{"start":{"line":66,"column":4},"end":{"line":66,"column":55}},"21":{"start":{"line":67,"column":4},"end":{"line":67,"column":73}},"22":{"start":{"line":68,"column":4},"end":{"line":68,"column":42}},"23":{"start":{"line":70,"column":4},"end":{"line":70,"column":48}},"24":{"start":{"line":71,"column":4},"end":{"line":122,"column":5}},"25":{"start":{"line":77,"column":8},"end":{"line":77,"column":35}},"26":{"start":{"line":78,"column":8},"end":{"line":78,"column":35}},"27":{"start":{"line":79,"column":8},"end":{"line":79,"column":95}},"28":{"start":{"line":80,"column":8},"end":{"line":80,"column":113}},"29":{"start":{"line":81,"column":8},"end":{"line":87,"column":11}},"30":{"start":{"line":88,"column":8},"end":{"line":92,"column":11}},"31":{"start":{"line":93,"column":8},"end":{"line":93,"column":14}},"32":{"start":{"line":99,"column":8},"end":{"line":101,"column":9}},"33":{"start":{"line":100,"column":10},"end":{"line":100,"column":39}},"34":{"start":{"line":102,"column":8},"end":{"line":107,"column":11}},"35":{"start":{"line":108,"column":8},"end":{"line":112,"column":11}},"36":{"start":{"line":113,"column":8},"end":{"line":113,"column":14}},"37":{"start":{"line":115,"column":8},"end":{"line":120,"column":9}},"38":{"start":{"line":116,"column":10},"end":{"line":119,"column":13}},"39":{"start":{"line":121,"column":8},"end":{"line":121,"column":14}},"40":{"start":{"line":123,"column":4},"end":{"line":123,"column":26}},"41":{"start":{"line":127,"column":4},"end":{"line":160,"column":5}},"42":{"start":{"line":129,"column":8},"end":{"line":138,"column":10}},"43":{"start":{"line":139,"column":8},"end":{"line":139,"column":30}},"44":{"start":{"line":140,"column":8},"end":{"line":140,"column":29}},"45":{"start":{"line":141,"column":8},"end":{"line":141,"column":20}},"46":{"start":{"line":143,"column":8},"end":{"line":149,"column":10}},"47":{"start":{"line":150,"column":8},"end":{"line":150,"column":20}},"48":{"start":{"line":152,"column":8},"end":{"line":152,"column":53}},"49":{"start":{"line":153,"column":8},"end":{"line":156,"column":10}},"50":{"start":{"line":157,"column":8},"end":{"line":157,"column":20}},"51":{"start":{"line":159,"column":8},"end":{"line":159,"column":21}},"52":{"start":{"line":165,"column":4},"end":{"line":165,"column":25}},"53":{"start":{"line":166,"column":4},"end":{"line":212,"column":5}},"54":{"start":{"line":168,"column":8},"end":{"line":208,"column":9}},"55":{"start":{"line":169,"column":10},"end":{"line":180,"column":12}},"56":{"start":{"line":181,"column":10},"end":{"line":183,"column":11}},"57":{"start":{"line":182,"column":12},"end":{"line":182,"column":52}},"58":{"start":{"line":184,"column":10},"end":{"line":184,"column":60}},"59":{"start":{"line":185,"column":10},"end":{"line":187,"column":11}},"60":{"start":{"line":186,"column":12},"end":{"line":186,"column":52}},"61":{"start":{"line":188,"column":10},"end":{"line":190,"column":11}},"62":{"start":{"line":189,"column":12},"end":{"line":189,"column":47}},"63":{"start":{"line":192,"column":10},"end":{"line":200,"column":12}},"64":{"start":{"line":201,"column":10},"end":{"line":201,"column":46}},"65":{"start":{"line":202,"column":10},"end":{"line":204,"column":11}},"66":{"start":{"line":203,"column":12},"end":{"line":203,"column":52}},"67":{"start":{"line":205,"column":10},"end":{"line":207,"column":11}},"68":{"start":{"line":206,"column":12},"end":{"line":206,"column":47}},"69":{"start":{"line":209,"column":8},"end":{"line":209,"column":21}},"70":{"start":{"line":211,"column":8},"end":{"line":211,"column":20}}},"branchMap":{"1":{"line":43,"type":"switch","locations":[{"start":{"line":44,"column":6},"end":{"line":44,"column":20}},{"start":{"line":45,"column":6},"end":{"line":46,"column":14}},{"start":{"line":47,"column":6},"end":{"line":49,"column":14}}]},"2":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":22},"end":{"line":55,"column":42}},{"start":{"line":55,"column":46},"end":{"line":55,"column":47}}]},"3":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":6},"end":{"line":58,"column":6}},{"start":{"line":58,"column":6},"end":{"line":58,"column":6}}]},"4":{"line":71,"type":"switch","locations":[{"start":{"line":72,"column":6},"end":{"line":93,"column":14}},{"start":{"line":94,"column":6},"end":{"line":113,"column":14}},{"start":{"line":114,"column":6},"end":{"line":121,"column":14}}]},"5":{"line":77,"type":"binary-expr","locations":[{"start":{"line":77,"column":17},"end":{"line":77,"column":29}},{"start":{"line":77,"column":33},"end":{"line":77,"column":34}}]},"6":{"line":78,"type":"binary-expr","locations":[{"start":{"line":78,"column":17},"end":{"line":78,"column":29}},{"start":{"line":78,"column":33},"end":{"line":78,"column":34}}]},"7":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":22},"end":{"line":79,"column":39}},{"start":{"line":79,"column":43},"end":{"line":79,"column":94}}]},"8":{"line":80,"type":"cond-expr","locations":[{"start":{"line":80,"column":54},"end":{"line":80,"column":67}},{"start":{"line":80,"column":71},"end":{"line":80,"column":111}}]},"9":{"line":80,"type":"binary-expr","locations":[{"start":{"line":80,"column":22},"end":{"line":80,"column":34}},{"start":{"line":80,"column":38},"end":{"line":80,"column":50}}]},"10":{"line":80,"type":"cond-expr","locations":[{"start":{"line":80,"column":86},"end":{"line":80,"column":96}},{"start":{"line":80,"column":99},"end":{"line":80,"column":111}}]},"11":{"line":82,"type":"binary-expr","locations":[{"start":{"line":82,"column":18},"end":{"line":82,"column":30}},{"start":{"line":82,"column":34},"end":{"line":82,"column":43}}]},"12":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":18},"end":{"line":83,"column":30}},{"start":{"line":83,"column":34},"end":{"line":83,"column":43}}]},"13":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":8},"end":{"line":99,"column":8}},{"start":{"line":99,"column":8},"end":{"line":99,"column":8}}]},"14":{"line":103,"type":"binary-expr","locations":[{"start":{"line":103,"column":18},"end":{"line":103,"column":30}},{"start":{"line":103,"column":34},"end":{"line":103,"column":43}}]},"15":{"line":104,"type":"binary-expr","locations":[{"start":{"line":104,"column":19},"end":{"line":104,"column":31}},{"start":{"line":104,"column":35},"end":{"line":104,"column":44}}]},"16":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":8},"end":{"line":115,"column":8}},{"start":{"line":115,"column":8},"end":{"line":115,"column":8}}]},"17":{"line":127,"type":"switch","locations":[{"start":{"line":128,"column":6},"end":{"line":141,"column":20}},{"start":{"line":142,"column":6},"end":{"line":150,"column":20}},{"start":{"line":151,"column":6},"end":{"line":157,"column":20}},{"start":{"line":158,"column":6},"end":{"line":159,"column":21}}]},"18":{"line":135,"type":"binary-expr","locations":[{"start":{"line":135,"column":30},"end":{"line":135,"column":55}},{"start":{"line":135,"column":59},"end":{"line":135,"column":62}}]},"19":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":36},"end":{"line":136,"column":67}},{"start":{"line":136,"column":71},"end":{"line":136,"column":74}}]},"20":{"line":144,"type":"binary-expr","locations":[{"start":{"line":144,"column":27},"end":{"line":144,"column":49}},{"start":{"line":144,"column":53},"end":{"line":144,"column":54}}]},"21":{"line":145,"type":"binary-expr","locations":[{"start":{"line":145,"column":27},"end":{"line":145,"column":49}},{"start":{"line":145,"column":53},"end":{"line":145,"column":54}}]},"22":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":23},"end":{"line":147,"column":49}},{"start":{"line":147,"column":53},"end":{"line":147,"column":62}}]},"23":{"line":152,"type":"binary-expr","locations":[{"start":{"line":152,"column":19},"end":{"line":152,"column":39}},{"start":{"line":152,"column":43},"end":{"line":152,"column":52}}]},"24":{"line":166,"type":"switch","locations":[{"start":{"line":167,"column":6},"end":{"line":209,"column":21}},{"start":{"line":210,"column":6},"end":{"line":211,"column":20}}]},"25":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":8},"end":{"line":168,"column":8}},{"start":{"line":168,"column":8},"end":{"line":168,"column":8}}]},"26":{"line":168,"type":"binary-expr","locations":[{"start":{"line":168,"column":12},"end":{"line":168,"column":26}},{"start":{"line":168,"column":30},"end":{"line":168,"column":39}}]},"27":{"line":171,"type":"binary-expr","locations":[{"start":{"line":171,"column":19},"end":{"line":171,"column":47}},{"start":{"line":171,"column":51},"end":{"line":171,"column":58}}]},"28":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":10},"end":{"line":181,"column":10}},{"start":{"line":181,"column":10},"end":{"line":181,"column":10}}]},"29":{"line":185,"type":"if","locations":[{"start":{"line":185,"column":10},"end":{"line":185,"column":10}},{"start":{"line":185,"column":10},"end":{"line":185,"column":10}}]},"30":{"line":185,"type":"binary-expr","locations":[{"start":{"line":185,"column":14},"end":{"line":185,"column":23}},{"start":{"line":185,"column":27},"end":{"line":185,"column":47}}]},"31":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":10},"end":{"line":188,"column":10}},{"start":{"line":188,"column":10},"end":{"line":188,"column":10}}]},"32":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":10},"end":{"line":202,"column":10}},{"start":{"line":202,"column":10},"end":{"line":202,"column":10}}]},"33":{"line":202,"type":"binary-expr","locations":[{"start":{"line":202,"column":14},"end":{"line":202,"column":23}},{"start":{"line":202,"column":27},"end":{"line":202,"column":47}}]},"34":{"line":205,"type":"if","locations":[{"start":{"line":205,"column":10},"end":{"line":205,"column":10}},{"start":{"line":205,"column":10},"end":{"line":205,"column":10}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../../utils/utils');","var colCache = require('../../../utils/col-cache');","var BaseXform = require('../base-xform');","","var VIEW_STATES = {","  frozen: 'frozen',","  frozenSplit: 'frozen',","  split: 'split'","};","","var SheetViewXform = module.exports = function() {","};","","utils.inherits(SheetViewXform, BaseXform, {","  ","  get tag() { return 'sheetView'; },","  ","  prepare: function(model) {","    switch(model.state) {","      case 'frozen':","      case 'split':","        break;","      default:","        model.state = 'normal';","        break;","    }","  },","","  render: function(xmlStream, model) {","    xmlStream.openNode('sheetView', {","      workbookViewId: model.workbookViewId || 0","    });","    var add = function(name, value, included) {","      if (included) {","        xmlStream.addAttribute(name, value);","      }","    };","    add('tabSelected', '1', model.tabSelected);","    add('showRuler', '0', model.showRuler === false);","    add('showRowColHeaders', '0', model.showRowColHeaders === false);","    add('showGridLines', '0', model.showGridLines === false);","    add('zoomScale', model.zoomScale, model.zoomScale);","    add('zoomScaleNormal', model.zoomScaleNormal, model.zoomScaleNormal);","    add('view', model.style, model.style);","    ","    var topLeftCell, xSplit, ySplit, activePane;","    switch(model.state) {","      case 'frozen':","        //  <sheetView tabSelected=\"1\" workbookViewId=\"0\">","        //   <pane xSplit=\"2\" ySplit=\"2\" topLeftCell=\"C3\" activePane=\"bottomRight\" state=\"frozen\"/>","        //   <selection pane=\"bottomRight\" activeCell=\"C3\" sqref=\"C3\"/>","        //  </sheetView>","        xSplit = model.xSplit || 0;","        ySplit = model.ySplit || 0;","        topLeftCell = model.topLeftCell || colCache.getAddress(ySplit + 1, xSplit + 1).address;","        activePane = (model.xSplit && model.ySplit) ? 'bottomRight' : (model.xSplit ? 'topRight' : 'bottomLeft');","        xmlStream.leafNode('pane', {","          xSplit: model.xSplit || undefined,","          ySplit: model.ySplit || undefined,","          topLeftCell: topLeftCell,","          activePane: activePane,","          state: 'frozen'","        });","        xmlStream.leafNode('selection', {","          pane: activePane,","          activeCell: model.activeCell,","          sqref: model.activeCell","        });","        break;","      case 'split':","        //  <sheetView tabSelected=\"1\" workbookViewId=\"1\">","        //   <pane xSplit=\"3432\" ySplit=\"1152\" topLeftCell=\"D4\" activePane=\"bottomRight\"/>","        //   <selection pane=\"bottomRight\" activeCell=\"D4\" sqref=\"D4\"/>","        //  </sheetView>","        if (model.activePane === 'topLeft') {","          model.activePane = undefined;","        }","        xmlStream.leafNode('pane', {","          xSplit: model.xSplit || undefined,","          ySplit:  model.ySplit || undefined,","          topLeftCell: model.topLeftCell,","          activePane: model.activePane","        });","        xmlStream.leafNode('selection', {","          pane: model.activePane,","          activeCell: model.activeCell,","          sqref: model.activeCell","        });","        break;","      case 'normal':","        if (model.activeCell) {","          xmlStream.leafNode('selection', {","            activeCell: model.activeCell,","            sqref: model.activeCell","          });","        }","        break;","    }","    xmlStream.closeNode();","  },","  ","  parseOpen: function(node) {","    switch(node.name) {","      case 'sheetView':","        this.sheetView = {","          workbookViewId: parseInt(node.attributes.workbookViewId),","          tabSelected: node.attributes.tabSelected === '1',","          showRuler: !(node.attributes.showRuler === '0'),","          showRowColHeaders: !(node.attributes.showRowColHeaders === '0'),","          showGridLines: !(node.attributes.showGridLines === '0'),","          zoomScale: parseInt(node.attributes.zoomScale || 100),","          zoomScaleNormal: parseInt(node.attributes.zoomScaleNormal || 100),","          style: node.attributes.view","        };","        this.pane = undefined;","        this.selections = {};","        return true;","      case 'pane':","        this.pane = {","          xSplit: parseInt(node.attributes.xSplit || 0),","          ySplit: parseInt(node.attributes.ySplit || 0),","          topLeftCell: node.attributes.topLeftCell,","          activePane:  node.attributes.activePane || 'topLeft',","          state: node.attributes.state","        };","        return true;","      case 'selection':","        var name = node.attributes.pane || 'topLeft';","        this.selections[name] = {","          pane: name,","          activeCell: node.attributes.activeCell","        };","        return true;","      default:","        return false;","    }","  },","  parseText: function() {","  },","  parseClose: function(name) {","    var model, selection;","    switch(name) {","      case 'sheetView':","        if (this.sheetView && this.pane) {","          model = this.model = {","            workbookViewId: this.sheetView.workbookViewId,","            state: VIEW_STATES[this.pane.state] || 'split', // split is default","            xSplit: this.pane.xSplit,","            ySplit: this.pane.ySplit,","            topLeftCell: this.pane.topLeftCell,","            showRuler: this.sheetView.showRuler,","            showRowColHeaders: this.sheetView.showRowColHeaders,","            showGridLines: this.sheetView.showGridLines,","            zoomScale: this.sheetView.zoomScale,","            zoomScaleNormal: this.sheetView.zoomScaleNormal","          };","          if (this.model.state === 'split') {","            model.activePane = this.pane.activePane;","          }","          selection = this.selections[this.pane.activePane];","          if (selection && selection.activeCell) {","            model.activeCell = selection.activeCell;","          }","          if (this.sheetView.style) {","            model.style = this.sheetView.style;","          }","        } else {","          model = this.model = {","            workbookViewId: this.sheetView.workbookViewId,","            state: 'normal',","            showRuler: this.sheetView.showRuler,","            showRowColHeaders: this.sheetView.showRowColHeaders,","            showGridLines: this.sheetView.showGridLines,","            zoomScale: this.sheetView.zoomScale,","            zoomScaleNormal: this.sheetView.zoomScaleNormal","          };","          selection = this.selections.topLeft;","          if (selection && selection.activeCell) {","            model.activeCell = selection.activeCell;","          }","          if (this.sheetView.style) {","            model.style = this.sheetView.style;","          }","        }","        return false;","      default:","        return true;","    }","  },","  ","  reconcile: function(model, options) {","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"35":1,"38":1,"40":0,"43":0,"46":0,"48":0,"49":0,"54":0,"57":0,"58":0,"59":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"70":0,"71":0,"77":0,"78":0,"79":0,"80":0,"81":0,"88":0,"93":0,"99":0,"100":0,"102":0,"108":0,"113":0,"115":0,"116":0,"121":0,"123":0,"127":0,"129":0,"139":0,"140":0,"141":0,"143":0,"150":0,"152":0,"153":0,"157":0,"159":0,"165":0,"166":0,"168":0,"169":0,"181":0,"182":0,"184":0,"185":0,"186":0,"188":0,"189":0,"192":0,"201":0,"202":0,"203":0,"205":0,"206":0,"209":0,"211":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/page-margins-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/page-margins-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"(anonymous_1)","line":28,"loc":{"start":{"line":28,"column":40},"end":{"line":28,"column":51}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":9},"end":{"line":33,"column":12}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":10},"end":{"line":35,"column":37}}},"4":{"name":"(anonymous_4)","line":45,"loc":{"start":{"line":45,"column":29},"end":{"line":45,"column":45}}},"5":{"name":"(anonymous_5)","line":51,"loc":{"start":{"line":51,"column":13},"end":{"line":51,"column":28}}},"6":{"name":"(anonymous_6)","line":67,"loc":{"start":{"line":67,"column":13},"end":{"line":67,"column":24}}},"7":{"name":"(anonymous_7)","line":69,"loc":{"start":{"line":69,"column":14},"end":{"line":69,"column":25}}}},"statementMap":{"1":{"start":{"line":24,"column":0},"end":{"line":24,"column":45}},"2":{"start":{"line":25,"column":0},"end":{"line":25,"column":44}},"3":{"start":{"line":26,"column":0},"end":{"line":26,"column":41}},"4":{"start":{"line":28,"column":0},"end":{"line":29,"column":2}},"5":{"start":{"line":31,"column":0},"end":{"line":72,"column":3}},"6":{"start":{"line":33,"column":14},"end":{"line":33,"column":35}},"7":{"start":{"line":36,"column":4},"end":{"line":48,"column":5}},"8":{"start":{"line":37,"column":6},"end":{"line":44,"column":8}},"9":{"start":{"line":45,"column":6},"end":{"line":47,"column":7}},"10":{"start":{"line":45,"column":47},"end":{"line":45,"column":73}},"11":{"start":{"line":46,"column":8},"end":{"line":46,"column":49}},"12":{"start":{"line":52,"column":4},"end":{"line":65,"column":5}},"13":{"start":{"line":54,"column":8},"end":{"line":61,"column":10}},"14":{"start":{"line":62,"column":8},"end":{"line":62,"column":20}},"15":{"start":{"line":64,"column":8},"end":{"line":64,"column":21}},"16":{"start":{"line":70,"column":4},"end":{"line":70,"column":17}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":36,"column":4}},{"start":{"line":36,"column":4},"end":{"line":36,"column":4}}]},"2":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":6},"end":{"line":45,"column":6}},{"start":{"line":45,"column":6},"end":{"line":45,"column":6}}]},"3":{"line":52,"type":"switch","locations":[{"start":{"line":53,"column":6},"end":{"line":62,"column":20}},{"start":{"line":63,"column":6},"end":{"line":64,"column":21}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":27},"end":{"line":55,"column":47}},{"start":{"line":55,"column":51},"end":{"line":55,"column":54}}]},"5":{"line":56,"type":"binary-expr","locations":[{"start":{"line":56,"column":28},"end":{"line":56,"column":49}},{"start":{"line":56,"column":53},"end":{"line":56,"column":56}}]},"6":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":26},"end":{"line":57,"column":45}},{"start":{"line":57,"column":49},"end":{"line":57,"column":53}}]},"7":{"line":58,"type":"binary-expr","locations":[{"start":{"line":58,"column":29},"end":{"line":58,"column":51}},{"start":{"line":58,"column":55},"end":{"line":58,"column":59}}]},"8":{"line":59,"type":"binary-expr","locations":[{"start":{"line":59,"column":29},"end":{"line":59,"column":51}},{"start":{"line":59,"column":55},"end":{"line":59,"column":58}}]},"9":{"line":60,"type":"binary-expr","locations":[{"start":{"line":60,"column":29},"end":{"line":60,"column":51}},{"start":{"line":60,"column":55},"end":{"line":60,"column":58}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","var _ = require('../../../utils/under-dash');","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","var PageMarginsXform = module.exports = function() {","};","","utils.inherits(PageMarginsXform, BaseXform, {","","  get tag() { return 'pageMargins'; },","","  render: function(xmlStream, model) {","    if (model) {","      var attributes = {","        left: model.left,","        right: model.right,","        top: model.top,","        bottom: model.bottom,","        header: model.header,","        footer: model.footer","      };","      if (_.some(attributes, function(value) { return value !== undefined})) {","        xmlStream.leafNode(this.tag, attributes);","      }","    }","  },","  ","  parseOpen: function(node) {","    switch(node.name) {","      case this.tag:","        this.model = {","          left: parseFloat(node.attributes.left || 0.7),","          right: parseFloat(node.attributes.right || 0.7),","          top: parseFloat(node.attributes.top || 0.75),","          bottom: parseFloat(node.attributes.bottom || 0.75),","          header: parseFloat(node.attributes.header || 0.3),","          footer: parseFloat(node.attributes.footer || 0.3)","        };","        return true;","      default:","        return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"24":1,"25":1,"26":1,"28":1,"31":1,"33":0,"36":0,"37":0,"45":0,"46":0,"52":0,"54":0,"62":0,"64":0,"70":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/page-setup-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/page-setup-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":1,"19":0,"20":1,"21":1,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0,0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"booleanToXml","line":29,"loc":{"start":{"line":29,"column":0},"end":{"line":29,"column":29}}},"2":{"name":"pageOrderToXml","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":31}}},"3":{"name":"cellCommentsToXml","line":40,"loc":{"start":{"line":40,"column":0},"end":{"line":40,"column":34}}},"4":{"name":"errorsToXml","line":49,"loc":{"start":{"line":49,"column":0},"end":{"line":49,"column":28}}},"5":{"name":"pageSizeToModel","line":59,"loc":{"start":{"line":59,"column":0},"end":{"line":59,"column":32}}},"6":{"name":"(anonymous_6)","line":63,"loc":{"start":{"line":63,"column":38},"end":{"line":63,"column":49}}},"7":{"name":"(anonymous_7)","line":68,"loc":{"start":{"line":68,"column":9},"end":{"line":68,"column":12}}},"8":{"name":"(anonymous_8)","line":70,"loc":{"start":{"line":70,"column":10},"end":{"line":70,"column":37}}},"9":{"name":"(anonymous_9)","line":90,"loc":{"start":{"line":90,"column":29},"end":{"line":90,"column":46}}},"10":{"name":"(anonymous_10)","line":98,"loc":{"start":{"line":98,"column":13},"end":{"line":98,"column":28}}},"11":{"name":"(anonymous_11)","line":124,"loc":{"start":{"line":124,"column":13},"end":{"line":124,"column":24}}},"12":{"name":"(anonymous_12)","line":126,"loc":{"start":{"line":126,"column":14},"end":{"line":126,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":45}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":44}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":29,"column":0},"end":{"line":31,"column":1}},"5":{"start":{"line":30,"column":2},"end":{"line":30,"column":33}},"6":{"start":{"line":32,"column":0},"end":{"line":39,"column":1}},"7":{"start":{"line":33,"column":2},"end":{"line":38,"column":3}},"8":{"start":{"line":35,"column":6},"end":{"line":35,"column":19}},"9":{"start":{"line":37,"column":6},"end":{"line":37,"column":23}},"10":{"start":{"line":40,"column":0},"end":{"line":48,"column":1}},"11":{"start":{"line":41,"column":2},"end":{"line":47,"column":3}},"12":{"start":{"line":44,"column":6},"end":{"line":44,"column":19}},"13":{"start":{"line":46,"column":6},"end":{"line":46,"column":23}},"14":{"start":{"line":49,"column":0},"end":{"line":58,"column":1}},"15":{"start":{"line":50,"column":2},"end":{"line":57,"column":3}},"16":{"start":{"line":54,"column":6},"end":{"line":54,"column":19}},"17":{"start":{"line":56,"column":6},"end":{"line":56,"column":23}},"18":{"start":{"line":59,"column":0},"end":{"line":61,"column":1}},"19":{"start":{"line":60,"column":2},"end":{"line":60,"column":59}},"20":{"start":{"line":63,"column":0},"end":{"line":64,"column":2}},"21":{"start":{"line":66,"column":0},"end":{"line":129,"column":3}},"22":{"start":{"line":68,"column":14},"end":{"line":68,"column":33}},"23":{"start":{"line":71,"column":4},"end":{"line":95,"column":5}},"24":{"start":{"line":72,"column":6},"end":{"line":89,"column":8}},"25":{"start":{"line":90,"column":6},"end":{"line":94,"column":7}},"26":{"start":{"line":91,"column":10},"end":{"line":91,"column":37}},"27":{"start":{"line":93,"column":8},"end":{"line":93,"column":49}},"28":{"start":{"line":99,"column":4},"end":{"line":122,"column":5}},"29":{"start":{"line":101,"column":8},"end":{"line":118,"column":10}},"30":{"start":{"line":119,"column":8},"end":{"line":119,"column":20}},"31":{"start":{"line":121,"column":8},"end":{"line":121,"column":21}},"32":{"start":{"line":127,"column":4},"end":{"line":127,"column":17}}},"branchMap":{"1":{"line":30,"type":"cond-expr","locations":[{"start":{"line":30,"column":17},"end":{"line":30,"column":20}},{"start":{"line":30,"column":23},"end":{"line":30,"column":32}}]},"2":{"line":33,"type":"switch","locations":[{"start":{"line":34,"column":4},"end":{"line":35,"column":19}},{"start":{"line":36,"column":4},"end":{"line":37,"column":23}}]},"3":{"line":41,"type":"switch","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":17}},{"start":{"line":43,"column":4},"end":{"line":44,"column":19}},{"start":{"line":45,"column":4},"end":{"line":46,"column":23}}]},"4":{"line":50,"type":"switch","locations":[{"start":{"line":51,"column":4},"end":{"line":51,"column":16}},{"start":{"line":52,"column":4},"end":{"line":52,"column":17}},{"start":{"line":53,"column":4},"end":{"line":54,"column":19}},{"start":{"line":55,"column":4},"end":{"line":56,"column":23}}]},"5":{"line":60,"type":"cond-expr","locations":[{"start":{"line":60,"column":31},"end":{"line":60,"column":46}},{"start":{"line":60,"column":49},"end":{"line":60,"column":58}}]},"6":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":4},"end":{"line":71,"column":4}},{"start":{"line":71,"column":4},"end":{"line":71,"column":4}}]},"7":{"line":90,"type":"if","locations":[{"start":{"line":90,"column":6},"end":{"line":90,"column":6}},{"start":{"line":90,"column":6},"end":{"line":90,"column":6}}]},"8":{"line":99,"type":"switch","locations":[{"start":{"line":100,"column":6},"end":{"line":119,"column":20}},{"start":{"line":120,"column":6},"end":{"line":121,"column":21}}]},"9":{"line":103,"type":"binary-expr","locations":[{"start":{"line":103,"column":23},"end":{"line":103,"column":50}},{"start":{"line":103,"column":54},"end":{"line":103,"column":64}}]},"10":{"line":104,"type":"binary-expr","locations":[{"start":{"line":104,"column":34},"end":{"line":104,"column":63}},{"start":{"line":104,"column":67},"end":{"line":104,"column":77}}]},"11":{"line":105,"type":"binary-expr","locations":[{"start":{"line":105,"column":32},"end":{"line":105,"column":59}},{"start":{"line":105,"column":63},"end":{"line":105,"column":73}}]},"12":{"line":106,"type":"binary-expr","locations":[{"start":{"line":106,"column":21},"end":{"line":106,"column":46}},{"start":{"line":106,"column":50},"end":{"line":106,"column":64}}]},"13":{"line":109,"type":"binary-expr","locations":[{"start":{"line":109,"column":24},"end":{"line":109,"column":52}},{"start":{"line":109,"column":56},"end":{"line":109,"column":62}}]},"14":{"line":110,"type":"binary-expr","locations":[{"start":{"line":110,"column":18},"end":{"line":110,"column":40}},{"start":{"line":110,"column":44},"end":{"line":110,"column":55}}]},"15":{"line":111,"type":"binary-expr","locations":[{"start":{"line":111,"column":26},"end":{"line":111,"column":47}},{"start":{"line":111,"column":51},"end":{"line":111,"column":54}}]},"16":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":31},"end":{"line":112,"column":57}},{"start":{"line":112,"column":61},"end":{"line":112,"column":62}}]},"17":{"line":113,"type":"binary-expr","locations":[{"start":{"line":113,"column":32},"end":{"line":113,"column":59}},{"start":{"line":113,"column":63},"end":{"line":113,"column":64}}]},"18":{"line":114,"type":"binary-expr","locations":[{"start":{"line":114,"column":36},"end":{"line":114,"column":67}},{"start":{"line":114,"column":71},"end":{"line":114,"column":72}}]},"19":{"line":117,"type":"binary-expr","locations":[{"start":{"line":117,"column":27},"end":{"line":117,"column":49}},{"start":{"line":117,"column":53},"end":{"line":117,"column":54}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../../../utils/under-dash');","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","function booleanToXml(model) {","  return model ? '1' : undefined;","}","function pageOrderToXml(model) {","  switch(model) {","    case 'overThenDown': ","      return model;","    default:","      return undefined;","  }","}","function cellCommentsToXml(model) {","  switch(model) {","    case 'atEnd': ","    case 'asDisplyed': ","      return model;","    default:","      return undefined;","  }","}","function errorsToXml(model) {","  switch(model) {","    case 'dash': ","    case 'blank': ","    case 'NA': ","      return model;","    default:","      return undefined;","  }","}","function pageSizeToModel(value) {","  return value !== undefined ? parseInt(value) : undefined;","}","","var PageSetupXform = module.exports = function() {","};","","utils.inherits(PageSetupXform, BaseXform, {","","  get tag() { return 'pageSetup'; },","","  render: function(xmlStream, model) {","    if (model) {","      var attributes = {","        paperSize: model.paperSize,","        orientation: model.orientation,","        horizontalDpi: model.horizontalDpi,","        verticalDpi: model.verticalDpi,","        pageOrder: pageOrderToXml(model.pageOrder),","        blackAndWhite: booleanToXml(model.blackAndWhite),","        draft: booleanToXml(model.draft),","        cellComments: cellCommentsToXml(model.cellComments),","        errors: errorsToXml(model.errors),","        scale: model.scale,","        fitToWidth: model.fitToWidth,","        fitToHeight: model.fitToHeight,","        firstPageNumber: model.firstPageNumber,","        useFirstPageNumber: booleanToXml(model.firstPageNumber),","        usePrinterDefaults: booleanToXml(model.usePrinterDefaults),","        copies: model.copies","      };","      if (_.some(attributes, function (value) {","          return value !== undefined;","        })) {","        xmlStream.leafNode(this.tag, attributes);","      }","    }","  },","  ","  parseOpen: function(node) {","    switch(node.name) {","      case this.tag: ","        this.model = {","          paperSize: pageSizeToModel(node.attributes.paperSize),","          orientation: node.attributes.orientation || 'portrait',","          horizontalDpi: parseInt(node.attributes.horizontalDpi || 4294967295),","          verticalDpi: parseInt(node.attributes.verticalDpi || 4294967295),","          pageOrder: node.attributes.pageOrder || 'downThenOver',","          blackAndWhite: node.attributes.blackAndWhite === '1',","          draft: node.attributes.draft === '1',","          cellComments: node.attributes.cellComments || 'None',","          errors: node.attributes.errors || 'displayed',","          scale: parseInt(node.attributes.scale || 100),","          fitToWidth: parseInt(node.attributes.fitToWidth || 1),","          fitToHeight: parseInt(node.attributes.fitToHeight || 1),","          firstPageNumber: parseInt(node.attributes.firstPageNumber || 1),","          useFirstPageNumber: node.attributes.useFirstPageNumber === '1',","          usePrinterDefaults: node.attributes.usePrinterDefaults === '1',","          copies: parseInt(node.attributes.copies || 1)","        };","        return true;","      default:","        return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"30":0,"32":1,"33":0,"35":0,"37":0,"40":1,"41":0,"44":0,"46":0,"49":1,"50":0,"54":0,"56":0,"59":1,"60":0,"63":1,"66":1,"68":0,"71":0,"72":0,"90":0,"91":0,"93":0,"99":0,"101":0,"119":0,"121":0,"127":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/print-options-xform.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xform/sheet/print-options-xform.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"booleanToXml","line":29,"loc":{"start":{"line":29,"column":0},"end":{"line":29,"column":29}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":41},"end":{"line":33,"column":52}}},"3":{"name":"(anonymous_3)","line":38,"loc":{"start":{"line":38,"column":9},"end":{"line":38,"column":12}}},"4":{"name":"(anonymous_4)","line":40,"loc":{"start":{"line":40,"column":10},"end":{"line":40,"column":37}}},"5":{"name":"(anonymous_5)","line":48,"loc":{"start":{"line":48,"column":29},"end":{"line":48,"column":46}}},"6":{"name":"(anonymous_6)","line":56,"loc":{"start":{"line":56,"column":13},"end":{"line":56,"column":28}}},"7":{"name":"(anonymous_7)","line":70,"loc":{"start":{"line":70,"column":13},"end":{"line":70,"column":24}}},"8":{"name":"(anonymous_8)","line":72,"loc":{"start":{"line":72,"column":14},"end":{"line":72,"column":25}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":45}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":44}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"4":{"start":{"line":29,"column":0},"end":{"line":31,"column":1}},"5":{"start":{"line":30,"column":2},"end":{"line":30,"column":33}},"6":{"start":{"line":33,"column":0},"end":{"line":34,"column":2}},"7":{"start":{"line":36,"column":0},"end":{"line":75,"column":3}},"8":{"start":{"line":38,"column":14},"end":{"line":38,"column":36}},"9":{"start":{"line":41,"column":4},"end":{"line":53,"column":5}},"10":{"start":{"line":42,"column":6},"end":{"line":47,"column":8}},"11":{"start":{"line":48,"column":6},"end":{"line":52,"column":7}},"12":{"start":{"line":49,"column":10},"end":{"line":49,"column":37}},"13":{"start":{"line":51,"column":8},"end":{"line":51,"column":49}},"14":{"start":{"line":57,"column":4},"end":{"line":68,"column":5}},"15":{"start":{"line":59,"column":8},"end":{"line":64,"column":10}},"16":{"start":{"line":65,"column":8},"end":{"line":65,"column":20}},"17":{"start":{"line":67,"column":8},"end":{"line":67,"column":21}},"18":{"start":{"line":73,"column":4},"end":{"line":73,"column":17}}},"branchMap":{"1":{"line":30,"type":"cond-expr","locations":[{"start":{"line":30,"column":17},"end":{"line":30,"column":20}},{"start":{"line":30,"column":23},"end":{"line":30,"column":32}}]},"2":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":4}},{"start":{"line":41,"column":4},"end":{"line":41,"column":4}}]},"3":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":6},"end":{"line":48,"column":6}},{"start":{"line":48,"column":6},"end":{"line":48,"column":6}}]},"4":{"line":57,"type":"switch","locations":[{"start":{"line":58,"column":6},"end":{"line":65,"column":20}},{"start":{"line":66,"column":6},"end":{"line":67,"column":21}}]}},"code":["/**"," * Copyright (c) 2016 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var _ = require('../../../utils/under-dash');","var utils = require('../../../utils/utils');","var BaseXform = require('../base-xform');","","function booleanToXml(model) {","  return model ? '1' : undefined;","}","","var PrintOptionsXform = module.exports = function() {","};","","utils.inherits(PrintOptionsXform, BaseXform, {","","  get tag() { return 'printOptions'; },","","  render: function(xmlStream, model) {","    if (model) {","      var attributes = {","        headings: booleanToXml(model.showRowColHeaders),","        gridLines: booleanToXml(model.showGridLines),","        horizontalCentered: booleanToXml(model.horizontalCentered),","        verticalCentered: booleanToXml(model.verticalCentered)","      };","      if (_.some(attributes, function (value) {","          return value !== undefined;","        })) {","        xmlStream.leafNode(this.tag, attributes);","      }","    }","  },","  ","  parseOpen: function(node) {","    switch(node.name) {","      case this.tag: ","        this.model = {","          showRowColHeaders: node.attributes.headings === '1',","          showGridLines: node.attributes.gridLines === '1',","          horizontalCentered: node.attributes.horizontalCentered === '1',","          verticalCentered: node.attributes.verticalCentered === '1'","        };","        return true;","      default:","        return false;","    }","  },","  parseText: function() {","  },","  parseClose: function() {","    return false;","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"30":0,"33":1,"36":1,"38":0,"41":0,"42":0,"48":0,"49":0,"51":0,"57":0,"59":0,"65":0,"67":0,"73":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xml/theme1.xml.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/xlsx/xml/theme1.xml.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":7914}}},"branchMap":{},"code":["module.exports = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"> <a:themeElements> <a:clrScheme name=\"Office\"> <a:dk1> <a:sysClr val=\"windowText\" lastClr=\"000000\"/> </a:dk1> <a:lt1> <a:sysClr val=\"window\" lastClr=\"FFFFFF\"/> </a:lt1> <a:dk2> <a:srgbClr val=\"1F497D\"/> </a:dk2> <a:lt2> <a:srgbClr val=\"EEECE1\"/> </a:lt2> <a:accent1> <a:srgbClr val=\"4F81BD\"/> </a:accent1> <a:accent2> <a:srgbClr val=\"C0504D\"/> </a:accent2> <a:accent3> <a:srgbClr val=\"9BBB59\"/> </a:accent3> <a:accent4> <a:srgbClr val=\"8064A2\"/> </a:accent4> <a:accent5> <a:srgbClr val=\"4BACC6\"/> </a:accent5> <a:accent6> <a:srgbClr val=\"F79646\"/> </a:accent6> <a:hlink> <a:srgbClr val=\"0000FF\"/> </a:hlink> <a:folHlink> <a:srgbClr val=\"800080\"/> </a:folHlink> </a:clrScheme> <a:fontScheme name=\"Office\"> <a:majorFont> <a:latin typeface=\"Cambria\"/> <a:ea typeface=\"\"/> <a:cs typeface=\"\"/> <a:font script=\"Jpan\" typeface=\" \"/> <a:font script=\"Hang\" typeface=\" \"/> <a:font script=\"Hans\" typeface=\"\"/> <a:font script=\"Hant\" typeface=\"\"/> <a:font script=\"Arab\" typeface=\"Times New Roman\"/> <a:font script=\"Hebr\" typeface=\"Times New Roman\"/> <a:font script=\"Thai\" typeface=\"Tahoma\"/> <a:font script=\"Ethi\" typeface=\"Nyala\"/> <a:font script=\"Beng\" typeface=\"Vrinda\"/> <a:font script=\"Gujr\" typeface=\"Shruti\"/> <a:font script=\"Khmr\" typeface=\"MoolBoran\"/> <a:font script=\"Knda\" typeface=\"Tunga\"/> <a:font script=\"Guru\" typeface=\"Raavi\"/> <a:font script=\"Cans\" typeface=\"Euphemia\"/> <a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/> <a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/> <a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/> <a:font script=\"Thaa\" typeface=\"MV Boli\"/> <a:font script=\"Deva\" typeface=\"Mangal\"/> <a:font script=\"Telu\" typeface=\"Gautami\"/> <a:font script=\"Taml\" typeface=\"Latha\"/> <a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/> <a:font script=\"Orya\" typeface=\"Kalinga\"/> <a:font script=\"Mlym\" typeface=\"Kartika\"/> <a:font script=\"Laoo\" typeface=\"DokChampa\"/> <a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/> <a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/> <a:font script=\"Viet\" typeface=\"Times New Roman\"/> <a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/> <a:font script=\"Geor\" typeface=\"Sylfaen\"/> </a:majorFont> <a:minorFont> <a:latin typeface=\"Calibri\"/> <a:ea typeface=\"\"/> <a:cs typeface=\"\"/> <a:font script=\"Jpan\" typeface=\" \"/> <a:font script=\"Hang\" typeface=\" \"/> <a:font script=\"Hans\" typeface=\"\"/> <a:font script=\"Hant\" typeface=\"\"/> <a:font script=\"Arab\" typeface=\"Arial\"/> <a:font script=\"Hebr\" typeface=\"Arial\"/> <a:font script=\"Thai\" typeface=\"Tahoma\"/> <a:font script=\"Ethi\" typeface=\"Nyala\"/> <a:font script=\"Beng\" typeface=\"Vrinda\"/> <a:font script=\"Gujr\" typeface=\"Shruti\"/> <a:font script=\"Khmr\" typeface=\"DaunPenh\"/> <a:font script=\"Knda\" typeface=\"Tunga\"/> <a:font script=\"Guru\" typeface=\"Raavi\"/> <a:font script=\"Cans\" typeface=\"Euphemia\"/> <a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/> <a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/> <a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/> <a:font script=\"Thaa\" typeface=\"MV Boli\"/> <a:font script=\"Deva\" typeface=\"Mangal\"/> <a:font script=\"Telu\" typeface=\"Gautami\"/> <a:font script=\"Taml\" typeface=\"Latha\"/> <a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/> <a:font script=\"Orya\" typeface=\"Kalinga\"/> <a:font script=\"Mlym\" typeface=\"Kartika\"/> <a:font script=\"Laoo\" typeface=\"DokChampa\"/> <a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/> <a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/> <a:font script=\"Viet\" typeface=\"Arial\"/> <a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/> <a:font script=\"Geor\" typeface=\"Sylfaen\"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name=\"Office\"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val=\"phClr\"/> </a:solidFill> <a:gradFill rotWithShape=\"1\"> <a:gsLst> <a:gs pos=\"0\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"50000\"/> <a:satMod val=\"300000\"/> </a:schemeClr> </a:gs> <a:gs pos=\"35000\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"37000\"/> <a:satMod val=\"300000\"/> </a:schemeClr> </a:gs> <a:gs pos=\"100000\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"15000\"/> <a:satMod val=\"350000\"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang=\"16200000\" scaled=\"1\"/> </a:gradFill> <a:gradFill rotWithShape=\"1\"> <a:gsLst> <a:gs pos=\"0\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"100000\"/> <a:shade val=\"100000\"/> <a:satMod val=\"130000\"/> </a:schemeClr> </a:gs> <a:gs pos=\"100000\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"50000\"/> <a:shade val=\"100000\"/> <a:satMod val=\"350000\"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang=\"16200000\" scaled=\"0\"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"> <a:solidFill> <a:schemeClr val=\"phClr\"> <a:shade val=\"95000\"/> <a:satMod val=\"105000\"/> </a:schemeClr> </a:solidFill> <a:prstDash val=\"solid\"/> </a:ln> <a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"> <a:solidFill> <a:schemeClr val=\"phClr\"/> </a:solidFill> <a:prstDash val=\"solid\"/> </a:ln> <a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"> <a:solidFill> <a:schemeClr val=\"phClr\"/> </a:solidFill> <a:prstDash val=\"solid\"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"> <a:srgbClr val=\"000000\"> <a:alpha val=\"38000\"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"> <a:srgbClr val=\"000000\"> <a:alpha val=\"35000\"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"> <a:srgbClr val=\"000000\"> <a:alpha val=\"35000\"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst=\"orthographicFront\"> <a:rot lat=\"0\" lon=\"0\" rev=\"0\"/> </a:camera> <a:lightRig rig=\"threePt\" dir=\"t\"> <a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w=\"63500\" h=\"25400\"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val=\"phClr\"/> </a:solidFill> <a:gradFill rotWithShape=\"1\"> <a:gsLst> <a:gs pos=\"0\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"40000\"/> <a:satMod val=\"350000\"/> </a:schemeClr> </a:gs> <a:gs pos=\"40000\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"45000\"/> <a:shade val=\"99000\"/> <a:satMod val=\"350000\"/> </a:schemeClr> </a:gs> <a:gs pos=\"100000\"> <a:schemeClr val=\"phClr\"> <a:shade val=\"20000\"/> <a:satMod val=\"255000\"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path=\"circle\"> <a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/> </a:path> </a:gradFill> <a:gradFill rotWithShape=\"1\"> <a:gsLst> <a:gs pos=\"0\"> <a:schemeClr val=\"phClr\"> <a:tint val=\"80000\"/> <a:satMod val=\"300000\"/> </a:schemeClr> </a:gs> <a:gs pos=\"100000\"> <a:schemeClr val=\"phClr\"> <a:shade val=\"30000\"/> <a:satMod val=\"200000\"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path=\"circle\"> <a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx=\"1\"> <a:schemeClr val=\"accent1\"/> </a:lnRef> <a:fillRef idx=\"3\"> <a:schemeClr val=\"accent1\"/> </a:fillRef> <a:effectRef idx=\"2\"> <a:schemeClr val=\"accent1\"/> </a:effectRef> <a:fontRef idx=\"minor\"> <a:schemeClr val=\"lt1\"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx=\"2\"> <a:schemeClr val=\"accent1\"/> </a:lnRef> <a:fillRef idx=\"0\"> <a:schemeClr val=\"accent1\"/> </a:fillRef> <a:effectRef idx=\"1\"> <a:schemeClr val=\"accent1\"/> </a:effectRef> <a:fontRef idx=\"minor\"> <a:schemeClr val=\"tx1\"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>';"],"l":{"1":1}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/csv/csv.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/csv/csv.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0},"fnMap":{"1":{"name":"(anonymous_1)","line":33,"loc":{"start":{"line":33,"column":27},"end":{"line":33,"column":46}}},"2":{"name":"(anonymous_2)","line":52,"loc":{"start":{"line":52,"column":12},"end":{"line":52,"column":40}}},"3":{"name":"(anonymous_3)","line":57,"loc":{"start":{"line":57,"column":12},"end":{"line":57,"column":29}}},"4":{"name":"(anonymous_4)","line":64,"loc":{"start":{"line":64,"column":12},"end":{"line":64,"column":32}}},"5":{"name":"(anonymous_5)","line":69,"loc":{"start":{"line":69,"column":8},"end":{"line":69,"column":34}}},"6":{"name":"(anonymous_6)","line":72,"loc":{"start":{"line":72,"column":34},"end":{"line":72,"column":60}}},"7":{"name":"(anonymous_7)","line":75,"loc":{"start":{"line":75,"column":25},"end":{"line":75,"column":45}}},"8":{"name":"(anonymous_8)","line":78,"loc":{"start":{"line":78,"column":21},"end":{"line":78,"column":37}}},"9":{"name":"(anonymous_9)","line":87,"loc":{"start":{"line":87,"column":21},"end":{"line":87,"column":39}}},"10":{"name":"(anonymous_10)","line":96,"loc":{"start":{"line":96,"column":29},"end":{"line":96,"column":45}}},"11":{"name":"(anonymous_11)","line":115,"loc":{"start":{"line":115,"column":18},"end":{"line":115,"column":32}}},"12":{"name":"(anonymous_12)","line":118,"loc":{"start":{"line":118,"column":17},"end":{"line":118,"column":28}}},"13":{"name":"(anonymous_13)","line":124,"loc":{"start":{"line":124,"column":9},"end":{"line":124,"column":35}}},"14":{"name":"(anonymous_14)","line":128,"loc":{"start":{"line":128,"column":34},"end":{"line":128,"column":60}}},"15":{"name":"(anonymous_15)","line":137,"loc":{"start":{"line":137,"column":26},"end":{"line":137,"column":37}}},"16":{"name":"(anonymous_16)","line":140,"loc":{"start":{"line":140,"column":28},"end":{"line":140,"column":44}}},"17":{"name":"(anonymous_17)","line":146,"loc":{"start":{"line":146,"column":31},"end":{"line":146,"column":47}}},"18":{"name":"(anonymous_18)","line":170,"loc":{"start":{"line":170,"column":26},"end":{"line":170,"column":52}}},"19":{"name":"(anonymous_19)","line":186,"loc":{"start":{"line":186,"column":13},"end":{"line":186,"column":41}}}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":26,"column":23}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":30}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":31}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":45}},"5":{"start":{"line":31,"column":0},"end":{"line":31,"column":38}},"6":{"start":{"line":33,"column":0},"end":{"line":36,"column":2}},"7":{"start":{"line":34,"column":2},"end":{"line":34,"column":27}},"8":{"start":{"line":35,"column":2},"end":{"line":35,"column":24}},"9":{"start":{"line":38,"column":0},"end":{"line":48,"column":2}},"10":{"start":{"line":51,"column":0},"end":{"line":196,"column":2}},"11":{"start":{"line":53,"column":4},"end":{"line":53,"column":20}},"12":{"start":{"line":54,"column":4},"end":{"line":54,"column":28}},"13":{"start":{"line":55,"column":4},"end":{"line":55,"column":15}},"14":{"start":{"line":56,"column":4},"end":{"line":67,"column":9}},"15":{"start":{"line":58,"column":8},"end":{"line":60,"column":9}},"16":{"start":{"line":59,"column":10},"end":{"line":59,"column":57}},"17":{"start":{"line":61,"column":8},"end":{"line":61,"column":47}},"18":{"start":{"line":62,"column":8},"end":{"line":62,"column":42}},"19":{"start":{"line":65,"column":8},"end":{"line":65,"column":23}},"20":{"start":{"line":66,"column":8},"end":{"line":66,"column":25}},"21":{"start":{"line":70,"column":4},"end":{"line":70,"column":28}},"22":{"start":{"line":71,"column":4},"end":{"line":71,"column":20}},"23":{"start":{"line":72,"column":4},"end":{"line":84,"column":7}},"24":{"start":{"line":74,"column":6},"end":{"line":80,"column":11}},"25":{"start":{"line":76,"column":10},"end":{"line":76,"column":29}},"26":{"start":{"line":79,"column":10},"end":{"line":79,"column":24}},"27":{"start":{"line":82,"column":6},"end":{"line":82,"column":29}},"28":{"start":{"line":88,"column":4},"end":{"line":88,"column":28}},"29":{"start":{"line":89,"column":4},"end":{"line":89,"column":66}},"30":{"start":{"line":91,"column":4},"end":{"line":95,"column":8}},"31":{"start":{"line":96,"column":4},"end":{"line":112,"column":8}},"32":{"start":{"line":97,"column":8},"end":{"line":99,"column":9}},"33":{"start":{"line":98,"column":10},"end":{"line":98,"column":22}},"34":{"start":{"line":100,"column":8},"end":{"line":102,"column":9}},"35":{"start":{"line":101,"column":10},"end":{"line":101,"column":35}},"36":{"start":{"line":103,"column":8},"end":{"line":103,"column":50}},"37":{"start":{"line":104,"column":8},"end":{"line":106,"column":9}},"38":{"start":{"line":105,"column":10},"end":{"line":105,"column":40}},"39":{"start":{"line":107,"column":8},"end":{"line":107,"column":44}},"40":{"start":{"line":108,"column":8},"end":{"line":110,"column":9}},"41":{"start":{"line":109,"column":10},"end":{"line":109,"column":25}},"42":{"start":{"line":111,"column":8},"end":{"line":111,"column":21}},"43":{"start":{"line":114,"column":4},"end":{"line":120,"column":9}},"44":{"start":{"line":116,"column":8},"end":{"line":116,"column":40}},"45":{"start":{"line":119,"column":8},"end":{"line":119,"column":47}},"46":{"start":{"line":121,"column":4},"end":{"line":121,"column":21}},"47":{"start":{"line":126,"column":4},"end":{"line":126,"column":20}},"48":{"start":{"line":128,"column":4},"end":{"line":183,"column":7}},"49":{"start":{"line":129,"column":6},"end":{"line":129,"column":30}},"50":{"start":{"line":134,"column":6},"end":{"line":134,"column":87}},"51":{"start":{"line":136,"column":6},"end":{"line":136,"column":53}},"52":{"start":{"line":137,"column":6},"end":{"line":139,"column":9}},"53":{"start":{"line":138,"column":8},"end":{"line":138,"column":18}},"54":{"start":{"line":140,"column":6},"end":{"line":142,"column":9}},"55":{"start":{"line":141,"column":8},"end":{"line":141,"column":22}},"56":{"start":{"line":143,"column":6},"end":{"line":143,"column":29}},"57":{"start":{"line":145,"column":6},"end":{"line":145,"column":42}},"58":{"start":{"line":146,"column":6},"end":{"line":165,"column":10}},"59":{"start":{"line":147,"column":10},"end":{"line":163,"column":11}},"60":{"start":{"line":148,"column":12},"end":{"line":150,"column":13}},"61":{"start":{"line":149,"column":14},"end":{"line":149,"column":57}},"62":{"start":{"line":151,"column":12},"end":{"line":153,"column":13}},"63":{"start":{"line":152,"column":14},"end":{"line":152,"column":40}},"64":{"start":{"line":154,"column":12},"end":{"line":156,"column":13}},"65":{"start":{"line":155,"column":14},"end":{"line":155,"column":92}},"66":{"start":{"line":157,"column":12},"end":{"line":159,"column":13}},"67":{"start":{"line":158,"column":14},"end":{"line":158,"column":33}},"68":{"start":{"line":160,"column":12},"end":{"line":162,"column":13}},"69":{"start":{"line":161,"column":14},"end":{"line":161,"column":43}},"70":{"start":{"line":164,"column":10},"end":{"line":164,"column":23}},"71":{"start":{"line":167,"column":6},"end":{"line":167,"column":98}},"72":{"start":{"line":168,"column":6},"end":{"line":168,"column":22}},"73":{"start":{"line":169,"column":6},"end":{"line":181,"column":7}},"74":{"start":{"line":170,"column":8},"end":{"line":180,"column":11}},"75":{"start":{"line":171,"column":10},"end":{"line":175,"column":11}},"76":{"start":{"line":172,"column":12},"end":{"line":174,"column":13}},"77":{"start":{"line":173,"column":14},"end":{"line":173,"column":34}},"78":{"start":{"line":176,"column":10},"end":{"line":176,"column":34}},"79":{"start":{"line":177,"column":10},"end":{"line":177,"column":25}},"80":{"start":{"line":178,"column":10},"end":{"line":178,"column":43}},"81":{"start":{"line":179,"column":10},"end":{"line":179,"column":30}},"82":{"start":{"line":182,"column":6},"end":{"line":182,"column":22}},"83":{"start":{"line":187,"column":4},"end":{"line":187,"column":28}},"84":{"start":{"line":189,"column":4},"end":{"line":191,"column":6}},"85":{"start":{"line":192,"column":4},"end":{"line":192,"column":57}},"86":{"start":{"line":194,"column":4},"end":{"line":194,"column":39}}},"branchMap":{"1":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":14},"end":{"line":54,"column":21}},{"start":{"line":54,"column":25},"end":{"line":54,"column":27}}]},"2":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":8},"end":{"line":58,"column":8}},{"start":{"line":58,"column":8},"end":{"line":58,"column":8}}]},"3":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":14},"end":{"line":70,"column":21}},{"start":{"line":70,"column":25},"end":{"line":70,"column":27}}]},"4":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":14},"end":{"line":88,"column":21}},{"start":{"line":88,"column":25},"end":{"line":88,"column":27}}]},"5":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":22},"end":{"line":91,"column":41}},{"start":{"line":91,"column":45},"end":{"line":95,"column":7}}]},"6":{"line":96,"type":"binary-expr","locations":[{"start":{"line":96,"column":14},"end":{"line":96,"column":25}},{"start":{"line":96,"column":29},"end":{"line":112,"column":7}}]},"7":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":8},"end":{"line":97,"column":8}},{"start":{"line":97,"column":8},"end":{"line":97,"column":8}}]},"8":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":8},"end":{"line":100,"column":8}},{"start":{"line":100,"column":8},"end":{"line":100,"column":8}}]},"9":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":8},"end":{"line":104,"column":8}},{"start":{"line":104,"column":8},"end":{"line":104,"column":8}}]},"10":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":8},"end":{"line":108,"column":8}},{"start":{"line":108,"column":8},"end":{"line":108,"column":8}}]},"11":{"line":129,"type":"binary-expr","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":23}},{"start":{"line":129,"column":27},"end":{"line":129,"column":29}}]},"12":{"line":134,"type":"binary-expr","locations":[{"start":{"line":134,"column":49},"end":{"line":134,"column":66}},{"start":{"line":134,"column":70},"end":{"line":134,"column":85}}]},"13":{"line":146,"type":"binary-expr","locations":[{"start":{"line":146,"column":16},"end":{"line":146,"column":27}},{"start":{"line":146,"column":31},"end":{"line":165,"column":9}}]},"14":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":10},"end":{"line":147,"column":10}},{"start":{"line":147,"column":10},"end":{"line":147,"column":10}}]},"15":{"line":148,"type":"if","locations":[{"start":{"line":148,"column":12},"end":{"line":148,"column":12}},{"start":{"line":148,"column":12},"end":{"line":148,"column":12}}]},"16":{"line":148,"type":"binary-expr","locations":[{"start":{"line":148,"column":16},"end":{"line":148,"column":26}},{"start":{"line":148,"column":30},"end":{"line":148,"column":45}}]},"17":{"line":149,"type":"binary-expr","locations":[{"start":{"line":149,"column":21},"end":{"line":149,"column":36}},{"start":{"line":149,"column":40},"end":{"line":149,"column":50}},{"start":{"line":149,"column":54},"end":{"line":149,"column":56}}]},"18":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":12},"end":{"line":151,"column":12}},{"start":{"line":151,"column":12},"end":{"line":151,"column":12}}]},"19":{"line":151,"type":"binary-expr","locations":[{"start":{"line":151,"column":16},"end":{"line":151,"column":29}},{"start":{"line":151,"column":33},"end":{"line":151,"column":45}}]},"20":{"line":152,"type":"binary-expr","locations":[{"start":{"line":152,"column":21},"end":{"line":152,"column":33}},{"start":{"line":152,"column":37},"end":{"line":152,"column":39}}]},"21":{"line":154,"type":"if","locations":[{"start":{"line":154,"column":12},"end":{"line":154,"column":12}},{"start":{"line":154,"column":12},"end":{"line":154,"column":12}}]},"22":{"line":155,"type":"cond-expr","locations":[{"start":{"line":155,"column":34},"end":{"line":155,"column":66}},{"start":{"line":155,"column":69},"end":{"line":155,"column":91}}]},"23":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":12},"end":{"line":157,"column":12}},{"start":{"line":157,"column":12},"end":{"line":157,"column":12}}]},"24":{"line":160,"type":"if","locations":[{"start":{"line":160,"column":12},"end":{"line":160,"column":12}},{"start":{"line":160,"column":12},"end":{"line":160,"column":12}}]},"25":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":30},"end":{"line":167,"column":68}},{"start":{"line":167,"column":73},"end":{"line":167,"column":97}}]},"26":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":6},"end":{"line":169,"column":6}},{"start":{"line":169,"column":6},"end":{"line":169,"column":6}}]},"27":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":10},"end":{"line":171,"column":10}},{"start":{"line":171,"column":10},"end":{"line":171,"column":10}}]},"28":{"line":187,"type":"binary-expr","locations":[{"start":{"line":187,"column":14},"end":{"line":187,"column":21}},{"start":{"line":187,"column":25},"end":{"line":187,"column":27}}]},"29":{"line":190,"type":"binary-expr","locations":[{"start":{"line":190,"column":16},"end":{"line":190,"column":32}},{"start":{"line":190,"column":36},"end":{"line":190,"column":42}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","","var fs = require('fs');","var csv = require('fast-csv');","var moment = require('moment');","var PromishLib = require('../utils/promish');","","var utils = require('../utils/utils');","","var CSV = module.exports = function(workbook) {","  this.workbook = workbook;","  this.worksheet = null;","};","","var SpecialValues = {","  'true': true,","  'false': false,","  '#N/A': { error: '#N/A' },","  '#REF!': { error: '#REF!' },","  '#NAME?': { error: '#NAME?' },","  '#DIV/0!': { error: '#DIV/0!' },","  '#NULL!': { error: '#NULL!' },","  '#VALUE!': { error: '#VALUE!' },","  '#NUM!': { error: '#NUM!' },","};","","","CSV.prototype = {","  readFile: function(filename, options) {","    var self = this;","    options = options || {};","    var stream;","    return utils.fs.exists(filename)","      .then(function(exists) {","        if (!exists) {","          throw new Error('File not found: ' + filename);","        }","        stream = fs.createReadStream(filename);","        return self.read(stream, options);","      })","      .then(function(worksheet) {","        stream.close();","        return worksheet;","      });","  },","  read: function(stream, options) {","    options = options || {};","    var self = this;","    return new PromishLib.Promish(function(resolve, reject) {","","      var csvStream = self.createInputStream(options)","        .on('worksheet', function(worksheet) {","          resolve(worksheet);","        })","        .on('error', function(error) {","          reject(error);","        });","","      stream.pipe(csvStream);","","    });","","  },","  createInputStream: function(options) {","    options = options || {};","    var worksheet = this.workbook.addWorksheet(options.sheetName);","","    var dateFormats = options.dateFormats || [","        moment.ISO_8601,","        'MM-DD-YYYY',","        'YYYY-MM-DD'","      ];","    var map = options.map || function(datum) {","        if (datum == '') {","          return null;","        }","        if (!isNaN(datum)) {","          return parseFloat(datum);","        }","        var dt = moment(datum, dateFormats, true);","        if (dt.isValid()) {","          return new Date(dt.valueOf());","        }","        var special =  SpecialValues[datum];","        if (special !== undefined) {","          return special;","        }","        return datum;","      };","","    var csvStream = csv(options)","      .on('data', function(data){","        worksheet.addRow(data.map(map));","      })","      .on('end', function() {","        csvStream.emit('worksheet', worksheet);","      });","    return csvStream;","  },","","  write: function(stream, options) {","","    var self = this;","","    return new PromishLib.Promish(function(resolve, reject) {","      options = options || {};","      //var encoding = options.encoding || 'utf8';","      //var separator = options.separator || ',';","      //var quoteChar = options.quoteChar || '\\'';","","      var worksheet = self.workbook.getWorksheet(options.sheetName || options.sheetId);","","      var csvStream = csv.createWriteStream(options);","      stream.on('finish', function() {","        resolve();","      });","      csvStream.on('error', function(error) {","        reject(error);","      });","      csvStream.pipe(stream);","","      var dateFormat = options.dateFormat;","      var map = options.map || function(value) {","          if (value) {","            if (value.text || value.hyperlink) {","              return value.hyperlink || value.text || '';","            }","            if (value.formula || value.result) {","              return value.result || '';","            }","            if (value instanceof Date) {","              return dateFormat ? moment(value).format(dateFormat) : moment(value).format();","            }","            if (value.error) {","              return value.error;","            }","            if (typeof value === 'object') {","              return JSON.stringify(value);","            }","          }","          return value;","        };","","      var includeEmptyRows = (options.includeEmptyRows === undefined) || options.includeEmptyRows;","      var lastRow = 1;","      if (worksheet) {","        worksheet.eachRow(function (row, rowNumber) {","          if (includeEmptyRows) {","            while (lastRow++ < rowNumber - 1) {","              csvStream.write([]);","            }","          }","          var values = row.values;","          values.shift();","          csvStream.write(values.map(map));","          lastRow = rowNumber;","        });","      }","      csvStream.end();","    });","","  },","  writeFile: function(filename, options) {","    options = options || {};","","    var streamOptions = {","      encoding: options.encoding || 'utf8'","    };","    var stream = fs.createWriteStream(filename, options);","","    return this.write(stream, options);","  }","};",""],"l":{"26":1,"27":1,"28":1,"29":1,"31":1,"33":1,"34":1,"35":1,"38":1,"51":1,"53":0,"54":0,"55":0,"56":0,"58":0,"59":0,"61":0,"62":0,"65":0,"66":0,"70":0,"71":0,"72":0,"74":0,"76":0,"79":0,"82":0,"88":0,"89":0,"91":0,"96":0,"97":0,"98":0,"100":0,"101":0,"103":0,"104":0,"105":0,"107":0,"108":0,"109":0,"111":0,"114":0,"116":0,"119":0,"121":0,"126":0,"128":0,"129":0,"134":0,"136":0,"137":0,"138":0,"140":0,"141":0,"143":0,"145":0,"146":0,"147":0,"148":0,"149":0,"151":0,"152":0,"154":0,"155":0,"157":0,"158":0,"160":0,"161":0,"164":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"176":0,"177":0,"178":0,"179":0,"182":0,"187":0,"189":0,"192":0,"194":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/modelcontainer.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/doc/modelcontainer.js","s":{"1":1,"2":1,"3":0,"4":1,"5":8},"b":{"1":[8,1]},"f":{"1":0,"2":8},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":38},"end":{"line":27,"column":54}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":10},"end":{"line":33,"column":13}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":37}},"2":{"start":{"line":27,"column":0},"end":{"line":29,"column":2}},"3":{"start":{"line":28,"column":2},"end":{"line":28,"column":21}},"4":{"start":{"line":32,"column":0},"end":{"line":36,"column":2}},"5":{"start":{"line":34,"column":4},"end":{"line":34,"column":55}}},"branchMap":{"1":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":11},"end":{"line":34,"column":21}},{"start":{"line":34,"column":26},"end":{"line":34,"column":53}}]}},"code":["/**"," * Copyright (c) 2014 Guyon Roche"," * "," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," * "," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," * "," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," * "," */","'use strict';","","var XLSX = require('./../xlsx/xlsx');","","var ModelContainer = module.exports = function(model) {","  this.model = model;","};","","","ModelContainer.prototype = {","  get xlsx() {","    return this._xlsx || (this._xlsx = new XLSX(this));","  }","};"],"l":{"25":1,"27":1,"28":0,"32":1,"34":8}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/workbook-writer.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/workbook-writer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":1,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},"fnMap":{"1":{"name":"(anonymous_1)","line":48,"loc":{"start":{"line":48,"column":38},"end":{"line":48,"column":56}}},"2":{"name":"(anonymous_2)","line":89,"loc":{"start":{"line":89,"column":18},"end":{"line":89,"column":21}}},"3":{"name":"(anonymous_3)","line":93,"loc":{"start":{"line":93,"column":15},"end":{"line":93,"column":30}}},"4":{"name":"(anonymous_4)","line":97,"loc":{"start":{"line":97,"column":24},"end":{"line":97,"column":35}}},"5":{"name":"(anonymous_5)","line":102,"loc":{"start":{"line":102,"column":21},"end":{"line":102,"column":32}}},"6":{"name":"(anonymous_6)","line":103,"loc":{"start":{"line":103,"column":26},"end":{"line":103,"column":46}}},"7":{"name":"(anonymous_7)","line":105,"loc":{"start":{"line":105,"column":38},"end":{"line":105,"column":56}}},"8":{"name":"(anonymous_8)","line":106,"loc":{"start":{"line":106,"column":40},"end":{"line":106,"column":51}}},"9":{"name":"(anonymous_9)","line":123,"loc":{"start":{"line":123,"column":10},"end":{"line":123,"column":21}}},"10":{"name":"(anonymous_10)","line":127,"loc":{"start":{"line":127,"column":29},"end":{"line":127,"column":40}}},"11":{"name":"(anonymous_11)","line":130,"loc":{"start":{"line":130,"column":12},"end":{"line":130,"column":23}}},"12":{"name":"(anonymous_12)","line":140,"loc":{"start":{"line":140,"column":12},"end":{"line":140,"column":23}}},"13":{"name":"(anonymous_13)","line":143,"loc":{"start":{"line":143,"column":12},"end":{"line":143,"column":22}}},"14":{"name":"(anonymous_14)","line":147,"loc":{"start":{"line":147,"column":12},"end":{"line":147,"column":15}}},"15":{"name":"(anonymous_15)","line":157,"loc":{"start":{"line":157,"column":16},"end":{"line":157,"column":40}}},"16":{"name":"(anonymous_16)","line":189,"loc":{"start":{"line":189,"column":16},"end":{"line":189,"column":29}}},"17":{"name":"(anonymous_17)","line":191,"loc":{"start":{"line":191,"column":35},"end":{"line":191,"column":46}}},"18":{"name":"(anonymous_18)","line":195,"loc":{"start":{"line":195,"column":35},"end":{"line":195,"column":55}}},"19":{"name":"(anonymous_19)","line":202,"loc":{"start":{"line":202,"column":13},"end":{"line":202,"column":24}}},"20":{"name":"(anonymous_20)","line":204,"loc":{"start":{"line":204,"column":34},"end":{"line":204,"column":52}}},"21":{"name":"(anonymous_21)","line":209,"loc":{"start":{"line":209,"column":13},"end":{"line":209,"column":24}}},"22":{"name":"(anonymous_22)","line":211,"loc":{"start":{"line":211,"column":34},"end":{"line":211,"column":52}}},"23":{"name":"(anonymous_23)","line":216,"loc":{"start":{"line":216,"column":17},"end":{"line":216,"column":28}}},"24":{"name":"(anonymous_24)","line":218,"loc":{"start":{"line":218,"column":34},"end":{"line":218,"column":52}}},"25":{"name":"(anonymous_25)","line":228,"loc":{"start":{"line":228,"column":19},"end":{"line":228,"column":30}}},"26":{"name":"(anonymous_26)","line":230,"loc":{"start":{"line":230,"column":34},"end":{"line":230,"column":52}}},"27":{"name":"(anonymous_27)","line":240,"loc":{"start":{"line":240,"column":10},"end":{"line":240,"column":21}}},"28":{"name":"(anonymous_28)","line":242,"loc":{"start":{"line":242,"column":34},"end":{"line":242,"column":52}}},"29":{"name":"(anonymous_29)","line":252,"loc":{"start":{"line":252,"column":11},"end":{"line":252,"column":22}}},"30":{"name":"(anonymous_30)","line":254,"loc":{"start":{"line":254,"column":34},"end":{"line":254,"column":52}}},"31":{"name":"(anonymous_31)","line":261,"loc":{"start":{"line":261,"column":20},"end":{"line":261,"column":31}}},"32":{"name":"(anonymous_32)","line":264,"loc":{"start":{"line":264,"column":36},"end":{"line":264,"column":54}}},"33":{"name":"(anonymous_33)","line":274,"loc":{"start":{"line":274,"column":19},"end":{"line":274,"column":30}}},"34":{"name":"(anonymous_34)","line":286,"loc":{"start":{"line":286,"column":29},"end":{"line":286,"column":50}}},"35":{"name":"(anonymous_35)","line":294,"loc":{"start":{"line":294,"column":34},"end":{"line":294,"column":52}}},"36":{"name":"(anonymous_36)","line":301,"loc":{"start":{"line":301,"column":15},"end":{"line":301,"column":26}}},"37":{"name":"(anonymous_37)","line":310,"loc":{"start":{"line":310,"column":34},"end":{"line":310,"column":52}}},"38":{"name":"(anonymous_38)","line":317,"loc":{"start":{"line":317,"column":13},"end":{"line":317,"column":24}}},"39":{"name":"(anonymous_39)","line":319,"loc":{"start":{"line":319,"column":34},"end":{"line":319,"column":60}}},"40":{"name":"(anonymous_40)","line":320,"loc":{"start":{"line":320,"column":30},"end":{"line":320,"column":45}}},"41":{"name":"(anonymous_41)","line":323,"loc":{"start":{"line":323,"column":31},"end":{"line":323,"column":41}}},"42":{"name":"(anonymous_42)","line":326,"loc":{"start":{"line":326,"column":27},"end":{"line":326,"column":42}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":23}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":35}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":48}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":41}},"5":{"start":{"line":30,"column":0},"end":{"line":30,"column":50}},"6":{"start":{"line":32,"column":0},"end":{"line":32,"column":45}},"7":{"start":{"line":33,"column":0},"end":{"line":33,"column":65}},"8":{"start":{"line":34,"column":0},"end":{"line":34,"column":58}},"9":{"start":{"line":35,"column":0},"end":{"line":35,"column":54}},"10":{"start":{"line":37,"column":0},"end":{"line":37,"column":60}},"11":{"start":{"line":38,"column":0},"end":{"line":38,"column":78}},"12":{"start":{"line":39,"column":0},"end":{"line":39,"column":77}},"13":{"start":{"line":40,"column":0},"end":{"line":40,"column":58}},"14":{"start":{"line":41,"column":0},"end":{"line":41,"column":68}},"15":{"start":{"line":42,"column":0},"end":{"line":42,"column":82}},"16":{"start":{"line":44,"column":0},"end":{"line":44,"column":52}},"17":{"start":{"line":46,"column":0},"end":{"line":46,"column":56}},"18":{"start":{"line":48,"column":0},"end":{"line":87,"column":2}},"19":{"start":{"line":49,"column":2},"end":{"line":49,"column":26}},"20":{"start":{"line":52,"column":2},"end":{"line":52,"column":47}},"21":{"start":{"line":53,"column":2},"end":{"line":53,"column":51}},"22":{"start":{"line":54,"column":2},"end":{"line":54,"column":46}},"23":{"start":{"line":55,"column":2},"end":{"line":55,"column":60}},"24":{"start":{"line":56,"column":2},"end":{"line":56,"column":41}},"25":{"start":{"line":59,"column":2},"end":{"line":59,"column":60}},"26":{"start":{"line":60,"column":2},"end":{"line":60,"column":43}},"27":{"start":{"line":63,"column":2},"end":{"line":63,"column":87}},"28":{"start":{"line":66,"column":2},"end":{"line":66,"column":42}},"29":{"start":{"line":68,"column":2},"end":{"line":68,"column":24}},"30":{"start":{"line":69,"column":2},"end":{"line":69,"column":18}},"31":{"start":{"line":71,"column":2},"end":{"line":71,"column":29}},"32":{"start":{"line":72,"column":2},"end":{"line":78,"column":3}},"33":{"start":{"line":73,"column":4},"end":{"line":73,"column":33}},"34":{"start":{"line":74,"column":9},"end":{"line":78,"column":3}},"35":{"start":{"line":75,"column":4},"end":{"line":75,"column":57}},"36":{"start":{"line":77,"column":4},"end":{"line":77,"column":34}},"37":{"start":{"line":79,"column":2},"end":{"line":79,"column":29}},"38":{"start":{"line":82,"column":2},"end":{"line":85,"column":5}},"39":{"start":{"line":88,"column":0},"end":{"line":333,"column":2}},"40":{"start":{"line":90,"column":4},"end":{"line":90,"column":30}},"41":{"start":{"line":94,"column":4},"end":{"line":94,"column":20}},"42":{"start":{"line":95,"column":4},"end":{"line":95,"column":62}},"43":{"start":{"line":96,"column":4},"end":{"line":96,"column":44}},"44":{"start":{"line":97,"column":4},"end":{"line":99,"column":7}},"45":{"start":{"line":98,"column":6},"end":{"line":98,"column":28}},"46":{"start":{"line":100,"column":4},"end":{"line":100,"column":18}},"47":{"start":{"line":103,"column":4},"end":{"line":114,"column":6}},"48":{"start":{"line":104,"column":6},"end":{"line":113,"column":7}},"49":{"start":{"line":105,"column":8},"end":{"line":110,"column":11}},"50":{"start":{"line":106,"column":10},"end":{"line":108,"column":13}},"51":{"start":{"line":107,"column":12},"end":{"line":107,"column":22}},"52":{"start":{"line":109,"column":10},"end":{"line":109,"column":29}},"53":{"start":{"line":112,"column":8},"end":{"line":112,"column":44}},"54":{"start":{"line":116,"column":4},"end":{"line":116,"column":57}},"55":{"start":{"line":117,"column":4},"end":{"line":121,"column":5}},"56":{"start":{"line":118,"column":6},"end":{"line":118,"column":46}},"57":{"start":{"line":120,"column":6},"end":{"line":120,"column":42}},"58":{"start":{"line":124,"column":4},"end":{"line":124,"column":20}},"59":{"start":{"line":127,"column":4},"end":{"line":145,"column":9}},"60":{"start":{"line":128,"column":8},"end":{"line":128,"column":40}},"61":{"start":{"line":131,"column":8},"end":{"line":138,"column":11}},"62":{"start":{"line":141,"column":8},"end":{"line":141,"column":34}},"63":{"start":{"line":144,"column":8},"end":{"line":144,"column":32}},"64":{"start":{"line":149,"column":4},"end":{"line":149,"column":10}},"65":{"start":{"line":150,"column":4},"end":{"line":154,"column":5}},"66":{"start":{"line":151,"column":6},"end":{"line":153,"column":7}},"67":{"start":{"line":152,"column":8},"end":{"line":152,"column":17}},"68":{"start":{"line":155,"column":4},"end":{"line":155,"column":40}},"69":{"start":{"line":161,"column":4},"end":{"line":161,"column":28}},"70":{"start":{"line":162,"column":4},"end":{"line":164,"column":28}},"71":{"start":{"line":166,"column":4},"end":{"line":171,"column":5}},"72":{"start":{"line":167,"column":6},"end":{"line":167,"column":84}},"73":{"start":{"line":168,"column":6},"end":{"line":170,"column":29}},"74":{"start":{"line":173,"column":4},"end":{"line":173,"column":25}},"75":{"start":{"line":174,"column":4},"end":{"line":174,"column":32}},"76":{"start":{"line":176,"column":4},"end":{"line":184,"column":7}},"77":{"start":{"line":186,"column":4},"end":{"line":186,"column":37}},"78":{"start":{"line":187,"column":4},"end":{"line":187,"column":21}},"79":{"start":{"line":190,"column":4},"end":{"line":200,"column":5}},"80":{"start":{"line":191,"column":6},"end":{"line":191,"column":64}},"81":{"start":{"line":191,"column":48},"end":{"line":191,"column":60}},"82":{"start":{"line":192,"column":11},"end":{"line":200,"column":5}},"83":{"start":{"line":193,"column":6},"end":{"line":193,"column":34}},"84":{"start":{"line":194,"column":11},"end":{"line":200,"column":5}},"85":{"start":{"line":195,"column":6},"end":{"line":197,"column":9}},"86":{"start":{"line":196,"column":8},"end":{"line":196,"column":49}},"87":{"start":{"line":199,"column":6},"end":{"line":199,"column":23}},"88":{"start":{"line":203,"column":4},"end":{"line":203,"column":20}},"89":{"start":{"line":204,"column":4},"end":{"line":207,"column":7}},"90":{"start":{"line":205,"column":6},"end":{"line":205,"column":64}},"91":{"start":{"line":206,"column":6},"end":{"line":206,"column":16}},"92":{"start":{"line":210,"column":4},"end":{"line":210,"column":20}},"93":{"start":{"line":211,"column":4},"end":{"line":214,"column":7}},"94":{"start":{"line":212,"column":6},"end":{"line":212,"column":66}},"95":{"start":{"line":213,"column":6},"end":{"line":213,"column":16}},"96":{"start":{"line":217,"column":4},"end":{"line":217,"column":20}},"97":{"start":{"line":218,"column":4},"end":{"line":225,"column":7}},"98":{"start":{"line":219,"column":6},"end":{"line":219,"column":43}},"99":{"start":{"line":220,"column":6},"end":{"line":222,"column":9}},"100":{"start":{"line":223,"column":6},"end":{"line":223,"column":51}},"101":{"start":{"line":224,"column":6},"end":{"line":224,"column":16}},"102":{"start":{"line":229,"column":4},"end":{"line":229,"column":20}},"103":{"start":{"line":230,"column":4},"end":{"line":238,"column":7}},"104":{"start":{"line":231,"column":6},"end":{"line":233,"column":8}},"105":{"start":{"line":234,"column":6},"end":{"line":234,"column":42}},"106":{"start":{"line":235,"column":6},"end":{"line":235,"column":35}},"107":{"start":{"line":236,"column":6},"end":{"line":236,"column":58}},"108":{"start":{"line":237,"column":6},"end":{"line":237,"column":16}},"109":{"start":{"line":241,"column":4},"end":{"line":241,"column":20}},"110":{"start":{"line":242,"column":4},"end":{"line":250,"column":7}},"111":{"start":{"line":243,"column":6},"end":{"line":245,"column":8}},"112":{"start":{"line":246,"column":6},"end":{"line":246,"column":33}},"113":{"start":{"line":247,"column":6},"end":{"line":247,"column":35}},"114":{"start":{"line":248,"column":6},"end":{"line":248,"column":55}},"115":{"start":{"line":249,"column":6},"end":{"line":249,"column":16}},"116":{"start":{"line":253,"column":4},"end":{"line":253,"column":20}},"117":{"start":{"line":254,"column":4},"end":{"line":259,"column":7}},"118":{"start":{"line":255,"column":6},"end":{"line":255,"column":38}},"119":{"start":{"line":256,"column":6},"end":{"line":256,"column":38}},"120":{"start":{"line":257,"column":6},"end":{"line":257,"column":56}},"121":{"start":{"line":258,"column":6},"end":{"line":258,"column":16}},"122":{"start":{"line":262,"column":4},"end":{"line":262,"column":20}},"123":{"start":{"line":263,"column":4},"end":{"line":272,"column":5}},"124":{"start":{"line":264,"column":6},"end":{"line":269,"column":9}},"125":{"start":{"line":265,"column":8},"end":{"line":265,"column":58}},"126":{"start":{"line":266,"column":8},"end":{"line":266,"column":63}},"127":{"start":{"line":267,"column":8},"end":{"line":267,"column":62}},"128":{"start":{"line":268,"column":8},"end":{"line":268,"column":18}},"129":{"start":{"line":271,"column":6},"end":{"line":271,"column":42}},"130":{"start":{"line":275,"column":4},"end":{"line":275,"column":20}},"131":{"start":{"line":276,"column":4},"end":{"line":276,"column":18}},"132":{"start":{"line":277,"column":4},"end":{"line":280,"column":6}},"133":{"start":{"line":281,"column":4},"end":{"line":285,"column":5}},"134":{"start":{"line":282,"column":6},"end":{"line":284,"column":8}},"135":{"start":{"line":286,"column":4},"end":{"line":293,"column":7}},"136":{"start":{"line":287,"column":6},"end":{"line":292,"column":7}},"137":{"start":{"line":288,"column":8},"end":{"line":288,"column":42}},"138":{"start":{"line":289,"column":8},"end":{"line":291,"column":10}},"139":{"start":{"line":294,"column":4},"end":{"line":299,"column":7}},"140":{"start":{"line":295,"column":6},"end":{"line":295,"column":43}},"141":{"start":{"line":296,"column":6},"end":{"line":296,"column":43}},"142":{"start":{"line":297,"column":6},"end":{"line":297,"column":66}},"143":{"start":{"line":298,"column":6},"end":{"line":298,"column":16}},"144":{"start":{"line":302,"column":4},"end":{"line":302,"column":23}},"145":{"start":{"line":303,"column":4},"end":{"line":308,"column":6}},"146":{"start":{"line":310,"column":4},"end":{"line":315,"column":7}},"147":{"start":{"line":311,"column":6},"end":{"line":311,"column":38}},"148":{"start":{"line":312,"column":6},"end":{"line":312,"column":27}},"149":{"start":{"line":313,"column":6},"end":{"line":313,"column":65}},"150":{"start":{"line":314,"column":6},"end":{"line":314,"column":16}},"151":{"start":{"line":318,"column":4},"end":{"line":318,"column":20}},"152":{"start":{"line":319,"column":4},"end":{"line":331,"column":7}},"153":{"start":{"line":320,"column":6},"end":{"line":322,"column":9}},"154":{"start":{"line":321,"column":8},"end":{"line":321,"column":22}},"155":{"start":{"line":323,"column":6},"end":{"line":325,"column":9}},"156":{"start":{"line":324,"column":8},"end":{"line":324,"column":22}},"157":{"start":{"line":326,"column":6},"end":{"line":328,"column":9}},"158":{"start":{"line":327,"column":8},"end":{"line":327,"column":22}},"159":{"start":{"line":330,"column":6},"end":{"line":330,"column":26}}},"branchMap":{"1":{"line":49,"type":"binary-expr","locations":[{"start":{"line":49,"column":12},"end":{"line":49,"column":19}},{"start":{"line":49,"column":23},"end":{"line":49,"column":25}}]},"2":{"line":52,"type":"binary-expr","locations":[{"start":{"line":52,"column":17},"end":{"line":52,"column":32}},{"start":{"line":52,"column":36},"end":{"line":52,"column":46}}]},"3":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":18},"end":{"line":53,"column":34}},{"start":{"line":53,"column":38},"end":{"line":53,"column":50}}]},"4":{"line":54,"type":"binary-expr","locations":[{"start":{"line":54,"column":17},"end":{"line":54,"column":32}},{"start":{"line":54,"column":36},"end":{"line":54,"column":45}}]},"5":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":24},"end":{"line":55,"column":46}},{"start":{"line":55,"column":50},"end":{"line":55,"column":59}}]},"6":{"line":59,"type":"binary-expr","locations":[{"start":{"line":59,"column":26},"end":{"line":59,"column":50}},{"start":{"line":59,"column":54},"end":{"line":59,"column":59}}]},"7":{"line":63,"type":"cond-expr","locations":[{"start":{"line":63,"column":36},"end":{"line":63,"column":57}},{"start":{"line":63,"column":60},"end":{"line":63,"column":86}}]},"8":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":2},"end":{"line":72,"column":2}},{"start":{"line":72,"column":2},"end":{"line":72,"column":2}}]},"9":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":9},"end":{"line":74,"column":9}},{"start":{"line":74,"column":9},"end":{"line":74,"column":9}}]},"10":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":6},"end":{"line":104,"column":6}},{"start":{"line":104,"column":6},"end":{"line":104,"column":6}}]},"11":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":4},"end":{"line":117,"column":4}},{"start":{"line":117,"column":4},"end":{"line":117,"column":4}}]},"12":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":6},"end":{"line":151,"column":6}},{"start":{"line":151,"column":6},"end":{"line":151,"column":6}}]},"13":{"line":155,"type":"binary-expr","locations":[{"start":{"line":155,"column":11},"end":{"line":155,"column":34}},{"start":{"line":155,"column":38},"end":{"line":155,"column":39}}]},"14":{"line":161,"type":"binary-expr","locations":[{"start":{"line":161,"column":14},"end":{"line":161,"column":21}},{"start":{"line":161,"column":25},"end":{"line":161,"column":27}}]},"15":{"line":162,"type":"cond-expr","locations":[{"start":{"line":163,"column":6},"end":{"line":163,"column":30}},{"start":{"line":164,"column":6},"end":{"line":164,"column":27}}]},"16":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"17":{"line":174,"type":"binary-expr","locations":[{"start":{"line":174,"column":11},"end":{"line":174,"column":15}},{"start":{"line":174,"column":19},"end":{"line":174,"column":31}}]},"18":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":4},"end":{"line":190,"column":4}},{"start":{"line":190,"column":4},"end":{"line":190,"column":4}}]},"19":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":11},"end":{"line":192,"column":11}},{"start":{"line":192,"column":11},"end":{"line":192,"column":11}}]},"20":{"line":194,"type":"if","locations":[{"start":{"line":194,"column":11},"end":{"line":194,"column":11}},{"start":{"line":194,"column":11},"end":{"line":194,"column":11}}]},"21":{"line":196,"type":"binary-expr","locations":[{"start":{"line":196,"column":15},"end":{"line":196,"column":24}},{"start":{"line":196,"column":28},"end":{"line":196,"column":48}}]},"22":{"line":263,"type":"if","locations":[{"start":{"line":263,"column":4},"end":{"line":263,"column":4}},{"start":{"line":263,"column":4},"end":{"line":263,"column":4}}]},"23":{"line":281,"type":"if","locations":[{"start":{"line":281,"column":4},"end":{"line":281,"column":4}},{"start":{"line":281,"column":4},"end":{"line":281,"column":4}}]},"24":{"line":287,"type":"if","locations":[{"start":{"line":287,"column":6},"end":{"line":287,"column":6}},{"start":{"line":287,"column":6},"end":{"line":287,"column":6}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var fs = require('fs');","var Archiver = require('archiver');","var PromishLib = require('../../utils/promish');","","var utils = require('../../utils/utils');","var StreamBuf = require('../../utils/stream-buf');","","var RelType = require('../../xlsx/rel-type');","var StylesXform = require('../../xlsx/xform/style/styles-xform');","var SharedStrings = require('../../utils/shared-strings');","var DefinedNames = require('../../doc/defined-names');","","var CoreXform = require('../../xlsx/xform/core/core-xform');","var RelationshipsXform = require('../../xlsx/xform/core/relationships-xform');","var ContentTypesXform = require('../../xlsx/xform/core/content-types-xform');","var AppXform = require('../../xlsx/xform/core/app-xform');","var WorkbookXform = require('../../xlsx/xform/book/workbook-xform');","var SharedStringsXform = require('../../xlsx/xform/strings/shared-strings-xform');","","var WorksheetWriter = require('./worksheet-writer');","","var theme1Xml = require('../../xlsx/xml/theme1.xml.js');","","var WorkbookWriter = module.exports = function(options) {","  options = options || {};","  //console.log(JSON.stringify(options, null, '    '))","","  this.created = options.created || new Date();","  this.modified = options.modified || this.created;","  this.creator = options.creator || 'ExcelJS';","  this.lastModifiedBy = options.lastModifiedBy || 'ExcelJS';","  this.lastPrinted = options.lastPrinted;","","  // using shared strings creates a smaller xlsx file but may use more memory","  this.useSharedStrings = options.useSharedStrings || false;","  this.sharedStrings = new SharedStrings();","","  // style manager","  this.styles = options.useStyles ? new StylesXform(true) : new StylesXform.Mock(true);","","  // defined names","  this._definedNames = new DefinedNames();","","  this._worksheets = [];","  this.views = [];","","  this.zip = Archiver('zip');","  if (options.stream) {","    this.stream = options.stream;","  } else if (options.filename) {","    this.stream = fs.createWriteStream(options.filename);","  } else {","    this.stream = new StreamBuf();","  }","  this.zip.pipe(this.stream);","","  // these bits can be added right now","  this.promise = PromishLib.Promish.all([","    this.addThemes(),","    this.addOfficeRels()","  ]);","","};","WorkbookWriter.prototype = {","  get definedNames() {","    return this._definedNames;","  },","","  _openStream: function(path) {","    var self = this;","    var stream = new StreamBuf({bufSize: 65536, batch: true});","    self.zip.append(stream, { name: path });","    stream.on('finish', function() {","      stream.emit('zipped');","    });","    return stream;","  },","  _commitWorksheets: function() {","    var commitWorksheet = function(worksheet) {","      if (!worksheet.committed) {","        return new PromishLib.Promish(function(resolve) {","          worksheet.stream.on('zipped', function() {","            resolve();","          });","          worksheet.commit();","        });","      } else {","        return PromishLib.Promish.resolve();","      }","    };","    // if there are any uncommitted worksheets, commit them now and wait","    var promises = this._worksheets.map(commitWorksheet);","    if (promises.length) {","      return PromishLib.Promish.all(promises);","    } else {","      return PromishLib.Promish.resolve();","    }","  },","  commit: function() {","    var self = this;","","    // commit all worksheets, then add suplimentary files","    return this.promise.then(function() {","        return self._commitWorksheets();","      })","      .then(function() {","        return PromishLib.Promish.all([","          self.addContentTypes(),","          self.addApp(),","          self.addCore(),","          self.addSharedStrings(),","          self.addStyles(),","          self.addWorkbookRels()","        ]);","      })","      .then(function() {","        return self.addWorkbook();","      })","      .then(function(){","        return self._finalize();","      });","  },","  get nextId() {","    // find the next unique spot to add worksheet","    var i;","    for (i = 1; i < this._worksheets.length; i++) {","      if (!this._worksheets[i]) {","        return i;","      }","    }","    return this._worksheets.length || 1;","  },","  addWorksheet: function(name, options) {","    // it's possible to add a worksheet with different than default","    // shared string handling","    // in fact, it's even possible to switch it mid-sheet","    options = options || {};","    var useSharedStrings = options.useSharedStrings !== undefined ?","      options.useSharedStrings :","      this.useSharedStrings;","","    if (options.tabColor) {","      console.trace('tabColor option has moved to { properties: tabColor: {...} }');","      options.properties  = Object.assign({","        tabColor: options.tabColor","      }, options.properties);","    }","","    var id = this.nextId;","    name = name || 'sheet' + id;","","    var worksheet = new WorksheetWriter({","      id: id,","      name: name,","      workbook: this,","      useSharedStrings: useSharedStrings,","      properties: options.properties,","      pageSetup: options.pageSetup,","      views: options.views","    });","","    this._worksheets[id] = worksheet;","    return worksheet;","  },","  getWorksheet: function(id) {","    if (id === undefined) {","      return this._worksheets.find(function() { return true; });","    } else if (typeof(id) === 'number') {","      return this._worksheets[id];","    } else if (typeof id === 'string') {","      return this._worksheets.find(function(worksheet) {","        return worksheet && worksheet.name == id;","      });","    } else {","      return undefined;","    }","  },","  addStyles: function() {","    var self = this;","    return new PromishLib.Promish(function(resolve) {","      self.zip.append(self.styles.xml, {name: 'xl/styles.xml'});","      resolve();","    });","  },","  addThemes: function() {","    var self = this;","    return new PromishLib.Promish(function(resolve) {","      self.zip.append(theme1Xml, { name: 'xl/theme/theme1.xml' });","      resolve();","    });","  },","  addOfficeRels: function() {","    var self = this;","    return new PromishLib.Promish(function(resolve) {","      var xform = new RelationshipsXform();","      var xml = xform.toXml([","        {rId: 'rId1', type: RelType.OfficeDocument, target: 'xl/workbook.xml'}","      ]);","      self.zip.append(xml, {name: '/_rels/.rels'});","      resolve();","    });","  },","","  addContentTypes: function() {","    var self = this;","    return new PromishLib.Promish(function(resolve) {","      var model = {","        worksheets: self._worksheets.filter(Boolean)","      };","      var xform = new ContentTypesXform();","      var xml = xform.toXml(model);","      self.zip.append(xml, {name: '[Content_Types].xml'});","      resolve();","    });","  },","  addApp: function() {","    var self = this;","    return new PromishLib.Promish(function(resolve) {","      var model = {","        worksheets: self._worksheets.filter(Boolean)","      };","      var xform = new AppXform();","      var xml = xform.toXml(model);","      self.zip.append(xml, {name: 'docProps/app.xml'});","      resolve();","    });","  },","  addCore: function() {","    var self = this;","    return new PromishLib.Promish(function(resolve) {","      var coreXform = new CoreXform();","      var xml = coreXform.toXml(self);","      self.zip.append(xml, {name: 'docProps/core.xml'});","      resolve();","    });","  },","  addSharedStrings: function() {","    var self = this;","    if (this.sharedStrings.count) {","      return new PromishLib.Promish(function(resolve) {","        var sharedStringsXform = new SharedStringsXform();","        var xml = sharedStringsXform.toXml(self.sharedStrings);","        self.zip.append(xml, {name: '/xl/sharedStrings.xml'});","        resolve();","      });","    } else {","      return PromishLib.Promish.resolve();","    }","  },","  addWorkbookRels: function() {","    var self = this;","    var count = 1;","    var relationships = [","      {rId: 'rId' + (count++), type: RelType.Styles, target: 'styles.xml'},","      {rId: 'rId' + (count++), type: RelType.Theme, target: 'theme/theme1.xml'}","    ];","    if (this.sharedStrings.count) {","      relationships.push(","        {rId: 'rId' + (count++), type: RelType.SharedStrings, target: 'sharedStrings.xml'}","      );","    }","    this._worksheets.forEach(function (worksheet) {","      if (worksheet) {","        worksheet.rId = 'rId' + (count++);","        relationships.push(","          {rId: worksheet.rId, type: RelType.Worksheet, target: 'worksheets/sheet' + worksheet.id + '.xml'}","        );","      }","    });","    return new PromishLib.Promish(function(resolve) {","      var xform = new RelationshipsXform();","      var xml = xform.toXml(relationships);","      self.zip.append(xml, {name: '/xl/_rels/workbook.xml.rels'});","      resolve();","    });","  },","  addWorkbook: function() {","    var zip = this.zip;","    var model = {","      worksheets: this._worksheets.filter(Boolean),","      definedNames: this._definedNames.model,","      views: this.views,","      properties: {}","    };","","    return new PromishLib.Promish(function(resolve) {","      var xform = new WorkbookXform();","      xform.prepare(model);","      zip.append(xform.toXml(model), {name: '/xl/workbook.xml'});","      resolve();","    });","  },","  _finalize: function() {","    var self = this;","    return new PromishLib.Promish(function(resolve, reject) {","      self.stream.on('error', function(error){","        reject(error);","      });","      self.stream.on('finish', function(){","        resolve(self);","      });","      self.zip.on('error', function(error){","        reject(error);","      });","","      self.zip.finalize();","    });","  }","};",""],"l":{"25":1,"26":1,"27":1,"29":1,"30":1,"32":1,"33":1,"34":1,"35":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"44":1,"46":1,"48":1,"49":0,"52":0,"53":0,"54":0,"55":0,"56":0,"59":0,"60":0,"63":0,"66":0,"68":0,"69":0,"71":0,"72":0,"73":0,"74":0,"75":0,"77":0,"79":0,"82":0,"88":1,"90":0,"94":0,"95":0,"96":0,"97":0,"98":0,"100":0,"103":0,"104":0,"105":0,"106":0,"107":0,"109":0,"112":0,"116":0,"117":0,"118":0,"120":0,"124":0,"127":0,"128":0,"131":0,"141":0,"144":0,"149":0,"150":0,"151":0,"152":0,"155":0,"161":0,"162":0,"166":0,"167":0,"168":0,"173":0,"174":0,"176":0,"186":0,"187":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"199":0,"203":0,"204":0,"205":0,"206":0,"210":0,"211":0,"212":0,"213":0,"217":0,"218":0,"219":0,"220":0,"223":0,"224":0,"229":0,"230":0,"231":0,"234":0,"235":0,"236":0,"237":0,"241":0,"242":0,"243":0,"246":0,"247":0,"248":0,"249":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"271":0,"275":0,"276":0,"277":0,"281":0,"282":0,"286":0,"287":0,"288":0,"289":0,"294":0,"295":0,"296":0,"297":0,"298":0,"302":0,"303":0,"310":0,"311":0,"312":0,"313":0,"314":0,"318":0,"319":0,"320":0,"321":0,"323":0,"324":0,"326":0,"327":0,"330":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/shared-strings.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/shared-strings.js","s":{"1":1,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":25,"loc":{"start":{"line":25,"column":37},"end":{"line":25,"column":48}}},"2":{"name":"(anonymous_2)","line":32,"loc":{"start":{"line":32,"column":11},"end":{"line":32,"column":14}}},"3":{"name":"(anonymous_3)","line":35,"loc":{"start":{"line":35,"column":12},"end":{"line":35,"column":15}}},"4":{"name":"(anonymous_4)","line":38,"loc":{"start":{"line":38,"column":15},"end":{"line":38,"column":18}}},"5":{"name":"(anonymous_5)","line":42,"loc":{"start":{"line":42,"column":13},"end":{"line":42,"column":29}}},"6":{"name":"(anonymous_6)","line":46,"loc":{"start":{"line":46,"column":7},"end":{"line":46,"column":23}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":29,"column":2}},"2":{"start":{"line":26,"column":2},"end":{"line":26,"column":20}},"3":{"start":{"line":27,"column":2},"end":{"line":27,"column":22}},"4":{"start":{"line":28,"column":2},"end":{"line":28,"column":17}},"5":{"start":{"line":31,"column":0},"end":{"line":55,"column":2}},"6":{"start":{"line":33,"column":4},"end":{"line":33,"column":31}},"7":{"start":{"line":36,"column":4},"end":{"line":36,"column":24}},"8":{"start":{"line":39,"column":4},"end":{"line":39,"column":27}},"9":{"start":{"line":43,"column":4},"end":{"line":43,"column":31}},"10":{"start":{"line":47,"column":4},"end":{"line":47,"column":34}},"11":{"start":{"line":48,"column":4},"end":{"line":51,"column":5}},"12":{"start":{"line":49,"column":6},"end":{"line":49,"column":54}},"13":{"start":{"line":50,"column":6},"end":{"line":50,"column":31}},"14":{"start":{"line":52,"column":4},"end":{"line":52,"column":22}},"15":{"start":{"line":53,"column":4},"end":{"line":53,"column":17}}},"branchMap":{"1":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":48,"column":4}},{"start":{"line":48,"column":4},"end":{"line":48,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var SharedStrings = module.exports = function() {","  this._values = [];","  this._totalRefs = 0;","  this._hash = {}","};","","SharedStrings.prototype = {","  get count() {","    return this._values.length;","  },","  get values() {","    return this._values;","  },","  get totalRefs() {","    return this._totalRefs;","  },","","  getString: function(index) {","    return this._values[index];","  },","","  add: function(value) {","    var index = this._hash[value];","    if (index === undefined) {","      index = this._hash[value] = this._values.length;","      this._values.push(value);","    }","    this._totalRefs++;","    return index;","  }","};",""],"l":{"25":1,"26":0,"27":0,"28":0,"31":1,"33":0,"36":0,"39":0,"43":0,"47":0,"48":0,"49":0,"50":0,"52":0,"53":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/worksheet-writer.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/worksheet-writer.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0},"b":{"1":[0,0],"2":[0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},"fnMap":{"1":{"name":"(anonymous_1)","line":70,"loc":{"start":{"line":70,"column":39},"end":{"line":70,"column":57}}},"2":{"name":"(anonymous_2)","line":89,"loc":{"start":{"line":89,"column":22},"end":{"line":89,"column":32}}},"3":{"name":"(anonymous_3)","line":153,"loc":{"start":{"line":153,"column":14},"end":{"line":153,"column":17}}},"4":{"name":"(anonymous_4)","line":157,"loc":{"start":{"line":157,"column":12},"end":{"line":157,"column":15}}},"5":{"name":"(anonymous_5)","line":169,"loc":{"start":{"line":169,"column":11},"end":{"line":169,"column":22}}},"6":{"name":"(anonymous_6)","line":173,"loc":{"start":{"line":173,"column":10},"end":{"line":173,"column":21}}},"7":{"name":"(anonymous_7)","line":179,"loc":{"start":{"line":179,"column":23},"end":{"line":179,"column":38}}},"8":{"name":"(anonymous_8)","line":214,"loc":{"start":{"line":214,"column":16},"end":{"line":214,"column":19}}},"9":{"name":"(anonymous_9)","line":218,"loc":{"start":{"line":218,"column":11},"end":{"line":218,"column":14}}},"10":{"name":"(anonymous_10)","line":226,"loc":{"start":{"line":226,"column":13},"end":{"line":226,"column":16}}},"11":{"name":"(anonymous_11)","line":232,"loc":{"start":{"line":232,"column":13},"end":{"line":232,"column":21}}},"12":{"name":"(anonymous_12)","line":236,"loc":{"start":{"line":236,"column":40},"end":{"line":236,"column":56}}},"13":{"name":"(anonymous_13)","line":244,"loc":{"start":{"line":244,"column":18},"end":{"line":244,"column":33}}},"14":{"name":"(anonymous_14)","line":253,"loc":{"start":{"line":253,"column":13},"end":{"line":253,"column":25}}},"15":{"name":"(anonymous_15)","line":274,"loc":{"start":{"line":274,"column":14},"end":{"line":274,"column":17}}},"16":{"name":"(anonymous_16)","line":279,"loc":{"start":{"line":279,"column":11},"end":{"line":279,"column":39}}},"17":{"name":"(anonymous_17)","line":290,"loc":{"start":{"line":290,"column":25},"end":{"line":290,"column":39}}},"18":{"name":"(anonymous_18)","line":298,"loc":{"start":{"line":298,"column":14},"end":{"line":298,"column":29}}},"19":{"name":"(anonymous_19)","line":312,"loc":{"start":{"line":312,"column":13},"end":{"line":312,"column":16}}},"20":{"name":"(anonymous_20)","line":322,"loc":{"start":{"line":322,"column":11},"end":{"line":322,"column":31}}},"21":{"name":"(anonymous_21)","line":327,"loc":{"start":{"line":327,"column":10},"end":{"line":327,"column":30}}},"22":{"name":"(anonymous_22)","line":341,"loc":{"start":{"line":341,"column":10},"end":{"line":341,"column":26}}},"23":{"name":"(anonymous_23)","line":352,"loc":{"start":{"line":352,"column":12},"end":{"line":352,"column":27}}},"24":{"name":"(anonymous_24)","line":359,"loc":{"start":{"line":359,"column":11},"end":{"line":359,"column":26}}},"25":{"name":"(anonymous_25)","line":365,"loc":{"start":{"line":365,"column":14},"end":{"line":365,"column":25}}},"26":{"name":"(anonymous_26)","line":370,"loc":{"start":{"line":370,"column":25},"end":{"line":370,"column":41}}},"27":{"name":"(anonymous_27)","line":391,"loc":{"start":{"line":391,"column":10},"end":{"line":391,"column":25}}},"28":{"name":"(anonymous_28)","line":398,"loc":{"start":{"line":398,"column":25},"end":{"line":398,"column":62}}},"29":{"name":"(anonymous_29)","line":408,"loc":{"start":{"line":408,"column":31},"end":{"line":408,"column":57}}},"30":{"name":"(anonymous_30)","line":418,"loc":{"start":{"line":418,"column":23},"end":{"line":418,"column":34}}},"31":{"name":"(anonymous_31)","line":434,"loc":{"start":{"line":434,"column":17},"end":{"line":434,"column":28}}},"32":{"name":"(anonymous_32)","line":441,"loc":{"start":{"line":441,"column":23},"end":{"line":441,"column":34}}},"33":{"name":"(anonymous_33)","line":444,"loc":{"start":{"line":444,"column":13},"end":{"line":444,"column":27}}},"34":{"name":"(anonymous_34)","line":465,"loc":{"start":{"line":465,"column":24},"end":{"line":465,"column":35}}},"35":{"name":"(anonymous_35)","line":468,"loc":{"start":{"line":468,"column":20},"end":{"line":468,"column":31}}},"36":{"name":"(anonymous_36)","line":474,"loc":{"start":{"line":474,"column":27},"end":{"line":474,"column":43}}},"37":{"name":"(anonymous_37)","line":483,"loc":{"start":{"line":483,"column":20},"end":{"line":483,"column":31}}},"38":{"name":"(anonymous_38)","line":486,"loc":{"start":{"line":486,"column":25},"end":{"line":486,"column":36}}},"39":{"name":"(anonymous_39)","line":489,"loc":{"start":{"line":489,"column":21},"end":{"line":489,"column":32}}},"40":{"name":"(anonymous_40)","line":492,"loc":{"start":{"line":492,"column":19},"end":{"line":492,"column":30}}},"41":{"name":"(anonymous_41)","line":495,"loc":{"start":{"line":495,"column":20},"end":{"line":495,"column":31}}},"42":{"name":"(anonymous_42)","line":498,"loc":{"start":{"line":498,"column":24},"end":{"line":498,"column":35}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":23}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":41}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":48}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":44}},"5":{"start":{"line":31,"column":0},"end":{"line":31,"column":50}},"6":{"start":{"line":33,"column":0},"end":{"line":33,"column":35}},"7":{"start":{"line":34,"column":0},"end":{"line":34,"column":41}},"8":{"start":{"line":36,"column":0},"end":{"line":36,"column":52}},"9":{"start":{"line":37,"column":0},"end":{"line":37,"column":60}},"10":{"start":{"line":39,"column":0},"end":{"line":39,"column":26}},"11":{"start":{"line":43,"column":0},"end":{"line":43,"column":55}},"12":{"start":{"line":44,"column":0},"end":{"line":44,"column":84}},"13":{"start":{"line":45,"column":0},"end":{"line":45,"column":84}},"14":{"start":{"line":46,"column":0},"end":{"line":46,"column":97}},"15":{"start":{"line":47,"column":0},"end":{"line":47,"column":59}},"16":{"start":{"line":48,"column":0},"end":{"line":48,"column":59}},"17":{"start":{"line":49,"column":0},"end":{"line":49,"column":71}},"18":{"start":{"line":50,"column":0},"end":{"line":50,"column":73}},"19":{"start":{"line":51,"column":0},"end":{"line":51,"column":77}},"20":{"start":{"line":52,"column":0},"end":{"line":52,"column":73}},"21":{"start":{"line":55,"column":0},"end":{"line":65,"column":2}},"22":{"start":{"line":70,"column":0},"end":{"line":150,"column":2}},"23":{"start":{"line":72,"column":2},"end":{"line":72,"column":23}},"24":{"start":{"line":75,"column":2},"end":{"line":75,"column":48}},"25":{"start":{"line":79,"column":2},"end":{"line":79,"column":18}},"26":{"start":{"line":82,"column":2},"end":{"line":82,"column":23}},"27":{"start":{"line":85,"column":2},"end":{"line":85,"column":18}},"28":{"start":{"line":88,"column":2},"end":{"line":88,"column":20}},"29":{"start":{"line":89,"column":2},"end":{"line":89,"column":35}},"30":{"start":{"line":92,"column":2},"end":{"line":92,"column":55}},"31":{"start":{"line":95,"column":2},"end":{"line":95,"column":38}},"32":{"start":{"line":98,"column":2},"end":{"line":98,"column":20}},"33":{"start":{"line":101,"column":2},"end":{"line":101,"column":25}},"34":{"start":{"line":104,"column":2},"end":{"line":104,"column":47}},"35":{"start":{"line":107,"column":2},"end":{"line":112,"column":25}},"36":{"start":{"line":115,"column":2},"end":{"line":136,"column":24}},"37":{"start":{"line":139,"column":2},"end":{"line":139,"column":60}},"38":{"start":{"line":141,"column":2},"end":{"line":141,"column":36}},"39":{"start":{"line":144,"column":2},"end":{"line":144,"column":36}},"40":{"start":{"line":147,"column":2},"end":{"line":147,"column":29}},"41":{"start":{"line":149,"column":2},"end":{"line":149,"column":27}},"42":{"start":{"line":152,"column":0},"end":{"line":501,"column":2}},"43":{"start":{"line":154,"column":4},"end":{"line":154,"column":26}},"44":{"start":{"line":158,"column":4},"end":{"line":163,"column":5}},"45":{"start":{"line":159,"column":6},"end":{"line":159,"column":91}},"46":{"start":{"line":162,"column":6},"end":{"line":162,"column":27}},"47":{"start":{"line":164,"column":4},"end":{"line":164,"column":24}},"48":{"start":{"line":170,"column":4},"end":{"line":170,"column":50}},"49":{"start":{"line":174,"column":4},"end":{"line":176,"column":5}},"50":{"start":{"line":175,"column":6},"end":{"line":175,"column":13}},"51":{"start":{"line":177,"column":4},"end":{"line":177,"column":20}},"52":{"start":{"line":179,"column":4},"end":{"line":184,"column":7}},"53":{"start":{"line":180,"column":6},"end":{"line":183,"column":7}},"54":{"start":{"line":182,"column":8},"end":{"line":182,"column":29}},"55":{"start":{"line":187,"column":4},"end":{"line":187,"column":22}},"56":{"start":{"line":189,"column":4},"end":{"line":191,"column":5}},"57":{"start":{"line":190,"column":8},"end":{"line":190,"column":35}},"58":{"start":{"line":192,"column":4},"end":{"line":192,"column":32}},"59":{"start":{"line":193,"column":4},"end":{"line":193,"column":28}},"60":{"start":{"line":198,"column":4},"end":{"line":198,"column":28}},"61":{"start":{"line":199,"column":4},"end":{"line":199,"column":33}},"62":{"start":{"line":200,"column":4},"end":{"line":200,"column":29}},"63":{"start":{"line":201,"column":4},"end":{"line":201,"column":27}},"64":{"start":{"line":202,"column":4},"end":{"line":202,"column":32}},"65":{"start":{"line":205,"column":4},"end":{"line":205,"column":22}},"66":{"start":{"line":208,"column":4},"end":{"line":208,"column":35}},"67":{"start":{"line":210,"column":4},"end":{"line":210,"column":26}},"68":{"start":{"line":215,"column":4},"end":{"line":215,"column":28}},"69":{"start":{"line":219,"column":4},"end":{"line":219,"column":23}},"70":{"start":{"line":227,"column":4},"end":{"line":227,"column":25}},"71":{"start":{"line":233,"column":4},"end":{"line":233,"column":20}},"72":{"start":{"line":236,"column":4},"end":{"line":239,"column":10}},"73":{"start":{"line":237,"column":6},"end":{"line":237,"column":77}},"74":{"start":{"line":238,"column":6},"end":{"line":238,"column":38}},"75":{"start":{"line":242,"column":4},"end":{"line":242,"column":18}},"76":{"start":{"line":243,"column":4},"end":{"line":243,"column":38}},"77":{"start":{"line":244,"column":4},"end":{"line":248,"column":7}},"78":{"start":{"line":245,"column":6},"end":{"line":245,"column":52}},"79":{"start":{"line":246,"column":6},"end":{"line":246,"column":28}},"80":{"start":{"line":247,"column":6},"end":{"line":247,"column":25}},"81":{"start":{"line":254,"column":4},"end":{"line":261,"column":5}},"82":{"start":{"line":256,"column":6},"end":{"line":256,"column":30}},"83":{"start":{"line":257,"column":6},"end":{"line":257,"column":26}},"84":{"start":{"line":257,"column":15},"end":{"line":257,"column":26}},"85":{"start":{"line":260,"column":6},"end":{"line":260,"column":26}},"86":{"start":{"line":262,"column":4},"end":{"line":262,"column":47}},"87":{"start":{"line":262,"column":26},"end":{"line":262,"column":45}},"88":{"start":{"line":263,"column":4},"end":{"line":268,"column":5}},"89":{"start":{"line":264,"column":6},"end":{"line":264,"column":39}},"90":{"start":{"line":265,"column":6},"end":{"line":267,"column":7}},"91":{"start":{"line":266,"column":8},"end":{"line":266,"column":50}},"92":{"start":{"line":269,"column":4},"end":{"line":269,"column":30}},"93":{"start":{"line":275,"column":4},"end":{"line":275,"column":45}},"94":{"start":{"line":280,"column":4},"end":{"line":283,"column":5}},"95":{"start":{"line":281,"column":6},"end":{"line":281,"column":25}},"96":{"start":{"line":282,"column":6},"end":{"line":282,"column":26}},"97":{"start":{"line":284,"column":4},"end":{"line":295,"column":5}},"98":{"start":{"line":285,"column":6},"end":{"line":285,"column":28}},"99":{"start":{"line":286,"column":6},"end":{"line":288,"column":7}},"100":{"start":{"line":287,"column":8},"end":{"line":287,"column":36}},"101":{"start":{"line":290,"column":6},"end":{"line":294,"column":9}},"102":{"start":{"line":291,"column":8},"end":{"line":293,"column":9}},"103":{"start":{"line":292,"column":10},"end":{"line":292,"column":36}},"104":{"start":{"line":300,"column":4},"end":{"line":300,"column":22}},"105":{"start":{"line":301,"column":4},"end":{"line":309,"column":5}},"106":{"start":{"line":302,"column":6},"end":{"line":302,"column":35}},"107":{"start":{"line":303,"column":6},"end":{"line":303,"column":22}},"108":{"start":{"line":304,"column":6},"end":{"line":308,"column":7}},"109":{"start":{"line":305,"column":8},"end":{"line":305,"column":28}},"110":{"start":{"line":306,"column":8},"end":{"line":306,"column":45}},"111":{"start":{"line":307,"column":8},"end":{"line":307,"column":39}},"112":{"start":{"line":314,"column":4},"end":{"line":318,"column":5}},"113":{"start":{"line":315,"column":6},"end":{"line":315,"column":45}},"114":{"start":{"line":317,"column":6},"end":{"line":317,"column":23}},"115":{"start":{"line":323,"column":4},"end":{"line":323,"column":42}},"116":{"start":{"line":324,"column":4},"end":{"line":324,"column":29}},"117":{"start":{"line":328,"column":4},"end":{"line":328,"column":42}},"118":{"start":{"line":331,"column":4},"end":{"line":333,"column":5}},"119":{"start":{"line":332,"column":6},"end":{"line":332,"column":68}},"120":{"start":{"line":334,"column":4},"end":{"line":334,"column":32}},"121":{"start":{"line":335,"column":4},"end":{"line":337,"column":5}},"122":{"start":{"line":336,"column":6},"end":{"line":336,"column":57}},"123":{"start":{"line":338,"column":4},"end":{"line":338,"column":15}},"124":{"start":{"line":342,"column":4},"end":{"line":342,"column":43}},"125":{"start":{"line":343,"column":4},"end":{"line":343,"column":47}},"126":{"start":{"line":344,"column":4},"end":{"line":344,"column":23}},"127":{"start":{"line":345,"column":4},"end":{"line":345,"column":15}},"128":{"start":{"line":353,"column":4},"end":{"line":353,"column":44}},"129":{"start":{"line":354,"column":4},"end":{"line":354,"column":40}},"130":{"start":{"line":355,"column":4},"end":{"line":355,"column":58}},"131":{"start":{"line":360,"column":4},"end":{"line":360,"column":44}},"132":{"start":{"line":361,"column":4},"end":{"line":361,"column":39}},"133":{"start":{"line":362,"column":4},"end":{"line":362,"column":33}},"134":{"start":{"line":367,"column":4},"end":{"line":367,"column":78}},"135":{"start":{"line":370,"column":4},"end":{"line":374,"column":7}},"136":{"start":{"line":371,"column":6},"end":{"line":373,"column":7}},"137":{"start":{"line":372,"column":8},"end":{"line":372,"column":60}},"138":{"start":{"line":377,"column":4},"end":{"line":377,"column":63}},"139":{"start":{"line":378,"column":4},"end":{"line":384,"column":5}},"140":{"start":{"line":379,"column":6},"end":{"line":383,"column":7}},"141":{"start":{"line":380,"column":8},"end":{"line":382,"column":9}},"142":{"start":{"line":381,"column":10},"end":{"line":381,"column":42}},"143":{"start":{"line":387,"column":4},"end":{"line":387,"column":34}},"144":{"start":{"line":393,"column":4},"end":{"line":393,"column":16}},"145":{"start":{"line":394,"column":4},"end":{"line":394,"column":22}},"146":{"start":{"line":395,"column":4},"end":{"line":395,"column":27}},"147":{"start":{"line":399,"column":4},"end":{"line":404,"column":6}},"148":{"start":{"line":406,"column":4},"end":{"line":406,"column":67}},"149":{"start":{"line":409,"column":4},"end":{"line":414,"column":18}},"150":{"start":{"line":416,"column":4},"end":{"line":416,"column":79}},"151":{"start":{"line":420,"column":4},"end":{"line":420,"column":16}},"152":{"start":{"line":422,"column":4},"end":{"line":422,"column":75}},"153":{"start":{"line":423,"column":4},"end":{"line":423,"column":341}},"154":{"start":{"line":425,"column":4},"end":{"line":425,"column":69}},"155":{"start":{"line":427,"column":4},"end":{"line":427,"column":52}},"156":{"start":{"line":429,"column":4},"end":{"line":429,"column":59}},"157":{"start":{"line":431,"column":4},"end":{"line":431,"column":27}},"158":{"start":{"line":435,"column":4},"end":{"line":435,"column":44}},"159":{"start":{"line":436,"column":4},"end":{"line":439,"column":5}},"160":{"start":{"line":437,"column":6},"end":{"line":437,"column":67}},"161":{"start":{"line":438,"column":6},"end":{"line":438,"column":51}},"162":{"start":{"line":442,"column":4},"end":{"line":442,"column":31}},"163":{"start":{"line":445,"column":4},"end":{"line":445,"column":20}},"164":{"start":{"line":447,"column":4},"end":{"line":451,"column":5}},"165":{"start":{"line":448,"column":6},"end":{"line":448,"column":27}},"166":{"start":{"line":449,"column":6},"end":{"line":449,"column":33}},"167":{"start":{"line":450,"column":6},"end":{"line":450,"column":30}},"168":{"start":{"line":453,"column":4},"end":{"line":463,"column":5}},"169":{"start":{"line":454,"column":6},"end":{"line":454,"column":28}},"170":{"start":{"line":455,"column":6},"end":{"line":460,"column":8}},"171":{"start":{"line":461,"column":6},"end":{"line":461,"column":40}},"172":{"start":{"line":462,"column":6},"end":{"line":462,"column":48}},"173":{"start":{"line":466,"column":4},"end":{"line":466,"column":32}},"174":{"start":{"line":470,"column":4},"end":{"line":481,"column":5}},"175":{"start":{"line":472,"column":6},"end":{"line":472,"column":18}},"176":{"start":{"line":473,"column":6},"end":{"line":473,"column":70}},"177":{"start":{"line":474,"column":6},"end":{"line":476,"column":9}},"178":{"start":{"line":475,"column":8},"end":{"line":475,"column":56}},"179":{"start":{"line":477,"column":6},"end":{"line":477,"column":35}},"180":{"start":{"line":479,"column":6},"end":{"line":479,"column":29}},"181":{"start":{"line":484,"column":4},"end":{"line":484,"column":81}},"182":{"start":{"line":487,"column":4},"end":{"line":487,"column":79}},"183":{"start":{"line":490,"column":4},"end":{"line":490,"column":71}},"184":{"start":{"line":493,"column":4},"end":{"line":493,"column":62}},"185":{"start":{"line":496,"column":4},"end":{"line":496,"column":63}},"186":{"start":{"line":499,"column":4},"end":{"line":499,"column":32}}},"branchMap":{"1":{"line":75,"type":"binary-expr","locations":[{"start":{"line":75,"column":14},"end":{"line":75,"column":26}},{"start":{"line":75,"column":30},"end":{"line":75,"column":47}}]},"2":{"line":120,"type":"binary-expr","locations":[{"start":{"line":120,"column":18},"end":{"line":120,"column":35}},{"start":{"line":120,"column":41},"end":{"line":120,"column":69}},{"start":{"line":120,"column":73},"end":{"line":120,"column":102}},{"start":{"line":120,"column":107},"end":{"line":120,"column":131}}]},"3":{"line":139,"type":"binary-expr","locations":[{"start":{"line":139,"column":26},"end":{"line":139,"column":50}},{"start":{"line":139,"column":54},"end":{"line":139,"column":59}}]},"4":{"line":144,"type":"binary-expr","locations":[{"start":{"line":144,"column":16},"end":{"line":144,"column":29}},{"start":{"line":144,"column":33},"end":{"line":144,"column":35}}]},"5":{"line":158,"type":"if","locations":[{"start":{"line":158,"column":4},"end":{"line":158,"column":4}},{"start":{"line":158,"column":4},"end":{"line":158,"column":4}}]},"6":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":4},"end":{"line":174,"column":4}},{"start":{"line":174,"column":4},"end":{"line":174,"column":4}}]},"7":{"line":180,"type":"if","locations":[{"start":{"line":180,"column":6},"end":{"line":180,"column":6}},{"start":{"line":180,"column":6},"end":{"line":180,"column":6}}]},"8":{"line":189,"type":"if","locations":[{"start":{"line":189,"column":4},"end":{"line":189,"column":4}},{"start":{"line":189,"column":4},"end":{"line":189,"column":4}}]},"9":{"line":237,"type":"cond-expr","locations":[{"start":{"line":237,"column":36},"end":{"line":237,"column":37}},{"start":{"line":237,"column":41},"end":{"line":237,"column":75}}]},"10":{"line":237,"type":"cond-expr","locations":[{"start":{"line":237,"column":54},"end":{"line":237,"column":71}},{"start":{"line":237,"column":74},"end":{"line":237,"column":75}}]},"11":{"line":254,"type":"if","locations":[{"start":{"line":254,"column":4},"end":{"line":254,"column":4}},{"start":{"line":254,"column":4},"end":{"line":254,"column":4}}]},"12":{"line":257,"type":"if","locations":[{"start":{"line":257,"column":6},"end":{"line":257,"column":6}},{"start":{"line":257,"column":6},"end":{"line":257,"column":6}}]},"13":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":4},"end":{"line":262,"column":4}},{"start":{"line":262,"column":4},"end":{"line":262,"column":4}}]},"14":{"line":263,"type":"if","locations":[{"start":{"line":263,"column":4},"end":{"line":263,"column":4}},{"start":{"line":263,"column":4},"end":{"line":263,"column":4}}]},"15":{"line":280,"type":"if","locations":[{"start":{"line":280,"column":4},"end":{"line":280,"column":4}},{"start":{"line":280,"column":4},"end":{"line":280,"column":4}}]},"16":{"line":284,"type":"if","locations":[{"start":{"line":284,"column":4},"end":{"line":284,"column":4}},{"start":{"line":284,"column":4},"end":{"line":284,"column":4}}]},"17":{"line":284,"type":"binary-expr","locations":[{"start":{"line":284,"column":8},"end":{"line":284,"column":15}},{"start":{"line":284,"column":19},"end":{"line":284,"column":39}}]},"18":{"line":291,"type":"if","locations":[{"start":{"line":291,"column":8},"end":{"line":291,"column":8}},{"start":{"line":291,"column":8},"end":{"line":291,"column":8}}]},"19":{"line":301,"type":"binary-expr","locations":[{"start":{"line":301,"column":11},"end":{"line":301,"column":28}},{"start":{"line":301,"column":32},"end":{"line":301,"column":38}}]},"20":{"line":304,"type":"if","locations":[{"start":{"line":304,"column":6},"end":{"line":304,"column":6}},{"start":{"line":304,"column":6},"end":{"line":304,"column":6}}]},"21":{"line":314,"type":"if","locations":[{"start":{"line":314,"column":4},"end":{"line":314,"column":4}},{"start":{"line":314,"column":4},"end":{"line":314,"column":4}}]},"22":{"line":331,"type":"if","locations":[{"start":{"line":331,"column":4},"end":{"line":331,"column":4}},{"start":{"line":331,"column":4},"end":{"line":331,"column":4}}]},"23":{"line":335,"type":"if","locations":[{"start":{"line":335,"column":4},"end":{"line":335,"column":4}},{"start":{"line":335,"column":4},"end":{"line":335,"column":4}}]},"24":{"line":355,"type":"cond-expr","locations":[{"start":{"line":355,"column":17},"end":{"line":355,"column":45}},{"start":{"line":355,"column":48},"end":{"line":355,"column":57}}]},"25":{"line":371,"type":"if","locations":[{"start":{"line":371,"column":6},"end":{"line":371,"column":6}},{"start":{"line":371,"column":6},"end":{"line":371,"column":6}}]},"26":{"line":380,"type":"if","locations":[{"start":{"line":380,"column":8},"end":{"line":380,"column":8}},{"start":{"line":380,"column":8},"end":{"line":380,"column":8}}]},"27":{"line":380,"type":"binary-expr","locations":[{"start":{"line":380,"column":13},"end":{"line":380,"column":31}},{"start":{"line":380,"column":37},"end":{"line":380,"column":56}}]},"28":{"line":400,"type":"binary-expr","locations":[{"start":{"line":400,"column":16},"end":{"line":400,"column":26}},{"start":{"line":400,"column":30},"end":{"line":400,"column":49}}]},"29":{"line":401,"type":"cond-expr","locations":[{"start":{"line":401,"column":52},"end":{"line":403,"column":7}},{"start":{"line":403,"column":10},"end":{"line":403,"column":19}}]},"30":{"line":401,"type":"binary-expr","locations":[{"start":{"line":401,"column":17},"end":{"line":401,"column":26}},{"start":{"line":401,"column":30},"end":{"line":401,"column":49}}]},"31":{"line":409,"type":"cond-expr","locations":[{"start":{"line":409,"column":50},"end":{"line":414,"column":5}},{"start":{"line":414,"column":8},"end":{"line":414,"column":17}}]},"32":{"line":436,"type":"if","locations":[{"start":{"line":436,"column":4},"end":{"line":436,"column":4}},{"start":{"line":436,"column":4},"end":{"line":436,"column":4}}]},"33":{"line":447,"type":"if","locations":[{"start":{"line":447,"column":4},"end":{"line":447,"column":4}},{"start":{"line":447,"column":4},"end":{"line":447,"column":4}}]},"34":{"line":453,"type":"if","locations":[{"start":{"line":453,"column":4},"end":{"line":453,"column":4}},{"start":{"line":453,"column":4},"end":{"line":453,"column":4}}]},"35":{"line":453,"type":"binary-expr","locations":[{"start":{"line":453,"column":8},"end":{"line":453,"column":21}},{"start":{"line":453,"column":25},"end":{"line":453,"column":35}}]},"36":{"line":457,"type":"cond-expr","locations":[{"start":{"line":457,"column":47},"end":{"line":457,"column":75}},{"start":{"line":457,"column":78},"end":{"line":457,"column":87}}]},"37":{"line":470,"type":"if","locations":[{"start":{"line":470,"column":4},"end":{"line":470,"column":4}},{"start":{"line":470,"column":4},"end":{"line":470,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var fs = require('fs');","","var utils = require('../../utils/utils');","var colCache = require('../../utils/col-cache');","var Dimensions = require('../../doc/range');","","var StringBuf = require('../../utils/string-buf');","","var Row = require('../../doc/row');","var Column = require('../../doc/column');","","var HyperlinkWriter = require('./hyperlink-writer');","var DataValidations = require('../../doc/data-validations');","","var xml = new StringBuf();","","// ============================================================================================","// Xforms","var ListXform = require('../../xlsx/xform/list-xform');","var DataValidationsXform = require('../../xlsx/xform/sheet/data-validations-xform');","var SheetPropertiesXform = require('../../xlsx/xform/sheet/sheet-properties-xform');","var SheetFormatPropertiesXform = require('../../xlsx/xform/sheet/sheet-format-properties-xform');","var ColXform = require('../../xlsx/xform/sheet/col-xform');","var RowXform = require('../../xlsx/xform/sheet/row-xform');","var HyperlinkXform = require('../../xlsx/xform/sheet/hyperlink-xform');","var SheetViewXform =  require('../../xlsx/xform/sheet/sheet-view-xform');","var PageMarginsXform =  require('../../xlsx/xform/sheet/page-margins-xform');","var PageSetupXform =  require('../../xlsx/xform/sheet/page-setup-xform');","","// since prepare and render is functional, we can use singletons","var xform = {","  dataValidations: new DataValidationsXform(),","  sheetProperties: new SheetPropertiesXform(),","  sheetFormatProperties: new SheetFormatPropertiesXform(),","  columns: new ListXform({tag: 'cols', length: false, childXform: new ColXform()}),","  row: new RowXform(),","  hyperlinks: new ListXform({tag: 'hyperlinks', length: false, childXform: new HyperlinkXform()}),","  sheetViews: new ListXform({tag: 'sheetViews', length: false, childXform: new SheetViewXform()}),","  pageMargins: new PageMarginsXform(),","  pageSeteup: new PageSetupXform()","};","","","// ============================================================================================","","var WorksheetWriter = module.exports = function(options) {","  // in a workbook, each sheet will have a number","  this.id = options.id;","","  // and a name","  this.name = options.name || 'Sheet' + this.id;","","  // rows are stored here while they need to be worked on.","  // when they are committed, they will be deleted.","  this._rows = [];","","  // column definitions","  this._columns = null;","","  // column keys (addRow convenience): key ==> this._columns index","  this._keys = {};","","  // keep record of all merges","  this._merges = [];","  this._merges.add  = function(){}; // ignore cell instruction","","  // keep record of all hyperlinks","  this._hyperlinkWriter = new HyperlinkWriter(options);","","  // keep a record of dimensions","  this._dimensions = new Dimensions();","","  // first uncommitted row","  this._rowZero = 1;","","  // committed flag","  this.committed = false;","","  // for data validations","  this.dataValidations = new DataValidations();","","  // for default row height, outline levels, etc","  this.properties = Object.assign({}, {","    defaultRowHeight: 15,","    dyDescent: 55,","    outlineLevelCol: 0,","    outlineLevelRow: 0","  }, options.properties);","","  // for all things printing","  this.pageSetup = Object.assign({}, {","    margins: {left: 0.7, right: 0.7, top: 0.75, bottom: 0.75, header: 0.3, footer:  0.3 },","    orientation: 'portrait',","    horizontalDpi: 4294967295,","    verticalDpi: 4294967295,","    fitToPage: !!(options.pageSetup && ((options.pageSetup.fitToWidth || options.pageSetup.fitToHeight) && !options.pageSetup.scale)),","    pageOrder: 'downThenOver',","    blackAndWhite: false,","    draft: false,","    cellComments: 'None',","    errors: 'displayed',","    scale: 100,","    fitToWidth: 1,","    fitToHeight: 1,","    paperSize: undefined,","    showRowColHeaders: false,","    showGridLines: false,","    horizontalCentered: false,","    verticalCentered: false,","    rowBreaks: null,","    colBreaks: null","  }, options.pageSetup);","","  // using shared strings creates a smaller xlsx file but may use more memory","  this.useSharedStrings = options.useSharedStrings || false;","","  this._workbook = options.workbook;","","  // views","  this._views = options.views || [];","","  // start writing to stream now","  this._writeOpenWorksheet();","","  this.startedData = false;","};","","WorksheetWriter.prototype = {","  get workbook() {","    return this._workbook;","  },","","  get stream() {","    if (!this._stream) {","      this._stream = this._workbook._openStream('/xl/worksheets/sheet' + this.id + '.xml');","","      // pause stream to prevent 'data' events","      this._stream.pause();","    }","    return this._stream;","  },","","  // destroy - not a valid operation for a streaming writer","  // even though some streamers might be able to, it's a bad idea.","  destroy: function() {","    throw new Error('Invalid Operation: destroy');","  },","","  commit: function() {","    if (this.committed) {","      return;","    }","    var self = this;","    // commit all rows","    this._rows.forEach(function(cRow) {","      if (cRow) {","        // write the row to the stream","        self._writeRow(cRow);","      }","    });","","    // we _cannot_ accept new rows from now on","    this._rows = null;","","    if (!this.startedData) {","        this._writeOpenSheetData();","    }","    this._writeCloseSheetData();","    this._writeMergeCells();","","    // for some reason, Excel can't handle dimensions at the bottom of the file","    //this._writeDimensions();","","    this._writeHyperlinks();","    this._writeDataValidations();","    this._writePageMargins();","    this._writePageSetup();","    this._writeCloseWorksheet();","","    // signal end of stream to workbook","    this.stream.end();","","    // also commit the hyperlinks if any","    this._hyperlinkWriter.commit();","","    this.committed = true;","  },","","  // return the current dimensions of the writer","  get dimensions() {","    return this._dimensions;","  },","","  get views() {","    return this._views;","  },","","  // =========================================================================","  // Columns","","  // get the current columns array.","  get columns() {","    return this._columns;","  },","","  // set the columns from an array of column definitions.","  // Note: any headers defined will overwrite existing values.","  set columns(value) {","    var self = this;","","    // calculate max header row count","    this._headerRowCount = value.reduce(function(pv,cv) {","      var headerCount = cv.header ? 1 : (cv.headers ? cv.headers.length : 0);","      return Math.max(pv, headerCount)","    }, 0);","","    // construct Column objects","    var count = 1;","    var _columns = this._columns = [];","    value.forEach(function(defn) {","      var column = new Column(self, count++, false);","      _columns.push(column);","      column.defn = defn;","    });","  },","","  // get a single column by col number. If it doesn't exist, it and any gaps before it","  // are created.","  getColumn: function(c) {","    if (typeof c === 'string'){","      // if it matches a key'd column, return that","      var col = this._keys[c];","      if (col) return col;","","      // otherise, assume letter","      c = colCache.l2n(c);","    }","    if (!this._columns) { this._columns = []; }","    if (c > this._columns.length) {","      var n = this._columns.length + 1;","      while (n <= c) {","        this._columns.push(new Column(this, n++));","      }","    }","    return this._columns[c-1];","  },","","  // =========================================================================","  // Rows","  get _nextRow() {","    return this._rowZero + this._rows.length;","  },","","  // iterate over every uncommitted row in the worksheet, including maybe empty rows","  eachRow: function(options, iteratee) {","    if (!iteratee) {","      iteratee = options;","      options = undefined;","    }","    if (options && options.includeEmpty) {","      var n = this._nextRow;","      for (var i = this._rowZero; i < n; i++) {","        iteratee(this.getRow(i), i);","      }","    } else {","      this._rows.forEach(function(row) {","        if (row.hasValues) {","          iteratee(row, row.number);","        }","      });","    }","  },","","  _commitRow: function(cRow) {","    // since rows must be written in order, we commit all rows up till and including cRow","    var found = false;","    while (this._rows.length && !found) {","      var row = this._rows.shift();","      this._rowZero++;","      if (row) {","        this._writeRow(row);","        found = (row.number === cRow.number);","        this._rowZero = row.number + 1;","      }","    }","  },","","  get lastRow() {","    // returns last uncommitted row","    if (this._rows.length) {","      return this._rows[this._rows.length-1];","    } else {","      return undefined;","    }","  },","","  // find a row (if exists) by row number","  findRow: function(rowNumber) {","    var index = rowNumber - this._rowZero;","    return this._rows[index];","  },","","  getRow: function(rowNumber) {","    var index = rowNumber - this._rowZero;","","    // may fail if rows have been comitted","    if (index < 0) {","      throw new Error('Out of bounds: this row has been committed');","    }","    var row = this._rows[index];","    if (!row) {","      this._rows[index] = row = new Row(this, rowNumber);","    }","    return row;","  },","","  addRow: function(value) {","    var row = new Row(this, this._nextRow);","    this._rows[row.number-this._rowZero] = row;","    row.values = value;","    return row;","  },","","  // ================================================================================","  // Cells","","  // returns the cell at [r,c] or address given by r. If not found, return undefined","  findCell: function(r, c) {","    var address = colCache.getAddress(r, c);","    var row = this.findRow(address.row);","    return row ? row.findCell(address.column) : undefined;","  },","","  // return the cell at [r,c] or address given by r. If not found, create a new one.","  getCell: function(r, c) {","    var address = colCache.getAddress(r, c);","    var row = this.getRow(address.row);","    return row._getCell(address);","  },","","  mergeCells: function() {","    // may fail if rows have been comitted","    var dimensions = new Dimensions(Array.prototype.slice.call(arguments, 0)); // convert arguments into Array","","    // check cells aren't already merged","    this._merges.forEach(function(merge) {","      if (merge.intersects(dimensions)) {","        throw new Error('Cannot merge alreay merged cells');","      }","    });","","    // apply merge","    var master = this.getCell(dimensions.top, dimensions.left);","    for (var i = dimensions.top; i <= dimensions.bottom; i++) {","      for (var j = dimensions.left; j <= dimensions.right; j++) {","        if ((i > dimensions.top) || (j > dimensions.left)) {","          this.getCell(i,j).merge(master);","        }","      }","    }","","    // index merge","    this._merges.push(dimensions);","  },","","  // ================================================================================","  _write: function(text) {","    // var xml = stringBufStack.pop();","    xml.reset();","    xml.addText(text);","    this.stream.write(xml);","    //stringBufStack.push(xml);","  },","  _writeSheetProperties: function(xml, properties, pageSetup) {","    var sheetPropertiesModel = {","      tabColor: properties && properties.tabColor,","      pageSetup: pageSetup && pageSetup.fitToPage ? {","        fitToPage: pageSetup.fitToPage","      } : undefined","    };","","    xml.addText(xform.sheetProperties.toXml(sheetPropertiesModel));","  },","  _writeSheetFormatProperties: function(xml, properties) {","    var sheetFormatPropertiesModel = properties ? {","      defaultRowHeight: properties.defaultRowHeight,","      dyDescent: properties.dyDescent,","      outlineLevelCol: properties.outlineLevelCol,","      outlineLevelRow: properties.outlineLevelRow","    } : undefined;","","    xml.addText(xform.sheetFormatProperties.toXml(sheetFormatPropertiesModel));","  },","  _writeOpenWorksheet: function() {","    // var xml = stringBufStack.pop();","    xml.reset();","","    xml.addText('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>');","    xml.addText('<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">');","","    this._writeSheetProperties(xml, this.properties, this.pageSetup);","","    xml.addText(xform.sheetViews.toXml(this.views));","","    this._writeSheetFormatProperties(xml, this.properties);","","    this.stream.write(xml);","    //stringBufStack.push(xml);","  },","  _writeColumns: function() {","    var cols = Column.toModel(this.columns);","    if (cols) {","      xform.columns.prepare(cols, {styles: this._workbook.styles});","      this.stream.write(xform.columns.toXml(cols));","    }","  },","  _writeOpenSheetData: function() {","    this._write('<sheetData>');","  },","  _writeRow: function(row) {","    var self = this;","","    if (!this.startedData) {","      this._writeColumns();","      this._writeOpenSheetData();","      this.startedData = true;","    }","","    if (row.hasValues || row.height) {","      var model = row.model;","      var options = {","        styles: this._workbook.styles,","        sharedStrings: self.useSharedStrings ? self._workbook.sharedStrings : undefined,","        hyperlinks: this._hyperlinkWriter,","        merges: this._merges","      };","      xform.row.prepare(model, options);","      this.stream.write(xform.row.toXml(model));","    }","  },","  _writeCloseSheetData: function() {","    this._write('</sheetData>');","  },","  _writeMergeCells: function() {","","    if (this._merges.length) {","      // var xml = stringBufStack.pop();","      xml.reset();","      xml.addText('<mergeCells count=\"' + this._merges.length + '\">');","      this._merges.forEach(function(merge) {","        xml.addText('<mergeCell ref=\"' + merge + '\"/>');","      });","      xml.addText('</mergeCells>');","","      this.stream.write(xml);","      //stringBufStack.push(xml);","    }","  },","  _writeHyperlinks: function() {","    this.stream.write(xform.hyperlinks.toXml(this._hyperlinkWriter._hyperlinks));","  },","  _writeDataValidations: function() {","    this.stream.write(xform.dataValidations.toXml(this.dataValidations.model));","  },","  _writePageMargins: function() {","    this.stream.write(xform.pageMargins.toXml(this.pageSetup.margins));","  },","  _writePageSetup: function() {","    this.stream.write(xform.pageSeteup.toXml(this.pageSetup));","  },","  _writeDimensions: function() {","    this._write('<dimension ref=\"' + this._dimensions + '\"/>');","  },","  _writeCloseWorksheet: function() {","    this._write('</worksheet>');","  }","};"],"l":{"25":1,"27":1,"28":1,"29":1,"31":1,"33":1,"34":1,"36":1,"37":1,"39":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"55":1,"70":1,"72":0,"75":0,"79":0,"82":0,"85":0,"88":0,"89":0,"92":0,"95":0,"98":0,"101":0,"104":0,"107":0,"115":0,"139":0,"141":0,"144":0,"147":0,"149":0,"152":1,"154":0,"158":0,"159":0,"162":0,"164":0,"170":0,"174":0,"175":0,"177":0,"179":0,"180":0,"182":0,"187":0,"189":0,"190":0,"192":0,"193":0,"198":0,"199":0,"200":0,"201":0,"202":0,"205":0,"208":0,"210":0,"215":0,"219":0,"227":0,"233":0,"236":0,"237":0,"238":0,"242":0,"243":0,"244":0,"245":0,"246":0,"247":0,"254":0,"256":0,"257":0,"260":0,"262":0,"263":0,"264":0,"265":0,"266":0,"269":0,"275":0,"280":0,"281":0,"282":0,"284":0,"285":0,"286":0,"287":0,"290":0,"291":0,"292":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"314":0,"315":0,"317":0,"323":0,"324":0,"328":0,"331":0,"332":0,"334":0,"335":0,"336":0,"338":0,"342":0,"343":0,"344":0,"345":0,"353":0,"354":0,"355":0,"360":0,"361":0,"362":0,"367":0,"370":0,"371":0,"372":0,"377":0,"378":0,"379":0,"380":0,"381":0,"387":0,"393":0,"394":0,"395":0,"399":0,"406":0,"409":0,"416":0,"420":0,"422":0,"423":0,"425":0,"427":0,"429":0,"431":0,"435":0,"436":0,"437":0,"438":0,"442":0,"445":0,"447":0,"448":0,"449":0,"450":0,"453":0,"454":0,"455":0,"461":0,"462":0,"466":0,"470":0,"472":0,"473":0,"474":0,"475":0,"477":0,"479":0,"484":0,"487":0,"490":0,"493":0,"496":0,"499":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/hyperlink-writer.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/hyperlink-writer.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"(anonymous_1)","line":27,"loc":{"start":{"line":27,"column":39},"end":{"line":27,"column":57}}},"2":{"name":"(anonymous_2)","line":38,"loc":{"start":{"line":38,"column":12},"end":{"line":38,"column":15}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":12},"end":{"line":45,"column":15}}},"4":{"name":"(anonymous_4)","line":49,"loc":{"start":{"line":49,"column":8},"end":{"line":49,"column":21}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":8},"end":{"line":53,"column":28}}},"6":{"name":"(anonymous_6)","line":69,"loc":{"start":{"line":69,"column":10},"end":{"line":69,"column":21}}},"7":{"name":"(anonymous_7)","line":79,"loc":{"start":{"line":79,"column":14},"end":{"line":79,"column":25}}},"8":{"name":"(anonymous_8)","line":84,"loc":{"start":{"line":84,"column":22},"end":{"line":84,"column":42}}},"9":{"name":"(anonymous_9)","line":93,"loc":{"start":{"line":93,"column":15},"end":{"line":93,"column":26}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":41}},"2":{"start":{"line":27,"column":0},"end":{"line":35,"column":2}},"3":{"start":{"line":29,"column":2},"end":{"line":29,"column":23}},"4":{"start":{"line":32,"column":2},"end":{"line":32,"column":24}},"5":{"start":{"line":34,"column":2},"end":{"line":34,"column":36}},"6":{"start":{"line":36,"column":0},"end":{"line":96,"column":2}},"7":{"start":{"line":39,"column":4},"end":{"line":41,"column":5}},"8":{"start":{"line":40,"column":6},"end":{"line":40,"column":102}},"9":{"start":{"line":42,"column":4},"end":{"line":42,"column":24}},"10":{"start":{"line":46,"column":4},"end":{"line":46,"column":35}},"11":{"start":{"line":50,"column":4},"end":{"line":50,"column":40}},"12":{"start":{"line":55,"column":4},"end":{"line":57,"column":5}},"13":{"start":{"line":56,"column":6},"end":{"line":56,"column":24}},"14":{"start":{"line":60,"column":4},"end":{"line":63,"column":7}},"15":{"start":{"line":66,"column":4},"end":{"line":66,"column":39}},"16":{"start":{"line":70,"column":4},"end":{"line":75,"column":5}},"17":{"start":{"line":72,"column":6},"end":{"line":72,"column":25}},"18":{"start":{"line":74,"column":6},"end":{"line":74,"column":24}},"19":{"start":{"line":80,"column":4},"end":{"line":82,"column":94}},"20":{"start":{"line":85,"column":4},"end":{"line":91,"column":12}},"21":{"start":{"line":94,"column":4},"end":{"line":94,"column":42}}},"branchMap":{"1":{"line":39,"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":39,"column":4}},{"start":{"line":39,"column":4},"end":{"line":39,"column":4}}]},"2":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":55,"column":4}},{"start":{"line":55,"column":4},"end":{"line":55,"column":4}}]},"3":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":4}},{"start":{"line":70,"column":4},"end":{"line":70,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var utils = require('../../utils/utils');","","var HyperlinkWriter = module.exports = function(options) {","  // in a workbook, each sheet will have a number","  this.id = options.id;","","  // keep record of all hyperlinks","  this._hyperlinks = [];","","  this._workbook = options.workbook;","};","HyperlinkWriter.prototype = {","","  get stream() {","    if (!this._stream) {","      this._stream = this._workbook._openStream('/xl/worksheets/_rels/sheet' + this.id + '.xml.rels');","    }","    return this._stream;","  },","","  get length() {","    return this._hyperlinks.length;","  },","","  each: function(fn) {","    return this._hyperlinks.forEach(fn);","  },","","  push: function(hyperlink) {","    // if first hyperlink, must open stream and write xml intro","    if (!this._hyperlinks.length) {","      this._writeOpen();","    }","","    // store sheet stuff for later","    this._hyperlinks.push({","      address: hyperlink.address,","      rId: hyperlink.rId","    });","","    // and write to stream","    this._writeRelationship(hyperlink);","  },","","  commit: function() {","    if (this._hyperlinks.length) {","      // write xml utro","      this._writeClose();","      // and close stream","      this.stream.end();","    }","  },","","  // ================================================================================","  _writeOpen: function() {","    this.stream.write(","      '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +","      '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">');","  },","  _writeRelationship: function(hyperlink) {","    this.stream.write(","      '<Relationship' +","      ' Id=\"' + hyperlink.rId + '\"' +","      ' Type=\"' + hyperlink.type + '\"' +","      ' Target=\"' + utils.xmlEncode(hyperlink.target) + '\"' +","      ' TargetMode=\"' + hyperlink.targetMode + '\"' +","      '/>');","  },","  _writeClose: function() {","    this.stream.write('</Relationships>');","  }","};"],"l":{"25":1,"27":1,"29":0,"32":0,"34":0,"36":1,"39":0,"40":0,"42":0,"46":0,"50":0,"55":0,"56":0,"60":0,"66":0,"70":0,"72":0,"74":0,"80":0,"85":0,"94":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/workbook-reader.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/workbook-reader.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"fnMap":{"1":{"name":"(anonymous_1)","line":45,"loc":{"start":{"line":45,"column":38},"end":{"line":45,"column":56}}},"2":{"name":"(anonymous_2)","line":66,"loc":{"start":{"line":66,"column":14},"end":{"line":66,"column":30}}},"3":{"name":"(anonymous_3)","line":76,"loc":{"start":{"line":76,"column":17},"end":{"line":76,"column":20}}},"4":{"name":"(anonymous_4)","line":90,"loc":{"start":{"line":90,"column":8},"end":{"line":90,"column":33}}},"5":{"name":"(anonymous_5)","line":95,"loc":{"start":{"line":95,"column":19},"end":{"line":95,"column":36}}},"6":{"name":"(anonymous_6)","line":126,"loc":{"start":{"line":126,"column":20},"end":{"line":126,"column":32}}},"7":{"name":"(anonymous_7)","line":138,"loc":{"start":{"line":138,"column":14},"end":{"line":138,"column":41}}},"8":{"name":"(anonymous_8)","line":143,"loc":{"start":{"line":143,"column":23},"end":{"line":143,"column":48}}},"9":{"name":"(anonymous_9)","line":162,"loc":{"start":{"line":162,"column":25},"end":{"line":162,"column":40}}},"10":{"name":"(anonymous_10)","line":168,"loc":{"start":{"line":168,"column":26},"end":{"line":168,"column":42}}},"11":{"name":"(anonymous_11)","line":178,"loc":{"start":{"line":178,"column":22},"end":{"line":178,"column":38}}},"12":{"name":"(anonymous_12)","line":181,"loc":{"start":{"line":181,"column":23},"end":{"line":181,"column":40}}},"13":{"name":"(anonymous_13)","line":186,"loc":{"start":{"line":186,"column":16},"end":{"line":186,"column":41}}},"14":{"name":"(anonymous_14)","line":195,"loc":{"start":{"line":195,"column":14},"end":{"line":195,"column":50}}},"15":{"name":"(anonymous_15)","line":201,"loc":{"start":{"line":201,"column":28},"end":{"line":201,"column":39}}},"16":{"name":"(anonymous_16)","line":212,"loc":{"start":{"line":212,"column":19},"end":{"line":212,"column":53}}},"17":{"name":"(anonymous_17)","line":220,"loc":{"start":{"line":220,"column":20},"end":{"line":220,"column":54}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":23}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":31}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":31}},"4":{"start":{"line":28,"column":0},"end":{"line":28,"column":30}},"5":{"start":{"line":29,"column":0},"end":{"line":29,"column":25}},"6":{"start":{"line":31,"column":0},"end":{"line":31,"column":41}},"7":{"start":{"line":35,"column":0},"end":{"line":35,"column":54}},"8":{"start":{"line":39,"column":0},"end":{"line":39,"column":66}},"9":{"start":{"line":42,"column":0},"end":{"line":42,"column":52}},"10":{"start":{"line":43,"column":0},"end":{"line":43,"column":52}},"11":{"start":{"line":45,"column":0},"end":{"line":63,"column":2}},"12":{"start":{"line":46,"column":2},"end":{"line":46,"column":41}},"13":{"start":{"line":50,"column":2},"end":{"line":50,"column":40}},"14":{"start":{"line":53,"column":2},"end":{"line":53,"column":29}},"15":{"start":{"line":56,"column":2},"end":{"line":56,"column":29}},"16":{"start":{"line":59,"column":2},"end":{"line":59,"column":19}},"17":{"start":{"line":62,"column":2},"end":{"line":62,"column":21}},"18":{"start":{"line":65,"column":0},"end":{"line":228,"column":3}},"19":{"start":{"line":67,"column":4},"end":{"line":69,"column":5}},"20":{"start":{"line":68,"column":6},"end":{"line":68,"column":19}},"21":{"start":{"line":70,"column":4},"end":{"line":72,"column":5}},"22":{"start":{"line":71,"column":6},"end":{"line":71,"column":40}},"23":{"start":{"line":73,"column":4},"end":{"line":73,"column":49}},"24":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"25":{"start":{"line":78,"column":6},"end":{"line":78,"column":56}},"26":{"start":{"line":80,"column":4},"end":{"line":80,"column":29}},"27":{"start":{"line":91,"column":4},"end":{"line":91,"column":20}},"28":{"start":{"line":92,"column":4},"end":{"line":92,"column":54}},"29":{"start":{"line":93,"column":4},"end":{"line":93,"column":39}},"30":{"start":{"line":95,"column":4},"end":{"line":124,"column":7}},"31":{"start":{"line":97,"column":6},"end":{"line":97,"column":25}},"32":{"start":{"line":98,"column":6},"end":{"line":123,"column":7}},"33":{"start":{"line":102,"column":10},"end":{"line":102,"column":28}},"34":{"start":{"line":103,"column":10},"end":{"line":103,"column":16}},"35":{"start":{"line":105,"column":10},"end":{"line":105,"column":51}},"36":{"start":{"line":106,"column":10},"end":{"line":106,"column":16}},"37":{"start":{"line":108,"column":10},"end":{"line":108,"column":44}},"38":{"start":{"line":109,"column":10},"end":{"line":109,"column":16}},"39":{"start":{"line":111,"column":10},"end":{"line":121,"column":11}},"40":{"start":{"line":112,"column":12},"end":{"line":112,"column":72}},"41":{"start":{"line":113,"column":12},"end":{"line":113,"column":31}},"42":{"start":{"line":114,"column":12},"end":{"line":114,"column":58}},"43":{"start":{"line":115,"column":17},"end":{"line":121,"column":11}},"44":{"start":{"line":116,"column":12},"end":{"line":116,"column":84}},"45":{"start":{"line":117,"column":12},"end":{"line":117,"column":31}},"46":{"start":{"line":118,"column":12},"end":{"line":118,"column":59}},"47":{"start":{"line":120,"column":12},"end":{"line":120,"column":30}},"48":{"start":{"line":122,"column":10},"end":{"line":122,"column":16}},"49":{"start":{"line":126,"column":4},"end":{"line":132,"column":7}},"50":{"start":{"line":127,"column":6},"end":{"line":127,"column":23}},"51":{"start":{"line":128,"column":6},"end":{"line":128,"column":24}},"52":{"start":{"line":129,"column":6},"end":{"line":131,"column":7}},"53":{"start":{"line":130,"column":8},"end":{"line":130,"column":30}},"54":{"start":{"line":136,"column":4},"end":{"line":136,"column":21}},"55":{"start":{"line":139,"column":4},"end":{"line":141,"column":5}},"56":{"start":{"line":140,"column":6},"end":{"line":140,"column":34}},"57":{"start":{"line":144,"column":4},"end":{"line":144,"column":55}},"58":{"start":{"line":145,"column":4},"end":{"line":145,"column":20}},"59":{"start":{"line":146,"column":4},"end":{"line":146,"column":29}},"60":{"start":{"line":147,"column":4},"end":{"line":156,"column":5}},"61":{"start":{"line":149,"column":8},"end":{"line":149,"column":48}},"62":{"start":{"line":150,"column":8},"end":{"line":150,"column":14}},"63":{"start":{"line":152,"column":8},"end":{"line":152,"column":14}},"64":{"start":{"line":154,"column":8},"end":{"line":154,"column":26}},"65":{"start":{"line":155,"column":8},"end":{"line":155,"column":15}},"66":{"start":{"line":158,"column":4},"end":{"line":158,"column":44}},"67":{"start":{"line":159,"column":4},"end":{"line":159,"column":20}},"68":{"start":{"line":160,"column":4},"end":{"line":160,"column":17}},"69":{"start":{"line":161,"column":4},"end":{"line":161,"column":18}},"70":{"start":{"line":162,"column":4},"end":{"line":167,"column":7}},"71":{"start":{"line":163,"column":6},"end":{"line":166,"column":7}},"72":{"start":{"line":164,"column":8},"end":{"line":164,"column":17}},"73":{"start":{"line":165,"column":8},"end":{"line":165,"column":19}},"74":{"start":{"line":168,"column":4},"end":{"line":177,"column":7}},"75":{"start":{"line":169,"column":6},"end":{"line":176,"column":7}},"76":{"start":{"line":170,"column":8},"end":{"line":174,"column":9}},"77":{"start":{"line":171,"column":10},"end":{"line":171,"column":32}},"78":{"start":{"line":173,"column":10},"end":{"line":173,"column":65}},"79":{"start":{"line":175,"column":8},"end":{"line":175,"column":17}},"80":{"start":{"line":178,"column":4},"end":{"line":180,"column":7}},"81":{"start":{"line":179,"column":6},"end":{"line":179,"column":30}},"82":{"start":{"line":181,"column":4},"end":{"line":183,"column":7}},"83":{"start":{"line":182,"column":6},"end":{"line":182,"column":32}},"84":{"start":{"line":184,"column":4},"end":{"line":184,"column":23}},"85":{"start":{"line":187,"column":4},"end":{"line":187,"column":47}},"86":{"start":{"line":188,"column":4},"end":{"line":191,"column":5}},"87":{"start":{"line":189,"column":6},"end":{"line":189,"column":24}},"88":{"start":{"line":190,"column":6},"end":{"line":190,"column":13}},"89":{"start":{"line":192,"column":4},"end":{"line":192,"column":37}},"90":{"start":{"line":193,"column":4},"end":{"line":193,"column":29}},"91":{"start":{"line":196,"column":4},"end":{"line":196,"column":20}},"92":{"start":{"line":197,"column":4},"end":{"line":197,"column":37}},"93":{"start":{"line":198,"column":4},"end":{"line":209,"column":5}},"94":{"start":{"line":199,"column":6},"end":{"line":199,"column":39}},"95":{"start":{"line":200,"column":6},"end":{"line":200,"column":21}},"96":{"start":{"line":201,"column":6},"end":{"line":207,"column":9}},"97":{"start":{"line":202,"column":8},"end":{"line":206,"column":9}},"98":{"start":{"line":203,"column":10},"end":{"line":205,"column":11}},"99":{"start":{"line":204,"column":12},"end":{"line":204,"column":34}},"100":{"start":{"line":208,"column":6},"end":{"line":208,"column":35}},"101":{"start":{"line":210,"column":4},"end":{"line":210,"column":18}},"102":{"start":{"line":213,"column":4},"end":{"line":213,"column":63}},"103":{"start":{"line":214,"column":4},"end":{"line":214,"column":91}},"104":{"start":{"line":215,"column":4},"end":{"line":217,"column":5}},"105":{"start":{"line":216,"column":6},"end":{"line":216,"column":46}},"106":{"start":{"line":218,"column":4},"end":{"line":218,"column":73}},"107":{"start":{"line":221,"column":4},"end":{"line":221,"column":63}},"108":{"start":{"line":222,"column":4},"end":{"line":222,"column":92}},"109":{"start":{"line":223,"column":4},"end":{"line":225,"column":5}},"110":{"start":{"line":224,"column":6},"end":{"line":224,"column":48}},"111":{"start":{"line":226,"column":4},"end":{"line":226,"column":42}}},"branchMap":{"1":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":27},"end":{"line":46,"column":34}},{"start":{"line":46,"column":38},"end":{"line":46,"column":40}}]},"2":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":67,"column":4}},{"start":{"line":67,"column":4},"end":{"line":67,"column":4}}]},"3":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":4}},{"start":{"line":70,"column":4},"end":{"line":70,"column":4}}]},"4":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":77,"column":4}},{"start":{"line":77,"column":4},"end":{"line":77,"column":4}}]},"5":{"line":98,"type":"switch","locations":[{"start":{"line":99,"column":8},"end":{"line":99,"column":27}},{"start":{"line":100,"column":8},"end":{"line":100,"column":31}},{"start":{"line":101,"column":8},"end":{"line":103,"column":16}},{"start":{"line":104,"column":8},"end":{"line":106,"column":16}},{"start":{"line":107,"column":8},"end":{"line":109,"column":16}},{"start":{"line":110,"column":8},"end":{"line":122,"column":16}}]},"6":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":10},"end":{"line":111,"column":10}},{"start":{"line":111,"column":10},"end":{"line":111,"column":10}}]},"7":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":17},"end":{"line":115,"column":17}},{"start":{"line":115,"column":17},"end":{"line":115,"column":17}}]},"8":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":6},"end":{"line":129,"column":6}},{"start":{"line":129,"column":6},"end":{"line":129,"column":6}}]},"9":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":4},"end":{"line":139,"column":4}},{"start":{"line":139,"column":4},"end":{"line":139,"column":4}}]},"10":{"line":147,"type":"switch","locations":[{"start":{"line":148,"column":6},"end":{"line":150,"column":14}},{"start":{"line":151,"column":6},"end":{"line":152,"column":14}},{"start":{"line":153,"column":6},"end":{"line":155,"column":15}}]},"11":{"line":163,"type":"if","locations":[{"start":{"line":163,"column":6},"end":{"line":163,"column":6}},{"start":{"line":163,"column":6},"end":{"line":163,"column":6}}]},"12":{"line":169,"type":"if","locations":[{"start":{"line":169,"column":6},"end":{"line":169,"column":6}},{"start":{"line":169,"column":6},"end":{"line":169,"column":6}}]},"13":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":10},"end":{"line":169,"column":13}},{"start":{"line":169,"column":18},"end":{"line":169,"column":30}}]},"14":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":8},"end":{"line":170,"column":8}},{"start":{"line":170,"column":8},"end":{"line":170,"column":8}}]},"15":{"line":179,"type":"cond-expr","locations":[{"start":{"line":179,"column":14},"end":{"line":179,"column":22}},{"start":{"line":179,"column":25},"end":{"line":179,"column":29}}]},"16":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":4},"end":{"line":188,"column":4}},{"start":{"line":188,"column":4},"end":{"line":188,"column":4}}]},"17":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":4},"end":{"line":198,"column":4}},{"start":{"line":198,"column":4},"end":{"line":198,"column":4}}]},"18":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":8},"end":{"line":202,"column":8}},{"start":{"line":202,"column":8},"end":{"line":202,"column":8}}]},"19":{"line":203,"type":"if","locations":[{"start":{"line":203,"column":10},"end":{"line":203,"column":10}},{"start":{"line":203,"column":10},"end":{"line":203,"column":10}}]},"20":{"line":215,"type":"if","locations":[{"start":{"line":215,"column":4},"end":{"line":215,"column":4}},{"start":{"line":215,"column":4},"end":{"line":215,"column":4}}]},"21":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":4},"end":{"line":223,"column":4}},{"start":{"line":223,"column":4},"end":{"line":223,"column":4}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var fs = require('fs');","var events = require('events');","var Stream = require('stream');","var unzip = require('unzip2');","var Sax = require('sax');","","var utils = require('../../utils/utils');","//var Enums = require('../../doc/enums');","//var StreamBuf = require('../../utils/stream-buf');","//var StutteredPipe = require('../../utils/stuttered-pipe');","var FlowControl = require('../../utils/flow-control');","//var AutoDrain = require('../../utils/auto-drain');","","//var RelType = require('../../xlsx/rel-type');","var StyleManager = require('../../xlsx/xform/style/styles-xform');","//var SharedStrings = require('../../utils/shared-strings');","","var WorksheetReader = require('./worksheet-reader');","var HyperlinkReader = require('./hyperlink-reader');","","var WorkbookReader = module.exports = function(options) {","  this.options = options = options || {};","","  // until we actually parse a styles.xml file, just assume we're not handling styles","  // (but we do need to handle dates)","  this.styles = new StyleManager.Mock();","","  // worksheet readers, indexed by sheetNo","  this.worksheetReaders = {};","","  // hyperlink readers, indexed by sheetNo","  this.hyperlinkReaders = {};","","  // count the open readers","  this.readers = 0;","","  // end of stream check","  this.atEnd = false;","};","","utils.inherits(WorkbookReader, events.EventEmitter, {","  _getStream: function(input) {","    if (input instanceof Stream.Readable) {","      return input;","    }","    if (typeof input === 'string') {","      return fs.createReadStream(input);","    }","    throw new Error('Could not recognise input');","  },","","  get flowControl() {","    if (!this._flowControl) {","      this._flowControl = new FlowControl(this.options);","    }","    return this._flowControl;","  },","","  options: {","    entries: ['emit'],","    sharedStrings: ['cache', 'emit'],","    styles: ['cache'],","    hyperlinks: ['cache', 'emit'],","    worksheets: ['emit']","  },","  read: function(input, options) {","    var self = this;","    var stream = this.stream = this._getStream(input);","    var zip = this.zip = unzip.Parse();","","    zip.on('entry',function (entry) {","      // console.log(entry.path)","      var match, sheetNo;","      switch(entry.path) {","        case '_rels/.rels':","        case 'xl/workbook.xml':","        case 'xl/_rels/workbook.xml.rels':","          entry.autodrain();","          break;","        case 'xl/sharedStrings.xml':","          self._parseSharedStrings(entry, options);","          break;","        case 'xl/styles.xml':","          self._parseStyles(entry, options);","          break;","        default:","          if (entry.path.match(/xl\\/worksheets\\/sheet\\d+\\.xml/)) {","            match = entry.path.match(/xl\\/worksheets\\/sheet(\\d+)\\.xml/);","            sheetNo = match[1];","            self._parseWorksheet(entry, sheetNo, options);","          } else if (entry.path.match(/xl\\/worksheets\\/_rels\\/sheet\\d+\\.xml.rels/)) {","            match = entry.path.match(/xl\\/worksheets\\/_rels\\/sheet(\\d+)\\.xml.rels/);","            sheetNo = match[1];","            self._parseHyperlinks(entry, sheetNo, options);","          } else {","            entry.autodrain();","          }","          break;","      }","    });","","    zip.on('close', function () {","      self.emit('end');","      self.atEnd = true;","      if (!self.readers) {","        self.emit('finished');","      }","    });","","    // Pipe stream into top flow-control","    // this.flowControl.pipe(zip);","    stream.pipe(zip);","  },","  _emitEntry: function(options, payload) {","    if (options.entries === 'emit') {","      this.emit('entry', payload);","    }","  },","  _parseSharedStrings: function(entry, options) {","    this._emitEntry(options, {type: 'shared-strings'});","    var self = this;","    var sharedStrings = null;","    switch(options.sharedStrings) {","      case 'cache':","        sharedStrings = this.sharedStrings = [];","        break;","      case 'emit':","        break;","      default:","        entry.autodrain();","        return;","    }","","    var parser = Sax.createStream(true, {});","    var inT = false;","    var t = null;","    var index = 0;","    parser.on('opentag', function(node) {","      if (node.name === 't') {","        t = null;","        inT = true;","      }","    });","    parser.on('closetag', function (name) {","      if (inT && (name === 't')) {","        if (sharedStrings) {","          sharedStrings.push(t);","        } else {","          self.emit('shared-string', { index: index++, text: t});","        }","        t = null;","      }","    });","    parser.on('text', function (text) {","      t = t ? t + text : text;","    });","    parser.on('error', function (error) {","      self.emit('error', error);","    });","    entry.pipe(parser);","  },","  _parseStyles: function(entry, options) {","    this._emitEntry(options, {type: 'styles'});","    if (options.styles !== 'cache') {","      entry.autodrain();","      return;","    }","    this.styles = new StyleManager();","    this.styles.parse(entry);","  },","  _getReader: function(Type, collection, sheetNo) {","    var self = this;","    var reader = collection[sheetNo];","    if (!reader) {","      reader = new Type(this, sheetNo);","      self.readers++;","      reader.on('finished', function() {","        if (!--self.readers) {","          if (self.atEnd) {","            self.emit('finished');","          }","        }","      });","      collection[sheetNo] = reader;","    }","    return reader;","  },","  _parseWorksheet: function(entry, sheetNo, options) {","    this._emitEntry(options, {type: 'worksheet', id: sheetNo});","    var worksheetReader = this._getReader(WorksheetReader, this.worksheetReaders, sheetNo);","    if (options.worksheets === 'emit') {","      this.emit('worksheet', worksheetReader);","    }","    worksheetReader.read(entry, options, this.hyperlinkReaders[sheetNo]);","  },","  _parseHyperlinks: function(entry, sheetNo, options) {","    this._emitEntry(options, {type: 'hyerlinks', id: sheetNo});","    var hyperlinksReader = this._getReader(HyperlinkReader, this.hyperlinkReaders, sheetNo);","    if (options.hyperlinks === 'emit') {","      this.emit('hyperlinks', hyperlinksReader);","    }","    hyperlinksReader.read(entry, options);","  }","});",""],"l":{"25":1,"26":1,"27":1,"28":1,"29":1,"31":1,"35":1,"39":1,"42":1,"43":1,"45":1,"46":0,"50":0,"53":0,"56":0,"59":0,"62":0,"65":1,"67":0,"68":0,"70":0,"71":0,"73":0,"77":0,"78":0,"80":0,"91":0,"92":0,"93":0,"95":0,"97":0,"98":0,"102":0,"103":0,"105":0,"106":0,"108":0,"109":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"120":0,"122":0,"126":0,"127":0,"128":0,"129":0,"130":0,"136":0,"139":0,"140":0,"144":0,"145":0,"146":0,"147":0,"149":0,"150":0,"152":0,"154":0,"155":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"168":0,"169":0,"170":0,"171":0,"173":0,"175":0,"178":0,"179":0,"181":0,"182":0,"184":0,"187":0,"188":0,"189":0,"190":0,"192":0,"193":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"208":0,"210":0,"213":0,"214":0,"215":0,"216":0,"218":0,"221":0,"222":0,"223":0,"224":0,"226":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/flow-control.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/utils/flow-control.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},"fnMap":{"1":{"name":"(anonymous_1)","line":33,"loc":{"start":{"line":33,"column":35},"end":{"line":33,"column":53}}},"2":{"name":"(anonymous_2)","line":61,"loc":{"start":{"line":61,"column":24},"end":{"line":61,"column":35}}},"3":{"name":"(anonymous_3)","line":73,"loc":{"start":{"line":73,"column":10},"end":{"line":73,"column":13}}},"4":{"name":"(anonymous_4)","line":80,"loc":{"start":{"line":80,"column":12},"end":{"line":80,"column":15}}},"5":{"name":"(anonymous_5)","line":83,"loc":{"start":{"line":83,"column":25},"end":{"line":83,"column":41}}},"6":{"name":"(anonymous_6)","line":85,"loc":{"start":{"line":85,"column":10},"end":{"line":85,"column":13}}},"7":{"name":"(anonymous_7)","line":91,"loc":{"start":{"line":91,"column":10},"end":{"line":91,"column":40}}},"8":{"name":"(anonymous_8)","line":95,"loc":{"start":{"line":95,"column":34},"end":{"line":95,"column":60}}},"9":{"name":"(anonymous_9)","line":96,"loc":{"start":{"line":96,"column":32},"end":{"line":96,"column":48}}},"10":{"name":"(anonymous_10)","line":108,"loc":{"start":{"line":108,"column":9},"end":{"line":108,"column":25}}},"11":{"name":"(anonymous_11)","line":113,"loc":{"start":{"line":113,"column":23},"end":{"line":113,"column":38}}},"12":{"name":"(anonymous_12)","line":128,"loc":{"start":{"line":128,"column":12},"end":{"line":128,"column":23}}},"13":{"name":"(anonymous_13)","line":136,"loc":{"start":{"line":136,"column":12},"end":{"line":136,"column":23}}},"14":{"name":"(anonymous_14)","line":141,"loc":{"start":{"line":141,"column":23},"end":{"line":141,"column":34}}},"15":{"name":"(anonymous_15)","line":145,"loc":{"start":{"line":145,"column":10},"end":{"line":145,"column":21}}},"16":{"name":"(anonymous_16)","line":150,"loc":{"start":{"line":150,"column":36},"end":{"line":150,"column":62}}},"17":{"name":"(anonymous_17)","line":152,"loc":{"start":{"line":152,"column":19},"end":{"line":152,"column":30}}},"18":{"name":"(anonymous_18)","line":162,"loc":{"start":{"line":162,"column":10},"end":{"line":162,"column":21}}},"19":{"name":"(anonymous_19)","line":171,"loc":{"start":{"line":171,"column":16},"end":{"line":171,"column":27}}},"20":{"name":"(anonymous_20)","line":174,"loc":{"start":{"line":174,"column":16},"end":{"line":174,"column":27}}},"21":{"name":"(anonymous_21)","line":175,"loc":{"start":{"line":175,"column":25},"end":{"line":175,"column":36}}},"22":{"name":"(anonymous_22)","line":190,"loc":{"start":{"line":190,"column":9},"end":{"line":190,"column":44}}},"23":{"name":"(anonymous_23)","line":217,"loc":{"start":{"line":217,"column":7},"end":{"line":217,"column":43}}},"24":{"name":"(anonymous_24)","line":222,"loc":{"start":{"line":222,"column":16},"end":{"line":222,"column":27}}},"25":{"name":"(anonymous_25)","line":230,"loc":{"start":{"line":230,"column":8},"end":{"line":230,"column":34}}},"26":{"name":"(anonymous_26)","line":241,"loc":{"start":{"line":241,"column":10},"end":{"line":241,"column":27}}},"27":{"name":"(anonymous_27)","line":242,"loc":{"start":{"line":242,"column":35},"end":{"line":242,"column":50}}},"28":{"name":"(anonymous_28)","line":247,"loc":{"start":{"line":247,"column":15},"end":{"line":247,"column":26}}},"29":{"name":"(anonymous_29)","line":254,"loc":{"start":{"line":254,"column":22},"end":{"line":254,"column":33}}},"30":{"name":"(anonymous_30)","line":259,"loc":{"start":{"line":259,"column":23},"end":{"line":259,"column":34}}},"31":{"name":"(anonymous_31)","line":261,"loc":{"start":{"line":261,"column":43},"end":{"line":261,"column":58}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":38}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":31}},"4":{"start":{"line":33,"column":0},"end":{"line":70,"column":2}},"5":{"start":{"line":34,"column":2},"end":{"line":34,"column":41}},"6":{"start":{"line":37,"column":2},"end":{"line":37,"column":18}},"7":{"start":{"line":40,"column":2},"end":{"line":40,"column":18}},"8":{"start":{"line":43,"column":2},"end":{"line":43,"column":21}},"9":{"start":{"line":46,"column":2},"end":{"line":46,"column":31}},"10":{"start":{"line":49,"column":2},"end":{"line":49,"column":24}},"11":{"start":{"line":52,"column":2},"end":{"line":69,"column":3}},"12":{"start":{"line":53,"column":4},"end":{"line":53,"column":24}},"13":{"start":{"line":54,"column":4},"end":{"line":66,"column":5}},"14":{"start":{"line":55,"column":6},"end":{"line":55,"column":38}},"15":{"start":{"line":58,"column":6},"end":{"line":58,"column":76}},"16":{"start":{"line":60,"column":6},"end":{"line":60,"column":67}},"17":{"start":{"line":61,"column":6},"end":{"line":65,"column":8}},"18":{"start":{"line":62,"column":8},"end":{"line":62,"column":43}},"19":{"start":{"line":63,"column":8},"end":{"line":63,"column":40}},"20":{"start":{"line":64,"column":8},"end":{"line":64,"column":75}},"21":{"start":{"line":68,"column":4},"end":{"line":68,"column":27}},"22":{"start":{"line":72,"column":0},"end":{"line":269,"column":3}},"23":{"start":{"line":74,"column":4},"end":{"line":78,"column":16}},"24":{"start":{"line":82,"column":4},"end":{"line":83,"column":88}},"25":{"start":{"line":83,"column":43},"end":{"line":83,"column":84}},"26":{"start":{"line":88,"column":4},"end":{"line":88,"column":65}},"27":{"start":{"line":95,"column":4},"end":{"line":105,"column":7}},"28":{"start":{"line":96,"column":6},"end":{"line":104,"column":9}},"29":{"start":{"line":97,"column":8},"end":{"line":103,"column":9}},"30":{"start":{"line":99,"column":10},"end":{"line":99,"column":24}},"31":{"start":{"line":102,"column":10},"end":{"line":102,"column":20}},"32":{"start":{"line":109,"column":4},"end":{"line":109,"column":20}},"33":{"start":{"line":112,"column":4},"end":{"line":112,"column":22}},"34":{"start":{"line":113,"column":4},"end":{"line":123,"column":7}},"35":{"start":{"line":114,"column":6},"end":{"line":122,"column":7}},"36":{"start":{"line":115,"column":8},"end":{"line":119,"column":9}},"37":{"start":{"line":116,"column":10},"end":{"line":116,"column":56}},"38":{"start":{"line":118,"column":10},"end":{"line":118,"column":78}},"39":{"start":{"line":121,"column":8},"end":{"line":121,"column":26}},"40":{"start":{"line":124,"column":4},"end":{"line":126,"column":5}},"41":{"start":{"line":125,"column":6},"end":{"line":125,"column":50}},"42":{"start":{"line":127,"column":4},"end":{"line":134,"column":9}},"43":{"start":{"line":129,"column":8},"end":{"line":133,"column":9}},"44":{"start":{"line":130,"column":10},"end":{"line":130,"column":27}},"45":{"start":{"line":137,"column":4},"end":{"line":137,"column":18}},"46":{"start":{"line":138,"column":4},"end":{"line":138,"column":36}},"47":{"start":{"line":140,"column":4},"end":{"line":140,"column":25}},"48":{"start":{"line":141,"column":4},"end":{"line":143,"column":12}},"49":{"start":{"line":142,"column":6},"end":{"line":142,"column":50}},"50":{"start":{"line":147,"column":4},"end":{"line":147,"column":55}},"51":{"start":{"line":148,"column":4},"end":{"line":148,"column":20}},"52":{"start":{"line":149,"column":4},"end":{"line":159,"column":5}},"53":{"start":{"line":150,"column":6},"end":{"line":156,"column":9}},"54":{"start":{"line":151,"column":8},"end":{"line":151,"column":36}},"55":{"start":{"line":152,"column":8},"end":{"line":155,"column":20}},"56":{"start":{"line":153,"column":10},"end":{"line":153,"column":31}},"57":{"start":{"line":154,"column":10},"end":{"line":154,"column":20}},"58":{"start":{"line":158,"column":6},"end":{"line":158,"column":42}},"59":{"start":{"line":164,"column":4},"end":{"line":164,"column":20}},"60":{"start":{"line":167,"column":4},"end":{"line":187,"column":5}},"61":{"start":{"line":168,"column":6},"end":{"line":180,"column":7}},"62":{"start":{"line":169,"column":8},"end":{"line":169,"column":29}},"63":{"start":{"line":170,"column":8},"end":{"line":179,"column":13}},"64":{"start":{"line":172,"column":12},"end":{"line":172,"column":50}},"65":{"start":{"line":175,"column":12},"end":{"line":178,"column":15}},"66":{"start":{"line":176,"column":14},"end":{"line":176,"column":36}},"67":{"start":{"line":177,"column":14},"end":{"line":177,"column":28}},"68":{"start":{"line":182,"column":6},"end":{"line":186,"column":7}},"69":{"start":{"line":185,"column":8},"end":{"line":185,"column":27}},"70":{"start":{"line":192,"column":4},"end":{"line":195,"column":5}},"71":{"start":{"line":193,"column":6},"end":{"line":193,"column":26}},"72":{"start":{"line":194,"column":6},"end":{"line":194,"column":24}},"73":{"start":{"line":196,"column":4},"end":{"line":196,"column":37}},"74":{"start":{"line":198,"column":4},"end":{"line":200,"column":5}},"75":{"start":{"line":199,"column":6},"end":{"line":199,"column":58}},"76":{"start":{"line":204,"column":4},"end":{"line":208,"column":7}},"77":{"start":{"line":209,"column":4},"end":{"line":209,"column":18}},"78":{"start":{"line":213,"column":4},"end":{"line":213,"column":58}},"79":{"start":{"line":214,"column":4},"end":{"line":214,"column":21}},"80":{"start":{"line":219,"column":4},"end":{"line":219,"column":20}},"81":{"start":{"line":221,"column":4},"end":{"line":226,"column":7}},"82":{"start":{"line":223,"column":8},"end":{"line":223,"column":26}},"83":{"start":{"line":224,"column":8},"end":{"line":224,"column":28}},"84":{"start":{"line":227,"column":4},"end":{"line":227,"column":18}},"85":{"start":{"line":231,"column":4},"end":{"line":231,"column":28}},"86":{"start":{"line":234,"column":4},"end":{"line":234,"column":37}},"87":{"start":{"line":236,"column":4},"end":{"line":239,"column":7}},"88":{"start":{"line":242,"column":4},"end":{"line":244,"column":7}},"89":{"start":{"line":243,"column":6},"end":{"line":243,"column":36}},"90":{"start":{"line":249,"column":4},"end":{"line":249,"column":20}},"91":{"start":{"line":250,"column":4},"end":{"line":250,"column":62}},"92":{"start":{"line":251,"column":4},"end":{"line":251,"column":41}},"93":{"start":{"line":252,"column":4},"end":{"line":252,"column":30}},"94":{"start":{"line":254,"column":4},"end":{"line":257,"column":7}},"95":{"start":{"line":256,"column":6},"end":{"line":256,"column":20}},"96":{"start":{"line":259,"column":4},"end":{"line":265,"column":7}},"97":{"start":{"line":261,"column":6},"end":{"line":263,"column":9}},"98":{"start":{"line":262,"column":8},"end":{"line":262,"column":30}},"99":{"start":{"line":264,"column":6},"end":{"line":264,"column":20}},"100":{"start":{"line":267,"column":4},"end":{"line":267,"column":17}}},"branchMap":{"1":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":27},"end":{"line":34,"column":34}},{"start":{"line":34,"column":38},"end":{"line":34,"column":40}}]},"2":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":2},"end":{"line":52,"column":2}},{"start":{"line":52,"column":2},"end":{"line":52,"column":2}}]},"3":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":4},"end":{"line":54,"column":4}},{"start":{"line":54,"column":4},"end":{"line":54,"column":4}}]},"4":{"line":58,"type":"cond-expr","locations":[{"start":{"line":58,"column":51},"end":{"line":58,"column":63}},{"start":{"line":58,"column":66},"end":{"line":58,"column":75}}]},"5":{"line":60,"type":"cond-expr","locations":[{"start":{"line":60,"column":47},"end":{"line":60,"column":57}},{"start":{"line":60,"column":60},"end":{"line":60,"column":66}}]},"6":{"line":64,"type":"cond-expr","locations":[{"start":{"line":64,"column":40},"end":{"line":64,"column":41}},{"start":{"line":64,"column":44},"end":{"line":64,"column":74}}]},"7":{"line":76,"type":"cond-expr","locations":[{"start":{"line":76,"column":20},"end":{"line":76,"column":27}},{"start":{"line":76,"column":30},"end":{"line":76,"column":36}}]},"8":{"line":77,"type":"cond-expr","locations":[{"start":{"line":77,"column":20},"end":{"line":77,"column":28}},{"start":{"line":77,"column":31},"end":{"line":77,"column":37}}]},"9":{"line":82,"type":"binary-expr","locations":[{"start":{"line":82,"column":12},"end":{"line":82,"column":36}},{"start":{"line":83,"column":6},"end":{"line":83,"column":87}}]},"10":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":50},"end":{"line":83,"column":61}},{"start":{"line":83,"column":65},"end":{"line":83,"column":83}}]},"11":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":11},"end":{"line":88,"column":22}},{"start":{"line":88,"column":26},"end":{"line":88,"column":37}},{"start":{"line":88,"column":42},"end":{"line":88,"column":63}}]},"12":{"line":97,"type":"if","locations":[{"start":{"line":97,"column":8},"end":{"line":97,"column":8}},{"start":{"line":97,"column":8},"end":{"line":97,"column":8}}]},"13":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":6},"end":{"line":114,"column":6}},{"start":{"line":114,"column":6},"end":{"line":114,"column":6}}]},"14":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":8},"end":{"line":115,"column":8}},{"start":{"line":115,"column":8},"end":{"line":115,"column":8}}]},"15":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":4},"end":{"line":124,"column":4}},{"start":{"line":124,"column":4},"end":{"line":124,"column":4}}]},"16":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":18},"end":{"line":147,"column":33}},{"start":{"line":147,"column":37},"end":{"line":147,"column":54}}]},"17":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":4},"end":{"line":149,"column":4}},{"start":{"line":149,"column":4},"end":{"line":149,"column":4}}]},"18":{"line":167,"type":"if","locations":[{"start":{"line":167,"column":4},"end":{"line":167,"column":4}},{"start":{"line":167,"column":4},"end":{"line":167,"column":4}}]},"19":{"line":167,"type":"binary-expr","locations":[{"start":{"line":167,"column":8},"end":{"line":167,"column":18}},{"start":{"line":167,"column":22},"end":{"line":167,"column":36}},{"start":{"line":167,"column":40},"end":{"line":167,"column":52}}]},"20":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":6},"end":{"line":168,"column":6}},{"start":{"line":168,"column":6},"end":{"line":168,"column":6}}]},"21":{"line":182,"type":"if","locations":[{"start":{"line":182,"column":6},"end":{"line":182,"column":6}},{"start":{"line":182,"column":6},"end":{"line":182,"column":6}}]},"22":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":4},"end":{"line":192,"column":4}},{"start":{"line":192,"column":4},"end":{"line":192,"column":4}}]},"23":{"line":196,"type":"binary-expr","locations":[{"start":{"line":196,"column":15},"end":{"line":196,"column":23}},{"start":{"line":196,"column":27},"end":{"line":196,"column":36}}]},"24":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":4},"end":{"line":198,"column":4}},{"start":{"line":198,"column":4},"end":{"line":198,"column":4}}]},"25":{"line":213,"type":"binary-expr","locations":[{"start":{"line":213,"column":19},"end":{"line":213,"column":30}},{"start":{"line":213,"column":35},"end":{"line":213,"column":56}}]},"26":{"line":231,"type":"binary-expr","locations":[{"start":{"line":231,"column":14},"end":{"line":231,"column":21}},{"start":{"line":231,"column":25},"end":{"line":231,"column":27}}]},"27":{"line":234,"type":"binary-expr","locations":[{"start":{"line":234,"column":15},"end":{"line":234,"column":27}},{"start":{"line":234,"column":31},"end":{"line":234,"column":36}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var events = require('events');","var PromishLib = require('./promish');","","var utils = require('./utils');","","// =============================================================================","// FlowControl - Used to slow down streaming to manageable speed","// Implements a subset of Stream.Duplex: pipe() and write()","var FlowControl = module.exports = function(options) {","  this.options = options = options || {};","","  // Buffer queue","  this.queue = [];","","  // Consumer streams","  this.pipes = [];","","  // Down-stream flow-control instances","  this.children = [];","","  // Up-stream flow-control instances","  this.parent = options.parent;","","  // Ensure we don't flush more than once at a time","  this.flushing = false;","","  // determine timeout for flow control delays","  if (options.gc) {","    var gc = options.gc;","    if (gc.getTimeout) {","      this.getTimeout = gc.getTimeout;","    } else {","      // heap size below which we don't bother delaying","      var threshold = gc.threshold !== undefined ? gc.threshold : 150000000;","      // convert from heapsize to ms timeout","      var divisor = gc.divisor !== undefined ? gc.divisor : 500000;","      this.getTimeout = function() {","        var memory = process.memoryUsage();","        var heapSize = memory.heapTotal;","        return (heapSize < threshold) ? 0 : Math.floor(heapSize / divisor);","      };","    }","  } else {","    this.getTimeout = null;","  }","};","","utils.inherits(FlowControl, events.EventEmitter, {","  get name() {","    return [","      'FlowControl',","      this.parent ? 'Child' : 'Root',","      this.corked ? 'corked' : 'open'","    ].join(' ');","  },","  get corked() {","    // We remain corked while we have children and at least one has data to consume","    return (this.children.length > 0) &&","      this.children.some(function(child) { return child.queue && child.queue.length; });","  },","  get stem() {","    // the decision to stem the incoming data depends on whether the children are corked","    // and how many buffers we have backed up","    return this.corked || !this.queue || (this.queue.length > 2);","  },","","  _write: function(dst, data, encoding) {","    // Write to a single destination and return a promise    ","    // console.log(this.name + ' _write: ' + data.length);","","    return new PromishLib.Promish(function(resolve, reject) {","      dst.write(data, encoding, function(error) {","        if (error) {","          // console.log(self.name + ' _write error: ' + error.message);            ","          reject(error);","        } else {","          // console.log(self.name + ' _write complete');            ","          resolve();","        }","      });","    });","  },","","  _pipe: function(chunk) {","    var self = this;","","    // Write chunk to all pipes. A chunk with no data is the end","    var promises = [];","    this.pipes.forEach(function(pipe) {","      if (chunk.data) {","        if (pipe.sync) {","          pipe.stream.write(chunk.data, chunk.encoding);","        } else {","          promises.push(self._write(pipe.stream, chunk.data, chunk.encoding));","        }","      } else {","        pipe.stream.end();","      }","    });","    if (!promises.length) {","      promises.push(PromishLib.Promish.resolve());","    }","    return PromishLib.Promish.all(promises)","      .then(function() {","        try {","          chunk.callback();","        }","        catch(e) {","        }","      });","  },","  _animate: function() {","    var count = 0;","    var seq = ['|', '/', '-', '\\\\'];","    //var cr = '\\033[0G';","    var cr = '\\u001b[0G';","    return setInterval(function() {","      process.stdout.write(seq[count++ % 4] + cr);","    }, 100);","  },","  _delay: function() {","    // in certain situations it may be useful to delay processing (e.g. for GC)","    var timeout = this.getTimeout && this.getTimeout();","    var self = this;","    if (timeout) {","      return new PromishLib.Promish(function(resolve, reject) {","        var anime = self._animate();","        setTimeout(function() {","          clearInterval(anime);","          resolve();","        }, timeout);","      });","    } else {","      return PromishLib.Promish.resolve();","    }","  },","","  _flush: function() {","    // If/while not corked and we have buffers to send, send them","    var self = this;","    // console.log(this.name + ' flush:' + (this.queue && this.queue.length));","","    if (this.queue && !this.flushing && !this.corked) {","      if (this.queue.length) {","        this.flushing = true;","        self._delay()","          .then(function() {","            return self._pipe(self.queue.shift());","          })","          .then(function() {","            setImmediate(function() {","              self.flushing = false;","              self._flush();","            });","          });","      }","","      if (!this.stem) {","        // Signal up-stream that we're ready for more data","        // console.log(self.name + ' emitting drain');","        self.emit('drain');","      }","    }","  },","","  write: function(data, encoding, callback) {","    // Called by up-stream pipe","    if (encoding instanceof Function) {","      callback = encoding;","      encoding = 'utf8';","    }","    callback = callback || utils.nop;","","    if (!this.queue) {","      throw new Error('Cannot write to stream after end');","    }","","    // Always queue chunks and then flush","    // console.log(this.name + ' write: ' + data.length);","    this.queue.push({","      data: data,","      encoding: encoding,","      callback: callback","    });","    this._flush();","","    // restrict further incoming data if we have backed up buffers or","    // the children are still busy","    var stemFlow = this.corked || (this.queue.length > 3);","    return !stemFlow;","  },","","  end: function(chunk, encoding, callback) {","    // Signal from up-stream ","    var self = this;","    // console.log(this.name + 'End')","    this.queue.push({","      callback: function() {","        self.queue = null;","        self.emit('finish');","      }","    });","    this._flush();","  },","","  pipe: function(stream, options) {","    options = options || {};","","    // some streams don't call callbacks","    var sync = options.sync || false;","","    this.pipes.push({","      stream: stream,","      sync: sync","    });","  },","  unpipe: function(stream) {","    this.pipes = this.pipes.filter(function(pipe) {","      return pipe.stream !== stream;","    });","  },","","  createChild: function() {","    // Create a down-stream flow-control","    var self = this;","    var options = Object.assign({parent: this}, this.options);","    var child = new FlowControl(options);","    this.children.push(child);","","    child.on('drain', function() {","      // a child is ready for more","      self._flush();","    });","","    child.on('finish', function() {","      // One child has finished it's stream. Remove it and continue","      self.children = self.children.filter(function(item) {","        return item !== child;","      });","      self._flush();","    });","","    return child;","  }","});",""],"l":{"25":1,"26":1,"28":1,"33":1,"34":0,"37":0,"40":0,"43":0,"46":0,"49":0,"52":0,"53":0,"54":0,"55":0,"58":0,"60":0,"61":0,"62":0,"63":0,"64":0,"68":0,"72":1,"74":0,"82":0,"83":0,"88":0,"95":0,"96":0,"97":0,"99":0,"102":0,"109":0,"112":0,"113":0,"114":0,"115":0,"116":0,"118":0,"121":0,"124":0,"125":0,"127":0,"129":0,"130":0,"137":0,"138":0,"140":0,"141":0,"142":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"158":0,"164":0,"167":0,"168":0,"169":0,"170":0,"172":0,"175":0,"176":0,"177":0,"182":0,"185":0,"192":0,"193":0,"194":0,"196":0,"198":0,"199":0,"204":0,"209":0,"213":0,"214":0,"219":0,"221":0,"223":0,"224":0,"227":0,"231":0,"234":0,"236":0,"242":0,"243":0,"249":0,"250":0,"251":0,"252":0,"254":0,"256":0,"259":0,"261":0,"262":0,"264":0,"267":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/worksheet-reader.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/worksheet-reader.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0,0],"9":[0,0],"10":[0,0,0,0,0,0,0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0,0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":37,"loc":{"start":{"line":37,"column":39},"end":{"line":37,"column":62}}},"2":{"name":"(anonymous_2)","line":56,"loc":{"start":{"line":56,"column":11},"end":{"line":56,"column":22}}},"3":{"name":"(anonymous_3)","line":61,"loc":{"start":{"line":61,"column":16},"end":{"line":61,"column":19}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":13},"end":{"line":69,"column":16}}},"5":{"name":"(anonymous_5)","line":75,"loc":{"start":{"line":75,"column":13},"end":{"line":75,"column":25}}},"6":{"name":"(anonymous_6)","line":97,"loc":{"start":{"line":97,"column":12},"end":{"line":97,"column":26}}},"7":{"name":"(anonymous_7)","line":101,"loc":{"start":{"line":101,"column":8},"end":{"line":101,"column":50}}},"8":{"name":"(anonymous_8)","line":145,"loc":{"start":{"line":145,"column":25},"end":{"line":145,"column":40}}},"9":{"name":"(anonymous_9)","line":229,"loc":{"start":{"line":229,"column":22},"end":{"line":229,"column":38}}},"10":{"name":"(anonymous_10)","line":237,"loc":{"start":{"line":237,"column":26},"end":{"line":237,"column":41}}},"11":{"name":"(anonymous_11)","line":311,"loc":{"start":{"line":311,"column":23},"end":{"line":311,"column":40}}},"12":{"name":"(anonymous_12)","line":314,"loc":{"start":{"line":314,"column":21},"end":{"line":314,"column":32}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":23}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":31}},"3":{"start":{"line":27,"column":0},"end":{"line":27,"column":25}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":41}},"5":{"start":{"line":30,"column":0},"end":{"line":30,"column":48}},"6":{"start":{"line":32,"column":0},"end":{"line":32,"column":44}},"7":{"start":{"line":34,"column":0},"end":{"line":34,"column":35}},"8":{"start":{"line":35,"column":0},"end":{"line":35,"column":41}},"9":{"start":{"line":37,"column":0},"end":{"line":50,"column":2}},"10":{"start":{"line":38,"column":2},"end":{"line":38,"column":27}},"11":{"start":{"line":39,"column":2},"end":{"line":39,"column":15}},"12":{"start":{"line":42,"column":2},"end":{"line":42,"column":32}},"13":{"start":{"line":45,"column":2},"end":{"line":45,"column":23}},"14":{"start":{"line":46,"column":2},"end":{"line":46,"column":18}},"15":{"start":{"line":49,"column":2},"end":{"line":49,"column":38}},"16":{"start":{"line":52,"column":0},"end":{"line":323,"column":3}},"17":{"start":{"line":57,"column":4},"end":{"line":57,"column":50}},"18":{"start":{"line":62,"column":4},"end":{"line":62,"column":28}},"19":{"start":{"line":70,"column":4},"end":{"line":70,"column":25}},"20":{"start":{"line":76,"column":4},"end":{"line":83,"column":5}},"21":{"start":{"line":78,"column":6},"end":{"line":78,"column":30}},"22":{"start":{"line":79,"column":6},"end":{"line":79,"column":30}},"23":{"start":{"line":79,"column":17},"end":{"line":79,"column":28}},"24":{"start":{"line":82,"column":6},"end":{"line":82,"column":26}},"25":{"start":{"line":84,"column":4},"end":{"line":84,"column":47}},"26":{"start":{"line":84,"column":26},"end":{"line":84,"column":45}},"27":{"start":{"line":85,"column":4},"end":{"line":90,"column":5}},"28":{"start":{"line":86,"column":6},"end":{"line":86,"column":39}},"29":{"start":{"line":87,"column":6},"end":{"line":89,"column":7}},"30":{"start":{"line":88,"column":8},"end":{"line":88,"column":50}},"31":{"start":{"line":91,"column":4},"end":{"line":91,"column":30}},"32":{"start":{"line":98,"column":4},"end":{"line":98,"column":26}},"33":{"start":{"line":102,"column":4},"end":{"line":102,"column":20}},"34":{"start":{"line":104,"column":4},"end":{"line":104,"column":26}},"35":{"start":{"line":105,"column":4},"end":{"line":105,"column":26}},"36":{"start":{"line":106,"column":4},"end":{"line":106,"column":31}},"37":{"start":{"line":107,"column":4},"end":{"line":107,"column":26}},"38":{"start":{"line":108,"column":4},"end":{"line":115,"column":5}},"39":{"start":{"line":110,"column":8},"end":{"line":110,"column":25}},"40":{"start":{"line":111,"column":8},"end":{"line":111,"column":14}},"41":{"start":{"line":113,"column":8},"end":{"line":113,"column":25}},"42":{"start":{"line":114,"column":8},"end":{"line":114,"column":14}},"43":{"start":{"line":116,"column":4},"end":{"line":123,"column":5}},"44":{"start":{"line":118,"column":8},"end":{"line":118,"column":30}},"45":{"start":{"line":119,"column":8},"end":{"line":119,"column":14}},"46":{"start":{"line":121,"column":8},"end":{"line":121,"column":42}},"47":{"start":{"line":122,"column":8},"end":{"line":122,"column":14}},"48":{"start":{"line":124,"column":4},"end":{"line":127,"column":5}},"49":{"start":{"line":125,"column":6},"end":{"line":125,"column":24}},"50":{"start":{"line":126,"column":6},"end":{"line":126,"column":13}},"51":{"start":{"line":130,"column":4},"end":{"line":130,"column":52}},"52":{"start":{"line":131,"column":4},"end":{"line":131,"column":38}},"53":{"start":{"line":134,"column":4},"end":{"line":134,"column":23}},"54":{"start":{"line":135,"column":4},"end":{"line":135,"column":23}},"55":{"start":{"line":136,"column":4},"end":{"line":136,"column":29}},"56":{"start":{"line":139,"column":4},"end":{"line":139,"column":20}},"57":{"start":{"line":140,"column":4},"end":{"line":140,"column":19}},"58":{"start":{"line":141,"column":4},"end":{"line":141,"column":17}},"59":{"start":{"line":142,"column":4},"end":{"line":142,"column":23}},"60":{"start":{"line":144,"column":4},"end":{"line":144,"column":44}},"61":{"start":{"line":145,"column":4},"end":{"line":226,"column":7}},"62":{"start":{"line":146,"column":6},"end":{"line":201,"column":7}},"63":{"start":{"line":147,"column":8},"end":{"line":200,"column":9}},"64":{"start":{"line":149,"column":12},"end":{"line":149,"column":26}},"65":{"start":{"line":150,"column":12},"end":{"line":150,"column":22}},"66":{"start":{"line":151,"column":12},"end":{"line":151,"column":18}},"67":{"start":{"line":153,"column":12},"end":{"line":153,"column":26}},"68":{"start":{"line":154,"column":12},"end":{"line":154,"column":18}},"69":{"start":{"line":157,"column":12},"end":{"line":164,"column":13}},"70":{"start":{"line":158,"column":14},"end":{"line":163,"column":17}},"71":{"start":{"line":165,"column":12},"end":{"line":165,"column":18}},"72":{"start":{"line":168,"column":12},"end":{"line":178,"column":13}},"73":{"start":{"line":169,"column":14},"end":{"line":169,"column":50}},"74":{"start":{"line":170,"column":14},"end":{"line":170,"column":37}},"75":{"start":{"line":171,"column":14},"end":{"line":173,"column":15}},"76":{"start":{"line":172,"column":16},"end":{"line":172,"column":60}},"77":{"start":{"line":174,"column":14},"end":{"line":177,"column":15}},"78":{"start":{"line":175,"column":16},"end":{"line":175,"column":58}},"79":{"start":{"line":176,"column":16},"end":{"line":176,"column":58}},"80":{"start":{"line":179,"column":12},"end":{"line":179,"column":18}},"81":{"start":{"line":181,"column":12},"end":{"line":187,"column":13}},"82":{"start":{"line":182,"column":14},"end":{"line":186,"column":16}},"83":{"start":{"line":188,"column":12},"end":{"line":188,"column":18}},"84":{"start":{"line":190,"column":12},"end":{"line":192,"column":13}},"85":{"start":{"line":191,"column":14},"end":{"line":191,"column":43}},"86":{"start":{"line":193,"column":12},"end":{"line":193,"column":18}},"87":{"start":{"line":195,"column":12},"end":{"line":197,"column":13}},"88":{"start":{"line":196,"column":14},"end":{"line":196,"column":43}},"89":{"start":{"line":198,"column":12},"end":{"line":198,"column":18}},"90":{"start":{"line":206,"column":6},"end":{"line":225,"column":7}},"91":{"start":{"line":207,"column":8},"end":{"line":224,"column":9}},"92":{"start":{"line":209,"column":12},"end":{"line":209,"column":32}},"93":{"start":{"line":210,"column":12},"end":{"line":210,"column":18}},"94":{"start":{"line":212,"column":12},"end":{"line":222,"column":13}},"95":{"start":{"line":213,"column":14},"end":{"line":216,"column":16}},"96":{"start":{"line":217,"column":14},"end":{"line":221,"column":15}},"97":{"start":{"line":218,"column":16},"end":{"line":218,"column":50}},"98":{"start":{"line":220,"column":16},"end":{"line":220,"column":54}},"99":{"start":{"line":223,"column":12},"end":{"line":223,"column":18}},"100":{"start":{"line":229,"column":4},"end":{"line":235,"column":7}},"101":{"start":{"line":230,"column":6},"end":{"line":234,"column":7}},"102":{"start":{"line":231,"column":8},"end":{"line":233,"column":9}},"103":{"start":{"line":232,"column":10},"end":{"line":232,"column":31}},"104":{"start":{"line":237,"column":4},"end":{"line":310,"column":7}},"105":{"start":{"line":238,"column":6},"end":{"line":302,"column":7}},"106":{"start":{"line":239,"column":8},"end":{"line":301,"column":9}},"107":{"start":{"line":241,"column":12},"end":{"line":241,"column":27}},"108":{"start":{"line":242,"column":12},"end":{"line":242,"column":51}},"109":{"start":{"line":243,"column":12},"end":{"line":243,"column":18}},"110":{"start":{"line":245,"column":12},"end":{"line":245,"column":27}},"111":{"start":{"line":246,"column":12},"end":{"line":246,"column":18}},"112":{"start":{"line":249,"column":12},"end":{"line":249,"column":44}},"113":{"start":{"line":250,"column":12},"end":{"line":250,"column":31}},"114":{"start":{"line":251,"column":12},"end":{"line":251,"column":23}},"115":{"start":{"line":252,"column":12},"end":{"line":252,"column":18}},"116":{"start":{"line":255,"column":12},"end":{"line":299,"column":13}},"117":{"start":{"line":256,"column":14},"end":{"line":256,"column":58}},"118":{"start":{"line":257,"column":14},"end":{"line":257,"column":50}},"119":{"start":{"line":258,"column":14},"end":{"line":260,"column":15}},"120":{"start":{"line":259,"column":16},"end":{"line":259,"column":69}},"121":{"start":{"line":262,"column":14},"end":{"line":297,"column":15}},"122":{"start":{"line":263,"column":16},"end":{"line":265,"column":18}},"123":{"start":{"line":266,"column":16},"end":{"line":272,"column":17}},"124":{"start":{"line":267,"column":18},"end":{"line":271,"column":19}},"125":{"start":{"line":268,"column":20},"end":{"line":268,"column":61}},"126":{"start":{"line":270,"column":20},"end":{"line":270,"column":56}},"127":{"start":{"line":273,"column":16},"end":{"line":273,"column":35}},"128":{"start":{"line":274,"column":21},"end":{"line":297,"column":15}},"129":{"start":{"line":275,"column":16},"end":{"line":296,"column":17}},"130":{"start":{"line":277,"column":20},"end":{"line":277,"column":51}},"131":{"start":{"line":278,"column":20},"end":{"line":284,"column":21}},"132":{"start":{"line":279,"column":22},"end":{"line":279,"column":56}},"133":{"start":{"line":281,"column":22},"end":{"line":283,"column":24}},"134":{"start":{"line":285,"column":20},"end":{"line":285,"column":26}},"135":{"start":{"line":287,"column":20},"end":{"line":287,"column":59}},"136":{"start":{"line":288,"column":20},"end":{"line":288,"column":26}},"137":{"start":{"line":290,"column":20},"end":{"line":294,"column":21}},"138":{"start":{"line":291,"column":22},"end":{"line":291,"column":75}},"139":{"start":{"line":293,"column":22},"end":{"line":293,"column":56}},"140":{"start":{"line":295,"column":20},"end":{"line":295,"column":26}},"141":{"start":{"line":298,"column":14},"end":{"line":298,"column":23}},"142":{"start":{"line":300,"column":12},"end":{"line":300,"column":18}},"143":{"start":{"line":303,"column":6},"end":{"line":309,"column":7}},"144":{"start":{"line":304,"column":8},"end":{"line":308,"column":9}},"145":{"start":{"line":306,"column":12},"end":{"line":306,"column":33}},"146":{"start":{"line":307,"column":12},"end":{"line":307,"column":18}},"147":{"start":{"line":311,"column":4},"end":{"line":313,"column":7}},"148":{"start":{"line":312,"column":6},"end":{"line":312,"column":32}},"149":{"start":{"line":314,"column":4},"end":{"line":316,"column":7}},"150":{"start":{"line":315,"column":6},"end":{"line":315,"column":28}},"151":{"start":{"line":319,"column":4},"end":{"line":319,"column":62}},"152":{"start":{"line":320,"column":4},"end":{"line":320,"column":43}},"153":{"start":{"line":321,"column":4},"end":{"line":321,"column":28}}},"branchMap":{"1":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":4},"end":{"line":76,"column":4}},{"start":{"line":76,"column":4},"end":{"line":76,"column":4}}]},"2":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":6},"end":{"line":79,"column":6}},{"start":{"line":79,"column":6},"end":{"line":79,"column":6}}]},"3":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":4},"end":{"line":84,"column":4}},{"start":{"line":84,"column":4},"end":{"line":84,"column":4}}]},"4":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":4},"end":{"line":85,"column":4}},{"start":{"line":85,"column":4},"end":{"line":85,"column":4}}]},"5":{"line":108,"type":"switch","locations":[{"start":{"line":109,"column":6},"end":{"line":111,"column":14}},{"start":{"line":112,"column":6},"end":{"line":114,"column":14}}]},"6":{"line":116,"type":"switch","locations":[{"start":{"line":117,"column":6},"end":{"line":119,"column":14}},{"start":{"line":120,"column":6},"end":{"line":122,"column":14}}]},"7":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":4},"end":{"line":124,"column":4}},{"start":{"line":124,"column":4},"end":{"line":124,"column":4}}]},"8":{"line":124,"type":"binary-expr","locations":[{"start":{"line":124,"column":8},"end":{"line":124,"column":18}},{"start":{"line":124,"column":22},"end":{"line":124,"column":37}},{"start":{"line":124,"column":41},"end":{"line":124,"column":52}}]},"9":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":6},"end":{"line":146,"column":6}},{"start":{"line":146,"column":6},"end":{"line":146,"column":6}}]},"10":{"line":147,"type":"switch","locations":[{"start":{"line":148,"column":10},"end":{"line":151,"column":18}},{"start":{"line":152,"column":10},"end":{"line":154,"column":18}},{"start":{"line":156,"column":10},"end":{"line":165,"column":18}},{"start":{"line":167,"column":10},"end":{"line":179,"column":18}},{"start":{"line":180,"column":10},"end":{"line":188,"column":18}},{"start":{"line":189,"column":10},"end":{"line":193,"column":18}},{"start":{"line":194,"column":10},"end":{"line":198,"column":18}},{"start":{"line":199,"column":10},"end":{"line":199,"column":27}}]},"11":{"line":157,"type":"if","locations":[{"start":{"line":157,"column":12},"end":{"line":157,"column":12}},{"start":{"line":157,"column":12},"end":{"line":157,"column":12}}]},"12":{"line":162,"type":"binary-expr","locations":[{"start":{"line":162,"column":34},"end":{"line":162,"column":55}},{"start":{"line":162,"column":59},"end":{"line":162,"column":62}}]},"13":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":12},"end":{"line":168,"column":12}},{"start":{"line":168,"column":12},"end":{"line":168,"column":12}}]},"14":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":14},"end":{"line":171,"column":14}},{"start":{"line":171,"column":14},"end":{"line":171,"column":14}}]},"15":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":14},"end":{"line":174,"column":14}},{"start":{"line":174,"column":14},"end":{"line":174,"column":14}}]},"16":{"line":181,"type":"if","locations":[{"start":{"line":181,"column":12},"end":{"line":181,"column":12}},{"start":{"line":181,"column":12},"end":{"line":181,"column":12}}]},"17":{"line":190,"type":"if","locations":[{"start":{"line":190,"column":12},"end":{"line":190,"column":12}},{"start":{"line":190,"column":12},"end":{"line":190,"column":12}}]},"18":{"line":195,"type":"if","locations":[{"start":{"line":195,"column":12},"end":{"line":195,"column":12}},{"start":{"line":195,"column":12},"end":{"line":195,"column":12}}]},"19":{"line":206,"type":"if","locations":[{"start":{"line":206,"column":6},"end":{"line":206,"column":6}},{"start":{"line":206,"column":6},"end":{"line":206,"column":6}}]},"20":{"line":206,"type":"binary-expr","locations":[{"start":{"line":206,"column":10},"end":{"line":206,"column":24}},{"start":{"line":206,"column":28},"end":{"line":206,"column":38}}]},"21":{"line":207,"type":"switch","locations":[{"start":{"line":208,"column":10},"end":{"line":210,"column":18}},{"start":{"line":211,"column":10},"end":{"line":223,"column":18}}]},"22":{"line":212,"type":"if","locations":[{"start":{"line":212,"column":12},"end":{"line":212,"column":12}},{"start":{"line":212,"column":12},"end":{"line":212,"column":12}}]},"23":{"line":217,"type":"if","locations":[{"start":{"line":217,"column":14},"end":{"line":217,"column":14}},{"start":{"line":217,"column":14},"end":{"line":217,"column":14}}]},"24":{"line":230,"type":"if","locations":[{"start":{"line":230,"column":6},"end":{"line":230,"column":6}},{"start":{"line":230,"column":6},"end":{"line":230,"column":6}}]},"25":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":8},"end":{"line":231,"column":8}},{"start":{"line":231,"column":8},"end":{"line":231,"column":8}}]},"26":{"line":238,"type":"if","locations":[{"start":{"line":238,"column":6},"end":{"line":238,"column":6}},{"start":{"line":238,"column":6},"end":{"line":238,"column":6}}]},"27":{"line":239,"type":"switch","locations":[{"start":{"line":240,"column":10},"end":{"line":243,"column":18}},{"start":{"line":244,"column":10},"end":{"line":246,"column":18}},{"start":{"line":248,"column":10},"end":{"line":252,"column":18}},{"start":{"line":254,"column":10},"end":{"line":300,"column":18}}]},"28":{"line":255,"type":"if","locations":[{"start":{"line":255,"column":12},"end":{"line":255,"column":12}},{"start":{"line":255,"column":12},"end":{"line":255,"column":12}}]},"29":{"line":255,"type":"binary-expr","locations":[{"start":{"line":255,"column":16},"end":{"line":255,"column":19}},{"start":{"line":255,"column":23},"end":{"line":255,"column":24}}]},"30":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":14},"end":{"line":258,"column":14}},{"start":{"line":258,"column":14},"end":{"line":258,"column":14}}]},"31":{"line":262,"type":"if","locations":[{"start":{"line":262,"column":14},"end":{"line":262,"column":14}},{"start":{"line":262,"column":14},"end":{"line":262,"column":14}}]},"32":{"line":266,"type":"if","locations":[{"start":{"line":266,"column":16},"end":{"line":266,"column":16}},{"start":{"line":266,"column":16},"end":{"line":266,"column":16}}]},"33":{"line":267,"type":"if","locations":[{"start":{"line":267,"column":18},"end":{"line":267,"column":18}},{"start":{"line":267,"column":18},"end":{"line":267,"column":18}}]},"34":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":21},"end":{"line":274,"column":21}},{"start":{"line":274,"column":21},"end":{"line":274,"column":21}}]},"35":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":18},"end":{"line":285,"column":26}},{"start":{"line":286,"column":18},"end":{"line":288,"column":26}},{"start":{"line":289,"column":18},"end":{"line":295,"column":26}}]},"36":{"line":278,"type":"if","locations":[{"start":{"line":278,"column":20},"end":{"line":278,"column":20}},{"start":{"line":278,"column":20},"end":{"line":278,"column":20}}]},"37":{"line":290,"type":"if","locations":[{"start":{"line":290,"column":20},"end":{"line":290,"column":20}},{"start":{"line":290,"column":20},"end":{"line":290,"column":20}}]},"38":{"line":303,"type":"if","locations":[{"start":{"line":303,"column":6},"end":{"line":303,"column":6}},{"start":{"line":303,"column":6},"end":{"line":303,"column":6}}]},"39":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":10},"end":{"line":303,"column":24}},{"start":{"line":303,"column":28},"end":{"line":303,"column":38}}]},"40":{"line":304,"type":"switch","locations":[{"start":{"line":305,"column":10},"end":{"line":307,"column":18}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," *"," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the 'Software'), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," *"," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," *"," * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," *"," */","'use strict';","","var fs = require('fs');","var events = require('events');","var Sax = require('sax');","","var utils = require('../../utils/utils');","var colCache = require('../../utils/col-cache');","//var Enums = require('../../doc/enums');","var Dimensions = require('../../doc/range');","","var Row = require('../../doc/row');","var Column = require('../../doc/column');","","var WorksheetReader = module.exports = function(workbook, id) {","  this.workbook = workbook;","  this.id = id;","","  // and a name","  this.name = 'Sheet' + this.id;","","  // column definitions","  this._columns = null;","  this._keys = {};","","  // keep a record of dimensions","  this._dimensions = new Dimensions();","};","","utils.inherits(WorksheetReader, events.EventEmitter, {","","  // destroy - not a valid operation for a streaming writer","  // even though some streamers might be able to, it's a bad idea.","  destroy: function() {","    throw new Error('Invalid Operation: destroy');","  },","","  // return the current dimensions of the writer","  get dimensions() {","    return this._dimensions;","  },","","  // =========================================================================","  // Columns","","  // get the current columns array.","  get columns() {","    return this._columns;","  },","","  // get a single column by col number. If it doesn't exist, it and any gaps before it","  // are created.","  getColumn: function(c) {","    if (typeof c === 'string'){","      // if it matches a key'd column, return that","      var col = this._keys[c];","      if (col) { return col; }","","      // otherise, assume letter","      c = colCache.l2n(c);","    }","    if (!this._columns) { this._columns = []; }","    if (c > this._columns.length) {","      var n = this._columns.length + 1;","      while (n <= c) {","        this._columns.push(new Column(this, n++));","      }","    }","    return this._columns[c-1];","  },","","  // =========================================================================","  // Read","","  _emitRow: function(row) {","    this.emit('row', row);","  },","","  read: function(entry, options, hyperlinkReader) {","    var self = this;","","    var emitSheet = false;","    var prepSheet = false;","    var emitHyperlinks = false;","    var hyperlinks = null;","    switch (options.worksheets) {","      case 'emit':","        emitSheet = true;","        break;","      case 'prep':","        prepSheet = true;","        break;","    }","    switch(options.hyperlinks) {","      case 'emit':","        emitHyperlinks = true;","        break;","      case 'cache':","        this.hyperlinks = hyperlinks = {};","        break;","    }","    if (!emitSheet && !emitHyperlinks && !hyperlinks) {","      entry.autodrain();","      return;","    }","","    // references","    var sharedStrings = this.workbook.sharedStrings;","    var styles = this.workbook.styles;","","    // xml position","    var inCols = false;","    var inRows = false;","    var inHyperlinks = false;","","    // parse state","    var cols = null;","    var row = null;","    var c = null;","    var current = null;","","    var parser = Sax.createStream(true, {});","    parser.on('opentag', function(node) {","      if (emitSheet) {","        switch (node.name) {","          case 'cols':","            inCols = true;","            cols = [];","            break;","          case 'sheetData':","            inRows = true;","            break;","","          case 'col':","            if (inCols) {","              cols.push({","                min: parseInt(node.attributes.min),","                max: parseInt(node.attributes.max),","                width: parseFloat(node.attributes.width),","                styleId: parseInt(node.attributes.style || '0')","              });","            }","            break;","","          case 'row':","            if (inRows) {","              var r = parseInt(node.attributes.r);","              row = new Row(self, r);","              if (node.attributes.ht) {","                row.height = parseFloat(node.attributes.ht);","              }","              if (node.attributes.s) {","                var styleId = parseInt(node.attributes.s);","                row.style = styles.getStyleModel(styleId);","              }","            }","            break;","          case 'c':","            if (row) {","              c = {","                ref: node.attributes.r,","                s: parseInt(node.attributes.s),","                t: node.attributes.t","              };","            }","            break;","          case 'f':","            if (c) {","              current = c.f = { text: '' };","            }","            break;","          case 'v':","            if (c) {","              current = c.v = { text: '' };","            }","            break;","          case 'mergeCell':","        }","      }","","","      // =================================================================","      //","      if (emitHyperlinks || hyperlinks) {","        switch (node.name) {","          case 'hyperlinks':","            inHyperlinks = true;","            break;","          case 'hyperlink':","            if (inHyperlinks) {","              var hyperlink = {","                ref: node.attributes.ref,","                rId: node.attributes['r:id']","              };","              if (emitHyperlinks) {","                self.emit('hyperlink', hyperlink);","              } else {","                hyperlinks[hyperlink.ref] = hyperlink;","              }","            }","            break;","        }","      }","    });","","    // only text data is for sheet values","    parser.on('text', function (text) {","      if (emitSheet) {","        if (current) {","          current.text += text;","        }","      }","    });","","    parser.on('closetag', function(name) {","      if (emitSheet) {","        switch (name) {","          case 'cols':","            inCols = false;","            self._columns = Column.fromModel(cols);","            break;","          case 'sheetData':","            inRows = false;","            break;","","          case 'row':","            self._dimensions.expandRow(row);","            self._emitRow(row);","            row = null;","            break;","","          case 'c':","            if (row && c) {","              var address = colCache.decodeAddress(c.ref);","              var cell = row.getCell(address.col);","              if (c.s) {","                cell.style = self.workbook.styles.getStyleModel(c.s);","              }","","              if (c.f) {","                var value = {","                  formula: c.f.text","                };","                if (c.v) {","                  if (c.t === 'str') {","                    value.result = utils.xmlDecode(c.v.text);","                  } else {","                    value.result = parseFloat(c.v.text);","                  }","                }","                cell.value = value;","              } else if (c.v) {","                switch(c.t) {","                  case 's':","                    var index = parseInt(c.v.text);","                    if (sharedStrings) {","                      cell.value = sharedStrings[index];","                    } else {","                      cell.value = {","                        sharedString: index","                      };","                    }","                    break;","                  case 'str':","                    cell.value = utils.xmlDecode(c.v.text);","                    break;","                  default:","                    if (utils.isDateFmt(cell.numFmt)) {","                      cell.value = utils.excelToDate(parseFloat(c.v.text));","                    } else {","                      cell.value = parseFloat(c.v.text);","                    }","                    break;","                }","              }","              c = null;","            }","            break;","        }","      }","      if (emitHyperlinks || hyperlinks) {","        switch (name) {","          case 'hyperlinks':","            inHyperlinks = false;","            break;","        }","      }","    });","    parser.on('error', function (error) {","      self.emit('error', error);","    });","    parser.on('end', function() {","      self.emit('finished');","    });","","    // create a down-stream flow-control to regulate the stream","    var flowControl = this.workbook.flowControl.createChild();","    flowControl.pipe(parser, {sync: true});","    entry.pipe(flowControl);","  }","});",""],"l":{"25":1,"26":1,"27":1,"29":1,"30":1,"32":1,"34":1,"35":1,"37":1,"38":0,"39":0,"42":0,"45":0,"46":0,"49":0,"52":1,"57":0,"62":0,"70":0,"76":0,"78":0,"79":0,"82":0,"84":0,"85":0,"86":0,"87":0,"88":0,"91":0,"98":0,"102":0,"104":0,"105":0,"106":0,"107":0,"108":0,"110":0,"111":0,"113":0,"114":0,"116":0,"118":0,"119":0,"121":0,"122":0,"124":0,"125":0,"126":0,"130":0,"131":0,"134":0,"135":0,"136":0,"139":0,"140":0,"141":0,"142":0,"144":0,"145":0,"146":0,"147":0,"149":0,"150":0,"151":0,"153":0,"154":0,"157":0,"158":0,"165":0,"168":0,"169":0,"170":0,"171":0,"172":0,"174":0,"175":0,"176":0,"179":0,"181":0,"182":0,"188":0,"190":0,"191":0,"193":0,"195":0,"196":0,"198":0,"206":0,"207":0,"209":0,"210":0,"212":0,"213":0,"217":0,"218":0,"220":0,"223":0,"229":0,"230":0,"231":0,"232":0,"237":0,"238":0,"239":0,"241":0,"242":0,"243":0,"245":0,"246":0,"249":0,"250":0,"251":0,"252":0,"255":0,"256":0,"257":0,"258":0,"259":0,"262":0,"263":0,"266":0,"267":0,"268":0,"270":0,"273":0,"274":0,"275":0,"277":0,"278":0,"279":0,"281":0,"285":0,"287":0,"288":0,"290":0,"291":0,"293":0,"295":0,"298":0,"300":0,"303":0,"304":0,"306":0,"307":0,"311":0,"312":0,"314":0,"315":0,"319":0,"320":0,"321":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/hyperlink-reader.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/stream/xlsx/hyperlink-reader.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0},"b":{"1":[0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0],"7":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"(anonymous_1)","line":31,"loc":{"start":{"line":31,"column":39},"end":{"line":31,"column":62}}},"2":{"name":"(anonymous_2)","line":40,"loc":{"start":{"line":40,"column":13},"end":{"line":40,"column":16}}},"3":{"name":"(anonymous_3)","line":44,"loc":{"start":{"line":44,"column":10},"end":{"line":44,"column":23}}},"4":{"name":"(anonymous_4)","line":48,"loc":{"start":{"line":48,"column":10},"end":{"line":48,"column":35}}},"5":{"name":"(anonymous_5)","line":66,"loc":{"start":{"line":66,"column":29},"end":{"line":66,"column":44}}},"6":{"name":"(anonymous_6)","line":86,"loc":{"start":{"line":86,"column":25},"end":{"line":86,"column":36}}}},"statementMap":{"1":{"start":{"line":25,"column":0},"end":{"line":25,"column":31}},"2":{"start":{"line":26,"column":0},"end":{"line":26,"column":25}},"3":{"start":{"line":28,"column":0},"end":{"line":28,"column":41}},"4":{"start":{"line":29,"column":0},"end":{"line":29,"column":39}},"5":{"start":{"line":31,"column":0},"end":{"line":36,"column":2}},"6":{"start":{"line":33,"column":4},"end":{"line":33,"column":17}},"7":{"start":{"line":35,"column":4},"end":{"line":35,"column":30}},"8":{"start":{"line":38,"column":0},"end":{"line":95,"column":3}},"9":{"start":{"line":41,"column":8},"end":{"line":41,"column":62}},"10":{"start":{"line":45,"column":8},"end":{"line":45,"column":43}},"11":{"start":{"line":49,"column":8},"end":{"line":49,"column":24}},"12":{"start":{"line":50,"column":8},"end":{"line":50,"column":35}},"13":{"start":{"line":51,"column":8},"end":{"line":51,"column":30}},"14":{"start":{"line":52,"column":8},"end":{"line":59,"column":9}},"15":{"start":{"line":54,"column":16},"end":{"line":54,"column":38}},"16":{"start":{"line":55,"column":16},"end":{"line":55,"column":22}},"17":{"start":{"line":57,"column":16},"end":{"line":57,"column":50}},"18":{"start":{"line":58,"column":16},"end":{"line":58,"column":22}},"19":{"start":{"line":60,"column":8},"end":{"line":63,"column":9}},"20":{"start":{"line":61,"column":12},"end":{"line":61,"column":30}},"21":{"start":{"line":62,"column":12},"end":{"line":62,"column":19}},"22":{"start":{"line":65,"column":8},"end":{"line":65,"column":48}},"23":{"start":{"line":66,"column":8},"end":{"line":85,"column":11}},"24":{"start":{"line":67,"column":12},"end":{"line":84,"column":13}},"25":{"start":{"line":68,"column":16},"end":{"line":68,"column":45}},"26":{"start":{"line":69,"column":16},"end":{"line":83,"column":17}},"27":{"start":{"line":71,"column":24},"end":{"line":76,"column":26}},"28":{"start":{"line":77,"column":24},"end":{"line":81,"column":25}},"29":{"start":{"line":78,"column":28},"end":{"line":78,"column":65}},"30":{"start":{"line":80,"column":28},"end":{"line":80,"column":72}},"31":{"start":{"line":82,"column":24},"end":{"line":82,"column":30}},"32":{"start":{"line":86,"column":8},"end":{"line":88,"column":11}},"33":{"start":{"line":87,"column":12},"end":{"line":87,"column":34}},"34":{"start":{"line":91,"column":8},"end":{"line":91,"column":66}},"35":{"start":{"line":92,"column":8},"end":{"line":92,"column":47}},"36":{"start":{"line":93,"column":8},"end":{"line":93,"column":32}}},"branchMap":{"1":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":15},"end":{"line":41,"column":30}},{"start":{"line":41,"column":34},"end":{"line":41,"column":56}},{"start":{"line":41,"column":60},"end":{"line":41,"column":61}}]},"2":{"line":52,"type":"switch","locations":[{"start":{"line":53,"column":12},"end":{"line":55,"column":22}},{"start":{"line":56,"column":12},"end":{"line":58,"column":22}}]},"3":{"line":60,"type":"if","locations":[{"start":{"line":60,"column":8},"end":{"line":60,"column":8}},{"start":{"line":60,"column":8},"end":{"line":60,"column":8}}]},"4":{"line":60,"type":"binary-expr","locations":[{"start":{"line":60,"column":12},"end":{"line":60,"column":27}},{"start":{"line":60,"column":31},"end":{"line":60,"column":42}}]},"5":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":12},"end":{"line":67,"column":12}},{"start":{"line":67,"column":12},"end":{"line":67,"column":12}}]},"6":{"line":69,"type":"switch","locations":[{"start":{"line":70,"column":20},"end":{"line":82,"column":30}}]},"7":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":24},"end":{"line":77,"column":24}},{"start":{"line":77,"column":24},"end":{"line":77,"column":24}}]}},"code":["/**"," * Copyright (c) 2015 Guyon Roche"," * "," * Permission is hereby granted, free of charge, to any person obtaining a copy"," * of this software and associated documentation files (the \"Software\"), to deal"," * in the Software without restriction, including without limitation the rights"," * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"," * copies of the Software, and to permit persons to whom the Software is"," * furnished to do so, subject to the following conditions:"," * "," * The above copyright notice and this permission notice shall be included in"," * all copies or substantial portions of the Software."," * "," * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"," * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"," * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE"," * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"," * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"," * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"," * THE SOFTWARE."," * "," */","'use strict';","","var events = require('events');","var Sax = require('sax');","","var utils = require('../../utils/utils');","var Enums = require('../../doc/enums');","","var HyperlinkReader = module.exports = function(workbook, id) {","    // in a workbook, each sheet will have a number","    this.id = id;","    ","    this._workbook = workbook;    ","};","","utils.inherits(HyperlinkReader, events.EventEmitter, {","    ","    get count() {","        return this.hyperlinks && this.hyperlinks.length || 0;","    },","    ","    each: function(fn) {","        return this.hyperlinks.forEach(fn);","    },","    ","    read: function(entry, options) {","        var self = this;","        var emitHyperlinks = false;","        var hyperlinks = null;","        switch(options.hyperlinks) {","            case 'emit':","                emitHyperlinks = true;","                break;","            case 'cache':","                this.hyperlinks = hyperlinks = {};","                break;","        }","        if (!emitHyperlinks && !hyperlinks) {","            entry.autodrain();","            return;","        }","        ","        var parser = Sax.createStream(true, {});","        parser.on('opentag', function(node) {","            if (node.name === 'Relationship') {","                var rId = node.attributes.Id;","                switch (node.attributes.Type) {","                    case XLSX.RelType.Hyperlink:","                        var relationship = {","                            type: Enums.RelationshipType.Styles,","                            rId: rId,","                            target: node.attributes.Target,","                            targetMode: node.attributes.TargetMode","                        };","                        if (emitHyperlinks) {","                            self.emit('hyperlink', relationship);","                        } else {","                            hyperlinks[relationship.rId] = relationship;","                        }","                        break;","                }","            }","        });","        parser.on('end', function() {","            self.emit('finished');","        });","        ","        // create a down-stream flow-control to regulate the stream","        var flowControl = this.workbook.flowControl.createChild();","        flowControl.pipe(parser, {sync: true});","        entry.pipe(flowControl);","    }","});"],"l":{"25":1,"26":1,"28":1,"29":1,"31":1,"33":0,"35":0,"38":1,"41":0,"45":0,"49":0,"50":0,"51":0,"52":0,"54":0,"55":0,"57":0,"58":0,"60":0,"61":0,"62":0,"65":0,"66":0,"67":0,"68":0,"69":0,"71":0,"77":0,"78":0,"80":0,"82":0,"86":0,"87":0,"91":0,"92":0,"93":0}},"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/exceljs.browser.js":{"path":"/home/travis/build/npmtest/node-npmtest-exceljs/node_modules/exceljs/lib/exceljs.browser.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":5,"7":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":2,"column":0},"end":{"line":2,"column":51}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":7,"column":2}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":35}},"5":{"start":{"line":11,"column":0},"end":{"line":13,"column":1}},"6":{"start":{"line":12,"column":2},"end":{"line":12,"column":24}},"7":{"start":{"line":15,"column":0},"end":{"line":15,"column":25}}},"branchMap":{},"code":["// for the benefit of browserify, include browser friendly promise","var setConfigValue = require('./config/set-value');","setConfigValue('promise', require('promish/dist/promish-node'), false);","","var ExcelJS = {","  Workbook: require(\"./doc/workbook\")","};","","// Object.assign mono-fill","var Enums = require('./doc/enums');","for (var i in Enums) {","  ExcelJS[i] = Enums[i];","}","","module.exports = ExcelJS;"],"l":{"2":1,"3":1,"5":1,"10":1,"11":1,"12":5,"15":1}}}